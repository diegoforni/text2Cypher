{
  "summary": {
    "total_queries": 15,
    "run_duration_seconds": 2822.690555,
    "model": "gpt-5.2",
    "provider": "openai",
    "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
    "started_at": "2026-02-20T04:38:21.462953+00:00",
    "ended_at": "2026-02-20T05:25:24.153508+00:00",
    "status_breakdown": {
      "SUCCESS": 9,
      "ERROR": 3,
      "SUCCESS_ZERO_ROWS": 3
    },
    "error_types": {
      "OTHER": 3
    },
    "total_tokens": 45967,
    "total_duration_seconds": 2822.677,
    "success_rate": 60.0
  },
  "results": [
    {
      "index": 1,
      "category": "simple",
      "prompt": "What is the attack technique most used overall?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH a.technique AS technique, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 1\nRETURN technique, attacks",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS attack_count\nORDER BY attack_count DESC\nWITH collect({technique: technique, attack_count: attack_count}) AS rows\nWITH rows, rows[0].attack_count AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.attack_count = max_count\nRETURN row.technique AS technique, row.attack_count AS attack_count\nORDER BY technique",
      "response": [
        {
          "technique": "T1566 Phishing",
          "attack_count": 2863569
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 458,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which attack technique appears most frequently in the dataset overall, based on recorded ATTACKS events, i.e., the technique used in the greatest number of observed attack relationships.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"IP\",\n      \"Country\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:ATTACKS]->(:Country)\"\n    ],\n    \"RELEVANT_PROPERTIES\": [\n      \"ATTACKS.technique\"\n    ],\n    \"CONTEXT_NOT_REQUIRED_BUT_AVAILABLE\": [\n      \"ATTACKS.protocol\",\n      \"ATTACKS.technology\",\n      \"ATTACKS.industry\",\n      \"ATTACKS.pulse_id\",\n      \"ATTACKS.documented_create_date\",\n      \"ATTACKS.documented_modified_date\",\n      \"IP.address\",\n      \"IP.botnet\",\n      \"IP.pulse_ids\",\n      \"Country.name\",\n      \"ASN.number\",\n      \"(:IP)-[:FROM]->(:Country)\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN)\"\n    ]\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [\n      \"Only consider relationships of type ATTACKS\",\n      \"Exclude ATTACKS records where technique is null/empty (to avoid counting unknown techniques as a category unless explicitly desired)\"\n    ],\n    \"NOT_SPECIFIED_BUT_COMMON_OPTIONS\": [\n      \"Time window filtering using documented_create_date/documented_modified_date (not requested; assume all time)\",\n      \"Filter by protocol/technology/industry/pulse_id (not requested; include all)\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": \"Return the single most-used attack technique with its total occurrence count across all ATTACKS relationships; if there is a tie for highest count, return all tied techniques with the same top count, sorted by count descending then technique name.\",\n  \"SUGGESTED_APPROACH\": \"Scan all ATTACKS relationships, group them by the technique property, count how many ATTACKS records fall into each technique, then select the maximum count group(s) and present the top technique(s) and their counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Across all (:IP)-[:ATTACKS]->(:Country) relationships, count occurrences by ATTACKS.technique (excluding null/empty), and return the technique(s) with the highest count along with that count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Across all (:IP)-[:ATTACKS]->(:Country) relationships, count occurrences by ATTACKS.technique (excluding null/empty), and return the technique(s) with the highest count along with that count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS attack_count\nORDER BY attack_count DESC\nWITH collect({technique: technique, attack_count: attack_count}) AS rows\nWITH rows, rows[0].attack_count AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.attack_count = max_count\nRETURN row.technique AS technique, row.attack_count AS attack_count\nORDER BY technique"
          ],
          "trace": [
            {
              "subproblem": "Across all (:IP)-[:ATTACKS]->(:Country) relationships, count occurrences by ATTACKS.technique (excluding null/empty), and return the technique(s) with the highest count along with that count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS attack_count\nORDER BY attack_count DESC\nWITH collect({technique: technique, attack_count: attack_count}) AS rows\nWITH rows, rows[0].attack_count AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.attack_count = max_count\nRETURN row.technique AS technique, row.attack_count AS attack_count\nORDER BY technique",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "attack_count": 2863569
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS attack_count\nORDER BY attack_count DESC\nWITH collect({technique: technique, attack_count: attack_count}) AS rows\nWITH rows, rows[0].attack_count AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.attack_count = max_count\nRETURN row.technique AS technique, row.attack_count AS attack_count\nORDER BY technique"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "attack_count": 2863569
            }
          ]
        },
        "explanation": {
          "text": "This query finds the ATTACKS technique(s) that appear most frequently (excluding null/blank techniques) across all `(:IP)-[:ATTACKS]->(:Country)` relationships and returns the top technique name(s) with their attack count (including ties)."
        }
      },
      "token_usage": {
        "input": 1553,
        "output": 931,
        "total": 2484
      },
      "duration_seconds": 257.795,
      "started_at": "2026-02-20T04:38:21.464842+00:00",
      "ended_at": "2026-02-20T04:42:39.260102+00:00",
      "metadata": {
        "time": "2026-02-20T04:42:39.247562+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 2,
      "category": "matcher-needed",
      "prompt": "From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?",
      "expected_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWITH ip, collect(toLower(a.technique)) AS allTechs\nWHERE any(t IN allTechs WHERE t CONTAINS 'phishing')\nMATCH (ip)-[a2:ATTACKS]->(:Country)\nWHERE NOT toLower(a2.technique) CONTAINS 'phishing'\nWITH a2.technique AS technique, count(*) AS cnt\nWITH collect({technique: technique, cnt: cnt}) AS rows, sum(cnt) AS total\nUNWIND rows AS r\nRETURN r.technique AS technique, r.cnt AS attacks, toFloat(r.cnt) / total * 100.0 AS percentage\nORDER BY percentage DESC",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort_ips\nMATCH (ip:IP)-[b:ATTACKS]->(:Country)\nWHERE ip IN cohort_ips\n  AND b.technique <> 'phishing'\n  AND b.technique <> 'unknown'\nWITH b.technique AS technique, count(*) AS technique_count\nWITH collect({technique: technique, technique_count: technique_count}) AS rows, sum(technique_count) AS non_phishing_activity_denominator\nUNWIND rows AS row\nRETURN\n  row.technique AS technique,\n  row.technique_count AS technique_count,\n  non_phishing_activity_denominator AS non_phishing_activity_denominator,\n  CASE\n    WHEN non_phishing_activity_denominator = 0 THEN 0.0\n    ELSE toFloat(row.technique_count) / toFloat(non_phishing_activity_denominator)\n  END AS percentage_of_cohort_non_phishing_activity\nORDER BY technique_count DESC, technique ASC",
      "response": [
        {
          "technique": "T1566 Phishing",
          "technique_count": 2863569,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.9431495594624424
        },
        {
          "technique": "T1595 Active Scanning",
          "technique_count": 19712,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.006492375115153036
        },
        {
          "technique": "T1110 Brute Force",
          "technique_count": 13452,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.004430571735442301
        },
        {
          "technique": "T1204 User Execution",
          "technique_count": 6119,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.002015363399432905
        },
        {
          "technique": "T1071 Application Layer Protocol",
          "technique_count": 4126,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.001358945805860462
        },
        {
          "technique": "T1129 Shared Modules",
          "technique_count": 3928,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.001293732216534148
        },
        {
          "technique": "T1060 Registry Run Keys / Startup Folder",
          "technique_count": 3717,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0012242369268985307
        },
        {
          "technique": "T1027 Obfuscated Files or Information",
          "technique_count": 3707,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0012209433112759895
        },
        {
          "technique": "T1055 Process Injection",
          "technique_count": 3664,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0012067807640990626
        },
        {
          "technique": "T1045 Software Packing",
          "technique_count": 3275,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0010786591163822136
        },
        {
          "technique": "T1057 Process Discovery",
          "technique_count": 3100,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0010210208429877442
        },
        {
          "technique": "T1040 Network Sniffing",
          "technique_count": 3026,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0009966480873809399
        },
        {
          "technique": "T1140 Deobfuscate/Decode Files or Information",
          "technique_count": 2920,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0009617357617820041
        },
        {
          "technique": "T1112 Modify Registry",
          "technique_count": 2850,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0009386804524242164
        },
        {
          "technique": "T1119 Automated Collection",
          "technique_count": 2809,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0009251766283717978
        },
        {
          "technique": "T1082 System Information Discovery",
          "technique_count": 2740,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0009024506805762641
        },
        {
          "technique": "T1210 Exploitation of Remote Services",
          "technique_count": 2501,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0008237332671975317
        },
        {
          "technique": "T1106 Native API",
          "technique_count": 2358,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0007766345637951938
        },
        {
          "technique": "T1036 Masquerading",
          "technique_count": 2316,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0007628013781805211
        },
        {
          "technique": "T1105 Ingress Tool Transfer",
          "technique_count": 2245,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0007394167072604793
        },
        {
          "technique": "T1143 Hidden Window",
          "technique_count": 2167,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0007137265054046586
        },
        {
          "technique": "T1047 Windows Management Instrumentation",
          "technique_count": 2095,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006900124729223626
        },
        {
          "technique": "T1003 OS Credential Dumping",
          "technique_count": 2056,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006771673719944523
        },
        {
          "technique": "T1023 Shortcut Modification",
          "technique_count": 2022,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006659690788778125
        },
        {
          "technique": "T1012 Query Registry",
          "technique_count": 1895,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006241401604715404
        },
        {
          "technique": "T1428 Unknown Technique",
          "technique_count": 1895,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006241401604715404
        },
        {
          "technique": "T1089 Disabling Security Tools",
          "technique_count": 1894,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0006238107989092862
        },
        {
          "technique": "T1573 Encrypted Channel",
          "technique_count": 1785,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005879103886235881
        },
        {
          "technique": "T1133 External Remote Services",
          "technique_count": 1774,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005842874114387929
        },
        {
          "technique": "T1499 Endpoint Denial of Service",
          "technique_count": 1665,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005483870011530949
        },
        {
          "technique": "T1071.004 DNS",
          "technique_count": 1646,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005421291314702667
        },
        {
          "technique": "T1203 Exploitation for Client Execution",
          "technique_count": 1546,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005091929752448556
        },
        {
          "technique": "T1031 Modify Existing Service",
          "technique_count": 1535,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005055699980600604
        },
        {
          "technique": "T1564 Hide Artifacts",
          "technique_count": 1529,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0005035938286865357
        },
        {
          "technique": "T1053 Scheduled Task/Job",
          "technique_count": 1480,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0004874551121360843
        },
        {
          "technique": "T1189 Drive-by Compromise",
          "technique_count": 1411,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00046472916434055065
        },
        {
          "technique": "T1485 Data Destruction",
          "technique_count": 1411,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00046472916434055065
        },
        {
          "technique": "T1068 Exploitation for Privilege Escalation",
          "technique_count": 1394,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00045913001778223074
        },
        {
          "technique": "T1059 Command and Scripting Interpreter",
          "technique_count": 1298,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0004275113078058361
        },
        {
          "technique": "T1449 Unknown Technique",
          "technique_count": 1195,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00039358706689366263
        },
        {
          "technique": "TA0011 Unknown Technique",
          "technique_count": 1013,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00033364326256341443
        },
        {
          "technique": "TA0003 Unknown Technique",
          "technique_count": 938,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00030894114539435614
        },
        {
          "technique": "TA0004 Unknown Technique",
          "technique_count": 930,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00030630625289632325
        },
        {
          "technique": "TA0005 Unknown Technique",
          "technique_count": 922,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00030367136039829035
        },
        {
          "technique": "T1056 Input Capture",
          "technique_count": 825,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002717232888596416
        },
        {
          "technique": "T1071.001 Web Protocols",
          "technique_count": 825,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002717232888596416
        },
        {
          "technique": "T1096 NTFS File Attributes",
          "technique_count": 820,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.000270076481048371
        },
        {
          "technique": "T1090 Proxy",
          "technique_count": 817,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002690883963616087
        },
        {
          "technique": "T1114 Email Collection",
          "technique_count": 817,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002690883963616087
        },
        {
          "technique": "T1018 Remote System Discovery",
          "technique_count": 785,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002585488263694771
        },
        {
          "technique": "T1056.001 Keylogging",
          "technique_count": 754,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002483386179395997
        },
        {
          "technique": "TA0007 Unknown Technique",
          "technique_count": 740,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00024372755606804215
        },
        {
          "technique": "T1497 Virtualization/Sandbox Evasion",
          "technique_count": 709,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002335173476381647
        },
        {
          "technique": "T1083 File and Directory Discovery",
          "technique_count": 692,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00022791820107984483
        },
        {
          "technique": "TA0009 Unknown Technique",
          "technique_count": 658,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00021671990796320504
        },
        {
          "technique": "T1059.007 JavaScript",
          "technique_count": 654,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0002154024617141886
        },
        {
          "technique": "T1568 Dynamic Resolution",
          "technique_count": 625,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00020585097640881937
        },
        {
          "technique": "T1088 Bypass User Account Control",
          "technique_count": 612,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00020156927609951594
        },
        {
          "technique": "TA0002 Unknown Technique",
          "technique_count": 582,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001916884292318926
        },
        {
          "technique": "TA0006 Unknown Technique",
          "technique_count": 570,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00018773609048484328
        },
        {
          "technique": "T1059.001 PowerShell",
          "technique_count": 568,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00018707736736033506
        },
        {
          "technique": "T1583.005 Botnet",
          "technique_count": 567,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00018674800579808094
        },
        {
          "technique": "T1033 System Owner/User Discovery",
          "technique_count": 563,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001854305595490645
        },
        {
          "technique": "T1553 Subvert Trust Controls",
          "technique_count": 562,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001851011979868104
        },
        {
          "technique": "T1583 Acquire Infrastructure",
          "technique_count": 554,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001824663054887775
        },
        {
          "technique": "T1176 Browser Extensions",
          "technique_count": 549,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00018081949767750693
        },
        {
          "technique": "T1498 Network Denial of Service",
          "technique_count": 527,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001735735433079165
        },
        {
          "technique": "T1125 Video Capture",
          "technique_count": 494,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00016270461175353084
        },
        {
          "technique": "T1547 Boot or Logon Autostart Execution",
          "technique_count": 491,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001617165270667685
        },
        {
          "technique": "T1110.002 Password Cracking",
          "technique_count": 490,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001613871655045144
        },
        {
          "technique": "T1132 Data Encoding",
          "technique_count": 476,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00015677610363295683
        },
        {
          "technique": "T1155 AppleScript",
          "technique_count": 452,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001488714261388582
        },
        {
          "technique": "T1543 Create or Modify System Process",
          "technique_count": 438,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00014426036426730063
        },
        {
          "technique": "T1094 Custom Command and Control Protocol",
          "technique_count": 432,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00014228419489377596
        },
        {
          "technique": "T1064 Scripting",
          "technique_count": 426,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001403080255202513
        },
        {
          "technique": "T1070 Indicator Removal",
          "technique_count": 426,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001403080255202513
        },
        {
          "technique": "T1202 Indirect Command Execution",
          "technique_count": 408,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00013437951739967728
        },
        {
          "technique": "T1003.008 /etc/passwd and /etc/shadow",
          "technique_count": 392,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00012910973240361153
        },
        {
          "technique": "T1095 Non-Application Layer Protocol",
          "technique_count": 380,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001251573936565622
        },
        {
          "technique": "T1598 Phishing for Information",
          "technique_count": 371,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00012219313959627517
        },
        {
          "technique": "T1445 Unknown Technique",
          "technique_count": 360,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00011857016241147996
        },
        {
          "technique": "T1114.002 Remote Email Collection",
          "technique_count": 332,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010934803866836485
        },
        {
          "technique": "T1531 Account Access Removal",
          "technique_count": 330,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010868931554385663
        },
        {
          "technique": "T1566.001 Spearphishing Attachment",
          "technique_count": 322,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010605442304582374
        },
        {
          "technique": "T1001 Data Obfuscation",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1021.001 Remote Desktop Protocol",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1021.006 Windows Remote Management",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1454 Unknown Technique",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1596.001 DNS/Passive DNS",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1596.004 CDNs",
          "technique_count": 318,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001047369767968073
        },
        {
          "technique": "T1192 Spearphishing Link",
          "technique_count": 316,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010407825367229908
        },
        {
          "technique": "T1553.004 Install Root Certificate",
          "technique_count": 310,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010210208429877442
        },
        {
          "technique": "T1562 Impair Defenses",
          "technique_count": 309,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.0001017727227365203
        },
        {
          "technique": "T1563.002 RDP Hijacking",
          "technique_count": 307,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010111399961201208
        },
        {
          "technique": "T1011 Exfiltration Over Other Network Medium",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1019 System Firmware",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1055.001 Dynamic-link Library Injection",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1059.004 Unix Shell",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1071.002 File Transfer Protocols",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1078.004 Cloud Accounts",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1204.001 Malicious Link",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1218.001 Compiled HTML File",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1476 Unknown Technique",
          "technique_count": 306,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 0.00010078463804975797
        },
        {
          "technique": "T1059.002 AppleScript",
          "technique_count": 295,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.716166086496274e-05
        },
        {
          "technique": "T1029 Scheduled Transfer",
          "technique_count": 288,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.485612992918398e-05
        },
        {
          "technique": "T1183 Image File Execution Options Injection",
          "technique_count": 288,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.485612992918398e-05
        },
        {
          "technique": "T1043 Commonly Used Port",
          "technique_count": 285,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.386804524242164e-05
        },
        {
          "technique": "T1563 Remote Service Session Hijacking",
          "technique_count": 284,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.353868368016753e-05
        },
        {
          "technique": "T1415 Unknown Technique",
          "technique_count": 282,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.287996055565931e-05
        },
        {
          "technique": "T1410 Unknown Technique",
          "technique_count": 265,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.728081399733941e-05
        },
        {
          "technique": "T1416 Unknown Technique",
          "technique_count": 264,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.69514524350853e-05
        },
        {
          "technique": "T1046 Network Service Discovery",
          "technique_count": 254,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.36578368125442e-05
        },
        {
          "technique": "T1212 Exploitation for Credential Access",
          "technique_count": 254,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.36578368125442e-05
        },
        {
          "technique": "T1459 Unknown Technique",
          "technique_count": 254,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.36578368125442e-05
        },
        {
          "technique": "T1041 Exfiltration Over C2 Channel",
          "technique_count": 249,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.201102900127364e-05
        },
        {
          "technique": "T1016.001 Internet Connection Discovery",
          "technique_count": 246,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.102294431451131e-05
        },
        {
          "technique": "T1123 Audio Capture",
          "technique_count": 243,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.003485962774897e-05
        },
        {
          "technique": "T1001.003 Protocol or Service Impersonation",
          "technique_count": 240,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098664e-05
        },
        {
          "technique": "T1017 Application Deployment Software",
          "technique_count": 240,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098664e-05
        },
        {
          "technique": "T1138 Application Shimming",
          "technique_count": 240,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098664e-05
        },
        {
          "technique": "T1457 Unknown Technique",
          "technique_count": 233,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.674124400520786e-05
        },
        {
          "technique": "T1158 Hidden Files and Directories",
          "technique_count": 228,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.509443619393732e-05
        },
        {
          "technique": "T1063 Security Software Discovery",
          "technique_count": 227,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.47650746316832e-05
        },
        {
          "technique": "TA0034 Unknown Technique",
          "technique_count": 226,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.44357130694291e-05
        },
        {
          "technique": "TA0040 Unknown Technique",
          "technique_count": 226,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.44357130694291e-05
        },
        {
          "technique": "T1568.002 Domain Generation Algorithms",
          "technique_count": 224,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.377698994492087e-05
        },
        {
          "technique": "T1472 Unknown Technique",
          "technique_count": 216,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.114209744688798e-05
        },
        {
          "technique": "T1491 Defacement",
          "technique_count": 216,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.114209744688798e-05
        },
        {
          "technique": "T1134 Access Token Manipulation",
          "technique_count": 213,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.015401276012564e-05
        },
        {
          "technique": "TA0010 Unknown Technique",
          "technique_count": 210,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.916592807336331e-05
        },
        {
          "technique": "T1199 Trusted Relationship",
          "technique_count": 209,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.88365665111092e-05
        },
        {
          "technique": "T1512 Unknown Technique",
          "technique_count": 208,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.850720494885509e-05
        },
        {
          "technique": "TA0008 Unknown Technique",
          "technique_count": 208,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.850720494885509e-05
        },
        {
          "technique": "T1518 Software Discovery",
          "technique_count": 205,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.751912026209275e-05
        },
        {
          "technique": "T1102 Web Service",
          "technique_count": 196,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.455486620180576e-05
        },
        {
          "technique": "T1480 Execution Guardrails",
          "technique_count": 193,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.356678151504343e-05
        },
        {
          "technique": "T1003.005 Cached Domain Credentials",
          "technique_count": 180,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.928508120573998e-05
        },
        {
          "technique": "TA0001 Unknown Technique",
          "technique_count": 174,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.730891183221532e-05
        },
        {
          "technique": "T1505 Server Software Component",
          "technique_count": 173,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.697955026996121e-05
        },
        {
          "technique": "T1107 File Deletion",
          "technique_count": 172,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.6650188707707095e-05
        },
        {
          "technique": "T1005 Data from Local System",
          "technique_count": 171,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.6320827145452984e-05
        },
        {
          "technique": "T1051 Shared Webroot",
          "technique_count": 168,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.533274245869065e-05
        },
        {
          "technique": "T1423 Unknown Technique",
          "technique_count": 168,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.533274245869065e-05
        },
        {
          "technique": "T1506 Web Session Cookie",
          "technique_count": 168,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.533274245869065e-05
        },
        {
          "technique": "T1122 Component Object Model Hijacking",
          "technique_count": 162,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.335657308516598e-05
        },
        {
          "technique": "T1179 Hooking",
          "technique_count": 161,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.302721152291187e-05
        },
        {
          "technique": "T1443 Unknown Technique",
          "technique_count": 160,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-05
        },
        {
          "technique": "T1478 Unknown Technique",
          "technique_count": 160,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-05
        },
        {
          "technique": "T1081 Credentials in Files",
          "technique_count": 158,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.203912683614954e-05
        },
        {
          "technique": "T1007 System Service Discovery",
          "technique_count": 156,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.138040371164132e-05
        },
        {
          "technique": "T1553.002 Code Signing",
          "technique_count": 156,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.138040371164132e-05
        },
        {
          "technique": "T1036.004 Masquerade Task or Service",
          "technique_count": 146,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.8086788089100204e-05
        },
        {
          "technique": "T1021 Remote Services",
          "technique_count": 135,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.4463810904304985e-05
        },
        {
          "technique": "T1560 Archive Collected Data",
          "technique_count": 130,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.281700309303443e-05
        },
        {
          "technique": "T1087 Account Discovery",
          "technique_count": 129,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.248764153078032e-05
        },
        {
          "technique": "T1550 Use Alternate Authentication Material",
          "technique_count": 129,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.248764153078032e-05
        },
        {
          "technique": "T1215 Kernel Modules and Extensions",
          "technique_count": 128,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.215827996852621e-05
        },
        {
          "technique": "T1489 Service Stop",
          "technique_count": 126,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.149955684401799e-05
        },
        {
          "technique": "TA0037 Unknown Technique",
          "technique_count": 126,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.149955684401799e-05
        },
        {
          "technique": "T1583.001 Domains",
          "technique_count": 124,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.0840833719509766e-05
        },
        {
          "technique": "T1558 Steal or Forge Kerberos Tickets",
          "technique_count": 121,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.985274903274743e-05
        },
        {
          "technique": "T1450 Unknown Technique",
          "technique_count": 120,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-05
        },
        {
          "technique": "T1530 Data from Cloud Storage",
          "technique_count": 120,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-05
        },
        {
          "technique": "T1552 Unsecured Credentials",
          "technique_count": 120,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-05
        },
        {
          "technique": "T1548 Abuse Elevation Control Mechanism",
          "technique_count": 119,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.919402590823921e-05
        },
        {
          "technique": "T1569 System Services",
          "technique_count": 117,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.8535302783730986e-05
        },
        {
          "technique": "T1049 System Network Connections Discovery",
          "technique_count": 116,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.8205941221476874e-05
        },
        {
          "technique": "T1218 System Binary Proxy Execution",
          "technique_count": 115,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.787657965922276e-05
        },
        {
          "technique": "T1571 Non-Standard Port",
          "technique_count": 114,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.754721809696866e-05
        },
        {
          "technique": "T1027.002 Software Packing",
          "technique_count": 112,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.6888494972460435e-05
        },
        {
          "technique": "T1016 System Network Configuration Discovery",
          "technique_count": 111,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.6559133410206324e-05
        },
        {
          "technique": "T1110.003 Password Spraying",
          "technique_count": 111,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.6559133410206324e-05
        },
        {
          "technique": "T1035 Service Execution",
          "technique_count": 110,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.622977184795221e-05
        },
        {
          "technique": "T1190 Exploit Public-Facing Application",
          "technique_count": 110,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.622977184795221e-05
        },
        {
          "technique": "T1427 Unknown Technique",
          "technique_count": 110,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.622977184795221e-05
        },
        {
          "technique": "T1059.006 Python",
          "technique_count": 108,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.557104872344399e-05
        },
        {
          "technique": "T1173 Dynamic Data Exchange",
          "technique_count": 108,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.557104872344399e-05
        },
        {
          "technique": "T1453 Unknown Technique",
          "technique_count": 108,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.557104872344399e-05
        },
        {
          "technique": "T1572 Protocol Tunneling",
          "technique_count": 105,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.4582964036681655e-05
        },
        {
          "technique": "T1205.001 Port Knocking",
          "technique_count": 104,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.4253602474427544e-05
        },
        {
          "technique": "T1460 Unknown Technique",
          "technique_count": 104,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.4253602474427544e-05
        },
        {
          "technique": "T1080 Taint Shared Content",
          "technique_count": 96,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.161870997639466e-05
        },
        {
          "technique": "T1198 SIP and Trust Provider Hijacking",
          "technique_count": 96,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.161870997639466e-05
        },
        {
          "technique": "T1010 Application Window Discovery",
          "technique_count": 90,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.964254060286999e-05
        },
        {
          "technique": "T1584 Compromise Infrastructure",
          "technique_count": 88,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.8983817478361767e-05
        },
        {
          "technique": "T1110.001 Password Guessing",
          "technique_count": 87,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.865445591610766e-05
        },
        {
          "technique": "T1008 Fallback Channels",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1020 Automated Exfiltration",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1055.003 Thread Execution Hijacking",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1074 Data Staged",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1567 Exfiltration Over Web Service",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1585 Establish Accounts",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1587 Develop Capabilities",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1608 Stage Capabilities",
          "technique_count": 84,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.7666371229345325e-05
        },
        {
          "technique": "T1444 Unknown Technique",
          "technique_count": 80,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-05
        },
        {
          "technique": "T1486 Data Encrypted for Impact",
          "technique_count": 78,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.569020185582066e-05
        },
        {
          "technique": "T1496 Resource Hijacking",
          "technique_count": 75,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.4702117169058325e-05
        },
        {
          "technique": "T1502 Parent PID Spoofing",
          "technique_count": 72,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.3714032482295994e-05
        },
        {
          "technique": "TA0029 Unknown Technique",
          "technique_count": 72,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.3714032482295994e-05
        },
        {
          "technique": "T1595.001 Scanning IP Blocks",
          "technique_count": 71,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.3384670920041883e-05
        },
        {
          "technique": "T1595.002 Vulnerability Scanning",
          "technique_count": 71,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.3384670920041883e-05
        },
        {
          "technique": "T1055.013 Process Doppelg\u00e4nging",
          "technique_count": 68,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.239658623327955e-05
        },
        {
          "technique": "T1574 Hijack Execution Flow",
          "technique_count": 67,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.2067224671025437e-05
        },
        {
          "technique": "T1156 Malicious Shell Modification",
          "technique_count": 66,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.1737863108771325e-05
        },
        {
          "technique": "T1614 System Location Discovery",
          "technique_count": 64,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.1079139984263106e-05
        },
        {
          "technique": "TA0030 Unknown Technique",
          "technique_count": 62,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.0420416859754883e-05
        },
        {
          "technique": "TA0043 Unknown Technique",
          "technique_count": 62,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.0420416859754883e-05
        },
        {
          "technique": "T1185 Browser Session Hijacking",
          "technique_count": 60,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-05
        },
        {
          "technique": "T1586.001 Social Media Accounts",
          "technique_count": 60,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-05
        },
        {
          "technique": "T1596.005 Scan Databases",
          "technique_count": 60,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-05
        },
        {
          "technique": "T1102.002 Bidirectional Communication",
          "technique_count": 56,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.8444247486230218e-05
        },
        {
          "technique": "T1091 Replication Through Removable Media",
          "technique_count": 54,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.7785524361721995e-05
        },
        {
          "technique": "T1110.004 Credential Stuffing",
          "technique_count": 54,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.7785524361721995e-05
        },
        {
          "technique": "T1098 Account Manipulation",
          "technique_count": 52,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.7126801237213772e-05
        },
        {
          "technique": "T1546 Event Triggered Execution",
          "technique_count": 48,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.580935498819733e-05
        },
        {
          "technique": "T1583.004 Server",
          "technique_count": 48,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.580935498819733e-05
        },
        {
          "technique": "T1605 Unknown Technique",
          "technique_count": 48,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.580935498819733e-05
        },
        {
          "technique": "T1055.012 Process Hollowing",
          "technique_count": 44,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.4491908739180884e-05
        },
        {
          "technique": "T1147 Hidden Users",
          "technique_count": 41,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3503824052418551e-05
        },
        {
          "technique": "T1414 Unknown Technique",
          "technique_count": 40,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-05
        },
        {
          "technique": "T1490 Inhibit System Recovery",
          "technique_count": 40,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-05
        },
        {
          "technique": "T1510 Unknown Technique",
          "technique_count": 40,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-05
        },
        {
          "technique": "T1529 System Shutdown/Reboot",
          "technique_count": 40,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-05
        },
        {
          "technique": "T1100 Web Shell",
          "technique_count": 37,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.2186377803402107e-05
        },
        {
          "technique": "T1059.005 Visual Basic",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1071.003 Mail Protocols",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1078 Valid Accounts",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1111 Multi-Factor Authentication Interception",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1132.001 Standard Encoding",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1184 SSH Hijacking",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1497.001 System Checks",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1547.001 Registry Run Keys / Startup Folder",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1552.001 Credentials In Files",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1555.003 Credentials from Web Browsers",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1588 Obtain Capabilities",
          "technique_count": 36,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1857016241147997e-05
        },
        {
          "technique": "T1584.005 Botnet",
          "technique_count": 34,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.1198293116639774e-05
        },
        {
          "technique": "T1037 Boot or Logon Initialization Scripts",
          "technique_count": 32,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.0539569992131553e-05
        },
        {
          "technique": "T1037.003 Network Logon Script",
          "technique_count": 32,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.0539569992131553e-05
        },
        {
          "technique": "T1098.002 Additional Email Delegate Permissions",
          "technique_count": 32,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.0539569992131553e-05
        },
        {
          "technique": "T1539 Steal Web Session Cookie",
          "technique_count": 28,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.222123743115109e-06
        },
        {
          "technique": "T1590 Gather Victim Network Information",
          "technique_count": 28,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 9.222123743115109e-06
        },
        {
          "technique": "T1113 Screen Capture",
          "technique_count": 27,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.892762180860997e-06
        },
        {
          "technique": "T1072 Software Deployment Tools",
          "technique_count": 26,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.563400618606886e-06
        },
        {
          "technique": "T1021.004 SSH",
          "technique_count": 25,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 8.234039056352774e-06
        },
        {
          "technique": "T1048.002 Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",
          "technique_count": 24,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098665e-06
        },
        {
          "technique": "T1211 Exploitation for Defense Evasion",
          "technique_count": 24,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098665e-06
        },
        {
          "technique": "T1434 Unknown Technique",
          "technique_count": 24,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098665e-06
        },
        {
          "technique": "T1546.015 Component Object Model Hijacking",
          "technique_count": 24,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098665e-06
        },
        {
          "technique": "T1588.004 Digital Certificates",
          "technique_count": 24,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 7.904677494098665e-06
        },
        {
          "technique": "T1562.001 Disable or Modify Tools",
          "technique_count": 20,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-06
        },
        {
          "technique": "T1399 Unknown Technique",
          "technique_count": 18,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.9285081205739985e-06
        },
        {
          "technique": "T1491.001 Internal Defacement",
          "technique_count": 18,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.9285081205739985e-06
        },
        {
          "technique": "T1448 Unknown Technique",
          "technique_count": 17,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.599146558319887e-06
        },
        {
          "technique": "T1118 InstallUtil",
          "technique_count": 16,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-06
        },
        {
          "technique": "T1528 Steal Application Access Token",
          "technique_count": 16,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-06
        },
        {
          "technique": "T1573.002 Asymmetric Cryptography",
          "technique_count": 16,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-06
        },
        {
          "technique": "T1589 Gather Victim Identity Information",
          "technique_count": 16,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-06
        },
        {
          "technique": "T1591 Gather Victim Org Information",
          "technique_count": 16,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 5.2697849960657765e-06
        },
        {
          "technique": "T1217 Browser Information Discovery",
          "technique_count": 14,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 4.611061871557554e-06
        },
        {
          "technique": "T1003.001 LSASS Memory",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1003.002 Security Account Manager",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1003.003 NTDS",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1003.004 LSA Secrets",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1036.005 Match Legitimate Name or Location",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1038 DLL Search Order Hijacking",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1048.003 Exfiltration Over Unencrypted Non-C2 Protocol",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1056.004 Credential API Hooking",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1069.001 Local Groups",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1076 Remote Desktop Protocol",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1078.002 Domain Accounts",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1078.003 Local Accounts",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1204.002 Malicious File",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1222.002 Linux and Mac File and Directory Permissions Modification",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1404 Unknown Technique",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1412 Unknown Technique",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1503 Credentials from Web Browsers",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1504 PowerShell Profile",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1518.001 Security Software Discovery",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1534 Internal Spearphishing",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1557 Adversary-in-the-Middle",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1562.004 Disable or Modify System Firewall",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1565 Data Manipulation",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1568.001 Fast Flux DNS",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1574.008 Path Interception by Search Order Hijacking",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1578.003 Delete Cloud Instance",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1583.002 DNS Server",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1585.001 Social Media Accounts",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1590.002 DNS",
          "technique_count": 12,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.952338747049332e-06
        },
        {
          "technique": "T1590.004 Network Topology",
          "technique_count": 10,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.2936156225411103e-06
        },
        {
          "technique": "T1590.005 IP Addresses",
          "technique_count": 10,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.2936156225411103e-06
        },
        {
          "technique": "T1195 Supply Chain Compromise",
          "technique_count": 9,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.9642540602869993e-06
        },
        {
          "technique": "T1009 Binary Padding",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1055.014 VDSO Hijacking",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1070.006 Timestomp",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1464 Unknown Technique",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1483 Domain Generation Algorithms",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1574.002 DLL Side-Loading",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1600 Weaken Encryption",
          "technique_count": 8,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 2.6348924980328882e-06
        },
        {
          "technique": "T1054 Indicator Blocking",
          "technique_count": 6,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-06
        },
        {
          "technique": "T1067 Bootkit",
          "technique_count": 6,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-06
        },
        {
          "technique": "T1070.003 Clear Command History",
          "technique_count": 6,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-06
        },
        {
          "technique": "T1120 Peripheral Device Discovery",
          "technique_count": 6,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.976169373524666e-06
        },
        {
          "technique": "T1429 Unknown Technique",
          "technique_count": 5,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.6468078112705551e-06
        },
        {
          "technique": "T1027.001 Binary Padding",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1027.003 Steganography",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1027.004 Compile After Delivery",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1027.005 Indicator Removal from Tools",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1036.001 Invalid Code Signature",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1055.008 Ptrace System Calls",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1055.011 Extra Window Memory Injection",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1059.003 Windows Command Shell",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1553.006 Code Signing Policy Modification",
          "technique_count": 4,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 1.3174462490164441e-06
        },
        {
          "technique": "T1181 Extra Window Memory Injection",
          "technique_count": 2,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-07
        },
        {
          "technique": "T1213 Data from Information Repositories",
          "technique_count": 2,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-07
        },
        {
          "technique": "T1408 Unknown Technique",
          "technique_count": 2,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-07
        },
        {
          "technique": "T1421 Unknown Technique",
          "technique_count": 2,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-07
        },
        {
          "technique": "T1422 Unknown Technique",
          "technique_count": 2,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 6.587231245082221e-07
        },
        {
          "technique": "T1516 Unknown Technique",
          "technique_count": 1,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.2936156225411103e-07
        },
        {
          "technique": "TA0033 Unknown Technique",
          "technique_count": 1,
          "non_phishing_activity_denominator": 3036177,
          "percentage_of_cohort_non_phishing_activity": 3.2936156225411103e-07
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 850,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 319,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 319 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify the set of IP addresses that have been observed conducting phishing attacks, then profile what other (non-phishing) attack techniques those same IPs use and quantify how common each technique is as a percentage of their non-phishing activity (or, alternatively, as a percentage of phishing-capable IPs).\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"IP (address, botnet, pulse_ids)\",\n      \"Country (name)\",\n      \"ASN (number)\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(:Country)\",\n      \"(:IP)-[:FROM]->(:Country)\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN)\"\n    ],\n    \"PRIMARY_FOCUS\": \"Use ATTACKS relationships to determine techniques used by IPs; optionally enrich with FROM country and BELONGS_TO ASN for context or breakdowns.\"\n  },\n  \"FILTERS\": {\n    \"SEED_SET_DEFINITION\": \"Start from IPs that have at least one ATTACKS relationship where technique equals 'phishing' (consider whether matching should be case-insensitive and whether technique values are standardized).\",\n    \"TARGET_TECHNIQUES\": \"For those same IPs, consider ATTACKS relationships with technique not equal to 'phishing' (exclude phishing from the distribution of 'other techniques').\",\n    \"TIME_WINDOW\": \"Not specified; default to all available data unless a date range is required (documented_create_date / documented_modified_date could be used if later constrained).\",\n    \"DEDUPLICATION_ASSUMPTIONS\": \"Decide whether to count each ATTACKS relationship as one event, or deduplicate by (ip, technique, pulse_id) if multiple edges represent the same documented incident.\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"RESULT_GRAIN\": \"One row per non-phishing technique used by IPs that have performed phishing.\",\n    \"FIELDS\": [\n      \"technique\",\n      \"attack_count (or distinct_ip_count, depending on chosen denominator)\",\n      \"percentage\"\n    ],\n    \"PERCENTAGE_DEFINITION_DEFAULT\": \"Percentage of non-phishing ATTACKS events executed by phishing-capable IPs: count_of_events_for_technique / total_non_phishing_events_by_phishing_ips * 100.\",\n    \"ALTERNATIVE_PERCENTAGE_OPTION\": \"Percentage of phishing-capable IPs that have ever used the technique: distinct_ips_using_technique / total_distinct_phishing_ips * 100.\",\n    \"SORTING\": \"Sort by percentage descending (or count descending).\",\n    \"OPTIONAL_ENRICHMENTS\": [\n      \"Include total distinct phishing IPs used as the seed set size\",\n      \"Include total non-phishing attack event count used as the denominator\",\n      \"Optionally break down by ASN or FROM country if needed later\"\n    ]\n  },\n  \"SUGGESTED_APPROACH\": \"1) Identify the cohort of IP nodes with at least one ATTACKS record labeled phishing. 2) From that cohort, collect all ATTACKS records where technique is present and not phishing. 3) Aggregate by technique, computing counts (events or distinct IPs). 4) Compute percentages using a clearly defined denominator (recommended: total non-phishing events by the cohort; alternatively: total cohort IPs). 5) Return the aggregated distribution sorted by prevalence; optionally include cohort/denominator totals for interpretability.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find all IPs that have performed phishing attacks, then aggregate the techniques (excluding phishing) used by those IPs in other ATTACKS records and return each technique\u2019s count and percentage of the cohort\u2019s non-phishing activity (with the denominator explicitly defined).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find all IPs that have performed phishing attacks, then aggregate the techniques (excluding phishing) used by those IPs in other ATTACKS records and return each technique\u2019s count and percentage of the cohort\u2019s non-phishing activity (with the denominator explicitly defined)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort_ips\nMATCH (ip:IP)-[b:ATTACKS]->(:Country)\nWHERE ip IN cohort_ips\n  AND b.technique <> 'phishing'\n  AND b.technique <> 'unknown'\nWITH b.technique AS technique, count(*) AS technique_count\nWITH collect({technique: technique, technique_count: technique_count}) AS rows, sum(technique_count) AS non_phishing_activity_denominator\nUNWIND rows AS row\nRETURN\n  row.technique AS technique,\n  row.technique_count AS technique_count,\n  non_phishing_activity_denominator AS non_phishing_activity_denominator,\n  CASE\n    WHEN non_phishing_activity_denominator = 0 THEN 0.0\n    ELSE toFloat(row.technique_count) / toFloat(non_phishing_activity_denominator)\n  END AS percentage_of_cohort_non_phishing_activity\nORDER BY technique_count DESC, technique ASC"
          ],
          "trace": [
            {
              "subproblem": "Find all IPs that have performed phishing attacks, then aggregate the techniques (excluding phishing) used by those IPs in other ATTACKS records and return each technique\u2019s count and percentage of the cohort\u2019s non-phishing activity (with the denominator explicitly defined).",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort_ips\nMATCH (ip:IP)-[b:ATTACKS]->(:Country)\nWHERE ip IN cohort_ips\n  AND b.technique <> 'phishing'\n  AND b.technique <> 'unknown'\nWITH b.technique AS technique, count(*) AS technique_count\nWITH collect({technique: technique, technique_count: technique_count}) AS rows, sum(technique_count) AS non_phishing_activity_denominator\nUNWIND rows AS row\nRETURN\n  row.technique AS technique,\n  row.technique_count AS technique_count,\n  non_phishing_activity_denominator AS non_phishing_activity_denominator,\n  CASE\n    WHEN non_phishing_activity_denominator = 0 THEN 0.0\n    ELSE toFloat(row.technique_count) / toFloat(non_phishing_activity_denominator)\n  END AS percentage_of_cohort_non_phishing_activity\nORDER BY technique_count DESC, technique ASC",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "phishing",
                      "value": "T1566 Phishing"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "technique_count": 2863569,
                      "non_phishing_activity_denominator": 3036177,
                      "percentage_of_cohort_non_phishing_activity": 0.9431495594624424
                    },
                    {
                      "technique": "T1595 Active Scanning",
                      "technique_count": 19712,
                      "non_phishing_activity_denominator": 3036177,
                      "percentage_of_cohort_non_phishing_activity": 0.006492375115153036
                    },
                    {
                      "technique": "T1110 Brute Force",
                      "technique_count": 13452,
                      "non_phishing_activity_denominator": 3036177,
                      "percentage_of_cohort_non_phishing_activity": 0.004430571735442301
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort_ips\nMATCH (ip:IP)-[b:ATTACKS]->(:Country)\nWHERE ip IN cohort_ips\n  AND b.technique <> 'phishing'\n  AND b.technique <> 'unknown'\nWITH b.technique AS technique, count(*) AS technique_count\nWITH collect({technique: technique, technique_count: technique_count}) AS rows, sum(technique_count) AS non_phishing_activity_denominator\nUNWIND rows AS row\nRETURN\n  row.technique AS technique,\n  row.technique_count AS technique_count,\n  non_phishing_activity_denominator AS non_phishing_activity_denominator,\n  CASE\n    WHEN non_phishing_activity_denominator = 0 THEN 0.0\n    ELSE toFloat(row.technique_count) / toFloat(non_phishing_activity_denominator)\n  END AS percentage_of_cohort_non_phishing_activity\nORDER BY technique_count DESC, technique ASC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "technique_count": 2863569,
              "non_phishing_activity_denominator": 3036177,
              "percentage_of_cohort_non_phishing_activity": 0.9431495594624424
            },
            {
              "technique": "T1595 Active Scanning",
              "technique_count": 19712,
              "non_phishing_activity_denominator": 3036177,
              "percentage_of_cohort_non_phishing_activity": 0.006492375115153036
            },
            {
              "technique": "T1110 Brute Force",
              "technique_count": 13452,
              "non_phishing_activity_denominator": 3036177,
              "percentage_of_cohort_non_phishing_activity": 0.004430571735442301
            }
          ]
        },
        "explanation": {
          "text": "It finds IPs that have performed the `T1566 Phishing` technique, then for that same IP cohort counts and ranks all *other* (non\u2011phishing, non\u2011unknown) `ATTACKS` techniques they used, returning each technique\u2019s count and its share of the cohort\u2019s total non\u2011phishing activity."
        }
      },
      "token_usage": {
        "input": 1782,
        "output": 2008,
        "total": 3790
      },
      "duration_seconds": 266.966,
      "started_at": "2026-02-20T04:42:39.260747+00:00",
      "ended_at": "2026-02-20T04:47:06.226615+00:00",
      "metadata": {
        "time": "2026-02-20T04:47:06.205618+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 3,
      "category": "complex",
      "prompt": "Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.protocol AS protocol, a.technique AS technique, a.industry AS industry, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, protocol, technique, industry, year_month, collect(DISTINCT asn) AS asns, count(*) AS attacks\nWHERE size(asns) > 1\nRETURN country, protocol, technique, industry, year_month, asns, size(asns) AS asn_count\nORDER BY asn_count DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS phishing_ips\nMATCH (ip:IP)-[a2:ATTACKS]->(:Country)\nWHERE ip IN phishing_ips AND a2.technique <> 'phishing'\nWITH a2.technique AS technique, count(*) AS technique_count\nWITH collect({technique: technique, count: technique_count}) AS rows, sum(technique_count) AS total_non_phishing\nUNWIND rows AS row\nRETURN row.technique AS technique,\n       row.count AS count,\n       CASE WHEN total_non_phishing = 0 THEN 0.0 ELSE (toFloat(row.count) * 100.0 / toFloat(total_non_phishing)) END AS percentage_of_total_non_phishing\nORDER BY count DESC, technique ASC",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1715,
        "output": 1429,
        "total": 3144
      },
      "duration_seconds": 400.095,
      "started_at": "2026-02-20T04:47:06.227832+00:00",
      "ended_at": "2026-02-20T04:53:46.322994+00:00",
      "metadata": {
        "time": "2026-02-20T04:53:30.045268+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 4,
      "category": "decomposable",
      "prompt": "Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.",
      "expected_cypher": "CALL {\n    MATCH (ip:IP)-[:FROM]->(country:Country)\n    WHERE country.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(:Country)\n    RETURN count(DISTINCT ip) AS chinaAttackingIPCount\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(originCountry:Country)\n    WHERE originCountry.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(targetCountry:Country)\n    WITH targetCountry.name AS countryName, count(DISTINCT ip) AS attackCount\n    ORDER BY attackCount DESC\n    LIMIT 5\n    RETURN collect({countryName: countryName, attackCount: attackCount}) AS top5AttackedCountries\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(c:Country {name: 'China'})\n    MATCH (ip)-[a:ATTACKS]->()\n    WITH a.technique AS technique, count(a.technique) AS count\n    ORDER BY count DESC\n    LIMIT 3\n    RETURN collect(technique) AS top3Techniques\n}\nRETURN chinaAttackingIPCount, top5AttackedCountries, top3Techniques",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_attacking_ips\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[:ATTACKS]->(victim:Country)\nWITH distinct_attacking_ips, victim.name AS victim_country, count(*) AS attack_event_count\nORDER BY attack_event_count DESC\nWITH distinct_attacking_ips, collect({victim_country: victim_country, attack_event_count: attack_event_count})[0..5] AS top_5_victim_countries\nMATCH (ip3:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip3)-[a3:ATTACKS]->(:Country)\nWHERE a3.technique <> 'unknown'\nWITH distinct_attacking_ips, top_5_victim_countries, a3.technique AS technique, count(*) AS frequency\nORDER BY frequency DESC\nWITH distinct_attacking_ips, top_5_victim_countries, collect({technique: technique, frequency: frequency})[0..3] AS top_3_techniques\nRETURN distinct_attacking_ips, top_5_victim_countries, top_3_techniques",
      "response": [
        {
          "distinct_attacking_ips": 1922,
          "top_5_victim_countries": [
            {
              "attack_event_count": 43430,
              "victim_country": "Germany"
            },
            {
              "attack_event_count": 38573,
              "victim_country": "United States of America"
            },
            {
              "attack_event_count": 36447,
              "victim_country": "France"
            },
            {
              "attack_event_count": 36047,
              "victim_country": "Poland"
            },
            {
              "attack_event_count": 35697,
              "victim_country": "Canada"
            }
          ],
          "top_3_techniques": [
            {
              "technique": "T1566 Phishing",
              "frequency": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "frequency": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "frequency": 7586
            }
          ]
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 943,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Summarize malicious activity originating from China by quantifying how many unique source IPs are involved, identifying which victim countries are most frequently attacked, and determining the most common attack techniques used across those attacks.\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacking source\",\n      \"(:Country {name}) as both the source country (China) and the victim/target countries\",\n      \"(:ASN {number}) is present but not required unless additional attribution is desired\"\n    ],\n    \"relationships\": [\n      \"(ip:IP)-[:FROM]->(sourceCountry:Country) to identify IPs that originate from China\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(victimCountry:Country) to represent attack events and their metadata\",\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN) is optional/not needed for the requested metrics\"\n    ],\n    \"properties_used\": [\n      \"Country.name (to match China and to label victim countries)\",\n      \"IP.address (for distinct attacker counting)\",\n      \"ATTACKS.technique (for technique frequency)\",\n      \"ATTACKS.* (relationship instances serve as the unit of 'number of attacks')\"\n    ]\n  },\n  \"FILTERS\": [\n    \"Limit to attacker IPs where (ip)-[:FROM]->(sourceCountry) and sourceCountry.name equals \\\"China\\\" (exact match unless otherwise specified).\",\n    \"Only include ATTACKS relationships emitted by those China-sourced IPs.\",\n    \"For 'top 5 countries attacked': group by the victim Country reached via ATTACKS; rank by total number of ATTACKS relationships (i.e., attack-event count).\",\n    \"For 'top 3 techniques overall': group by ATTACKS.technique across all included attack events; exclude null/empty technique values if present (otherwise they may dominate as 'unknown').\",\n    \"No time window is specified; include all available attack events unless the user later provides a date range using documented_create_date/documented_modified_date.\"\n  ],\n  \"OUTPUT_FORMAT\": \"Return a single result object containing: (1) total_distinct_attacking_ips (integer), (2) top_5_countries_attacked (ordered list of {country, attack_count}), and (3) top_3_attack_techniques (ordered list of {technique, attack_count}). Ensure ordering is by descending attack_count, with a stable secondary sort (e.g., alphabetical) for ties if needed.\",\n  \"SUGGESTED_APPROACH\": \"First identify the set of IP nodes that have a FROM relationship to the Country node named China. From those IPs, traverse outgoing ATTACKS relationships to victim Country nodes. Compute three aggregates over the same filtered attack set: (a) count distinct IP.address (or distinct IP nodes) for total attackers, (b) count attack relationships per victim country and take the top 5, and (c) count attack relationships per technique and take the top 3. Assemble these aggregates into one consolidated response structure.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Using all ATTACKS events emitted by IPs whose source country is China, compute the total number of distinct attacking IPs, the top 5 victim countries by attack-event count, and the top 3 attack techniques by overall frequency.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Using all ATTACKS events emitted by IPs whose source country is China, compute the total number of distinct attacking IPs, the top 5 victim countries by attack-event count, and the top 3 attack techniques by overall frequency."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_attacking_ips\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[:ATTACKS]->(victim:Country)\nWITH distinct_attacking_ips, victim.name AS victim_country, count(*) AS attack_event_count\nORDER BY attack_event_count DESC\nWITH distinct_attacking_ips, collect({victim_country: victim_country, attack_event_count: attack_event_count})[0..5] AS top_5_victim_countries\nMATCH (ip3:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip3)-[a3:ATTACKS]->(:Country)\nWHERE a3.technique <> 'unknown'\nWITH distinct_attacking_ips, top_5_victim_countries, a3.technique AS technique, count(*) AS frequency\nORDER BY frequency DESC\nWITH distinct_attacking_ips, top_5_victim_countries, collect({technique: technique, frequency: frequency})[0..3] AS top_3_techniques\nRETURN distinct_attacking_ips, top_5_victim_countries, top_3_techniques"
          ],
          "trace": [
            {
              "subproblem": "Using all ATTACKS events emitted by IPs whose source country is China, compute the total number of distinct attacking IPs, the top 5 victim countries by attack-event count, and the top 3 attack techniques by overall frequency.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_attacking_ips\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[:ATTACKS]->(victim:Country)\nWITH distinct_attacking_ips, victim.name AS victim_country, count(*) AS attack_event_count\nORDER BY attack_event_count DESC\nWITH distinct_attacking_ips, collect({victim_country: victim_country, attack_event_count: attack_event_count})[0..5] AS top_5_victim_countries\nMATCH (ip3:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip3)-[a3:ATTACKS]->(:Country)\nWHERE a3.technique <> 'unknown'\nWITH distinct_attacking_ips, top_5_victim_countries, a3.technique AS technique, count(*) AS frequency\nORDER BY frequency DESC\nWITH distinct_attacking_ips, top_5_victim_countries, collect({technique: technique, frequency: frequency})[0..3] AS top_3_techniques\nRETURN distinct_attacking_ips, top_5_victim_countries, top_3_techniques",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "distinct_attacking_ips": 1922,
                      "top_5_victim_countries": [
                        {
                          "attack_event_count": 43430,
                          "victim_country": "Germany"
                        },
                        {
                          "attack_event_count": 38573,
                          "victim_country": "United States of America"
                        },
                        {
                          "attack_event_count": 36447,
                          "victim_country": "France"
                        },
                        {
                          "attack_event_count": 36047,
                          "victim_country": "Poland"
                        },
                        {
                          "attack_event_count": 35697,
                          "victim_country": "Canada"
                        }
                      ],
                      "top_3_techniques": [
                        {
                          "technique": "T1566 Phishing",
                          "frequency": 533403
                        },
                        {
                          "technique": "T1110 Brute Force",
                          "frequency": 8224
                        },
                        {
                          "technique": "T1595 Active Scanning",
                          "frequency": 7586
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_attacking_ips\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[:ATTACKS]->(victim:Country)\nWITH distinct_attacking_ips, victim.name AS victim_country, count(*) AS attack_event_count\nORDER BY attack_event_count DESC\nWITH distinct_attacking_ips, collect({victim_country: victim_country, attack_event_count: attack_event_count})[0..5] AS top_5_victim_countries\nMATCH (ip3:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip3)-[a3:ATTACKS]->(:Country)\nWHERE a3.technique <> 'unknown'\nWITH distinct_attacking_ips, top_5_victim_countries, a3.technique AS technique, count(*) AS frequency\nORDER BY frequency DESC\nWITH distinct_attacking_ips, top_5_victim_countries, collect({technique: technique, frequency: frequency})[0..3] AS top_3_techniques\nRETURN distinct_attacking_ips, top_5_victim_countries, top_3_techniques"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "distinct_attacking_ips": 1922,
              "top_5_victim_countries": [
                {
                  "attack_event_count": 43430,
                  "victim_country": "Germany"
                },
                {
                  "attack_event_count": 38573,
                  "victim_country": "United States of America"
                },
                {
                  "attack_event_count": 36447,
                  "victim_country": "France"
                },
                {
                  "attack_event_count": 36047,
                  "victim_country": "Poland"
                },
                {
                  "attack_event_count": 35697,
                  "victim_country": "Canada"
                }
              ],
              "top_3_techniques": [
                {
                  "technique": "T1566 Phishing",
                  "frequency": 533403
                },
                {
                  "technique": "T1110 Brute Force",
                  "frequency": 8224
                },
                {
                  "technique": "T1595 Active Scanning",
                  "frequency": 7586
                }
              ]
            }
          ]
        },
        "explanation": {
          "text": "This query analyzes IPs originating from China to return (1) how many distinct Chinese-source IPs have launched attacks, (2) the top 5 victim countries by attack event count, and (3) the top 3 most frequent non\u2011`unknown` attack techniques used."
        }
      },
      "token_usage": {
        "input": 1887,
        "output": 1951,
        "total": 3838
      },
      "duration_seconds": 41.142,
      "started_at": "2026-02-20T04:53:46.324182+00:00",
      "ended_at": "2026-02-20T04:54:27.466654+00:00",
      "metadata": {
        "time": "2026-02-20T04:54:27.452124+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 5,
      "category": "multi-subquery",
      "prompt": "For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.",
      "expected_cypher": "CALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  RETURN count(DISTINCT ip) AS distinctIPs\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[:ATTACKS]->(:Country)\n  RETURN count(*) AS totalAttacks\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[a:ATTACKS]->(:Country)\n  WITH a.industry AS industry, count(*) AS attacks\n  ORDER BY attacks DESC\n  LIMIT 5\n  RETURN collect({industry: industry, attacks: attacks}) AS topIndustries\n}\nRETURN distinctIPs, totalAttacks, topIndustries",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})\nWITH collect(DISTINCT ip) AS ips\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attacks, a.industry AS industry\nWITH distinct_source_ips, total_attacks, industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_source_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top5_industries\nRETURN distinct_source_ips, total_attacks, top5_industries",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 546,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Determine the volume and characteristics of attack activity originating from Russian IP addresses by measuring how many unique source IPs are involved, how many total attack events they generated, and which target industries they most frequently attacked (top 5).\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\",\n      \"(:ASN {number})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:FROM]->(country:Country)\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\",\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)\"\n    ],\n    \"PRIMARY_FIELDS_USED\": [\n      \"Country.name\",\n      \"IP.address\",\n      \"ATTACKS.industry\"\n    ]\n  },\n  \"FILTERS\": {\n    \"SOURCE_GEO_FILTER\": \"Only include IP nodes that are linked via (:IP)-[:FROM]->(:Country) where Country.name = 'Russia'.\",\n    \"ATTACKS_SCOPE\": \"Only count :ATTACKS relationships that originate from those Russian-source IPs (regardless of the destination country on the :ATTACKS relationship, unless otherwise specified).\",\n    \"DATA_QUALITY_RULES\": [\n      \"If ATTACKS.industry is null/empty, decide whether to exclude it from the top-industries ranking or bucket it as 'Unknown' (must be consistent).\"\n    ],\n    \"TIME_WINDOW\": \"No time filtering specified; include all available attacks unless the user later adds date constraints (e.g., documented_create_date range).\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"METRICS\": {\n      \"distinct_ip_count\": \"Integer: number of unique Russian-source IP.address values (or distinct IP nodes).\",\n      \"total_attack_count\": \"Integer: total number of :ATTACKS relationships originating from those IPs.\"\n    },\n    \"TOP_5_INDUSTRIES\": [\n      {\n        \"industry\": \"String\",\n        \"attack_count\": \"Integer\"\n      }\n    ],\n    \"NOTES\": \"Top industries should be ordered by attack_count descending and limited to 5.\"\n  },\n  \"SUGGESTED_APPROACH\": \"Identify all IP nodes geolocated to Russia via the :FROM relationship, then traverse their outgoing :ATTACKS relationships. Aggregate (1) distinct source IPs, (2) total number of attack relationships, and (3) counts of attacks grouped by the ATTACKS.industry property; sort industry counts descending and return the top 5 alongside the two overall metrics. Ensure industry null/empty handling is defined (exclude or label as 'Unknown').\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"From IPs whose :FROM country is 'Russia', compute the number of distinct source IPs, the total number of outgoing :ATTACKS events, and the top 5 ATTACKS.industry values by attack count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "From IPs whose :FROM country is 'Russia', compute the number of distinct source IPs, the total number of outgoing :ATTACKS events, and the top 5 ATTACKS.industry values by attack count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})\nWITH collect(DISTINCT ip) AS ips\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attacks, a.industry AS industry\nWITH distinct_source_ips, total_attacks, industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_source_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top5_industries\nRETURN distinct_source_ips, total_attacks, top5_industries"
          ],
          "trace": [
            {
              "subproblem": "From IPs whose :FROM country is 'Russia', compute the number of distinct source IPs, the total number of outgoing :ATTACKS events, and the top 5 ATTACKS.industry values by attack count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})\nWITH collect(DISTINCT ip) AS ips\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attacks, a.industry AS industry\nWITH distinct_source_ips, total_attacks, industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_source_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top5_industries\nRETURN distinct_source_ips, total_attacks, top5_industries",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})\nWITH collect(DISTINCT ip) AS ips\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attacks, a.industry AS industry\nWITH distinct_source_ips, total_attacks, industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_source_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top5_industries\nRETURN distinct_source_ips, total_attacks, top5_industries"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "It finds all IPs originating from Russia, counts how many distinct source IPs and total `ATTACKS` relationships they generate, then returns those totals along with the top five targeted industries ranked by attack count."
        }
      },
      "token_usage": {
        "input": 1623,
        "output": 1533,
        "total": 3156
      },
      "duration_seconds": 26.764,
      "started_at": "2026-02-20T04:54:27.467778+00:00",
      "ended_at": "2026-02-20T04:54:54.232232+00:00",
      "metadata": {
        "time": "2026-02-20T04:54:54.219077+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 6,
      "category": "aggregation",
      "prompt": "Which ASN has attacked the most distinct countries?",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[:ATTACKS]->(c:Country)\nWITH asn.number AS asn, count(DISTINCT c.name) AS countries\nORDER BY countries DESC\nLIMIT 1\nRETURN asn, countries",
      "agent_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[:ATTACKS]->(victim:Country)\nWITH asn, count(DISTINCT victim) AS distinct_victim_countries\nWITH max(distinct_victim_countries) AS max_countries, collect({asn: asn, cnt: distinct_victim_countries}) AS rows\nUNWIND rows AS row\nWITH row.asn AS asn, row.cnt AS distinct_victim_countries, max_countries\nWHERE distinct_victim_countries = max_countries\nRETURN asn.number AS asn_number, distinct_victim_countries AS distinct_country_count",
      "response": [
        {
          "asn_number": "AS57523 chang way technologies co. limited",
          "distinct_country_count": 64
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 479,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify the ASN whose associated attacking IPs have targeted the widest geographic spread, measured by the number of distinct victim countries those IPs have attacked.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:ASN {number})\",\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN) to map attacker IPs to an ASN\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country) to map attacker IPs to victim countries\"\n    ],\n    \"OPTIONAL_CONTEXT\": [\n      \"(ip:IP)-[:FROM]->(country:Country) is not required for 'attacked countries' but could be used later to compare origin vs victim geography if needed\"\n    ]\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [\n      \"Only consider ASNs that have at least one IP which has at least one ATTACKS relationship to a Country\"\n    ],\n    \"DISTINCTNESS_RULES\": [\n      \"Count distinct victim Country nodes per ASN (not total attacks)\",\n      \"Deduplicate multiple attacks from the same ASN to the same victim country (even if coming from multiple IPs or multiple ATTACKS edges)\"\n    ],\n    \"NOT_SPECIFIED_BUT_COMMON\": [\n      \"No time range, technique, protocol, industry, botnet, or pulse-based filtering is specified; include all available ATTACKS data unless the user later adds constraints\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": \"Return the top ASN (by ASN number) with the corresponding count of distinct attacked countries; if there are ties, return all tied ASNs or clearly specify tie-breaking (e.g., return all ties).\",\n  \"SUGGESTED_APPROACH\": \"Traverse from ASN to its IPs via BELONGS_TO, then from those IPs to victim countries via ATTACKS. For each ASN, compute the number of unique victim countries reached. Sort ASNs descending by that unique-country count and return the maximum (optionally including ties).\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the ASN whose BELONGS_TO IPs have ATTACKS relationships to the largest number of distinct victim Country nodes, and return the ASN number along with that distinct-country count (including ties if applicable).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the ASN whose BELONGS_TO IPs have ATTACKS relationships to the largest number of distinct victim Country nodes, and return the ASN number along with that distinct-country count (including ties if applicable)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[:ATTACKS]->(victim:Country)\nWITH asn, count(DISTINCT victim) AS distinct_victim_countries\nWITH max(distinct_victim_countries) AS max_countries, collect({asn: asn, cnt: distinct_victim_countries}) AS rows\nUNWIND rows AS row\nWITH row.asn AS asn, row.cnt AS distinct_victim_countries, max_countries\nWHERE distinct_victim_countries = max_countries\nRETURN asn.number AS asn_number, distinct_victim_countries AS distinct_country_count"
          ],
          "trace": [
            {
              "subproblem": "Find the ASN whose BELONGS_TO IPs have ATTACKS relationships to the largest number of distinct victim Country nodes, and return the ASN number along with that distinct-country count (including ties if applicable).",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[:ATTACKS]->(victim:Country)\nWITH asn, count(DISTINCT victim) AS distinct_victim_countries\nWITH max(distinct_victim_countries) AS max_countries, collect({asn: asn, cnt: distinct_victim_countries}) AS rows\nUNWIND rows AS row\nWITH row.asn AS asn, row.cnt AS distinct_victim_countries, max_countries\nWHERE distinct_victim_countries = max_countries\nRETURN asn.number AS asn_number, distinct_victim_countries AS distinct_country_count",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn_number": "AS57523 chang way technologies co. limited",
                      "distinct_country_count": 64
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[:ATTACKS]->(victim:Country)\nWITH asn, count(DISTINCT victim) AS distinct_victim_countries\nWITH max(distinct_victim_countries) AS max_countries, collect({asn: asn, cnt: distinct_victim_countries}) AS rows\nUNWIND rows AS row\nWITH row.asn AS asn, row.cnt AS distinct_victim_countries, max_countries\nWHERE distinct_victim_countries = max_countries\nRETURN asn.number AS asn_number, distinct_victim_countries AS distinct_country_count"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn_number": "AS57523 chang way technologies co. limited",
              "distinct_country_count": 64
            }
          ]
        },
        "explanation": {
          "text": "It finds the ASN(s) whose IPs have attacked the largest number of distinct victim countries, returning the ASN number and that maximum distinct-country count."
        }
      },
      "token_usage": {
        "input": 1589,
        "output": 815,
        "total": 2404
      },
      "duration_seconds": 17.975,
      "started_at": "2026-02-20T04:54:54.232783+00:00",
      "ended_at": "2026-02-20T04:55:12.207870+00:00",
      "metadata": {
        "time": "2026-02-20T04:55:12.195312+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 7,
      "category": "graph-structure",
      "prompt": "Find IPs that attacked more than 10 distinct countries.",
      "expected_cypher": "MATCH (ip:IP)-[:ATTACKS]->(c:Country)\nWITH ip.address AS ip, count(DISTINCT c.name) AS countries\nWHERE countries > 10\nRETURN ip, countries\nORDER BY countries DESC",
      "agent_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWITH asn, count(DISTINCT target) AS distinct_attacked_countries\nWITH collect({asn_number: asn.number, cnt: distinct_attacked_countries}) AS rows, max(distinct_attacked_countries) AS max_cnt\nUNWIND rows AS row\nWITH row, max_cnt\nWHERE row.cnt = max_cnt\nRETURN row.asn_number AS asn_number, row.cnt AS distinct_attacked_country_count\nORDER BY asn_number",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1562,
        "output": 911,
        "total": 2473
      },
      "duration_seconds": 400.117,
      "started_at": "2026-02-20T04:55:12.208449+00:00",
      "ended_at": "2026-02-20T05:01:52.325198+00:00",
      "metadata": {
        "time": "2026-02-20T05:01:49.782063+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 8,
      "category": "matcher-needed",
      "prompt": "Top 5 target countries attacked by IPs from United States using protocol ssh.",
      "expected_cypher": "MATCH (ip:IP)-[:FROM]->(src:Country {name:'United States of America'})\nMATCH (ip)-[a:ATTACKS {protocol:'RDP'}]->(tgt:Country)\nWITH tgt.name AS country, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 5\nRETURN country, attacks",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(src:Country)\nWHERE src.name = 'United States'\nMATCH (ip)-[r:ATTACKS]->(tgt:Country)\nWHERE r.protocol = 'ssh'\nWITH tgt, count(*) AS ssh_attack_count\nORDER BY ssh_attack_count DESC\nLIMIT 5\nRETURN tgt.name AS target_country, ssh_attack_count",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 262,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which destination (target) countries are most frequently attacked when the attacking source IPs are geolocated to the United States and the attack protocol is SSH, returning the top 5 target countries by attack volume.\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacking source\",\n      \"(:Country {name}) as both the source country (United States) and the target country being attacked\"\n    ],\n    \"relationships\": [\n      \"(ip:IP)-[:FROM]->(sourceCountry:Country) to determine that the IP is from the United States\",\n      \"(ip:IP)-[:ATTACKS {protocol, technique, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(targetCountry:Country) to represent an attack event from the IP to a target country\"\n    ],\n    \"optional_context\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN {number}) is available but not required unless the user later wants attribution by ASN\"\n    ]\n  },\n  \"FILTERS\": {\n    \"source_country\": \"United States (match via (:Country {name}) on the :FROM relationship)\",\n    \"attack_protocol\": \"ssh (match against ATTACKS.protocol; clarify case-sensitivity/normalization if needed, e.g., 'ssh' vs 'SSH')\",\n    \"target_entity_type\": \"Targets are countries reached via the ATTACKS relationship (exclude the source country node from this role unless the data includes self-targeting and the user wants it included)\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"type\": \"ranked_list\",\n    \"top_n\": 5,\n    \"columns\": [\n      \"target_country_name\",\n      \"attack_count (number of ATTACKS relationships matching the filters)\"\n    ],\n    \"recommended_extras\": [\n      \"unique_source_ip_count (distinct IPs from the US contributing to attacks on each target) as an additional interpretability metric\"\n    ],\n    \"sorting\": \"Descending by attack_count; tie-breaker can be target_country_name ascending for deterministic ordering\"\n  },\n  \"SUGGESTED_APPROACH\": \"Start from IP nodes, restrict to those that have a :FROM relationship to the Country node named 'United States'. From those IPs, traverse outgoing :ATTACKS relationships filtered to protocol = 'ssh' and reach the target Country nodes. Aggregate by target country, compute the number of matching attack relationships (and optionally distinct attacking IPs), order by the attack count descending, and return the top 5.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Return the top 5 target countries by count of SSH attacks where the attacking IPs are from the United States, using IP-[:FROM]->Country to identify US sources and IP-[:ATTACKS {protocol:'ssh'}]->Country to identify targets.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Return the top 5 target countries by count of SSH attacks where the attacking IPs are from the United States, using IP-[:FROM]->Country to identify US sources and IP-[:ATTACKS {protocol:'ssh'}]->Country to identify targets."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(src:Country)\nWHERE src.name = 'United States'\nMATCH (ip)-[r:ATTACKS]->(tgt:Country)\nWHERE r.protocol = 'ssh'\nWITH tgt, count(*) AS ssh_attack_count\nORDER BY ssh_attack_count DESC\nLIMIT 5\nRETURN tgt.name AS target_country, ssh_attack_count"
          ],
          "trace": [
            {
              "subproblem": "Return the top 5 target countries by count of SSH attacks where the attacking IPs are from the United States, using IP-[:FROM]->Country to identify US sources and IP-[:ATTACKS {protocol:'ssh'}]->Country to identify targets.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(src:Country)\nWHERE src.name = 'United States'\nMATCH (ip)-[r:ATTACKS]->(tgt:Country)\nWHERE r.protocol = 'ssh'\nWITH tgt, count(*) AS ssh_attack_count\nORDER BY ssh_attack_count DESC\nLIMIT 5\nRETURN tgt.name AS target_country, ssh_attack_count",
                  "matched_pairs": [
                    {
                      "kind": "node",
                      "label": "Country",
                      "property": "name",
                      "original": "United States",
                      "value": "United States"
                    },
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "protocol",
                      "original": "ssh",
                      "value": "ssh"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(src:Country)\nWHERE src.name = 'United States'\nMATCH (ip)-[r:ATTACKS]->(tgt:Country)\nWHERE r.protocol = 'ssh'\nWITH tgt, count(*) AS ssh_attack_count\nORDER BY ssh_attack_count DESC\nLIMIT 5\nRETURN tgt.name AS target_country, ssh_attack_count"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "This query finds IPs originating from the United States, counts how many SSH (`protocol = 'ssh'`) `ATTACKS` they make against each target country, and returns the top 5 target countries by attack count."
        }
      },
      "token_usage": {
        "input": 1482,
        "output": 889,
        "total": 2371
      },
      "duration_seconds": 22.766,
      "started_at": "2026-02-20T05:01:52.325884+00:00",
      "ended_at": "2026-02-20T05:02:15.091998+00:00",
      "metadata": {
        "time": "2026-02-20T05:02:15.079283+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 9,
      "category": "temporal",
      "prompt": "Monthly attack counts per technique (grouped by YYYY-MM).",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH substring(toString(a.documented_create_date[0]),0,7) AS year_month, a.technique AS technique, count(*) AS attacks\nRETURN year_month, technique, attacks\nORDER BY year_month DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWHERE a.protocol <> 'unknown' AND a.protocol = 'ssh'\nWITH target, count(*) AS attack_events\nORDER BY attack_events DESC\nLIMIT 5\nRETURN target.name AS target_country, attack_events",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1456,
        "output": 955,
        "total": 2411
      },
      "duration_seconds": 400.112,
      "started_at": "2026-02-20T05:02:15.092493+00:00",
      "ended_at": "2026-02-20T05:08:55.203987+00:00",
      "metadata": {
        "time": "2026-02-20T05:08:54.457569+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 10,
      "category": "discovery",
      "prompt": "List distinct technologies observed in attacks against the Finance industry, with counts.",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWHERE a.industry = 'Finance'\nWITH a.technology AS technology, count(*) AS attacks\nORDER BY attacks DESC\nRETURN technology, attacks",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.industry = 'Finance'\n  AND r.technology IS NOT NULL\n  AND trim(r.technology) <> ''\n  AND r.technology <> 'unknown'\nWITH r.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC",
      "response": [
        {
          "technology": "windows",
          "attack_count": 30
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 277,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which attack technologies have been observed targeting the Finance industry and quantify how frequently each technology appears in the attack observations.\",\n  \"KEY_ENTITIES\": \"Primary: (:IP)-[:ATTACKS]->(:Country), using the ATTACKS relationship properties (technology, industry, and optionally pulse_id and dates). Secondary (not required for the core request but available for enrichment): (:IP)-[:FROM]->(:Country) for source geography context and (:IP)-[:BELONGS_TO]->(:ASN) for network ownership context.\",\n  \"FILTERS\": \"Include only ATTACKS relationships where the relationship property industry equals 'Finance' (case/format should match stored values). Consider only records where ATTACKS.technology is present (exclude null/empty technologies). No explicit time window is requested; include all available dates unless otherwise specified.\",\n  \"OUTPUT_FORMAT\": \"Return one row per distinct technology with an associated count. Present as a list/table of {technology, count}, typically sorted by count descending (and optionally technology ascending as a tie-breaker).\",\n  \"SUGGESTED_APPROACH\": \"Traverse from IP nodes through ATTACKS relationships, restrict to those with industry = Finance, extract the technology property, normalize/omit missing values, then group by technology and compute the number of matching ATTACKS observations per technology. Order results by the computed count to highlight the most frequently observed technologies.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For all ATTACKS observations targeting the Finance industry, list each distinct ATTACKS.technology value (excluding null/empty) and the number of matching ATTACKS relationships for that technology, sorted by count descending.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For all ATTACKS observations targeting the Finance industry, list each distinct ATTACKS.technology value (excluding null/empty) and the number of matching ATTACKS relationships for that technology, sorted by count descending."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.industry = 'Finance'\n  AND r.technology IS NOT NULL\n  AND trim(r.technology) <> ''\n  AND r.technology <> 'unknown'\nWITH r.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC"
          ],
          "trace": [
            {
              "subproblem": "For all ATTACKS observations targeting the Finance industry, list each distinct ATTACKS.technology value (excluding null/empty) and the number of matching ATTACKS relationships for that technology, sorted by count descending.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.industry = 'Finance'\n  AND r.technology IS NOT NULL\n  AND trim(r.technology) <> ''\n  AND r.technology <> 'unknown'\nWITH r.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "industry",
                      "original": "'Finance'",
                      "value": "Finance"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technology": "windows",
                      "attack_count": 30
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.industry = 'Finance'\n  AND r.technology IS NOT NULL\n  AND trim(r.technology) <> ''\n  AND r.technology <> 'unknown'\nWITH r.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technology": "windows",
              "attack_count": 30
            }
          ]
        },
        "explanation": {
          "text": "It finds all IP\u2192Country `ATTACKS` relationships targeting the Finance industry with a non-empty, non-`unknown` `technology` value, then counts and ranks how many such attacks occurred per technology."
        }
      },
      "token_usage": {
        "input": 1468,
        "output": 768,
        "total": 2236
      },
      "duration_seconds": 286.543,
      "started_at": "2026-02-20T05:08:55.204628+00:00",
      "ended_at": "2026-02-20T05:13:41.747242+00:00",
      "metadata": {
        "time": "2026-02-20T05:13:41.733797+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 11,
      "category": "multi-hop",
      "prompt": "For each ASN, top 3 protocols it used when attacking France.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name:'France'})\nWITH asn.number AS asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn, cnt DESC\nWITH asn, collect({protocol: protocol, cnt: cnt}) AS items\nUNWIND items[0..3] AS top\nRETURN asn, top.protocol AS protocol, top.cnt AS attacks\nORDER BY asn, attacks DESC",
      "agent_cypher": "MATCH (c:Country {name:'France'})\nMATCH (ip:IP)-[:BELONGS_TO]->(a:ASN)\nMATCH (ip)-[r:ATTACKS]->(c)\nWHERE r.protocol <> 'unknown'\nWITH a.number AS asn, r.protocol AS protocol, count(*) AS protocol_count\nORDER BY asn, protocol_count DESC, protocol\nWITH asn, collect({protocol: protocol, count: protocol_count})[0..3] AS top_protocols\nUNWIND top_protocols AS p\nRETURN asn, p.protocol AS protocol, p.count AS count\nORDER BY asn, count DESC, protocol",
      "response": [
        {
          "asn": "AS10103 hk broadband network ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS10220 pt. kreasi sejahtera teknologi",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS10439 carinet  inc.",
          "protocol": "snmp",
          "count": 4
        },
        {
          "asn": "AS10439 carinet  inc.",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS11419 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS11427 charter communications inc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS11888 television internacional  s.a. de c.v.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS12252 america movil peru s.a.c.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS12353 vodafone portugal - communicacoes pessoais s.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS12389 pjsc rostelecom",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS12479 orange espagne sa",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS12695 llc digital network",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS12768 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS12874 fastweb spa",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS12876 online s.a.s.",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS12876 online s.a.s.",
          "protocol": "snmp",
          "count": 3
        },
        {
          "asn": "AS131090 cat telecom public company ltd",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS131314 china broadband communications (hong kong) company limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS131353 nhanhoa software company",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS131423 branch of long van system solution jsc - hanoi",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS132203 tencent building  kejizhongyi avenue",
          "protocol": "ssh",
          "count": 312
        },
        {
          "asn": "AS132203 tencent building  kejizhongyi avenue",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS132787 helios it infrasolutions pvt",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS13285 talktalk communications",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS133296 web werks india pvt. ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS133334 dctv cable network broadband services inc",
          "protocol": "sip",
          "count": 9
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "http",
          "count": 112
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "tcp",
          "count": 112
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS133398 tele asia limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS133774 fuzhou",
          "protocol": "ssh",
          "count": 9
        },
        {
          "asn": "AS134026 ultranet services private limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134238 chinanet jiangxi province idc network",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS134337 r2 net solutions pvt ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134366 cloud computing hk limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134761 chinanet ningxia province zhongwei idc network",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS134763 chinanet guangdong province network",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS134765 chinanet yunnan province idc1 network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134768 chinanet shaanxi province cloud base network",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS134771 wenzhou  zhejiang province  p.r.china.",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS13490 buckeye cablevision  inc.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134945 blue sky broadband pvt. ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS134963 alibaba.com singapore e-commerce private limited",
          "protocol": "snmp",
          "count": 2
        },
        {
          "asn": "AS135182 moradabad internet services private limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS135310 inspire broadband",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "ssh",
          "count": 13
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "sip",
          "count": 7
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "snmp",
          "count": 7
        },
        {
          "asn": "AS135524 university of dhaka",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS135777 shreenortheast connect and services pvt ltd",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS135905 vietnam posts and telecommunications group",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS135932 viet storage technology joint stock company",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS135953 vietnam online network solution joint stock compnay",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS136052 pt cloud hosting indonesia",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS136170 pt. exabytes network indonesia",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS13650 axia fibrenet ltd.",
          "protocol": "snmp",
          "count": 11
        },
        {
          "asn": "AS13650 axia fibrenet ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS136827 universitas pgri semarang",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS136958 china unicom guangdong ip network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS136970 yisu cloud ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137280 kingsoft cloud corporation limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137318 diskominfo kabupaten pati",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS137361 diskominfo kab. magelang",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137687 luoyang  henan province  p.r.china.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137697 chinatelecom jiangsu yangzhou idc networkdescr",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS137699 chinatelecom jiangsu suqian idc network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137702 nanjing  jiangsu province  p.r.china.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS137718 beijing volcano engine technology co.  ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS137823 cloudone",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS138421 china unicom",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS138950 jiangsu wuxi international idc network",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS139190 google asia pacific pte. ltd.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS139201 jiangxi jiujiang idc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS139282 novus network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS139473 shebatel network ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS13999 mega cable  s.a. de c.v.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS140061 qinghai telecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS140469 pt wahyu adidaya network",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS14051 consolidated communications",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS14061 digitalocean  llc",
          "protocol": "ssh",
          "count": 207
        },
        {
          "asn": "AS14061 digitalocean  llc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS14080 telmex colombia s.a.",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS142403 yisu cloud ltd",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS142608 china telecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS14618 amazon.com  inc.",
          "protocol": "snmp",
          "count": 3
        },
        {
          "asn": "AS147161 universitas muhammadiyah gresik",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS14987 rethem hosting llc",
          "protocol": "snmp",
          "count": 3
        },
        {
          "asn": "AS14988 african network information center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "http",
          "count": 36
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "tcp",
          "count": 36
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "ssh",
          "count": 10
        },
        {
          "asn": "AS15290 allstream corp.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS15311 telefonica empresas",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS15475 nile online",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS15582 ojsc comcor",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS15704 xtra telecom s.a.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS15713 llc global-city-net",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS15895 kyivstar pjsc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS15924 vodafone net iletisim hizmetleri anonim sirketi",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS16223 lanet network ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "ssh",
          "count": 33
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "sip",
          "count": 10
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS16735 algar telecom s/a",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS16814 nss s.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17222 mundivox do brasil ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS174 cogent communications",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS17501 worldlink communications pvt ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17557 pakistan telecommunication company limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17577 lg hellovision corp.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS17621 china unicom shanghai network",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS17623 china unicom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17638 china telecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17676 softbank bb corp.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS17676 softbank bb corp.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS17858 lg powercomm",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS17882 univision llc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS17993 vodafone samoa limited",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS18049 taiwan infrastructure network technologie",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS18207 you broadband & cable india ltd.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS18229 ctrls datacenters",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS18403 fpt telecom company",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS18881 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS19318 interserver  inc",
          "protocol": "sip",
          "count": 4
        },
        {
          "asn": "AS19429 etb - colombia",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS19527 google llc",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS197068 hll llc",
          "protocol": "snmp",
          "count": 7
        },
        {
          "asn": "AS197119 krena - kyrgyz research and education network association",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS200350 yandex.cloud llc",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS20115 charter communications",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS20115 charter communications",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS201746 olivenet network s.l.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS202425 ip volume inc",
          "protocol": "snmp",
          "count": 15
        },
        {
          "asn": "AS202425 ip volume inc",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS202660 uzbektelekom joint stock company",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS203247 islamic azad university",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS207423 steil-south ltd",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS209605 uab host baltic",
          "protocol": "ssh",
          "count": 21
        },
        {
          "asn": "AS210644 ",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS210950 tov e-rishennya",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS211252 delis llc",
          "protocol": "snmp",
          "count": 2
        },
        {
          "asn": "AS211279 alianta-tv s.r.l.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS211298 constantine cybersecurity ltd.",
          "protocol": "sip",
          "count": 11
        },
        {
          "asn": "AS211298 constantine cybersecurity ltd.",
          "protocol": "snmp",
          "count": 6
        },
        {
          "asn": "AS211680 nsec - sistemas informaticos  s.a.",
          "protocol": "sip",
          "count": 2
        },
        {
          "asn": "AS211680 nsec - sistemas informaticos  s.a.",
          "protocol": "snmp",
          "count": 2
        },
        {
          "asn": "AS21491 uganda telecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS21501 host europe gmbh",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS21574 century telecom ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS21859 zenlayer inc",
          "protocol": "snmp",
          "count": 8
        },
        {
          "asn": "AS22773 cox communications inc.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS22884 total play telecomunicaciones sa de cv",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS23201 telecel s.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS23647 communications & communicate nepal pvt ltd",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS23650 chinanet",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS23678 mykris asia  managed network and service provider",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS23700 linknet fastnet asn",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS23724 idc china telecommunications corporation",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS23969 tot public company limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS23969 tot public company limited",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS24186 railtel corporation of india ltd",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS24309 atria convergence technologies",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS24400 shanghai mobile communications co. ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS24514 malaysian research & education network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS24532 inet global indo",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS24560 bharti airtel ltd.",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS24757 ethionet",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS24955 ojsc ufanet",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS25003 internet binat ltd",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS25106 mobile telesystems jllc",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS2518 biglobe inc.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS25184 afranet",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS2519 arteria networks corporation",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS25250 gamtel",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS2527 sony network communications inc.",
          "protocol": "telnet",
          "count": 4
        },
        {
          "asn": "AS25408 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS25490 pjsc rostelecom",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS25514 modus-global llc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS25820 it7 networks inc",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS26210 axs bolivia s a",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS262793 douracom servicos de comunicacao ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS262805 rede minas telecom ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS263998 sim telecom",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS264411 costa do sol tv a cabo",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS26496 godaddy.com  llc",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS267251 telefonarnet telecomunicacoes",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS267285 ANDRE PEREIRA DA COSTA EIRELI ME",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS267506 netlux telecom",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS268622 oliveira telecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS268888 acrf servicos de informatica ltda - me",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS27651 entel chile s.a.",
          "protocol": "ssh",
          "count": 10
        },
        {
          "asn": "AS27653 alpha communications network",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS27665 columbus communications trinidad limited.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS27699 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS27843 optical technologies s.a.c.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS27882 telefnica celular de bolivia s.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS27988 servicios y telecomunicaciones s.a.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS28308 orion telecomunicaes comercio e servios ltda",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS2856 british telecommunications plc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS28573 claro s.a.",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS28624 provedora cma internet ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS28649 desktop sigmanet comunicao multimdia sa",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS28665 predlink rede de telecomunices ltda",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS29518 bredband2 ab",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS29580 a1 bulgaria ead",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS29789 reflected networks  inc.",
          "protocol": "http",
          "count": 150
        },
        {
          "asn": "AS29789 reflected networks  inc.",
          "protocol": "tcp",
          "count": 42
        },
        {
          "asn": "AS29791 internap holding llc",
          "protocol": "sip",
          "count": 5
        },
        {
          "asn": "AS30722 vodafone italia s.p.a.",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS30844 liquid telecommunications ltd",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS31200 novotelecom ltd",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS31898 oracle corporation",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS32 stanford university",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS3215 orange s.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS3216 pjsc vimpelcom",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS3243 meo servicos de comunicacoes e multimedia sa",
          "protocol": "ssh",
          "count": 6
        },
        {
          "asn": "AS32475 singlehop llc",
          "protocol": "sip",
          "count": 10
        },
        {
          "asn": "AS327724 african network information center",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS327764 african network information center",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS327934 african network information center",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS3320 deutsche telekom ag",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS3356 level 3 parent  llc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS34088 host europe gmbh",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS3462 data communication business group",
          "protocol": "ssh",
          "count": 17
        },
        {
          "asn": "AS34918 pishgaman toseeh ertebatat company (private joint stock)",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS34974 pjsc rostelecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS34984 tellcom iletisim hizmetleri a.s.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS35366 isppro internet kg",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS35478 bunea telecom srl",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS35913 dedipath",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS36352 colocrossing",
          "protocol": "ssh",
          "count": 12
        },
        {
          "asn": "AS36791 portland internet hosting llc",
          "protocol": "snmp",
          "count": 7
        },
        {
          "asn": "AS36791 portland internet hosting llc",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS36866 african network information center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS36946 african network information center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS37061 african network information center",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS37353 african network information center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS37385 african network information center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS3786 lg dacom corporation",
          "protocol": "ssh",
          "count": 17
        },
        {
          "asn": "AS37963 hangzhou alibaba advertising co. ltd.",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS3816 colombia telecomunicaciones s.a. esp",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS38283 chinanet sichuan telecom internet data center",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS38283 chinanet sichuan telecom internet data center",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS38365 beijing baidu netcom science and technology co.  ltd.",
          "protocol": "ssh",
          "count": 25
        },
        {
          "asn": "AS38457 honesty net solution",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS38482 biznet isp",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS38623 viettel",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS38700 smileserv",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS38731 vietel - cht company",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS394695 pdr",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS39493 cjsc kolomna-sviaz tv",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS396356 maxihost llc",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS396507 emerald onion",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS39651 com hem ab",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS396982 google",
          "protocol": "ssh",
          "count": 46
        },
        {
          "asn": "AS396982 google",
          "protocol": "snmp",
          "count": 20
        },
        {
          "asn": "AS396982 google",
          "protocol": "sip",
          "count": 4
        },
        {
          "asn": "AS398101 godaddy.com  llc",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS398108 godaddy.com  llc",
          "protocol": "sip",
          "count": 7
        },
        {
          "asn": "AS39811 mts pjsc",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS39812 closed joint stock company radiotelephone",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS398324 censys  inc.",
          "protocol": "snmp",
          "count": 6
        },
        {
          "asn": "AS398324 censys  inc.",
          "protocol": "sip",
          "count": 5
        },
        {
          "asn": "AS39927 e-light-telecom ltd.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS399804 hostodo",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "ssh",
          "count": 237
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "snmp",
          "count": 9
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "telnet",
          "count": 8
        },
        {
          "asn": "AS41668 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS42237 amati foundation",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS42313 albtelecom sh.a.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS42610 pjsc rostelecom",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS42667 artur sienkiewicz",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS42708 glesys ab",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS43162 olimp llc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS44327 delta comm llc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS45061 shanghai information network co. ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS45090 shenzhen tencent computer systems company limited",
          "protocol": "ssh",
          "count": 192
        },
        {
          "asn": "AS45090 shenzhen tencent computer systems company limited",
          "protocol": "telnet",
          "count": 4
        },
        {
          "asn": "AS45102 alibaba (us) technology co.  ltd.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS4538 china education and research network center",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS45557 vietnam technology and telecommunication jsc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS45820 tata teleservices",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS45899 vnpt corp",
          "protocol": "ssh",
          "count": 21
        },
        {
          "asn": "AS45903 cmc telecom infrastructure company",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS4609 companhia de telecomunicacoes de macau sarl",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS4621 uninet-th",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS46606 unified layer",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS47331 ttnet a.s.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS47433 sibirskie seti ltd.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS4750 cs loxinfo public company limited",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS4755 tata communications",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS4760 hkt limited",
          "protocol": "ssh",
          "count": 10
        },
        {
          "asn": "AS4766 korea telecom",
          "protocol": "ssh",
          "count": 40
        },
        {
          "asn": "AS4766 korea telecom",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS4780 digital united inc.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS4788 tm net  internet service provider",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS48004 pe tsibrankov konstantin igorevich",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS4808 china unicom beijing province network",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS48090 pptechnology limited",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS48090 pptechnology limited",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS4812 china telecom (group)",
          "protocol": "ssh",
          "count": 13
        },
        {
          "asn": "AS4816 china telecom (group)",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS4835 china telecom (group)",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS4837 china unicom china169 backbone",
          "protocol": "ssh",
          "count": 37
        },
        {
          "asn": "AS4847 china networks inter-exchange",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS49392 llc baxet",
          "protocol": "ssh",
          "count": 8
        },
        {
          "asn": "AS49403 avk-wellcom ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS49424 new line solutions llc",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS49434 harmony hosting sarl",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS49505 ooo network of data-centers selectel",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS49870 alsycon b.v.",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS50215 master llc",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS51167 contabo gmbh",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS51559 netinternet bilisim teknolojileri as",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS51604 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS51604 jsc er-telecom holding",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS51852 private layer inc",
          "protocol": "ssh",
          "count": 9
        },
        {
          "asn": "AS52312 tv music house jujuy",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS53334 total uptime technologies  llc",
          "protocol": "http",
          "count": 112
        },
        {
          "asn": "AS53334 total uptime technologies  llc",
          "protocol": "tcp",
          "count": 112
        },
        {
          "asn": "AS53667 frantech solutions",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS53831 squarespace  inc.",
          "protocol": "http",
          "count": 396
        },
        {
          "asn": "AS53831 squarespace  inc.",
          "protocol": "tcp",
          "count": 396
        },
        {
          "asn": "AS54113 fastly",
          "protocol": "http",
          "count": 112
        },
        {
          "asn": "AS54113 fastly",
          "protocol": "tcp",
          "count": 112
        },
        {
          "asn": "AS5483 magyar telekom plc.",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS55577 atria convergence technologies pvt ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS55720 gigabit hosting sdn bhd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS56040 china mobile communications corporation",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS56044 china mobile communications corporation",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS56046 china mobile communications corporation",
          "protocol": "ssh",
          "count": 13
        },
        {
          "asn": "AS56048 china mobile communicaitons corporation",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS56466 zentex",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS5650 frontier communications of america  inc.",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS57049 small private enterprise kvant-ii",
          "protocol": "telnet",
          "count": 3
        },
        {
          "asn": "AS57427 sierra llc",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS57523 chang way technologies co. limited",
          "protocol": "http",
          "count": 42
        },
        {
          "asn": "AS57523 chang way technologies co. limited",
          "protocol": "tcp",
          "count": 42
        },
        {
          "asn": "AS577 bell canada",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS57835 jsc elektrosvyaz",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS57858 inter connects inc",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS58461 ct-hangzhou-idc",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS58461 ct-hangzhou-idc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS58519 cloud computing corporation",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS58542 tianjij 300000",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS58543 guangdong",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS58593 shanghai blue cloud technology co. ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS58819 pt arsenet global solusi",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS58946 grameen communications",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS59019 beijing kingsoft cloud internet technology co ltd",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS6057 administracion nacional de telecomunicaciones",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS6128 cablevision systems corp.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS6130 american internet services  llc.",
          "protocol": "snmp",
          "count": 3
        },
        {
          "asn": "AS61432 itbks892",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS6147 telefonica del peru s.a.a.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS61826 nethouse telecom",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS62068 spectraip b.v.",
          "protocol": "sip",
          "count": 7
        },
        {
          "asn": "AS63199 capitalonline data service co. ltd",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS63526 systems solutions & development technologies limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS63730 vnso technology company",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS63835 no 293 wanbao avenue",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS63949 linode  llc",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS63949 linode  llc",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS6568 entel s.a. - entelnet",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS6702 science production company trifle ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS6703 private joint-stock company farlep-invest",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS6713 itissalat al-maghrib",
          "protocol": "ssh",
          "count": 7
        },
        {
          "asn": "AS6730 sunrise communications ag",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS6799 ote sa (hellenic telecommunications organisation)",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS6830 liberty global b.v.",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS6849 pjsc ukrtelecom",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS6939 hurricane electric llc",
          "protocol": "snmp",
          "count": 9
        },
        {
          "asn": "AS6939 hurricane electric llc",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS701 verizon",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "sip",
          "count": 14
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "telnet",
          "count": 2
        },
        {
          "asn": "AS7184 universidad veracruzana",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS7303 telecom argentina s.a.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS7470 true internet co. ltd.",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS7545 tpg telecom limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS7552 viettel group",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS7713 pt telekomunikasi indonesia",
          "protocol": "ssh",
          "count": 11
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "sip",
          "count": 7
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS8048 cantv servicios  venezuela",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS8070 microsoft corporation",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS8075 microsoft corporation",
          "protocol": "ssh",
          "count": 31
        },
        {
          "asn": "AS8151 uninet s.a. de c.v.",
          "protocol": "ssh",
          "count": 5
        },
        {
          "asn": "AS8220 colt technology services group limited",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8228 sfr sa",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8331 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8359 mts pjsc",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS8402 pjsc vimpelcom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8449 elcat ltd.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS8473 bahnhof",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS852 telus communications inc.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8560 1&1 ionos se",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8612 tiscali italia s.p.a.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS8758 iway ag",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS8866 bulgarian telecommunications company plc.",
          "protocol": "telnet",
          "count": 1
        },
        {
          "asn": "AS9009 m247 ltd",
          "protocol": "sip",
          "count": 1
        },
        {
          "asn": "AS9009 m247 ltd",
          "protocol": "snmp",
          "count": 1
        },
        {
          "asn": "AS9198 jsc kazakhtelecom",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS9269 hong kong broadband network",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS9299 philippine long distance telephone company",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS9304 hgc global communications limited",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS9318 sk broadband co ltd",
          "protocol": "ssh",
          "count": 18
        },
        {
          "asn": "AS9341 pt indonesia comnets plus",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS9381 hkbn enterprise solutions hk limited",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS9498 bharti airtel ltd.",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS9802 abitcool(china) inc.",
          "protocol": "ssh",
          "count": 2
        },
        {
          "asn": "AS9808 china mobile communications group co.  ltd.",
          "protocol": "ssh",
          "count": 25
        },
        {
          "asn": "AS9812 oriental cable network co.  ltd.",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "AS9829 national internet backbone",
          "protocol": "ssh",
          "count": 4
        },
        {
          "asn": "AS9891 cs loxinfo public company limited.",
          "protocol": "ssh",
          "count": 9
        },
        {
          "asn": "AS9924 taiwan fixed network telco and network service provider",
          "protocol": "ssh",
          "count": 3
        },
        {
          "asn": "AS9931 the communication authority of thailand",
          "protocol": "ssh",
          "count": 1
        },
        {
          "asn": "ASNone ",
          "protocol": "ssh",
          "count": 51
        },
        {
          "asn": "ASNone ",
          "protocol": "sip",
          "count": 16
        },
        {
          "asn": "ASNone ",
          "protocol": "snmp",
          "count": 14
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 445,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 426,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 426 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify, for each ASN that has source IPs performing attacks against France, the three most frequently used attack protocols, ranked by usage, to understand protocol preferences per ASN when targeting France.\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacking source\",\n      \"(:Country {name}) as the target country (France)\",\n      \"(:ASN {number}) as the ASN owning/associated with the attacking IP\"\n    ],\n    \"relationships\": [\n      \"(ip)-[:ATTACKS {protocol, technique, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country) to represent attacks and capture the protocol used\",\n      \"(ip)-[:BELONGS_TO]->(asn) to associate each attacking IP with an ASN\",\n      \"(ip)-[:FROM]->(country) is available for origin-country context but is not required to answer the question unless the user also wants attacker geography\"\n    ]\n  },\n  \"FILTERS\": {\n    \"target_country\": \"Country.name must equal 'France' on the attacked country node\",\n    \"protocol_presence\": \"ATTACKS.protocol must be present/non-null to be counted\",\n    \"scope\": \"Only consider IPs that both (a) attack France and (b) belong to an ASN via BELONGS_TO\",\n    \"time_window\": \"No time constraints stated; include all ATTACKS events unless the user later specifies a date range using documented_create_date / documented_modified_date\"\n  },\n  \"OUTPUT_FORMAT\": \"Return one row per ASN with its ASN number and a ranked list of the top 3 protocols used to attack France. Each protocol entry should include the protocol name and a count of occurrences (e.g., number of ATTACKS relationships/events). If fewer than 3 protocols exist for an ASN, return as many as available.\",\n  \"SUGGESTED_APPROACH\": \"Traverse from ASN to its IPs (via BELONGS_TO), then from those IPs to attacks targeting the Country node named France (via ATTACKS). Group by ASN and protocol, count attack occurrences, rank protocols per ASN by descending count (using a deterministic tie-breaker such as protocol name), then keep only the top 3 protocols per ASN and format as a list per ASN.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For each ASN, count and rank the protocols used in ATTACKS relationships from its IPs to the Country node named 'France', and return the top three protocols per ASN with their counts.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For each ASN, count and rank the protocols used in ATTACKS relationships from its IPs to the Country node named 'France', and return the top three protocols per ASN with their counts."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (c:Country {name:'France'})\nMATCH (ip:IP)-[:BELONGS_TO]->(a:ASN)\nMATCH (ip)-[r:ATTACKS]->(c)\nWHERE r.protocol <> 'unknown'\nWITH a.number AS asn, r.protocol AS protocol, count(*) AS protocol_count\nORDER BY asn, protocol_count DESC, protocol\nWITH asn, collect({protocol: protocol, count: protocol_count})[0..3] AS top_protocols\nUNWIND top_protocols AS p\nRETURN asn, p.protocol AS protocol, p.count AS count\nORDER BY asn, count DESC, protocol"
          ],
          "trace": [
            {
              "subproblem": "For each ASN, count and rank the protocols used in ATTACKS relationships from its IPs to the Country node named 'France', and return the top three protocols per ASN with their counts.",
              "attempts": [
                {
                  "fragment": "MATCH (c:Country {name:'France'})\nMATCH (ip:IP)-[:BELONGS_TO]->(a:ASN)\nMATCH (ip)-[r:ATTACKS]->(c)\nWHERE r.protocol <> 'unknown'\nWITH a.number AS asn, r.protocol AS protocol, count(*) AS protocol_count\nORDER BY asn, protocol_count DESC, protocol\nWITH asn, collect({protocol: protocol, count: protocol_count})[0..3] AS top_protocols\nUNWIND top_protocols AS p\nRETURN asn, p.protocol AS protocol, p.count AS count\nORDER BY asn, count DESC, protocol",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn": "AS10103 hk broadband network ltd.",
                      "protocol": "ssh",
                      "count": 1
                    },
                    {
                      "asn": "AS10220 pt. kreasi sejahtera teknologi",
                      "protocol": "ssh",
                      "count": 2
                    },
                    {
                      "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
                      "protocol": "ssh",
                      "count": 4
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (c:Country {name:'France'})\nMATCH (ip:IP)-[:BELONGS_TO]->(a:ASN)\nMATCH (ip)-[r:ATTACKS]->(c)\nWHERE r.protocol <> 'unknown'\nWITH a.number AS asn, r.protocol AS protocol, count(*) AS protocol_count\nORDER BY asn, protocol_count DESC, protocol\nWITH asn, collect({protocol: protocol, count: protocol_count})[0..3] AS top_protocols\nUNWIND top_protocols AS p\nRETURN asn, p.protocol AS protocol, p.count AS count\nORDER BY asn, count DESC, protocol"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn": "AS10103 hk broadband network ltd.",
              "protocol": "ssh",
              "count": 1
            },
            {
              "asn": "AS10220 pt. kreasi sejahtera teknologi",
              "protocol": "ssh",
              "count": 2
            },
            {
              "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
              "protocol": "ssh",
              "count": 4
            }
          ]
        },
        "explanation": {
          "text": "It finds, for each ASN whose IPs have **ATTACKS** edges targeting **France** with a known protocol, the **top three most-used protocols** by attack count and returns them with their counts per ASN."
        }
      },
      "token_usage": {
        "input": 1581,
        "output": 835,
        "total": 2416
      },
      "duration_seconds": 33.097,
      "started_at": "2026-02-20T05:13:41.747849+00:00",
      "ended_at": "2026-02-20T05:14:14.844787+00:00",
      "metadata": {
        "time": "2026-02-20T05:14:14.824102+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 12,
      "category": "impossible",
      "prompt": "List the top 5 malware families used in attacks.",
      "expected_cypher": "RETURN 'Not enough information in schema (no malware family)' AS note",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.technology IS NOT NULL AND trim(r.technology) <> '' AND r.technology <> 'unknown'\nWITH r.technology AS malware_family, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN malware_family, attack_count",
      "response": [
        {
          "malware_family": "windows",
          "attack_count": 55347
        },
        {
          "malware_family": "win32",
          "attack_count": 48519
        },
        {
          "malware_family": "SSSL(Secure Sockets Layer)",
          "attack_count": 33031
        },
        {
          "malware_family": "hacktool",
          "attack_count": 14432
        },
        {
          "malware_family": "lamp",
          "attack_count": 10327
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 267,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 5,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 5 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which malware families are most commonly associated with observed attacks in the dataset, returning the five most frequent families based on attack activity.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\",\n      \"(:ASN {number})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\"\n    ],\n    \"NOTES\": \"The question asks for 'malware families', but the provided schema does not include an explicit malware_family field. The closest ATTACKS properties that could represent this are likely 'technology' (e.g., malware/tool name) or possibly 'technique' (though that is more commonly a TTP classification, not a family). This needs a mapping decision before querying.\"\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [\n      \"Only include ATTACKS relationships where the chosen malware-family proxy property is present and non-empty (e.g., ATTACKS.technology or ATTACKS.technique).\"\n    ],\n    \"OPTIONAL/UNSPECIFIED\": [\n      \"Time window is not specified; default to all available ATTACKS records unless the user provides a date range (could use documented_create_date or documented_modified_date).\",\n      \"No geography, ASN, protocol, industry, or botnet restrictions were requested; keep unfiltered unless the user adds constraints.\"\n    ],\n    \"AMBIGUITY_TO_RESOLVE\": [\n      \"Which property should be treated as the 'malware family' label: ATTACKS.technology (recommended if it contains tool/malware names) vs ATTACKS.technique (may be tactics/techniques rather than families).\",\n      \"Whether to count by total ATTACKS relationships, by distinct IPs involved, or by distinct pulse_id (to reduce duplication across repeated observations).\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": \"Return a ranked list of the top 5 malware-family labels with their corresponding counts (and optionally rank). Example fields: malware_family, attack_count, rank. Sorted by attack_count descending, limited to 5.\",\n  \"SUGGESTED_APPROACH\": \"Traverse ATTACKS relationships from IP to Country, select the property that represents 'malware family' (preferably technology if it contains malware/tool names), discard null/blank values, group by that label, compute frequency using the chosen counting method (relationships vs distinct pulse_id vs distinct IP), sort descending by frequency, and return the top 5 with counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Using ATTACKS relationships, treat ATTACKS.technology (or the agreed malware-family field) as the malware family label, count how often each family appears in attacks (excluding null/empty), sort by count descending, and return the top 5 families with their counts.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Using ATTACKS relationships, treat ATTACKS.technology (or the agreed malware-family field) as the malware family label, count how often each family appears in attacks (excluding null/empty), sort by count descending, and return the top 5 families with their counts."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.technology IS NOT NULL AND trim(r.technology) <> '' AND r.technology <> 'unknown'\nWITH r.technology AS malware_family, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN malware_family, attack_count"
          ],
          "trace": [
            {
              "subproblem": "Using ATTACKS relationships, treat ATTACKS.technology (or the agreed malware-family field) as the malware family label, count how often each family appears in attacks (excluding null/empty), sort by count descending, and return the top 5 families with their counts.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.technology IS NOT NULL AND trim(r.technology) <> '' AND r.technology <> 'unknown'\nWITH r.technology AS malware_family, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN malware_family, attack_count",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "malware_family": "windows",
                      "attack_count": 55347
                    },
                    {
                      "malware_family": "win32",
                      "attack_count": 48519
                    },
                    {
                      "malware_family": "SSSL(Secure Sockets Layer)",
                      "attack_count": 33031
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.technology IS NOT NULL AND trim(r.technology) <> '' AND r.technology <> 'unknown'\nWITH r.technology AS malware_family, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN malware_family, attack_count"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "malware_family": "windows",
              "attack_count": 55347
            },
            {
              "malware_family": "win32",
              "attack_count": 48519
            },
            {
              "malware_family": "SSSL(Secure Sockets Layer)",
              "attack_count": 33031
            }
          ]
        },
        "explanation": {
          "text": "It finds the five most frequently observed non-empty, non-\u201cunknown\u201d `technology` values on `ATTACKS` relationships (treated as malware families) and returns each with the total number of attacks."
        }
      },
      "token_usage": {
        "input": 1469,
        "output": 987,
        "total": 2456
      },
      "duration_seconds": 293.378,
      "started_at": "2026-02-20T05:14:14.846013+00:00",
      "ended_at": "2026-02-20T05:19:08.224108+00:00",
      "metadata": {
        "time": "2026-02-20T05:19:08.211667+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 13,
      "category": "impossible",
      "prompt": "What destination ports are most targeted?",
      "expected_cypher": "RETURN 'Not enough information in schema (no destination port)' AS note",
      "agent_cypher": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.protocol IS NOT NULL AND r.protocol <> 'unknown'\nWITH\n  CASE\n    WHEN r.protocol CONTAINS '/' THEN split(r.protocol, '/')[-1]\n    WHEN r.protocol CONTAINS ':' THEN split(r.protocol, ':')[-1]\n    ELSE r.protocol\n  END AS portStr\nWHERE portStr =~ '^[0-9]+$'\nWITH toInteger(portStr) AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 420,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which destination network ports are being attacked most frequently, ranking ports by how often they appear in recorded attack events.\",\n  \"KEY_ENTITIES\": \"Primary: (:IP)-[:ATTACKS]->(:Country). The destination port is expected to be represented on the :ATTACKS relationship (ideally as an explicit property such as destination_port). Supporting context entities for optional segmentation: (ip:IP)-[:FROM]->(country:Country) to describe source geography, and (ip:IP)-[:BELONGS_TO]->(asn:ASN) to describe source network ownership. Potentially relevant relationship properties on :ATTACKS include protocol, technique, technology, industry, pulse_id, documented_create_date, documented_modified_date.\",\n  \"FILTERS\": \"No explicit filters are specified in the question. Implicit requirement: only attack events where a destination port can be determined should be included. Note: the current schema does not explicitly list a destination port property; if the port is embedded in an existing field (commonly protocol or technology) it must be consistently parseable/extractable; otherwise the result cannot be computed from the provided schema without additional data or a schema update.\",\n  \"OUTPUT_FORMAT\": \"Return a ranked list/table of destination ports with at least: destination_port and attack_event_count, sorted by attack_event_count descending. Optionally include protocol (if ports are protocol-specific), and allow a top-N limit (e.g., top 10/20).\",\n  \"SUGGESTED_APPROACH\": \"Use attack events represented by :ATTACKS relationships as the unit of counting. For each :ATTACKS event, extract the destination port (preferably from a dedicated property; alternatively parse it from an existing field such as protocol if it contains patterns like \\\"tcp/22\\\" or \\\"udp:53\\\"). Exclude events where the port is missing/invalid. Aggregate counts by destination port (and optionally by protocol), then sort descending and return the top results. If the user wants more context, add optional breakdowns/filters by time window (documented_create_date/modified_date), source IP botnet flag, source country via :FROM, source ASN via :BELONGS_TO, or victim country via the :ATTACKS target node.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Rank destination ports by how many :ATTACKS events target them (extracting the port from the attack data), returning each port with its attack count sorted descending (optionally top N).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Rank destination ports by how many :ATTACKS events target them (extracting the port from the attack data), returning each port with its attack count sorted descending (optionally top N)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.protocol IS NOT NULL AND r.protocol <> 'unknown'\nWITH\n  CASE\n    WHEN r.protocol CONTAINS '/' THEN split(r.protocol, '/')[-1]\n    WHEN r.protocol CONTAINS ':' THEN split(r.protocol, ':')[-1]\n    ELSE r.protocol\n  END AS portStr\nWHERE portStr =~ '^[0-9]+$'\nWITH toInteger(portStr) AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC"
          ],
          "trace": [
            {
              "subproblem": "Rank destination ports by how many :ATTACKS events target them (extracting the port from the attack data), returning each port with its attack count sorted descending (optionally top N).",
              "attempts": [
                {
                  "fragment": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.protocol IS NOT NULL AND r.protocol <> 'unknown'\nWITH\n  CASE\n    WHEN r.protocol CONTAINS '/' THEN split(r.protocol, '/')[-1]\n    WHEN r.protocol CONTAINS ':' THEN split(r.protocol, ':')[-1]\n    ELSE r.protocol\n  END AS portStr\nWHERE portStr =~ '^[0-9]+$'\nWITH toInteger(portStr) AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.protocol IS NOT NULL AND r.protocol <> 'unknown'\nWITH\n  CASE\n    WHEN r.protocol CONTAINS '/' THEN split(r.protocol, '/')[-1]\n    WHEN r.protocol CONTAINS ':' THEN split(r.protocol, ':')[-1]\n    ELSE r.protocol\n  END AS portStr\nWHERE portStr =~ '^[0-9]+$'\nWITH toInteger(portStr) AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "It extracts numeric destination ports from the `r.protocol` field on `ATTACKS` relationships (handling `/` or `:` separators), counts how many attacks target each port, and returns the ports ranked by attack frequency."
        }
      },
      "token_usage": {
        "input": 1543,
        "output": 1473,
        "total": 3016
      },
      "duration_seconds": 202.479,
      "started_at": "2026-02-20T05:19:08.224829+00:00",
      "ended_at": "2026-02-20T05:22:30.703352+00:00",
      "metadata": {
        "time": "2026-02-20T05:22:30.690578+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 14,
      "category": "matcher-needed",
      "prompt": "How many attacks used technique ' Phishing' against Australia?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS {technique:'T1566 Phishing'}]->(:Country {name:'Australia'})\nRETURN count(a) AS attacks",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})\nWHERE trim(r.technique) = 'T1566 Phishing'\nRETURN count(*) AS phishing_attacks_to_australia",
      "response": [
        {
          "phishing_attacks_to_australia": 156
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 150,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Determine the total number of recorded attack events in the dataset where the attack technique is labeled 'Phishing' and the target country is Australia.\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"IP (attacker/source or attacking host)\",\n      \"Country (target country)\"\n    ],\n    \"relationships\": [\n      \"IP-[:ATTACKS]->Country (contains the attack event details such as technique and pulse identifiers)\"\n    ],\n    \"relationship_properties_used\": [\n      \"ATTACKS.technique\"\n    ],\n    \"node_properties_used\": [\n      \"Country.name\"\n    ]\n  },\n  \"FILTERS\": {\n    \"technique\": \"Phishing\",\n    \"target_country_name\": \"Australia\",\n    \"notes\": [\n      \"Trim leading/trailing whitespace in the technique value since the prompt shows it as ' Phishing'.\",\n      \"Match technique consistently (e.g., exact match after trimming; optionally case-insensitive if data quality is inconsistent).\",\n      \"Count attacks based on ATTACKS relationships (each relationship instance represents an attack record/event).\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": {\n    \"type\": \"single_value\",\n    \"fields\": [\n      {\n        \"name\": \"attack_count\",\n        \"description\": \"Integer count of ATTACKS relationships where technique is Phishing and the target Country is Australia.\"\n      }\n    ]\n  },\n  \"SUGGESTED_APPROACH\": [\n    \"Identify the Country node representing Australia using Country.name.\",\n    \"Traverse incoming ATTACKS relationships from IP nodes to that Country node.\",\n    \"Filter those ATTACKS relationships to only those whose technique equals 'Phishing' (after trimming whitespace and normalizing case if needed).\",\n    \"Aggregate by counting the qualifying ATTACKS relationships and return the count.\"\n  ],\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Count the number of ATTACKS relationships from any IP node to the Country node named 'Australia' where the ATTACKS.technique value is 'Phishing' (accounting for possible leading whitespace in the stored technique).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Count the number of ATTACKS relationships from any IP node to the Country node named 'Australia' where the ATTACKS.technique value is 'Phishing' (accounting for possible leading whitespace in the stored technique)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})\nWHERE trim(r.technique) = 'T1566 Phishing'\nRETURN count(*) AS phishing_attacks_to_australia"
          ],
          "trace": [
            {
              "subproblem": "Count the number of ATTACKS relationships from any IP node to the Country node named 'Australia' where the ATTACKS.technique value is 'Phishing' (accounting for possible leading whitespace in the stored technique).",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})\nWHERE trim(r.technique) = 'T1566 Phishing'\nRETURN count(*) AS phishing_attacks_to_australia",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "'Phishing'",
                      "value": "T1566 Phishing"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "phishing_attacks_to_australia": 156
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})\nWHERE trim(r.technique) = 'T1566 Phishing'\nRETURN count(*) AS phishing_attacks_to_australia"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "phishing_attacks_to_australia": 156
            }
          ]
        },
        "explanation": {
          "text": "It counts how many `ATTACKS` relationships from IP nodes to the `Country` node named \u201cAustralia\u201d have the technique exactly equal to `T1566 Phishing` (after trimming whitespace)."
        }
      },
      "token_usage": {
        "input": 1410,
        "output": 659,
        "total": 2069
      },
      "duration_seconds": 20.573,
      "started_at": "2026-02-20T05:22:30.703842+00:00",
      "ended_at": "2026-02-20T05:22:51.276865+00:00",
      "metadata": {
        "time": "2026-02-20T05:22:51.264157+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 15,
      "category": "complex",
      "prompt": "Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.technique AS technique, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, technique, year_month, collect(DISTINCT asn)[0..50] AS asns\nUNWIND range(0, size(asns)-2) AS i\nUNWIND range(i+1, size(asns)-1) AS j\nWITH asns[i] AS asnA, asns[j] AS asnB, country, technique, year_month\nRETURN asnA, asnB, country, technique, year_month, count(*) AS co_attacks\nORDER BY co_attacks DESC\nLIMIT 10",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  c.name AS country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2\nWITH asn1, asn2, count(*) AS co_occurrences\nORDER BY co_occurrences DESC, asn1 ASC, asn2 ASC\nLIMIT 10\nRETURN asn1, asn2, co_occurrences",
      "response": [
        {
          "asn1": "AS57523 chang way technologies co. limited",
          "asn2": "AS29789 reflected networks  inc.",
          "co_occurrences": 2800
        },
        {
          "asn1": "AS57523 chang way technologies co. limited",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_occurrences": 2619
        },
        {
          "asn1": "AS53334 total uptime technologies  llc",
          "asn2": "AS29789 reflected networks  inc.",
          "co_occurrences": 2580
        },
        {
          "asn1": "AS13335 cloudflare",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_occurrences": 1035
        },
        {
          "asn1": "AS54113 fastly",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_occurrences": 1012
        },
        {
          "asn1": "AS13335 cloudflare",
          "asn2": "AS54113 fastly",
          "co_occurrences": 977
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS54113 fastly",
          "co_occurrences": 637
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS13335 cloudflare",
          "co_occurrences": 580
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_occurrences": 575
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS7922 comcast",
          "co_occurrences": 529
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 507,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 10,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 10 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Find which autonomous systems (ASNs) tend to co-occur as sources of attacks by identifying pairs of ASNs that, in the same calendar month, used the same attack technique against the same target country, then rank those ASN pairs by how often this co-attack pattern happens.\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacking source\",\n      \"(:ASN {number}) as the IP\u2019s owning network\",\n      \"(:Country {name}) as the attack target (and optionally the IP\u2019s origin country)\"\n    ],\n    \"relationships\": [\n      \"(ip)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country) provides the attack event and its attributes (technique and time)\",\n      \"(ip)-[:BELONGS_TO]->(asn) links each attacking IP to an ASN\",\n      \"(ip)-[:FROM]->(country) links each IP to its origin country (not required for the co-attack logic unless additional context is desired)\"\n    ]\n  },\n  \"FILTERS\": [\n    \"Only consider ATTACKS events that have a valid technique value (non-null/non-empty).\",\n    \"Only consider ATTACKS events with a usable event date for month-bucketing (prefer documented_create_date; use documented_modified_date only if explicitly desired as a fallback).\",\n    \"Define the grouping key as: (target country, technique, calendar month derived from the chosen ATTACKS date).\",\n    \"For each grouping key, include ASNs that have at least one attacking IP participating in that group.\",\n    \"Generate ASN pairs from the set of ASNs within each group, excluding self-pairs (ASN A != ASN B) and treating (A,B) the same as (B,A) (i.e., unordered unique pairs).\",\n    \"Co-attack count for a pair should be the number of group occurrences (distinct combinations of target country + technique + month) where both ASNs appear; if desired, clarify whether to count multiple events within the same group once or multiple times (default: count once per group occurrence).\",\n    \"Return only the top 10 ASN pairs by descending co-attack count; apply deterministic tie-breaking (e.g., by ASN numbers) if needed.\"\n  ],\n  \"OUTPUT_FORMAT\": \"Return a ranked list of 10 results where each row includes: asn_1, asn_2, co_attack_count, and optionally supporting context such as the number of distinct months, distinct techniques, and distinct target countries contributing to the count (or a small sample of (country, technique, month) triples).\",\n  \"SUGGESTED_APPROACH\": \"Start from ATTACKS relationships to capture target country, technique, and event date. Join each attacking IP to its ASN via BELONGS_TO. Normalize the event date into a calendar-month bucket (e.g., YYYY-MM). Group records by (target country, technique, month) and collect the distinct ASNs observed in that group. From each group\u2019s ASN set, form all unique unordered pairs and emit one co-attack increment per pair per group. Aggregate increments across all groups to get co-attack counts per ASN pair, sort descending, and return the top 10.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Compute the top 10 unordered pairs of ASNs that both appear as sources (via IPs) of ATTACKS against the same target country using the same technique within the same calendar month, ranking pairs by the number of distinct (country, technique, month) co-occurrences.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Compute the top 10 unordered pairs of ASNs that both appear as sources (via IPs) of ATTACKS against the same target country using the same technique within the same calendar month, ranking pairs by the number of distinct (country, technique, month) co-occurrences."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  c.name AS country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2\nWITH asn1, asn2, count(*) AS co_occurrences\nORDER BY co_occurrences DESC, asn1 ASC, asn2 ASC\nLIMIT 10\nRETURN asn1, asn2, co_occurrences"
          ],
          "trace": [
            {
              "subproblem": "Compute the top 10 unordered pairs of ASNs that both appear as sources (via IPs) of ATTACKS against the same target country using the same technique within the same calendar month, ranking pairs by the number of distinct (country, technique, month) co-occurrences.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(target:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  target.name AS country,\n  r.technique AS technique,\n  date.truncate('month', r.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH\n  CASE WHEN asns[i] <= asns[j] THEN asns[i] ELSE asns[j] END AS asn1,\n  CASE WHEN asns[i] <= asns[j] THEN asns[j] ELSE asns[i] END AS asn2,\n  country,\n  technique,\n  year_month\nWITH\n  asn1,\n  asn2,\n  count(DISTINCT (country + '|' + technique + '|' + toString(year_month))) AS cooccurrence_count\nRETURN asn1, asn2, cooccurrence_count\nORDER BY cooccurrence_count DESC, asn1 ASC, asn2 ASC\nLIMIT 10",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.TransientError.General.MemoryPoolOutOfMemoryError} {message: The allocation of an extra 2.0 MiB would use more than the limit 716.8 MiB. Currently using 716.0 MiB. dbms.memory.transaction.total.max threshold reached} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  country.name AS target_country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH\n  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,\n  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2,\n  target_country,\n  technique,\n  year_month\nWITH\n  asn1,\n  asn2,\n  count(DISTINCT {target_country: target_country, technique: technique, year_month: year_month}) AS co_occurrences\nRETURN asn1, asn2, co_occurrences\nORDER BY co_occurrences DESC, asn1 ASC, asn2 ASC\nLIMIT 10",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.TransientError.General.MemoryPoolOutOfMemoryError} {message: The allocation of an extra 2.0 MiB would use more than the limit 716.8 MiB. Currently using 716.0 MiB. dbms.memory.transaction.total.max threshold reached} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  c.name AS country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2\nWITH asn1, asn2, count(*) AS co_occurrences\nORDER BY co_occurrences DESC, asn1 ASC, asn2 ASC\nLIMIT 10\nRETURN asn1, asn2, co_occurrences",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn1": "AS57523 chang way technologies co. limited",
                      "asn2": "AS29789 reflected networks  inc.",
                      "co_occurrences": 2800
                    },
                    {
                      "asn1": "AS57523 chang way technologies co. limited",
                      "asn2": "AS53334 total uptime technologies  llc",
                      "co_occurrences": 2619
                    },
                    {
                      "asn1": "AS53334 total uptime technologies  llc",
                      "asn2": "AS29789 reflected networks  inc.",
                      "co_occurrences": 2580
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  c.name AS country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2\nWITH asn1, asn2, count(*) AS co_occurrences\nORDER BY co_occurrences DESC, asn1 ASC, asn2 ASC\nLIMIT 10\nRETURN asn1, asn2, co_occurrences"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn1": "AS57523 chang way technologies co. limited",
              "asn2": "AS29789 reflected networks  inc.",
              "co_occurrences": 2800
            },
            {
              "asn1": "AS57523 chang way technologies co. limited",
              "asn2": "AS53334 total uptime technologies  llc",
              "co_occurrences": 2619
            },
            {
              "asn1": "AS53334 total uptime technologies  llc",
              "asn2": "AS29789 reflected networks  inc.",
              "co_occurrences": 2580
            }
          ]
        },
        "explanation": {
          "text": "It finds the top 10 pairs of distinct ASNs that co-occur in the same **country + attack technique + month** (i.e., both have IPs attacking that country with that technique in that month), ranked by how often each ASN pair appears together."
        }
      },
      "token_usage": {
        "input": 4030,
        "output": 3673,
        "total": 7703
      },
      "duration_seconds": 152.875,
      "started_at": "2026-02-20T05:22:51.277356+00:00",
      "ended_at": "2026-02-20T05:25:24.152840+00:00",
      "metadata": {
        "time": "2026-02-20T05:25:24.140077+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    }
  ]
}