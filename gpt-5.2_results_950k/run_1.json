{
  "summary": {
    "total_queries": 15,
    "run_duration_seconds": 2168.758025,
    "model": "gpt-5.2",
    "provider": "openai",
    "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
    "started_at": "2026-02-20T03:25:38.236029+00:00",
    "ended_at": "2026-02-20T04:01:46.994054+00:00",
    "status_breakdown": {
      "SUCCESS": 8,
      "ERROR": 4,
      "SUCCESS_ZERO_ROWS": 3
    },
    "error_types": {
      "OTHER": 3,
      "EMPTY_QUERY": 1
    },
    "total_tokens": 47875,
    "total_duration_seconds": 2168.737,
    "success_rate": 53.33
  },
  "results": [
    {
      "index": 1,
      "category": "simple",
      "prompt": "What is the attack technique most used overall?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH a.technique AS technique, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 1\nRETURN technique, attacks",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique IS NOT NULL AND trim(a.technique) <> ''\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, max(event_count) AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique",
      "response": [
        {
          "technique": "T1566 Phishing",
          "event_count": 2863569
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 411,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which attack technique appears most frequently across all recorded attack events in the dataset (i.e., the overall most commonly used technique).\",\n  \"KEY_ENTITIES\": \"Primary: (ip:IP)-[r:ATTACKS]->(country:Country), focusing on the relationship property r.technique as the categorical value to aggregate. Secondary (not required for this question): :IP node properties (address, botnet, pulse_ids) and relationships (ip)-[:FROM]->(country) and (ip)-[:BELONGS_TO]->(asn:ASN), plus :Country and :ASN nodes, which are not needed unless later segmentation is requested.\",\n  \"FILTERS\": \"No explicit filters are stated; compute across all :ATTACKS relationships. Implicit data-quality constraints to consider: exclude attacks where r.technique is null, missing, or empty/whitespace to avoid counting unknown techniques as a top result. No time-window, protocol, technology, industry, botnet, source country, or ASN constraints are requested.\",\n  \"OUTPUT_FORMAT\": \"Return the top attack technique overall, ideally with: (1) technique name, (2) total number of :ATTACKS relationships/events using that technique. If multiple techniques tie for the top count, return all tied techniques with the same highest count (or otherwise specify a deterministic tie-break rule such as alphabetical ordering).\",\n  \"SUGGESTED_APPROACH\": \"Scan all :ATTACKS relationships, group them by the technique property, count the number of occurrences per technique, sort counts descending, and select the highest-count technique (handling ties if desired). Ensure null/blank technique values are excluded from the aggregation. Present the winning technique(s) with their counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Across all (IP)-[:ATTACKS]->(Country) relationships, find the technique value used most often (excluding null/empty), and return the top technique(s) with the corresponding event count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Across all (IP)-[:ATTACKS]->(Country) relationships, find the technique value used most often (excluding null/empty), and return the top technique(s) with the corresponding event count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique IS NOT NULL AND trim(a.technique) <> ''\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, max(event_count) AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique"
          ],
          "trace": [
            {
              "subproblem": "Across all (IP)-[:ATTACKS]->(Country) relationships, find the technique value used most often (excluding null/empty), and return the top technique(s) with the corresponding event count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nWHERE a.technique IS NOT NULL AND trim(a.technique) <> ''\nWITH a.technique AS technique, count(*) AS event_count\nWITH max(event_count) AS max_count, collect({technique: technique, event_count: event_count}) AS rows\nUNWIND rows AS row\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected 'FOREACH', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 6, column 1 (offset: 279))\n\"WHERE row.event_count = max_count\"\n ^} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS event_count\nWITH max(event_count) AS max_count, collect({technique: technique, event_count: event_count}) AS rows\nUNWIND rows AS row\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected 'FOREACH', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 6, column 1 (offset: 273))\n\"WHERE row.event_count = max_count\"\n ^} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique IS NOT NULL AND trim(a.technique) <> ''\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, max(event_count) AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "event_count": 2863569
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique IS NOT NULL AND trim(a.technique) <> ''\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, max(event_count) AS max_count\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.event_count = max_count\nRETURN row.technique AS technique, row.event_count AS event_count\nORDER BY technique"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "event_count": 2863569
            }
          ]
        },
        "explanation": {
          "text": "This query finds the ATTACKS \u201ctechnique\u201d value(s) that appear most often across all IP\u2192Country attack relationships (ignoring null/blank techniques) and returns the top technique(s) with their event count."
        }
      },
      "token_usage": {
        "input": 3464,
        "output": 1658,
        "total": 5122
      },
      "duration_seconds": 123.022,
      "started_at": "2026-02-20T03:25:38.237881+00:00",
      "ended_at": "2026-02-20T03:27:41.259880+00:00",
      "metadata": {
        "time": "2026-02-20T03:27:41.248447+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 2,
      "category": "matcher-needed",
      "prompt": "From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?",
      "expected_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWITH ip, collect(toLower(a.technique)) AS allTechs\nWHERE any(t IN allTechs WHERE t CONTAINS 'phishing')\nMATCH (ip)-[a2:ATTACKS]->(:Country)\nWHERE NOT toLower(a2.technique) CONTAINS 'phishing'\nWITH a2.technique AS technique, count(*) AS cnt\nWITH collect({technique: technique, cnt: cnt}) AS rows, sum(cnt) AS total\nUNWIND rows AS r\nRETURN r.technique AS technique, r.cnt AS attacks, toFloat(r.cnt) / total * 100.0 AS percentage\nORDER BY percentage DESC",
      "agent_cypher": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort, count(DISTINCT ip) AS cohort_size\nUNWIND cohort AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique <> 'phishing'\nWITH a.technique AS technique, count(DISTINCT ip) AS distinct_ip_count, cohort_size\nRETURN\n  technique,\n  distinct_ip_count AS distinct_ip_count,\n  (100.0 * distinct_ip_count) / cohort_size AS percentage_of_phishing_ip_cohort\nORDER BY percentage_of_phishing_ip_cohort DESC, distinct_ip_count DESC, technique",
      "response": [
        {
          "technique": "T1566 Phishing",
          "distinct_ip_count": 4190,
          "percentage_of_phishing_ip_cohort": 100.0
        },
        {
          "technique": "T1595 Active Scanning",
          "distinct_ip_count": 1978,
          "percentage_of_phishing_ip_cohort": 47.20763723150358
        },
        {
          "technique": "T1110 Brute Force",
          "distinct_ip_count": 1701,
          "percentage_of_phishing_ip_cohort": 40.59665871121718
        },
        {
          "technique": "unknown",
          "distinct_ip_count": 1423,
          "percentage_of_phishing_ip_cohort": 33.9618138424821
        },
        {
          "technique": "T1046 Network Service Discovery",
          "distinct_ip_count": 121,
          "percentage_of_phishing_ip_cohort": 2.8878281622911692
        },
        {
          "technique": "T1498 Network Denial of Service",
          "distinct_ip_count": 73,
          "percentage_of_phishing_ip_cohort": 1.7422434367541766
        },
        {
          "technique": "T1133 External Remote Services",
          "distinct_ip_count": 72,
          "percentage_of_phishing_ip_cohort": 1.7183770883054892
        },
        {
          "technique": "T1595.001 Scanning IP Blocks",
          "distinct_ip_count": 71,
          "percentage_of_phishing_ip_cohort": 1.694510739856802
        },
        {
          "technique": "T1595.002 Vulnerability Scanning",
          "distinct_ip_count": 71,
          "percentage_of_phishing_ip_cohort": 1.694510739856802
        },
        {
          "technique": "T1531 Account Access Removal",
          "distinct_ip_count": 66,
          "percentage_of_phishing_ip_cohort": 1.5751789976133652
        },
        {
          "technique": "T1423 Unknown Technique",
          "distinct_ip_count": 62,
          "percentage_of_phishing_ip_cohort": 1.4797136038186158
        },
        {
          "technique": "TA0043 Unknown Technique",
          "distinct_ip_count": 61,
          "percentage_of_phishing_ip_cohort": 1.4558472553699284
        },
        {
          "technique": "T1596.005 Scan Databases",
          "distinct_ip_count": 60,
          "percentage_of_phishing_ip_cohort": 1.431980906921241
        },
        {
          "technique": "T1018 Remote System Discovery",
          "distinct_ip_count": 57,
          "percentage_of_phishing_ip_cohort": 1.360381861575179
        },
        {
          "technique": "T1110.003 Password Spraying",
          "distinct_ip_count": 43,
          "percentage_of_phishing_ip_cohort": 1.026252983293556
        },
        {
          "technique": "T1583.005 Botnet",
          "distinct_ip_count": 42,
          "percentage_of_phishing_ip_cohort": 1.0023866348448687
        },
        {
          "technique": "T1110.001 Password Guessing",
          "distinct_ip_count": 40,
          "percentage_of_phishing_ip_cohort": 0.954653937947494
        },
        {
          "technique": "T1204 User Execution",
          "distinct_ip_count": 40,
          "percentage_of_phishing_ip_cohort": 0.954653937947494
        },
        {
          "technique": "T1071 Application Layer Protocol",
          "distinct_ip_count": 32,
          "percentage_of_phishing_ip_cohort": 0.7637231503579952
        },
        {
          "technique": "T1027 Obfuscated Files or Information",
          "distinct_ip_count": 31,
          "percentage_of_phishing_ip_cohort": 0.7398568019093079
        },
        {
          "technique": "T1105 Ingress Tool Transfer",
          "distinct_ip_count": 31,
          "percentage_of_phishing_ip_cohort": 0.7398568019093079
        },
        {
          "technique": "T1055 Process Injection",
          "distinct_ip_count": 30,
          "percentage_of_phishing_ip_cohort": 0.7159904534606205
        },
        {
          "technique": "T1057 Process Discovery",
          "distinct_ip_count": 29,
          "percentage_of_phishing_ip_cohort": 0.6921241050119332
        },
        {
          "technique": "T1129 Shared Modules",
          "distinct_ip_count": 29,
          "percentage_of_phishing_ip_cohort": 0.6921241050119332
        },
        {
          "technique": "T1060 Registry Run Keys / Startup Folder",
          "distinct_ip_count": 28,
          "percentage_of_phishing_ip_cohort": 0.6682577565632458
        },
        {
          "technique": "T1110.002 Password Cracking",
          "distinct_ip_count": 28,
          "percentage_of_phishing_ip_cohort": 0.6682577565632458
        },
        {
          "technique": "T1082 System Information Discovery",
          "distinct_ip_count": 27,
          "percentage_of_phishing_ip_cohort": 0.6443914081145584
        },
        {
          "technique": "T1112 Modify Registry",
          "distinct_ip_count": 27,
          "percentage_of_phishing_ip_cohort": 0.6443914081145584
        },
        {
          "technique": "T1045 Software Packing",
          "distinct_ip_count": 26,
          "percentage_of_phishing_ip_cohort": 0.6205250596658711
        },
        {
          "technique": "T1053 Scheduled Task/Job",
          "distinct_ip_count": 24,
          "percentage_of_phishing_ip_cohort": 0.5727923627684964
        },
        {
          "technique": "T1031 Modify Existing Service",
          "distinct_ip_count": 23,
          "percentage_of_phishing_ip_cohort": 0.548926014319809
        },
        {
          "technique": "T1036 Masquerading",
          "distinct_ip_count": 23,
          "percentage_of_phishing_ip_cohort": 0.548926014319809
        },
        {
          "technique": "T1059 Command and Scripting Interpreter",
          "distinct_ip_count": 23,
          "percentage_of_phishing_ip_cohort": 0.548926014319809
        },
        {
          "technique": "T1140 Deobfuscate/Decode Files or Information",
          "distinct_ip_count": 23,
          "percentage_of_phishing_ip_cohort": 0.548926014319809
        },
        {
          "technique": "T1040 Network Sniffing",
          "distinct_ip_count": 22,
          "percentage_of_phishing_ip_cohort": 0.5250596658711217
        },
        {
          "technique": "T1071.004 DNS",
          "distinct_ip_count": 21,
          "percentage_of_phishing_ip_cohort": 0.5011933174224343
        },
        {
          "technique": "T1143 Hidden Window",
          "distinct_ip_count": 20,
          "percentage_of_phishing_ip_cohort": 0.477326968973747
        },
        {
          "technique": "T1497 Virtualization/Sandbox Evasion",
          "distinct_ip_count": 20,
          "percentage_of_phishing_ip_cohort": 0.477326968973747
        },
        {
          "technique": "T1041 Exfiltration Over C2 Channel",
          "distinct_ip_count": 19,
          "percentage_of_phishing_ip_cohort": 0.45346062052505964
        },
        {
          "technique": "T1071.001 Web Protocols",
          "distinct_ip_count": 19,
          "percentage_of_phishing_ip_cohort": 0.45346062052505964
        },
        {
          "technique": "T1119 Automated Collection",
          "distinct_ip_count": 19,
          "percentage_of_phishing_ip_cohort": 0.45346062052505964
        },
        {
          "technique": "T1449 Unknown Technique",
          "distinct_ip_count": 19,
          "percentage_of_phishing_ip_cohort": 0.45346062052505964
        },
        {
          "technique": "TA0011 Unknown Technique",
          "distinct_ip_count": 19,
          "percentage_of_phishing_ip_cohort": 0.45346062052505964
        },
        {
          "technique": "T1068 Exploitation for Privilege Escalation",
          "distinct_ip_count": 18,
          "percentage_of_phishing_ip_cohort": 0.4295942720763723
        },
        {
          "technique": "T1083 File and Directory Discovery",
          "distinct_ip_count": 18,
          "percentage_of_phishing_ip_cohort": 0.4295942720763723
        },
        {
          "technique": "T1568 Dynamic Resolution",
          "distinct_ip_count": 18,
          "percentage_of_phishing_ip_cohort": 0.4295942720763723
        },
        {
          "technique": "T1023 Shortcut Modification",
          "distinct_ip_count": 17,
          "percentage_of_phishing_ip_cohort": 0.40572792362768495
        },
        {
          "technique": "T1059.007 JavaScript",
          "distinct_ip_count": 17,
          "percentage_of_phishing_ip_cohort": 0.40572792362768495
        },
        {
          "technique": "T1047 Windows Management Instrumentation",
          "distinct_ip_count": 16,
          "percentage_of_phishing_ip_cohort": 0.3818615751789976
        },
        {
          "technique": "T1090 Proxy",
          "distinct_ip_count": 16,
          "percentage_of_phishing_ip_cohort": 0.3818615751789976
        },
        {
          "technique": "T1106 Native API",
          "distinct_ip_count": 16,
          "percentage_of_phishing_ip_cohort": 0.3818615751789976
        },
        {
          "technique": "T1012 Query Registry",
          "distinct_ip_count": 15,
          "percentage_of_phishing_ip_cohort": 0.35799522673031026
        },
        {
          "technique": "T1553 Subvert Trust Controls",
          "distinct_ip_count": 15,
          "percentage_of_phishing_ip_cohort": 0.35799522673031026
        },
        {
          "technique": "T1573 Encrypted Channel",
          "distinct_ip_count": 15,
          "percentage_of_phishing_ip_cohort": 0.35799522673031026
        },
        {
          "technique": "TA0003 Unknown Technique",
          "distinct_ip_count": 15,
          "percentage_of_phishing_ip_cohort": 0.35799522673031026
        },
        {
          "technique": "T1021.004 SSH",
          "distinct_ip_count": 14,
          "percentage_of_phishing_ip_cohort": 0.3341288782816229
        },
        {
          "technique": "T1056 Input Capture",
          "distinct_ip_count": 14,
          "percentage_of_phishing_ip_cohort": 0.3341288782816229
        },
        {
          "technique": "T1210 Exploitation of Remote Services",
          "distinct_ip_count": 14,
          "percentage_of_phishing_ip_cohort": 0.3341288782816229
        },
        {
          "technique": "TA0004 Unknown Technique",
          "distinct_ip_count": 14,
          "percentage_of_phishing_ip_cohort": 0.3341288782816229
        },
        {
          "technique": "TA0005 Unknown Technique",
          "distinct_ip_count": 14,
          "percentage_of_phishing_ip_cohort": 0.3341288782816229
        },
        {
          "technique": "T1059.001 PowerShell",
          "distinct_ip_count": 13,
          "percentage_of_phishing_ip_cohort": 0.31026252983293556
        },
        {
          "technique": "T1480 Execution Guardrails",
          "distinct_ip_count": 13,
          "percentage_of_phishing_ip_cohort": 0.31026252983293556
        },
        {
          "technique": "T1499 Endpoint Denial of Service",
          "distinct_ip_count": 13,
          "percentage_of_phishing_ip_cohort": 0.31026252983293556
        },
        {
          "technique": "T1518 Software Discovery",
          "distinct_ip_count": 13,
          "percentage_of_phishing_ip_cohort": 0.31026252983293556
        },
        {
          "technique": "T1003 OS Credential Dumping",
          "distinct_ip_count": 12,
          "percentage_of_phishing_ip_cohort": 0.2863961813842482
        },
        {
          "technique": "T1110.004 Credential Stuffing",
          "distinct_ip_count": 12,
          "percentage_of_phishing_ip_cohort": 0.2863961813842482
        },
        {
          "technique": "T1114 Email Collection",
          "distinct_ip_count": 12,
          "percentage_of_phishing_ip_cohort": 0.2863961813842482
        },
        {
          "technique": "T1583 Acquire Infrastructure",
          "distinct_ip_count": 12,
          "percentage_of_phishing_ip_cohort": 0.2863961813842482
        },
        {
          "technique": "T1056.001 Keylogging",
          "distinct_ip_count": 11,
          "percentage_of_phishing_ip_cohort": 0.26252983293556087
        },
        {
          "technique": "T1072 Software Deployment Tools",
          "distinct_ip_count": 11,
          "percentage_of_phishing_ip_cohort": 0.26252983293556087
        },
        {
          "technique": "T1089 Disabling Security Tools",
          "distinct_ip_count": 11,
          "percentage_of_phishing_ip_cohort": 0.26252983293556087
        },
        {
          "technique": "T1096 NTFS File Attributes",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1176 Browser Extensions",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1410 Unknown Technique",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1428 Unknown Technique",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1547 Boot or Logon Autostart Execution",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1553.002 Code Signing",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1562 Impair Defenses",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1590.004 Network Topology",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1590.005 IP Addresses",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1598 Phishing for Information",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "TA0006 Unknown Technique",
          "distinct_ip_count": 10,
          "percentage_of_phishing_ip_cohort": 0.2386634844868735
        },
        {
          "technique": "T1010 Application Window Discovery",
          "distinct_ip_count": 9,
          "percentage_of_phishing_ip_cohort": 0.21479713603818615
        },
        {
          "technique": "T1095 Non-Application Layer Protocol",
          "distinct_ip_count": 9,
          "percentage_of_phishing_ip_cohort": 0.21479713603818615
        },
        {
          "technique": "T1158 Hidden Files and Directories",
          "distinct_ip_count": 9,
          "percentage_of_phishing_ip_cohort": 0.21479713603818615
        },
        {
          "technique": "TA0007 Unknown Technique",
          "distinct_ip_count": 9,
          "percentage_of_phishing_ip_cohort": 0.21479713603818615
        },
        {
          "technique": "T1070 Indicator Removal",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "T1132 Data Encoding",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "T1190 Exploit Public-Facing Application",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "T1568.002 Domain Generation Algorithms",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "TA0002 Unknown Technique",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "TA0009 Unknown Technique",
          "distinct_ip_count": 8,
          "percentage_of_phishing_ip_cohort": 0.1909307875894988
        },
        {
          "technique": "T1005 Data from Local System",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1123 Audio Capture",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1155 AppleScript",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1457 Unknown Technique",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1491 Defacement",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1543 Create or Modify System Process",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1583.001 Domains",
          "distinct_ip_count": 7,
          "percentage_of_phishing_ip_cohort": 0.16706443914081145
        },
        {
          "technique": "T1003.008 /etc/passwd and /etc/shadow",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1033 System Owner/User Discovery",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1049 System Network Connections Discovery",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1063 Security Software Discovery",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1064 Scripting",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1088 Bypass User Account Control",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1114.002 Remote Email Collection",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1125 Video Capture",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1192 Spearphishing Link",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1202 Indirect Command Execution",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1560 Archive Collected Data",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1564 Hide Artifacts",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1574 Hijack Execution Flow",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "TA0008 Unknown Technique",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "TA0010 Unknown Technique",
          "distinct_ip_count": 6,
          "percentage_of_phishing_ip_cohort": 0.1431980906921241
        },
        {
          "technique": "T1036.004 Masquerade Task or Service",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1094 Custom Command and Control Protocol",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1113 Screen Capture",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1122 Component Object Model Hijacking",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1179 Hooking",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1472 Unknown Technique",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1496 Resource Hijacking",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1512 Unknown Technique",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1546 Event Triggered Execution",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1563 Remote Service Session Hijacking",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1566.001 Spearphishing Attachment",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1571 Non-Standard Port",
          "distinct_ip_count": 5,
          "percentage_of_phishing_ip_cohort": 0.11933174224343675
        },
        {
          "technique": "T1001 Data Obfuscation",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1021 Remote Services",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1021.001 Remote Desktop Protocol",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1043 Commonly Used Port",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1055.013 Process Doppelg\u00e4nging",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1059.002 AppleScript",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1059.006 Python",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1147 Hidden Users",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1189 Drive-by Compromise",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1203 Exploitation for Client Execution",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1212 Exploitation for Credential Access",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1218 System Binary Proxy Execution",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1415 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1443 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1445 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1454 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1478 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1485 Data Destruction",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1553.004 Install Root Certificate",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1563.002 RDP Hijacking",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1584 Compromise Infrastructure",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "TA0001 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "TA0034 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "TA0040 Unknown Technique",
          "distinct_ip_count": 4,
          "percentage_of_phishing_ip_cohort": 0.0954653937947494
        },
        {
          "technique": "T1007 System Service Discovery",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1011 Exfiltration Over Other Network Medium",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1016.001 Internet Connection Discovery",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1019 System Firmware",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1021.006 Windows Remote Management",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1035 Service Execution",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1051 Shared Webroot",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1055.001 Dynamic-link Library Injection",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1055.003 Thread Execution Hijacking",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1055.012 Process Hollowing",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1056.004 Credential API Hooking",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1059.004 Unix Shell",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1071.002 File Transfer Protocols",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1071.003 Mail Protocols",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1078 Valid Accounts",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1078.004 Cloud Accounts",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1080 Taint Shared Content",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1081 Credentials in Files",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1098 Account Manipulation",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1100 Web Shell",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1102 Web Service",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1107 File Deletion",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1134 Access Token Manipulation",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1156 Malicious Shell Modification",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1199 Trusted Relationship",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1204.001 Malicious Link",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1215 Kernel Modules and Extensions",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1218.001 Compiled HTML File",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1427 Unknown Technique",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1450 Unknown Technique",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1459 Unknown Technique",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1476 Unknown Technique",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1486 Data Encrypted for Impact",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1489 Service Stop",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1505 Server Software Component",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1506 Web Session Cookie",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1518.001 Security Software Discovery",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1548 Abuse Elevation Control Mechanism",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1562.001 Disable or Modify Tools",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1584.005 Botnet",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1585.001 Social Media Accounts",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1596.001 DNS/Passive DNS",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1596.004 CDNs",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1614 System Location Discovery",
          "distinct_ip_count": 3,
          "percentage_of_phishing_ip_cohort": 0.07159904534606205
        },
        {
          "technique": "T1001.003 Protocol or Service Impersonation",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1016 System Network Configuration Discovery",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1017 Application Deployment Software",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1027.002 Software Packing",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1029 Scheduled Transfer",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1055.014 VDSO Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1059.005 Visual Basic",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1087 Account Discovery",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1091 Replication Through Removable Media",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1102.002 Bidirectional Communication",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1111 Multi-Factor Authentication Interception",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1118 InstallUtil",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1138 Application Shimming",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1173 Dynamic Data Exchange",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1183 Image File Execution Options Injection",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1184 SSH Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1185 Browser Session Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1198 SIP and Trust Provider Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1205.001 Port Knocking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1211 Exploitation for Defense Evasion",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1217 Browser Information Discovery",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1222.002 Linux and Mac File and Directory Permissions Modification",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1399 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1414 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1416 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1429 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1444 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1453 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1460 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1483 Domain Generation Algorithms",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1490 Inhibit System Recovery",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1491.001 Internal Defacement",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1497.001 System Checks",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1503 Credentials from Web Browsers",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1504 PowerShell Profile",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1510 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1528 Steal Application Access Token",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1529 System Shutdown/Reboot",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1530 Data from Cloud Storage",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1539 Steal Web Session Cookie",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1546.015 Component Object Model Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1547.001 Registry Run Keys / Startup Folder",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1552 Unsecured Credentials",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1552.001 Credentials In Files",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1555.003 Credentials from Web Browsers",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1558 Steal or Forge Kerberos Tickets",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1569 System Services",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1573.002 Asymmetric Cryptography",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1574.008 Path Interception by Search Order Hijacking",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1586.001 Social Media Accounts",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1588 Obtain Capabilities",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1588.004 Digital Certificates",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1589 Gather Victim Identity Information",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1590 Gather Victim Network Information",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1591 Gather Victim Org Information",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1600 Weaken Encryption",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "TA0029 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "TA0030 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "TA0037 Unknown Technique",
          "distinct_ip_count": 2,
          "percentage_of_phishing_ip_cohort": 0.0477326968973747
        },
        {
          "technique": "T1003.001 LSASS Memory",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1003.002 Security Account Manager",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1003.003 NTDS",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1003.004 LSA Secrets",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1003.005 Cached Domain Credentials",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1008 Fallback Channels",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1009 Binary Padding",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1020 Automated Exfiltration",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1027.001 Binary Padding",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1027.003 Steganography",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1027.004 Compile After Delivery",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1027.005 Indicator Removal from Tools",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1036.001 Invalid Code Signature",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1036.005 Match Legitimate Name or Location",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1037 Boot or Logon Initialization Scripts",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1037.003 Network Logon Script",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1038 DLL Search Order Hijacking",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1048.002 Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1048.003 Exfiltration Over Unencrypted Non-C2 Protocol",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1054 Indicator Blocking",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1055.008 Ptrace System Calls",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1055.011 Extra Window Memory Injection",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1059.003 Windows Command Shell",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1067 Bootkit",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1069.001 Local Groups",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1070.003 Clear Command History",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1070.006 Timestomp",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1074 Data Staged",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1076 Remote Desktop Protocol",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1078.002 Domain Accounts",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1078.003 Local Accounts",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1098.002 Additional Email Delegate Permissions",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1120 Peripheral Device Discovery",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1132.001 Standard Encoding",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1181 Extra Window Memory Injection",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1195 Supply Chain Compromise",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1204.002 Malicious File",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1213 Data from Information Repositories",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1404 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1408 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1412 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1421 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1422 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1434 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1448 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1464 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1502 Parent PID Spoofing",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1516 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1534 Internal Spearphishing",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1550 Use Alternate Authentication Material",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1553.006 Code Signing Policy Modification",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1557 Adversary-in-the-Middle",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1562.004 Disable or Modify System Firewall",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1565 Data Manipulation",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1567 Exfiltration Over Web Service",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1568.001 Fast Flux DNS",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1572 Protocol Tunneling",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1574.002 DLL Side-Loading",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1578.003 Delete Cloud Instance",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1583.002 DNS Server",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1583.004 Server",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1585 Establish Accounts",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1587 Develop Capabilities",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1590.002 DNS",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1605 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "T1608 Stage Capabilities",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        },
        {
          "technique": "TA0033 Unknown Technique",
          "distinct_ip_count": 1,
          "percentage_of_phishing_ip_cohort": 0.02386634844868735
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 540,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 320,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 320 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify the set of IP addresses that have conducted phishing attacks, then determine what other ATTACKS.technique values those same IPs have used in non-phishing attacks, and quantify how common each other technique is as a percentage of the phishing-attacker IP population.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"IP (address, botnet, pulse_ids)\",\n      \"Country (name)\",\n      \"ASN (number)\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(:Country)\",\n      \"(:IP)-[:FROM]->(:Country) (optional enrichment: origin country of IP)\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN) (optional enrichment: ASN ownership)\"\n    ],\n    \"PRIMARY_FIELDS_USED\": [\n      \"ATTACKS.technique (to identify phishing and other techniques)\",\n      \"IP.address (to deduplicate unique IPs)\"\n    ]\n  },\n  \"FILTERS\": {\n    \"INCLUSION\": [\n      \"Select IPs that have at least one ATTACKS relationship where technique equals 'phishing' (case/format normalization may be needed depending on stored values).\"\n    ],\n    \"EXCLUSION\": [\n      \"When listing 'other techniques', exclude technique = 'phishing' from the technique breakdown.\"\n    ],\n    \"OPTIONAL_CONSIDERATIONS\": [\n      \"If there are null/empty technique values, decide whether to exclude them from 'other techniques'.\",\n      \"No time window is specified; by default include all ATTACKS records unless the user later adds date constraints (documented_create_date / documented_modified_date).\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": {\n    \"TYPE\": \"Aggregated table-like result\",\n    \"FIELDS\": [\n      \"other_technique\",\n      \"ip_count_using_technique (number of distinct phishing-attacker IPs that also used this technique at least once)\",\n      \"percentage_of_phishing_ips (ip_count_using_technique / total_distinct_phishing_attacker_ips * 100)\"\n    ],\n    \"SORTING\": [\n      \"Order by percentage_of_phishing_ips descending (or ip_count_using_technique descending).\"\n    ],\n    \"NOTES\": [\n      \"Percentages are best interpreted as: 'Among IPs that have done phishing, what share have also used technique X at least once?'\",\n      \"If the user instead means frequency by number of attack events, a second metric could be added (attack_event_count and percent_of_all_attacks_from_phishing_ips), but the default interpretation is IP-based prevalence.\"\n    ]\n  },\n  \"SUGGESTED_APPROACH\": \"1) Build the cohort of distinct IP nodes that have at least one ATTACKS record labeled with technique 'phishing'. 2) From that IP cohort, traverse all ATTACKS relationships and collect their technique values excluding 'phishing'. 3) Aggregate by technique, counting distinct IPs that exhibit each technique at least once. 4) Compute the denominator once: total distinct phishing-attacker IPs. 5) Calculate percentage for each technique and return the ranked list (optionally include total phishing-IP denominator for reference).\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For all distinct IPs that have at least one ATTACKS entry with technique 'phishing', list every other ATTACKS.technique those IPs use (excluding 'phishing') and return, for each technique, the distinct IP count and the percentage of the phishing-IP cohort that uses it.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For all distinct IPs that have at least one ATTACKS entry with technique 'phishing', list every other ATTACKS.technique those IPs use (excluding 'phishing') and return, for each technique, the distinct IP count and the percentage of the phishing-IP cohort that uses it."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort, count(DISTINCT ip) AS cohort_size\nUNWIND cohort AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique <> 'phishing'\nWITH a.technique AS technique, count(DISTINCT ip) AS distinct_ip_count, cohort_size\nRETURN\n  technique,\n  distinct_ip_count AS distinct_ip_count,\n  (100.0 * distinct_ip_count) / cohort_size AS percentage_of_phishing_ip_cohort\nORDER BY percentage_of_phishing_ip_cohort DESC, distinct_ip_count DESC, technique"
          ],
          "trace": [
            {
              "subproblem": "For all distinct IPs that have at least one ATTACKS entry with technique 'phishing', list every other ATTACKS.technique those IPs use (excluding 'phishing') and return, for each technique, the distinct IP count and the percentage of the phishing-IP cohort that uses it.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort, count(DISTINCT ip) AS cohort_size\nUNWIND cohort AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique <> 'phishing'\nWITH a.technique AS technique, count(DISTINCT ip) AS distinct_ip_count, cohort_size\nRETURN\n  technique,\n  distinct_ip_count AS distinct_ip_count,\n  (100.0 * distinct_ip_count) / cohort_size AS percentage_of_phishing_ip_cohort\nORDER BY percentage_of_phishing_ip_cohort DESC, distinct_ip_count DESC, technique",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "'phishing'",
                      "value": "T1566 Phishing"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "distinct_ip_count": 4190,
                      "percentage_of_phishing_ip_cohort": 100.0
                    },
                    {
                      "technique": "T1595 Active Scanning",
                      "distinct_ip_count": 1978,
                      "percentage_of_phishing_ip_cohort": 47.20763723150358
                    },
                    {
                      "technique": "T1110 Brute Force",
                      "distinct_ip_count": 1701,
                      "percentage_of_phishing_ip_cohort": 40.59665871121718
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort, count(DISTINCT ip) AS cohort_size\nUNWIND cohort AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique <> 'phishing'\nWITH a.technique AS technique, count(DISTINCT ip) AS distinct_ip_count, cohort_size\nRETURN\n  technique,\n  distinct_ip_count AS distinct_ip_count,\n  (100.0 * distinct_ip_count) / cohort_size AS percentage_of_phishing_ip_cohort\nORDER BY percentage_of_phishing_ip_cohort DESC, distinct_ip_count DESC, technique"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "distinct_ip_count": 4190,
              "percentage_of_phishing_ip_cohort": 100.0
            },
            {
              "technique": "T1595 Active Scanning",
              "distinct_ip_count": 1978,
              "percentage_of_phishing_ip_cohort": 47.20763723150358
            },
            {
              "technique": "T1110 Brute Force",
              "distinct_ip_count": 1701,
              "percentage_of_phishing_ip_cohort": 40.59665871121718
            }
          ]
        },
        "explanation": {
          "text": "This query finds all IPs that have performed the **\u201cT1566 Phishing\u201d** ATTACKS technique, then reports which **other (non\u2011phishing) techniques** those same IPs have used, along with the **count and percentage** of the phishing-IP cohort associated with each technique."
        }
      },
      "token_usage": {
        "input": 1649,
        "output": 1587,
        "total": 3236
      },
      "duration_seconds": 109.752,
      "started_at": "2026-02-20T03:27:41.260416+00:00",
      "ended_at": "2026-02-20T03:29:31.012299+00:00",
      "metadata": {
        "time": "2026-02-20T03:29:30.993286+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 3,
      "category": "complex",
      "prompt": "Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.protocol AS protocol, a.technique AS technique, a.industry AS industry, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, protocol, technique, industry, year_month, collect(DISTINCT asn) AS asns, count(*) AS attacks\nWHERE size(asns) > 1\nRETURN country, protocol, technique, industry, year_month, asns, size(asns) AS asn_count\nORDER BY asn_count DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWITH date.truncate('month', a.documented_create_date) AS year_month, a.technique AS technique, count(*) AS attack_count\nRETURN year_month, technique, attack_count\nORDER BY year_month, technique",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1442,
        "output": 877,
        "total": 2319
      },
      "duration_seconds": 400.105,
      "started_at": "2026-02-20T03:29:31.013450+00:00",
      "ended_at": "2026-02-20T03:36:11.118005+00:00",
      "metadata": {
        "time": "2026-02-20T03:34:12.929592+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 4,
      "category": "decomposable",
      "prompt": "Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.",
      "expected_cypher": "CALL {\n    MATCH (ip:IP)-[:FROM]->(country:Country)\n    WHERE country.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(:Country)\n    RETURN count(DISTINCT ip) AS chinaAttackingIPCount\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(originCountry:Country)\n    WHERE originCountry.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(targetCountry:Country)\n    WITH targetCountry.name AS countryName, count(DISTINCT ip) AS attackCount\n    ORDER BY attackCount DESC\n    LIMIT 5\n    RETURN collect({countryName: countryName, attackCount: attackCount}) AS top5AttackedCountries\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(c:Country {name: 'China'})\n    MATCH (ip)-[a:ATTACKS]->()\n    WITH a.technique AS technique, count(a.technique) AS count\n    ORDER BY count DESC\n    LIMIT 3\n    RETURN collect(technique) AS top3Techniques\n}\nRETURN chinaAttackingIPCount, top5AttackedCountries, top3Techniques",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH count(DISTINCT ip) AS distinct_attacker_ips, c.name AS attacked_country, count(*) AS attack_events\nORDER BY attack_events DESC\nWITH distinct_attacker_ips, collect({country: attacked_country, attack_events: attack_events})[0..5] AS top_attacked_countries\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWHERE a2.technique <> 'unknown'\nWITH distinct_attacker_ips, top_attacked_countries, a2.technique AS technique, count(*) AS technique_events\nORDER BY technique_events DESC\nWITH distinct_attacker_ips, top_attacked_countries, collect({technique: technique, attack_events: technique_events})[0..3] AS top_techniques\nRETURN distinct_attacker_ips, top_attacked_countries, top_techniques",
      "response": [
        {
          "distinct_attacker_ips": 786,
          "top_attacked_countries": [
            {
              "attack_events": 43430,
              "country": "Germany"
            },
            {
              "attack_events": 35674,
              "country": "United Kingdom of Great Britain and Northern Ireland"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 1031,
          "top_attacked_countries": [
            {
              "attack_events": 38573,
              "country": "United States of America"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 1018,
          "top_attacked_countries": [
            {
              "attack_events": 36447,
              "country": "France"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 906,
          "top_attacked_countries": [
            {
              "attack_events": 36047,
              "country": "Poland"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 758,
          "top_attacked_countries": [
            {
              "attack_events": 35697,
              "country": "Canada"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 757,
          "top_attacked_countries": [
            {
              "attack_events": 35611,
              "country": "Ukraine"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 751,
          "top_attacked_countries": [
            {
              "attack_events": 35541,
              "country": "Romania"
            },
            {
              "attack_events": 35541,
              "country": "Lithuania"
            },
            {
              "attack_events": 35541,
              "country": "Norway"
            },
            {
              "attack_events": 35541,
              "country": "Turkey"
            },
            {
              "attack_events": 35541,
              "country": "Czechia"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 1299,
          "top_attacked_countries": [
            {
              "attack_events": 4594,
              "country": "Australia"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 15,
          "top_attacked_countries": [
            {
              "attack_events": 1414,
              "country": "indonesia"
            },
            {
              "attack_events": 94,
              "country": "ukraine"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 13,
          "top_attacked_countries": [
            {
              "attack_events": 1411,
              "country": "mexico"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 43,
          "top_attacked_countries": [
            {
              "attack_events": 531,
              "country": "Belgium"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 271,
          "top_attacked_countries": [
            {
              "attack_events": 407,
              "country": "Spain"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 121,
          "top_attacked_countries": [
            {
              "attack_events": 268,
              "country": "Malaysia"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 97,
          "top_attacked_countries": [
            {
              "attack_events": 167,
              "country": "Indonesia"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 35,
          "top_attacked_countries": [
            {
              "attack_events": 137,
              "country": "Korea, Republic of"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 12,
          "top_attacked_countries": [
            {
              "attack_events": 129,
              "country": "Italy"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 18,
          "top_attacked_countries": [
            {
              "attack_events": 127,
              "country": "Singapore"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 110,
          "top_attacked_countries": [
            {
              "attack_events": 115,
              "country": "Sweden"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 8,
          "top_attacked_countries": [
            {
              "attack_events": 110,
              "country": "China"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 6,
          "top_attacked_countries": [
            {
              "attack_events": 108,
              "country": "India"
            },
            {
              "attack_events": 108,
              "country": "Taiwan"
            },
            {
              "attack_events": 108,
              "country": "Thailand"
            },
            {
              "attack_events": 6,
              "country": "Kazajist\u00e1n"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 7,
          "top_attacked_countries": [
            {
              "attack_events": 70,
              "country": "Cayman Islands"
            },
            {
              "attack_events": 70,
              "country": "Georgia"
            },
            {
              "attack_events": 70,
              "country": "Saint Martin (French part)"
            },
            {
              "attack_events": 70,
              "country": "Tanzania, United Republic of"
            },
            {
              "attack_events": 70,
              "country": "Anguilla"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 36,
          "top_attacked_countries": [
            {
              "attack_events": 43,
              "country": "United States"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 17,
          "top_attacked_countries": [
            {
              "attack_events": 35,
              "country": "United Kingdom"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 9,
          "top_attacked_countries": [
            {
              "attack_events": 25,
              "country": "germany"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 4,
          "top_attacked_countries": [
            {
              "attack_events": 4,
              "country": "Bahrain"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 1,
          "top_attacked_countries": [
            {
              "attack_events": 3,
              "country": "Russian Federation"
            },
            {
              "attack_events": 1,
              "country": "Jersey"
            },
            {
              "attack_events": 1,
              "country": "Austria"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        },
        {
          "distinct_attacker_ips": 2,
          "top_attacked_countries": [
            {
              "attack_events": 2,
              "country": "Brazil"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "attack_events": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "attack_events": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "attack_events": 7586
            }
          ]
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 813,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 27,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 27 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Summarize attack activity originating from China by (a) counting how many unique attacker IPs are involved, (b) identifying which destination countries are most frequently attacked (top 5 by attack volume), and (c) determining the most common attack techniques used across all those China-origin attacks (top 3).\",\n  \"KEY_ENTITIES\": {\n    \"nodes\": [\n      \"IP (attacker; identified by IP.address; optionally enriched with botnet and pulse_ids)\",\n      \"Country (used both as the source country via FROM and as the attacked/target country via ATTACKS)\",\n      \"ASN (optional enrichment for attackers via BELONGS_TO, not required for requested metrics)\"\n    ],\n    \"relationships\": [\n      \"(:IP)-[:FROM]->(:Country) to determine attacker origin country (must be China)\",\n      \"(:IP)-[:ATTACKS]->(:Country) to represent each attack event from an IP to a target country; relationship properties include technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN) as optional context for attackers (not directly requested in outputs)\"\n    ],\n    \"fields_used\": [\n      \"Country.name (to match China and to label attacked countries)\",\n      \"IP.address (to count distinct attacking IPs)\",\n      \"ATTACKS.technique (to rank techniques)\",\n      \"ATTACKS properties generally define an attack 'event' for counting purposes (each relationship instance counts as one attack)\"\n    ]\n  },\n  \"FILTERS\": {\n    \"origin_country\": \"Include only attacker IPs where (:IP)-[:FROM]->(:Country {name: 'China'})\",\n    \"attack_scope\": \"Count only attacks represented by (:IP)-[:ATTACKS]->(:Country) relationships originating from those China-based IPs\",\n    \"time_window\": \"No time constraint provided; default to all available data unless a date range is later specified\",\n    \"data_quality_notes\": [\n      \"If there are multiple Country nodes representing China (e.g., naming variations), normalization may be needed; otherwise exact match on name 'China' is assumed\",\n      \"If ATTACKS.technique can be null/empty, decide whether to exclude unknown techniques from the top-3 ranking or group them under 'Unknown' (should be clarified if this matters)\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": {\n    \"structure\": \"Return one consolidated result containing: (1) total_distinct_attacking_ips (integer), (2) top_5_countries_attacked (ordered list), (3) top_3_attack_techniques (ordered list)\",\n    \"top_5_countries_attacked_item\": {\n      \"country\": \"Country.name of the attacked/target country\",\n      \"attack_count\": \"Number of ATTACKS relationship instances from China-origin IPs to that country\"\n    },\n    \"top_3_attack_techniques_item\": {\n      \"technique\": \"ATTACKS.technique value\",\n      \"attack_count\": \"Number of ATTACKS relationship instances from China-origin IPs where technique matches\"\n    },\n    \"ordering\": \"Rank lists by attack_count descending; use a stable tie-breaker if needed (e.g., alphabetical by name/technique)\",\n    \"notes\": \"All metrics are computed within the same China-origin subset of attacks\"\n  },\n  \"SUGGESTED_APPROACH\": \"First restrict the dataset to attacker IPs whose origin country is China via the FROM relationship. From that subset, traverse their ATTACKS relationships to target Country nodes and treat each ATTACKS relationship as one attack event. Compute three aggregations over this restricted set: (1) count distinct attacker IP.address values, (2) group by attacked Country.name and count attacks, then select the top 5, and (3) group by ATTACKS.technique and count attacks, then select the top 3. Combine these aggregates into a single consolidated output record.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For attacks launched by IPs whose origin country is China, compute the total number of distinct attacker IPs, the top 5 attacked countries by number of attack events, and the top 3 most common attack techniques overall, returning the results as a single consolidated report.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For attacks launched by IPs whose origin country is China, compute the total number of distinct attacker IPs, the top 5 attacked countries by number of attack events, and the top 3 most common attack techniques overall, returning the results as a single consolidated report."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH count(DISTINCT ip) AS distinct_attacker_ips, c.name AS attacked_country, count(*) AS attack_events\nORDER BY attack_events DESC\nWITH distinct_attacker_ips, collect({country: attacked_country, attack_events: attack_events})[0..5] AS top_attacked_countries\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWHERE a2.technique <> 'unknown'\nWITH distinct_attacker_ips, top_attacked_countries, a2.technique AS technique, count(*) AS technique_events\nORDER BY technique_events DESC\nWITH distinct_attacker_ips, top_attacked_countries, collect({technique: technique, attack_events: technique_events})[0..3] AS top_techniques\nRETURN distinct_attacker_ips, top_attacked_countries, top_techniques"
          ],
          "trace": [
            {
              "subproblem": "For attacks launched by IPs whose origin country is China, compute the total number of distinct attacker IPs, the top 5 attacked countries by number of attack events, and the top 3 most common attack techniques overall, returning the results as a single consolidated report.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH count(DISTINCT ip) AS distinct_attacker_ips, c.name AS attacked_country, count(*) AS attack_events\nORDER BY attack_events DESC\nWITH distinct_attacker_ips, collect({country: attacked_country, attack_events: attack_events})[0..5] AS top_attacked_countries\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWHERE a2.technique <> 'unknown'\nWITH distinct_attacker_ips, top_attacked_countries, a2.technique AS technique, count(*) AS technique_events\nORDER BY technique_events DESC\nWITH distinct_attacker_ips, top_attacked_countries, collect({technique: technique, attack_events: technique_events})[0..3] AS top_techniques\nRETURN distinct_attacker_ips, top_attacked_countries, top_techniques",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "distinct_attacker_ips": 786,
                      "top_attacked_countries": [
                        {
                          "attack_events": 43430,
                          "country": "Germany"
                        },
                        {
                          "attack_events": 35674,
                          "country": "United Kingdom of Great Britain and Northern Ireland"
                        }
                      ],
                      "top_techniques": [
                        {
                          "technique": "T1566 Phishing",
                          "attack_events": 533403
                        },
                        {
                          "technique": "T1110 Brute Force",
                          "attack_events": 8224
                        },
                        {
                          "technique": "T1595 Active Scanning",
                          "attack_events": 7586
                        }
                      ]
                    },
                    {
                      "distinct_attacker_ips": 1031,
                      "top_attacked_countries": [
                        {
                          "attack_events": 38573,
                          "country": "United States of America"
                        }
                      ],
                      "top_techniques": [
                        {
                          "technique": "T1566 Phishing",
                          "attack_events": 533403
                        },
                        {
                          "technique": "T1110 Brute Force",
                          "attack_events": 8224
                        },
                        {
                          "technique": "T1595 Active Scanning",
                          "attack_events": 7586
                        }
                      ]
                    },
                    {
                      "distinct_attacker_ips": 1018,
                      "top_attacked_countries": [
                        {
                          "attack_events": 36447,
                          "country": "France"
                        }
                      ],
                      "top_techniques": [
                        {
                          "technique": "T1566 Phishing",
                          "attack_events": 533403
                        },
                        {
                          "technique": "T1110 Brute Force",
                          "attack_events": 8224
                        },
                        {
                          "technique": "T1595 Active Scanning",
                          "attack_events": 7586
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH count(DISTINCT ip) AS distinct_attacker_ips, c.name AS attacked_country, count(*) AS attack_events\nORDER BY attack_events DESC\nWITH distinct_attacker_ips, collect({country: attacked_country, attack_events: attack_events})[0..5] AS top_attacked_countries\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWHERE a2.technique <> 'unknown'\nWITH distinct_attacker_ips, top_attacked_countries, a2.technique AS technique, count(*) AS technique_events\nORDER BY technique_events DESC\nWITH distinct_attacker_ips, top_attacked_countries, collect({technique: technique, attack_events: technique_events})[0..3] AS top_techniques\nRETURN distinct_attacker_ips, top_attacked_countries, top_techniques"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "distinct_attacker_ips": 786,
              "top_attacked_countries": [
                {
                  "attack_events": 43430,
                  "country": "Germany"
                },
                {
                  "attack_events": 35674,
                  "country": "United Kingdom of Great Britain and Northern Ireland"
                }
              ],
              "top_techniques": [
                {
                  "technique": "T1566 Phishing",
                  "attack_events": 533403
                },
                {
                  "technique": "T1110 Brute Force",
                  "attack_events": 8224
                },
                {
                  "technique": "T1595 Active Scanning",
                  "attack_events": 7586
                }
              ]
            },
            {
              "distinct_attacker_ips": 1031,
              "top_attacked_countries": [
                {
                  "attack_events": 38573,
                  "country": "United States of America"
                }
              ],
              "top_techniques": [
                {
                  "technique": "T1566 Phishing",
                  "attack_events": 533403
                },
                {
                  "technique": "T1110 Brute Force",
                  "attack_events": 8224
                },
                {
                  "technique": "T1595 Active Scanning",
                  "attack_events": 7586
                }
              ]
            },
            {
              "distinct_attacker_ips": 1018,
              "top_attacked_countries": [
                {
                  "attack_events": 36447,
                  "country": "France"
                }
              ],
              "top_techniques": [
                {
                  "technique": "T1566 Phishing",
                  "attack_events": 533403
                },
                {
                  "technique": "T1110 Brute Force",
                  "attack_events": 8224
                },
                {
                  "technique": "T1595 Active Scanning",
                  "attack_events": 7586
                }
              ]
            }
          ]
        },
        "explanation": {
          "text": "It counts how many distinct IPs originating from China are attackers, returns the top 5 countries they most frequently attack, and lists the top 3 non\u2011`unknown` attack techniques used (by total ATTACKS events)."
        }
      },
      "token_usage": {
        "input": 1793,
        "output": 2130,
        "total": 3923
      },
      "duration_seconds": 62.098,
      "started_at": "2026-02-20T03:36:11.120069+00:00",
      "ended_at": "2026-02-20T03:37:13.218306+00:00",
      "metadata": {
        "time": "2026-02-20T03:37:13.203657+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 5,
      "category": "multi-subquery",
      "prompt": "For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.",
      "expected_cypher": "CALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  RETURN count(DISTINCT ip) AS distinctIPs\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[:ATTACKS]->(:Country)\n  RETURN count(*) AS totalAttacks\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[a:ATTACKS]->(:Country)\n  WITH a.industry AS industry, count(*) AS attacks\n  ORDER BY attacks DESC\n  LIMIT 5\n  RETURN collect({industry: industry, attacks: attacks}) AS topIndustries\n}\nRETURN distinctIPs, totalAttacks, topIndustries",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH collect(DISTINCT ip) AS ips, collect(a) AS attacks\nWITH size(ips) AS distinct_ips, size(attacks) AS total_attacks, attacks\nUNWIND attacks AS a\nWITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries\nRETURN distinct_ips, total_attacks, top_industries",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 537,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Summarize malicious activity attributed to IP addresses originating from Russia by reporting (a) how many unique Russian IPs are observed, (b) how many total attack events they generated, and (c) which industries are most frequently targeted (top 5).\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\",\n      \"(:ASN {number})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:FROM]->(country:Country)\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(targetCountry:Country)\",\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)\"\n    ],\n    \"NOTES\": \"The core of the question relies on the IP\u2019s origin country via :FROM and the attack records stored on :ATTACKS (particularly the 'industry' property). :BELONGS_TO/:ASN is present in the schema but not required unless additional breakdowns are desired.\"\n  },\n  \"FILTERS\": {\n    \"ORIGIN_COUNTRY\": \"Select only IP nodes where (ip)-[:FROM]->(:Country {name = 'Russia'}) (or equivalent canonical name such as 'Russian Federation' if that is how it is stored).\",\n    \"ATTACK_SCOPE\": \"Count only :ATTACKS relationships originating from those Russian IPs (each relationship instance represents one attack event/record).\",\n    \"INDUSTRY_HANDLING\": \"For the top-5 industry list, decide whether to exclude missing/blank industry values or group them under an 'Unknown' bucket; also consider normalizing case/whitespace if industries are inconsistently formatted.\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"SHAPE\": \"One aggregated result containing overall counts plus a ranked list for industries.\",\n    \"FIELDS\": [\n      \"distinct_ip_count (integer)\",\n      \"total_attack_count (integer)\",\n      \"top_industries (array of up to 5 objects, each with: industry (string) and attack_count (integer))\"\n    ],\n    \"ORDERING\": \"top_industries sorted by attack_count descending (tie-breaker optional, e.g., alphabetical industry name).\"\n  },\n  \"SUGGESTED_APPROACH\": \"Identify IPs whose :FROM country is Russia, then traverse their outgoing :ATTACKS relationships. Compute (1) distinct count of IP addresses, and (2) total number of :ATTACKS relationships. In the same pass (or via an internal sub-aggregation), group attack relationships by the 'industry' property, count occurrences, sort descending, and keep only the top 5 industries. Return a single consolidated output combining the overall metrics with the top-5 industry breakdown.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For IPs whose origin country is Russia, return the number of distinct IPs, the total number of attack records they generated, and the top 5 targeted industries ranked by attack count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For IPs whose origin country is Russia, return the number of distinct IPs, the total number of attack records they generated, and the top 5 targeted industries ranked by attack count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH collect(DISTINCT ip) AS ips, collect(a) AS attacks\nWITH size(ips) AS distinct_ips, size(attacks) AS total_attacks, attacks\nUNWIND attacks AS a\nWITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries\nRETURN distinct_ips, total_attacks, top_industries"
          ],
          "trace": [
            {
              "subproblem": "For IPs whose origin country is Russia, return the number of distinct IPs, the total number of attack records they generated, and the top 5 targeted industries ranked by attack count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH collect(DISTINCT ip) AS ips, collect(a) AS attacks\nWITH size(ips) AS distinct_ips, size(attacks) AS total_attacks, attacks\nUNWIND attacks AS a\nWITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries\nRETURN distinct_ips, total_attacks, top_industries",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH collect(DISTINCT ip) AS ips, collect(a) AS attacks\nWITH size(ips) AS distinct_ips, size(attacks) AS total_attacks, attacks\nUNWIND attacks AS a\nWITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nWITH distinct_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries\nRETURN distinct_ips, total_attacks, top_industries"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "This query finds IPs originating from Russia, counts the number of distinct Russian-source IPs and total ATTACKS they launched, then returns the top 5 targeted industries by attack volume."
        }
      },
      "token_usage": {
        "input": 1613,
        "output": 1651,
        "total": 3264
      },
      "duration_seconds": 27.882,
      "started_at": "2026-02-20T03:37:13.219641+00:00",
      "ended_at": "2026-02-20T03:37:41.101563+00:00",
      "metadata": {
        "time": "2026-02-20T03:37:41.090032+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 6,
      "category": "aggregation",
      "prompt": "Which ASN has attacked the most distinct countries?",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[:ATTACKS]->(c:Country)\nWITH asn.number AS asn, count(DISTINCT c.name) AS countries\nORDER BY countries DESC\nLIMIT 1\nRETURN asn, countries",
      "agent_cypher": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, count(DISTINCT c) AS attacked_country_count\nWITH max(attacked_country_count) AS maxCount\nMATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, maxCount, count(DISTINCT c) AS attacked_country_count\nWHERE attacked_country_count = maxCount\nRETURN asn.number AS asn_number, attacked_country_count\nORDER BY asn_number",
      "response": [
        {
          "asn_number": "AS57523 chang way technologies co. limited",
          "attacked_country_count": 64
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 404,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which Autonomous System Number (ASN) is associated with attack activity targeting the broadest geographic range, measured by the number of distinct victim countries attacked by IPs belonging to that ASN.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:ASN {number})\",\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\"\n    ],\n    \"NOTES\": \"The (ip)-[:FROM]->(country) relationship represents the origin country of the IP and is not required to answer \u2018which ASN has attacked the most distinct countries\u2019, unless the user later clarifies they want to exclude attacks against the IP\u2019s own origin country or perform origin-based analysis.\"\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [\n      \"Only consider countries that are targets of :ATTACKS relationships (victim/target countries).\",\n      \"Only consider ASNs connected via (ip)-[:BELONGS_TO]->(asn).\"\n    ],\n    \"DISTINCTNESS_RULES\": [\n      \"Count distinct attacked countries per ASN (deduplicate multiple attacks from the same ASN to the same country, even if performed by multiple IPs, techniques, pulse_ids, or different timestamps).\"\n    ],\n    \"OPTIONAL_OR_UNSPECIFIED\": [\n      \"No timeframe filter is provided; include all :ATTACKS relationships unless later constrained by documented_create_date / documented_modified_date.\",\n      \"No filtering by technique/protocol/technology/industry/botnet/pulse_id is requested.\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": {\n    \"PRIMARY_RESULT\": \"Return the ASN (asn.number) with the highest count of distinct attacked countries, along with that distinct country count.\",\n    \"TIES\": \"If multiple ASNs tie for the maximum, return all tied ASNs (or return a ranked list and clearly indicate ties).\",\n    \"OPTIONAL_ADDITIONS\": [\n      \"Include a list of the attacked country names for the top ASN(s) if the user wants supporting detail.\"\n    ]\n  },\n  \"SUGGESTED_APPROACH\": \"Traverse from ASN to its IPs via BELONGS_TO, then from those IPs to attacked Countries via ATTACKS. For each ASN, compute the number of unique Country nodes reached through ATTACKS. Rank ASNs by this unique-country count in descending order and return the top result(s), handling ties if needed.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the ASN whose associated IPs have ATTACKS relationships to the greatest number of distinct Country nodes, and return the ASN number and that distinct attacked-country count (including all ties for first if applicable).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the ASN whose associated IPs have ATTACKS relationships to the greatest number of distinct Country nodes, and return the ASN number and that distinct attacked-country count (including all ties for first if applicable)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, count(DISTINCT c) AS attacked_country_count\nWITH max(attacked_country_count) AS maxCount\nMATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, maxCount, count(DISTINCT c) AS attacked_country_count\nWHERE attacked_country_count = maxCount\nRETURN asn.number AS asn_number, attacked_country_count\nORDER BY asn_number"
          ],
          "trace": [
            {
              "subproblem": "Find the ASN whose associated IPs have ATTACKS relationships to the greatest number of distinct Country nodes, and return the ASN number and that distinct attacked-country count (including all ties for first if applicable).",
              "attempts": [
                {
                  "fragment": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, count(DISTINCT c) AS attacked_country_count\nWITH max(attacked_country_count) AS maxCount\nMATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, maxCount, count(DISTINCT c) AS attacked_country_count\nWHERE attacked_country_count = maxCount\nRETURN asn.number AS asn_number, attacked_country_count\nORDER BY asn_number",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn_number": "AS57523 chang way technologies co. limited",
                      "attacked_country_count": 64
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, count(DISTINCT c) AS attacked_country_count\nWITH max(attacked_country_count) AS maxCount\nMATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)\nWITH asn, maxCount, count(DISTINCT c) AS attacked_country_count\nWHERE attacked_country_count = maxCount\nRETURN asn.number AS asn_number, attacked_country_count\nORDER BY asn_number"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn_number": "AS57523 chang way technologies co. limited",
              "attacked_country_count": 64
            }
          ]
        },
        "explanation": {
          "text": "This query finds the ASN(s) whose associated IPs have attacked the largest number of distinct countries, and returns those ASN numbers along with that maximum distinct-country count."
        }
      },
      "token_usage": {
        "input": 1562,
        "output": 1099,
        "total": 2661
      },
      "duration_seconds": 20.942,
      "started_at": "2026-02-20T03:37:41.102158+00:00",
      "ended_at": "2026-02-20T03:38:02.044053+00:00",
      "metadata": {
        "time": "2026-02-20T03:38:02.031995+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 7,
      "category": "graph-structure",
      "prompt": "Find IPs that attacked more than 10 distinct countries.",
      "expected_cypher": "MATCH (ip:IP)-[:ATTACKS]->(c:Country)\nWITH ip.address AS ip, count(DISTINCT c.name) AS countries\nWHERE countries > 10\nRETURN ip, countries\nORDER BY countries DESC",
      "agent_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[r:ATTACKS]->(c:Country {name: 'France'})\nWHERE r.protocol <> 'unknown'\nWITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count\nORDER BY asn_number, attack_count DESC, protocol\nWITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols\nUNWIND top_protocols AS p\nRETURN asn_number, p.protocol AS protocol, p.attack_count AS attack_count\nORDER BY asn_number, attack_count DESC, protocol",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1598,
        "output": 826,
        "total": 2424
      },
      "duration_seconds": 400.094,
      "started_at": "2026-02-20T03:38:02.044619+00:00",
      "ended_at": "2026-02-20T03:44:42.138547+00:00",
      "metadata": {
        "time": "2026-02-20T03:42:46.685692+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 8,
      "category": "matcher-needed",
      "prompt": "Top 5 target countries attacked by IPs from United States using protocol ssh.",
      "expected_cypher": "MATCH (ip:IP)-[:FROM]->(src:Country {name:'United States of America'})\nMATCH (ip)-[a:ATTACKS {protocol:'RDP'}]->(tgt:Country)\nWITH tgt.name AS country, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 5\nRETURN country, attacks",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})\nMATCH (ip)-[r:ATTACKS {protocol: 'ssh'}]->(tgt:Country)\nWITH tgt.name AS target_country, count(*) AS attack_count\nRETURN target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 245,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which destination (target) countries are most frequently attacked when the attacking source IPs originate from the United States and the recorded attack protocol is SSH, returning the top five targets by attack volume.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"IP (source attacker IPs)\",\n      \"Country (both the source country and the target country)\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:FROM]->(:Country) to determine the origin country of the IP (must be United States)\",\n      \"(:IP)-[:ATTACKS]->(:Country) to represent an attack from a source IP to a target country, including protocol and other metadata\"\n    ],\n    \"RELATIONSHIP_PROPERTIES_USED\": [\n      \"ATTACKS.protocol\",\n      \"ATTACKS.documented_create_date (optional, if time scoping is later needed)\",\n      \"ATTACKS.pulse_id (optional, for deduplication or attribution if needed)\"\n    ],\n    \"OPTIONAL_CONTEXT\": [\n      \"(:IP)-[:BELONGS_TO]->(:ASN) could be added later if the user wants breakdowns by network/ASN, but it is not required for the stated question\"\n    ]\n  },\n  \"FILTERS\": {\n    \"SOURCE_COUNTRY\": \"United States (match the Country node connected via (:IP)-[:FROM]->(:Country))\",\n    \"ATTACK_PROTOCOL\": \"ssh (match ATTACKS.protocol; consider normalizing case if the dataset varies, e.g., 'SSH' vs 'ssh')\",\n    \"TARGET_COUNTRY\": \"Any (the Country node at the end of (:IP)-[:ATTACKS]->(:Country))\",\n    \"TIME_RANGE\": \"Not specified; include all available records unless a date filter is later provided\",\n    \"COUNTING_RULE\": \"Default to counting ATTACKS relationships (attack events). If the user instead wants unique attacking IPs per target country, that would be a different aggregation and should be confirmed if ambiguous.\"\n  },\n  \"OUTPUT_FORMAT\": \"A ranked list of 5 records, each containing: target_country_name and attack_count (number of SSH ATTACKS events from US-origin IPs). Optionally include rank (1\u20135). Sort by attack_count descending; use a deterministic tie-breaker such as target_country_name ascending.\",\n  \"SUGGESTED_APPROACH\": \"Select IP nodes whose origin country (via FROM) is United States; from those IPs, follow ATTACKS relationships to target Country nodes while filtering ATTACKS.protocol to ssh; aggregate by target country and compute the total number of matching attack events per country; sort descending by this count and return the top 5 target countries with their counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Return the top 5 target countries by number of ATTACKS events where the source IP is FROM the United States and the ATTACKS.protocol is 'ssh', including each target country name and the corresponding attack count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Return the top 5 target countries by number of ATTACKS events where the source IP is FROM the United States and the ATTACKS.protocol is 'ssh', including each target country name and the corresponding attack count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})\nMATCH (ip)-[r:ATTACKS {protocol: 'ssh'}]->(tgt:Country)\nWITH tgt.name AS target_country, count(*) AS attack_count\nRETURN target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
          ],
          "trace": [
            {
              "subproblem": "Return the top 5 target countries by number of ATTACKS events where the source IP is FROM the United States and the ATTACKS.protocol is 'ssh', including each target country name and the corresponding attack count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})\nMATCH (ip)-[r:ATTACKS {protocol: 'ssh'}]->(tgt:Country)\nWITH tgt.name AS target_country, count(*) AS attack_count\nRETURN target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "protocol",
                      "original": "ssh",
                      "value": "ssh"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})\nMATCH (ip)-[r:ATTACKS {protocol: 'ssh'}]->(tgt:Country)\nWITH tgt.name AS target_country, count(*) AS attack_count\nRETURN target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "It finds IPs originating from the United States and counts how many SSH (`protocol: 'ssh'`) `ATTACKS` they launched against each target country, returning the top 5 target countries by attack count."
        }
      },
      "token_usage": {
        "input": 1464,
        "output": 896,
        "total": 2360
      },
      "duration_seconds": 23.733,
      "started_at": "2026-02-20T03:44:42.139609+00:00",
      "ended_at": "2026-02-20T03:45:05.872897+00:00",
      "metadata": {
        "time": "2026-02-20T03:45:05.859874+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 9,
      "category": "temporal",
      "prompt": "Monthly attack counts per technique (grouped by YYYY-MM).",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH substring(toString(a.documented_create_date[0]),0,7) AS year_month, a.technique AS technique, count(*) AS attacks\nRETURN year_month, technique, attacks\nORDER BY year_month DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWITH date.truncate('month', a.documented_create_date) AS year_month, a.technique AS technique, count(*) AS attack_count\nRETURN year_month, technique, attack_count\nORDER BY year_month ASC, technique ASC",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1436,
        "output": 821,
        "total": 2257
      },
      "duration_seconds": 400.076,
      "started_at": "2026-02-20T03:45:05.873669+00:00",
      "ended_at": "2026-02-20T03:51:45.949803+00:00",
      "metadata": {
        "time": "2026-02-20T03:51:36.112485+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 10,
      "category": "discovery",
      "prompt": "List distinct technologies observed in attacks against the Finance industry, with counts.",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWHERE a.industry = 'Finance'\nWITH a.technology AS technology, count(*) AS attacks\nORDER BY attacks DESC\nRETURN technology, attacks",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC",
      "response": [
        {
          "technology": "unknown",
          "attack_count": 5624
        },
        {
          "technology": "windows",
          "attack_count": 30
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 252,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 2,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 2 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which distinct attack technologies have been observed targeting the Finance industry and quantify how frequently each technology appears in the recorded attack observations.\",\n  \"KEY_ENTITIES\": \"Primary focus is the (ip:IP)-[:ATTACKS]->(country:Country) relationship, specifically its properties: industry (to scope to Finance) and technology (to group by). The :IP and :Country nodes are only needed to traverse the ATTACKS relationships; :ASN and the :FROM/:BELONGS_TO relationships are not required for this question unless additional attribution context is later desired.\",\n  \"FILTERS\": \"Include only ATTACKS relationships where industry equals \\\"Finance\\\" (exact match unless otherwise specified). Exclude records where technology is missing, null, or an empty/placeholder value if present in the data. No date constraints are specified; all available observations are included.\",\n  \"OUTPUT_FORMAT\": \"Return a table/list of results with one row per distinct technology value and a corresponding count. Each row should include: technology and count. Typically sort by count descending, then technology ascending for stable ordering.\",\n  \"SUGGESTED_APPROACH\": \"Traverse ATTACKS relationships, filter to those whose industry indicates Finance, then group the remaining relationships by the technology property and compute the number of matching ATTACKS observations per technology. Optionally apply data hygiene rules for blank/unknown technology values and order the aggregated results for readability.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For all ATTACKS observations targeting the Finance industry, group by the ATTACKS.technology value and return each distinct technology with the count of matching ATTACKS records (excluding null/empty technologies), ordered by count descending.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For all ATTACKS observations targeting the Finance industry, group by the ATTACKS.technology value and return each distinct technology with the count of matching ATTACKS records (excluding null/empty technologies), ordered by count descending."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC"
          ],
          "trace": [
            {
              "subproblem": "For all ATTACKS observations targeting the Finance industry, group by the ATTACKS.technology value and return each distinct technology with the count of matching ATTACKS records (excluding null/empty technologies), ordered by count descending.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "industry",
                      "original": "'Finance'",
                      "value": "Finance"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technology": "unknown",
                      "attack_count": 5624
                    },
                    {
                      "technology": "windows",
                      "attack_count": 30
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_count\nRETURN technology, attack_count\nORDER BY attack_count DESC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technology": "unknown",
              "attack_count": 5624
            },
            {
              "technology": "windows",
              "attack_count": 30
            }
          ]
        },
        "explanation": {
          "text": "It counts and ranks how many `ATTACKS` relationships involve the Finance industry for each non-empty `technology` value, returning the technologies ordered by attack frequency (highest first)."
        }
      },
      "token_usage": {
        "input": 1456,
        "output": 744,
        "total": 2200
      },
      "duration_seconds": 346.171,
      "started_at": "2026-02-20T03:51:45.955572+00:00",
      "ended_at": "2026-02-20T03:57:32.126870+00:00",
      "metadata": {
        "time": "2026-02-20T03:57:32.114651+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 11,
      "category": "multi-hop",
      "prompt": "For each ASN, top 3 protocols it used when attacking France.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name:'France'})\nWITH asn.number AS asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn, cnt DESC\nWITH asn, collect({protocol: protocol, cnt: cnt}) AS items\nUNWIND items[0..3] AS top\nRETURN asn, top.protocol AS protocol, top.cnt AS attacks\nORDER BY asn, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(fr:Country {name: 'France'})\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWHERE r.protocol <> 'unknown'\nWITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count\nORDER BY asn_number, attack_count DESC\nWITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols\nUNWIND range(0, size(top_protocols) - 1) AS idx\nWITH asn_number, idx + 1 AS rank, top_protocols[idx] AS p\nRETURN asn_number, rank, p.protocol AS protocol, p.attack_count AS attack_count\nORDER BY asn_number, rank",
      "response": [
        {
          "asn_number": "AS10103 hk broadband network ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS10220 pt. kreasi sejahtera teknologi",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS10439 carinet  inc.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 4
        },
        {
          "asn_number": "AS10439 carinet  inc.",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS11419 telefnica brasil s.a",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS11427 charter communications inc",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS11888 television internacional  s.a. de c.v.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS12252 america movil peru s.a.c.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS12353 vodafone portugal - communicacoes pessoais s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS12389 pjsc rostelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS12479 orange espagne sa",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS12695 llc digital network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS12768 jsc er-telecom holding",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS12874 fastweb spa",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS12876 online s.a.s.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS12876 online s.a.s.",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 3
        },
        {
          "asn_number": "AS131090 cat telecom public company ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS131314 china broadband communications (hong kong) company limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS131353 nhanhoa software company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS131423 branch of long van system solution jsc - hanoi",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS132203 tencent building  kejizhongyi avenue",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 312
        },
        {
          "asn_number": "AS132203 tencent building  kejizhongyi avenue",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS132787 helios it infrasolutions pvt",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS13285 talktalk communications",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS133296 web werks india pvt. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS133334 dctv cable network broadband services inc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 9
        },
        {
          "asn_number": "AS13335 cloudflare",
          "rank": 1,
          "protocol": "tcp",
          "attack_count": 112
        },
        {
          "asn_number": "AS13335 cloudflare",
          "rank": 2,
          "protocol": "http",
          "attack_count": 112
        },
        {
          "asn_number": "AS13335 cloudflare",
          "rank": 3,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS133398 tele asia limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS133774 fuzhou",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 9
        },
        {
          "asn_number": "AS134026 ultranet services private limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134238 chinanet jiangxi province idc network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS134337 r2 net solutions pvt ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134366 cloud computing hk limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134761 chinanet ningxia province zhongwei idc network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS134763 chinanet guangdong province network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS134765 chinanet yunnan province idc1 network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134768 chinanet shaanxi province cloud base network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS134771 wenzhou  zhejiang province  p.r.china.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS13490 buckeye cablevision  inc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134945 blue sky broadband pvt. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS134963 alibaba.com singapore e-commerce private limited",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 2
        },
        {
          "asn_number": "AS135182 moradabad internet services private limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS135310 inspire broadband",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS135377 ucloud information technology (hk) limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 13
        },
        {
          "asn_number": "AS135377 ucloud information technology (hk) limited",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 7
        },
        {
          "asn_number": "AS135377 ucloud information technology (hk) limited",
          "rank": 3,
          "protocol": "sip",
          "attack_count": 7
        },
        {
          "asn_number": "AS135524 university of dhaka",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS135777 shreenortheast connect and services pvt ltd",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS135905 vietnam posts and telecommunications group",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS135932 viet storage technology joint stock company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS135953 vietnam online network solution joint stock compnay",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS136052 pt cloud hosting indonesia",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS136170 pt. exabytes network indonesia",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS13650 axia fibrenet ltd.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 11
        },
        {
          "asn_number": "AS13650 axia fibrenet ltd.",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS136827 universitas pgri semarang",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS136958 china unicom guangdong ip network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS136970 yisu cloud ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137280 kingsoft cloud corporation limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137318 diskominfo kabupaten pati",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS137361 diskominfo kab. magelang",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137687 luoyang  henan province  p.r.china.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137697 chinatelecom jiangsu yangzhou idc networkdescr",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS137699 chinatelecom jiangsu suqian idc network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137702 nanjing  jiangsu province  p.r.china.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS137718 beijing volcano engine technology co.  ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS137823 cloudone",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS138421 china unicom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS138950 jiangsu wuxi international idc network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS139190 google asia pacific pte. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS139201 jiangxi jiujiang idc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS139282 novus network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS139473 shebatel network ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS13999 mega cable  s.a. de c.v.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS140061 qinghai telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS140469 pt wahyu adidaya network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS14051 consolidated communications",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS14061 digitalocean  llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 207
        },
        {
          "asn_number": "AS14061 digitalocean  llc",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS14080 telmex colombia s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS142403 yisu cloud ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS142608 china telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS14618 amazon.com  inc.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 3
        },
        {
          "asn_number": "AS147161 universitas muhammadiyah gresik",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS14987 rethem hosting llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 3
        },
        {
          "asn_number": "AS14988 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS15169 google llc",
          "rank": 1,
          "protocol": "http",
          "attack_count": 36
        },
        {
          "asn_number": "AS15169 google llc",
          "rank": 2,
          "protocol": "tcp",
          "attack_count": 36
        },
        {
          "asn_number": "AS15169 google llc",
          "rank": 3,
          "protocol": "ssh",
          "attack_count": 10
        },
        {
          "asn_number": "AS15290 allstream corp.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS15311 telefonica empresas",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS15475 nile online",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS15582 ojsc comcor",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS15704 xtra telecom s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS15713 llc global-city-net",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS15895 kyivstar pjsc",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS15924 vodafone net iletisim hizmetleri anonim sirketi",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS16223 lanet network ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS16276 ovh sas",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 33
        },
        {
          "asn_number": "AS16276 ovh sas",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 10
        },
        {
          "asn_number": "AS16276 ovh sas",
          "rank": 3,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS16735 algar telecom s/a",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS16814 nss s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17222 mundivox do brasil ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS174 cogent communications",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS17501 worldlink communications pvt ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17557 pakistan telecommunication company limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17577 lg hellovision corp.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS17621 china unicom shanghai network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS17623 china unicom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17638 china telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17676 softbank bb corp.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS17676 softbank bb corp.",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS17858 lg powercomm",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS17882 univision llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS17993 vodafone samoa limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS18049 taiwan infrastructure network technologie",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS18207 you broadband & cable india ltd.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS18229 ctrls datacenters",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS18403 fpt telecom company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS18881 telefnica brasil s.a",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS19318 interserver  inc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 4
        },
        {
          "asn_number": "AS19429 etb - colombia",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS19527 google llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS197068 hll llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 7
        },
        {
          "asn_number": "AS197119 krena - kyrgyz research and education network association",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS200350 yandex.cloud llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS20115 charter communications",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS20115 charter communications",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS201746 olivenet network s.l.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS202425 ip volume inc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 15
        },
        {
          "asn_number": "AS202425 ip volume inc",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS202660 uzbektelekom joint stock company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS203247 islamic azad university",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS207423 steil-south ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS209605 uab host baltic",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 21
        },
        {
          "asn_number": "AS210644 ",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS210950 tov e-rishennya",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS211252 delis llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 2
        },
        {
          "asn_number": "AS211279 alianta-tv s.r.l.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS211298 constantine cybersecurity ltd.",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 11
        },
        {
          "asn_number": "AS211298 constantine cybersecurity ltd.",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 6
        },
        {
          "asn_number": "AS211680 nsec - sistemas informaticos  s.a.",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 2
        },
        {
          "asn_number": "AS211680 nsec - sistemas informaticos  s.a.",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 2
        },
        {
          "asn_number": "AS21491 uganda telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS21501 host europe gmbh",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS21574 century telecom ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS21859 zenlayer inc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 8
        },
        {
          "asn_number": "AS22773 cox communications inc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS22884 total play telecomunicaciones sa de cv",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS23201 telecel s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS23647 communications & communicate nepal pvt ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS23650 chinanet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS23678 mykris asia  managed network and service provider",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS23700 linknet fastnet asn",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS23724 idc china telecommunications corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS23969 tot public company limited",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS23969 tot public company limited",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS24186 railtel corporation of india ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS24309 atria convergence technologies",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS24400 shanghai mobile communications co. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS24514 malaysian research & education network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS24532 inet global indo",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS24560 bharti airtel ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS24757 ethionet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS24955 ojsc ufanet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS25003 internet binat ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS25106 mobile telesystems jllc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS2518 biglobe inc.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS25184 afranet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS2519 arteria networks corporation",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS25250 gamtel",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS2527 sony network communications inc.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 4
        },
        {
          "asn_number": "AS25408 jsc er-telecom holding",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS25490 pjsc rostelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS25514 modus-global llc",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS25820 it7 networks inc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS26210 axs bolivia s a",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS262793 douracom servicos de comunicacao ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS262805 rede minas telecom ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS263998 sim telecom",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS264411 costa do sol tv a cabo",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS26496 godaddy.com  llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS267251 telefonarnet telecomunicacoes",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS267285 ANDRE PEREIRA DA COSTA EIRELI ME",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS267506 netlux telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS268622 oliveira telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS268888 acrf servicos de informatica ltda - me",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS27651 entel chile s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 10
        },
        {
          "asn_number": "AS27653 alpha communications network",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS27665 columbus communications trinidad limited.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS27699 telefnica brasil s.a",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS27843 optical technologies s.a.c.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS27882 telefnica celular de bolivia s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS27988 servicios y telecomunicaciones s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS28308 orion telecomunicaes comercio e servios ltda",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS2856 british telecommunications plc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS28573 claro s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS28624 provedora cma internet ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS28649 desktop sigmanet comunicao multimdia sa",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS28665 predlink rede de telecomunices ltda",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS29518 bredband2 ab",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS29580 a1 bulgaria ead",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS29789 reflected networks  inc.",
          "rank": 1,
          "protocol": "http",
          "attack_count": 150
        },
        {
          "asn_number": "AS29789 reflected networks  inc.",
          "rank": 2,
          "protocol": "tcp",
          "attack_count": 42
        },
        {
          "asn_number": "AS29791 internap holding llc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 5
        },
        {
          "asn_number": "AS30722 vodafone italia s.p.a.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS30844 liquid telecommunications ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS31200 novotelecom ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS31898 oracle corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS32 stanford university",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS3215 orange s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS3216 pjsc vimpelcom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS3243 meo servicos de comunicacoes e multimedia sa",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 6
        },
        {
          "asn_number": "AS32475 singlehop llc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 10
        },
        {
          "asn_number": "AS327724 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS327764 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS327934 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS3320 deutsche telekom ag",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS3356 level 3 parent  llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS34088 host europe gmbh",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS3462 data communication business group",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 17
        },
        {
          "asn_number": "AS34918 pishgaman toseeh ertebatat company (private joint stock)",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS34974 pjsc rostelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS34984 tellcom iletisim hizmetleri a.s.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS35366 isppro internet kg",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS35478 bunea telecom srl",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS35913 dedipath",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS36352 colocrossing",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 12
        },
        {
          "asn_number": "AS36791 portland internet hosting llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 7
        },
        {
          "asn_number": "AS36791 portland internet hosting llc",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS36866 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS36946 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS37061 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS37353 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS37385 african network information center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS3786 lg dacom corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 17
        },
        {
          "asn_number": "AS37963 hangzhou alibaba advertising co. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS3816 colombia telecomunicaciones s.a. esp",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS38283 chinanet sichuan telecom internet data center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS38283 chinanet sichuan telecom internet data center",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS38365 beijing baidu netcom science and technology co.  ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 25
        },
        {
          "asn_number": "AS38457 honesty net solution",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS38482 biznet isp",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS38623 viettel",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS38700 smileserv",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS38731 vietel - cht company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS394695 pdr",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS39493 cjsc kolomna-sviaz tv",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS396356 maxihost llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS396507 emerald onion",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS39651 com hem ab",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS396982 google",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 46
        },
        {
          "asn_number": "AS396982 google",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 20
        },
        {
          "asn_number": "AS396982 google",
          "rank": 3,
          "protocol": "sip",
          "attack_count": 4
        },
        {
          "asn_number": "AS398101 godaddy.com  llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS398108 godaddy.com  llc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 7
        },
        {
          "asn_number": "AS39811 mts pjsc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS39812 closed joint stock company radiotelephone",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS398324 censys  inc.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 6
        },
        {
          "asn_number": "AS398324 censys  inc.",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 5
        },
        {
          "asn_number": "AS39927 e-light-telecom ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS399804 hostodo",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS4134 chinanet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 237
        },
        {
          "asn_number": "AS4134 chinanet",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 9
        },
        {
          "asn_number": "AS4134 chinanet",
          "rank": 3,
          "protocol": "telnet",
          "attack_count": 8
        },
        {
          "asn_number": "AS41668 jsc er-telecom holding",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS42237 amati foundation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS42313 albtelecom sh.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS42610 pjsc rostelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS42667 artur sienkiewicz",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS42708 glesys ab",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS43162 olimp llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS44327 delta comm llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS45061 shanghai information network co. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS45090 shenzhen tencent computer systems company limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 192
        },
        {
          "asn_number": "AS45090 shenzhen tencent computer systems company limited",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 4
        },
        {
          "asn_number": "AS45102 alibaba (us) technology co.  ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS4538 china education and research network center",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS45557 vietnam technology and telecommunication jsc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS45820 tata teleservices",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS45899 vnpt corp",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 21
        },
        {
          "asn_number": "AS45903 cmc telecom infrastructure company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS4609 companhia de telecomunicacoes de macau sarl",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS4621 uninet-th",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS46606 unified layer",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS47331 ttnet a.s.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS47433 sibirskie seti ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS4750 cs loxinfo public company limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS4755 tata communications",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS4760 hkt limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 10
        },
        {
          "asn_number": "AS4766 korea telecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 40
        },
        {
          "asn_number": "AS4766 korea telecom",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS4780 digital united inc.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS4788 tm net  internet service provider",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS48004 pe tsibrankov konstantin igorevich",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS4808 china unicom beijing province network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS48090 pptechnology limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS48090 pptechnology limited",
          "rank": 2,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS4812 china telecom (group)",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 13
        },
        {
          "asn_number": "AS4816 china telecom (group)",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS4835 china telecom (group)",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS4837 china unicom china169 backbone",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 37
        },
        {
          "asn_number": "AS4847 china networks inter-exchange",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS49392 llc baxet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 8
        },
        {
          "asn_number": "AS49403 avk-wellcom ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS49424 new line solutions llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS49434 harmony hosting sarl",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS49505 ooo network of data-centers selectel",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS49870 alsycon b.v.",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS50215 master llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS51167 contabo gmbh",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS51559 netinternet bilisim teknolojileri as",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS51604 jsc er-telecom holding",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS51604 jsc er-telecom holding",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS51852 private layer inc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 9
        },
        {
          "asn_number": "AS52312 tv music house jujuy",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS53334 total uptime technologies  llc",
          "rank": 1,
          "protocol": "tcp",
          "attack_count": 112
        },
        {
          "asn_number": "AS53334 total uptime technologies  llc",
          "rank": 2,
          "protocol": "http",
          "attack_count": 112
        },
        {
          "asn_number": "AS53667 frantech solutions",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS53831 squarespace  inc.",
          "rank": 1,
          "protocol": "tcp",
          "attack_count": 396
        },
        {
          "asn_number": "AS53831 squarespace  inc.",
          "rank": 2,
          "protocol": "http",
          "attack_count": 396
        },
        {
          "asn_number": "AS54113 fastly",
          "rank": 1,
          "protocol": "http",
          "attack_count": 112
        },
        {
          "asn_number": "AS54113 fastly",
          "rank": 2,
          "protocol": "tcp",
          "attack_count": 112
        },
        {
          "asn_number": "AS5483 magyar telekom plc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS55577 atria convergence technologies pvt ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS55720 gigabit hosting sdn bhd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS56040 china mobile communications corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS56044 china mobile communications corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS56046 china mobile communications corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 13
        },
        {
          "asn_number": "AS56048 china mobile communicaitons corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS56466 zentex",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS5650 frontier communications of america  inc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS57049 small private enterprise kvant-ii",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 3
        },
        {
          "asn_number": "AS57427 sierra llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS57523 chang way technologies co. limited",
          "rank": 1,
          "protocol": "tcp",
          "attack_count": 42
        },
        {
          "asn_number": "AS57523 chang way technologies co. limited",
          "rank": 2,
          "protocol": "http",
          "attack_count": 42
        },
        {
          "asn_number": "AS577 bell canada",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS57835 jsc elektrosvyaz",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS57858 inter connects inc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS58461 ct-hangzhou-idc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS58461 ct-hangzhou-idc",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS58519 cloud computing corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS58542 tianjij 300000",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS58543 guangdong",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS58593 shanghai blue cloud technology co. ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS58819 pt arsenet global solusi",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS58946 grameen communications",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS59019 beijing kingsoft cloud internet technology co ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS6057 administracion nacional de telecomunicaciones",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS6128 cablevision systems corp.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS6130 american internet services  llc.",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 3
        },
        {
          "asn_number": "AS61432 itbks892",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS6147 telefonica del peru s.a.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS61826 nethouse telecom",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS62068 spectraip b.v.",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 7
        },
        {
          "asn_number": "AS63199 capitalonline data service co. ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS63526 systems solutions & development technologies limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS63730 vnso technology company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS63835 no 293 wanbao avenue",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS63949 linode  llc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS63949 linode  llc",
          "rank": 2,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS6568 entel s.a. - entelnet",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS6702 science production company trifle ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS6703 private joint-stock company farlep-invest",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS6713 itissalat al-maghrib",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 7
        },
        {
          "asn_number": "AS6730 sunrise communications ag",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS6799 ote sa (hellenic telecommunications organisation)",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS6830 liberty global b.v.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS6849 pjsc ukrtelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS6939 hurricane electric llc",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 9
        },
        {
          "asn_number": "AS6939 hurricane electric llc",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS701 verizon",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS7018 att services inc",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 14
        },
        {
          "asn_number": "AS7018 att services inc",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS7018 att services inc",
          "rank": 3,
          "protocol": "telnet",
          "attack_count": 2
        },
        {
          "asn_number": "AS7184 universidad veracruzana",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS7303 telecom argentina s.a.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS7470 true internet co. ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS7545 tpg telecom limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS7552 viettel group",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS7713 pt telekomunikasi indonesia",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 11
        },
        {
          "asn_number": "AS7922 comcast",
          "rank": 1,
          "protocol": "sip",
          "attack_count": 7
        },
        {
          "asn_number": "AS7922 comcast",
          "rank": 2,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS7922 comcast",
          "rank": 3,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS8048 cantv servicios  venezuela",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS8070 microsoft corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS8075 microsoft corporation",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 31
        },
        {
          "asn_number": "AS8151 uninet s.a. de c.v.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 5
        },
        {
          "asn_number": "AS8220 colt technology services group limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8228 sfr sa",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8331 jsc er-telecom holding",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8359 mts pjsc",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS8402 pjsc vimpelcom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8449 elcat ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS8473 bahnhof",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS852 telus communications inc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8560 1&1 ionos se",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8612 tiscali italia s.p.a.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS8758 iway ag",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS8866 bulgarian telecommunications company plc.",
          "rank": 1,
          "protocol": "telnet",
          "attack_count": 1
        },
        {
          "asn_number": "AS9009 m247 ltd",
          "rank": 1,
          "protocol": "snmp",
          "attack_count": 1
        },
        {
          "asn_number": "AS9009 m247 ltd",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 1
        },
        {
          "asn_number": "AS9198 jsc kazakhtelecom",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS9269 hong kong broadband network",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS9299 philippine long distance telephone company",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS9304 hgc global communications limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS9318 sk broadband co ltd",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 18
        },
        {
          "asn_number": "AS9341 pt indonesia comnets plus",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS9381 hkbn enterprise solutions hk limited",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS9498 bharti airtel ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS9802 abitcool(china) inc.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 2
        },
        {
          "asn_number": "AS9808 china mobile communications group co.  ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 25
        },
        {
          "asn_number": "AS9812 oriental cable network co.  ltd.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "AS9829 national internet backbone",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 4
        },
        {
          "asn_number": "AS9891 cs loxinfo public company limited.",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 9
        },
        {
          "asn_number": "AS9924 taiwan fixed network telco and network service provider",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 3
        },
        {
          "asn_number": "AS9931 the communication authority of thailand",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 1
        },
        {
          "asn_number": "ASNone ",
          "rank": 1,
          "protocol": "ssh",
          "attack_count": 51
        },
        {
          "asn_number": "ASNone ",
          "rank": 2,
          "protocol": "sip",
          "attack_count": 16
        },
        {
          "asn_number": "ASNone ",
          "rank": 3,
          "protocol": "snmp",
          "attack_count": 14
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 551,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 426,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 426 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Determine, for each ASN associated with attacking IPs, which network/application protocols are most frequently used in attacks that target France, returning the top three protocols per ASN based on observed attack activity.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:ASN {number})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)\",\n      \"(ip:IP)-[:ATTACKS {protocol, technique, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\"\n    ],\n    \"PRIMARY_PROPERTIES_USED\": [\n      \"Country.name (target identification, specifically 'France')\",\n      \"ASN.number (grouping key)\",\n      \"ATTACKS.protocol (ranking dimension)\",\n      \"ATTACKS.pulse_id or documented_* dates (optional for uniqueness/time filtering if needed)\"\n    ]\n  },\n  \"FILTERS\": [\n    \"Target country must be France (match ATTACKS relationship to (:Country {name: 'France'}))\",\n    \"Only consider IPs that have an explicit BELONGS_TO relationship to an ASN\",\n    \"Only consider ATTACKS relationships where protocol is present/non-null (recommended to avoid empty protocol buckets)\",\n    \"No time window specified; include all available attacks unless additional constraints are later provided\"\n  ],\n  \"OUTPUT_FORMAT\": \"Return one record per ASN, including ASN number and an ordered list/array of the top 3 protocols used against France, each with its attack count (or frequency). Example shape: {asn: <number>, top_protocols: [{protocol: <name>, count: <n>}, ... up to 3]}.\",\n  \"SUGGESTED_APPROACH\": \"1) Identify the France country node as the attack target. 2) Traverse from IPs that ATTACK France to their owning ASN via BELONGS_TO. 3) Aggregate attack occurrences by (ASN, protocol) using the ATTACKS.relationship protocol attribute. 4) For each ASN, sort protocols by descending count (optionally add a deterministic secondary sort like protocol name to break ties). 5) Collect the top 3 protocols per ASN into a list and return results per ASN.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For each ASN, find IPs that attacked the Country node named 'France', count attacks by ATTACKS.protocol, and return the top 3 protocols per ASN ordered by frequency (including counts).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For each ASN, find IPs that attacked the Country node named 'France', count attacks by ATTACKS.protocol, and return the top 3 protocols per ASN ordered by frequency (including counts)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(fr:Country {name: 'France'})\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWHERE r.protocol <> 'unknown'\nWITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count\nORDER BY asn_number, attack_count DESC\nWITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols\nUNWIND range(0, size(top_protocols) - 1) AS idx\nWITH asn_number, idx + 1 AS rank, top_protocols[idx] AS p\nRETURN asn_number, rank, p.protocol AS protocol, p.attack_count AS attack_count\nORDER BY asn_number, rank"
          ],
          "trace": [
            {
              "subproblem": "For each ASN, find IPs that attacked the Country node named 'France', count attacks by ATTACKS.protocol, and return the top 3 protocols per ASN ordered by frequency (including counts).",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(fr:Country {name: 'France'})\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWHERE r.protocol <> 'unknown'\nWITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count\nORDER BY asn_number, attack_count DESC\nWITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols\nUNWIND range(0, size(top_protocols) - 1) AS idx\nWITH asn_number, idx + 1 AS rank, top_protocols[idx] AS p\nRETURN asn_number, rank, p.protocol AS protocol, p.attack_count AS attack_count\nORDER BY asn_number, rank",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn_number": "AS10103 hk broadband network ltd.",
                      "rank": 1,
                      "protocol": "ssh",
                      "attack_count": 1
                    },
                    {
                      "asn_number": "AS10220 pt. kreasi sejahtera teknologi",
                      "rank": 1,
                      "protocol": "ssh",
                      "attack_count": 2
                    },
                    {
                      "asn_number": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
                      "rank": 1,
                      "protocol": "ssh",
                      "attack_count": 4
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(fr:Country {name: 'France'})\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWHERE r.protocol <> 'unknown'\nWITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count\nORDER BY asn_number, attack_count DESC\nWITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols\nUNWIND range(0, size(top_protocols) - 1) AS idx\nWITH asn_number, idx + 1 AS rank, top_protocols[idx] AS p\nRETURN asn_number, rank, p.protocol AS protocol, p.attack_count AS attack_count\nORDER BY asn_number, rank"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn_number": "AS10103 hk broadband network ltd.",
              "rank": 1,
              "protocol": "ssh",
              "attack_count": 1
            },
            {
              "asn_number": "AS10220 pt. kreasi sejahtera teknologi",
              "rank": 1,
              "protocol": "ssh",
              "attack_count": 2
            },
            {
              "asn_number": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
              "rank": 1,
              "protocol": "ssh",
              "attack_count": 4
            }
          ]
        },
        "explanation": {
          "text": "This query finds IPs (grouped by their ASN) that attacked France, excludes attacks with an `unknown` protocol, counts attacks per protocol per ASN, and returns the top 3 most-used protocols for each ASN ranked by attack volume."
        }
      },
      "token_usage": {
        "input": 1648,
        "output": 1392,
        "total": 3040
      },
      "duration_seconds": 39.843,
      "started_at": "2026-02-20T03:57:32.128176+00:00",
      "ended_at": "2026-02-20T03:58:11.970683+00:00",
      "metadata": {
        "time": "2026-02-20T03:58:11.948444+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 12,
      "category": "impossible",
      "prompt": "List the top 5 malware families used in attacks.",
      "expected_cypher": "RETURN 'Not enough information in schema (no malware family)' AS note",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS malware_family, count(*) AS attack_count\nRETURN malware_family, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
      "response": [
        {
          "malware_family": "unknown",
          "attack_count": 3025957
        },
        {
          "malware_family": "botnet",
          "attack_count": 73462
        },
        {
          "malware_family": "mirai",
          "attack_count": 36090
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 215,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 3,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 3 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which malware families are most commonly observed in the dataset\u2019s recorded attacks by ranking them and returning the top 5 based on attack frequency.\",\n  \"KEY_ENTITIES\": \"Primary nodes: IP (as the attacking source). Primary relationship: (IP)-[:ATTACKS]->(Country), using the ATTACKS relationship instances as the attack records to be counted. Likely malware-family attribute: IP.botnet (interpreted as the malware family associated with that IP). Optional context nodes/relationships (not required for the ranking unless the user later asks for breakdowns): Country via ATTACKS target, Country via FROM (source geolocation), ASN via BELONGS_TO (network ownership).\",\n  \"FILTERS\": \"No explicit filters were provided. Implicit constraints to make the result meaningful: consider only IP nodes that participate in at least one ATTACKS relationship; consider only non-null/non-empty malware-family values (most plausibly IP.botnet). If multiple ATTACKS relationships exist per IP, count each relationship occurrence as an attack event. Time range is not specified (so use all available dates).\",\n  \"OUTPUT_FORMAT\": \"Return a ranked list of 5 entries, each containing: malware_family (the family name/value), attack_count (number of ATTACKS records attributed to that family), and rank (1\u20135).\",\n  \"SUGGESTED_APPROACH\": \"Treat each ATTACKS relationship as an attack event. For each such event, associate it with a malware family value (most plausibly IP.botnet) from the source IP node. Aggregate by malware family, counting attack events. Exclude unknown/blank families. Sort families by descending count and return the top 5 with their counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Rank malware families (using the malware-family field on the attacking IP, e.g., IP.botnet) by the number of ATTACKS relationships they are associated with, and return the top 5 families with their attack counts.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Rank malware families (using the malware-family field on the attacking IP, e.g., IP.botnet) by the number of ATTACKS relationships they are associated with, and return the top 5 families with their attack counts."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS malware_family, count(*) AS attack_count\nRETURN malware_family, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
          ],
          "trace": [
            {
              "subproblem": "Rank malware families (using the malware-family field on the attacking IP, e.g., IP.botnet) by the number of ATTACKS relationships they are associated with, and return the top 5 families with their attack counts.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS malware_family, count(*) AS attack_count\nRETURN malware_family, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "malware_family": "unknown",
                      "attack_count": 3025957
                    },
                    {
                      "malware_family": "botnet",
                      "attack_count": 73462
                    },
                    {
                      "malware_family": "mirai",
                      "attack_count": 36090
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS malware_family, count(*) AS attack_count\nRETURN malware_family, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "malware_family": "unknown",
              "attack_count": 3025957
            },
            {
              "malware_family": "botnet",
              "attack_count": 73462
            },
            {
              "malware_family": "mirai",
              "attack_count": 36090
            }
          ]
        },
        "explanation": {
          "text": "This query finds IPs with a non-empty `botnet` value, counts how many `ATTACKS` relationships each botnet/malware family is associated with, and returns the top 5 families by attack count."
        }
      },
      "token_usage": {
        "input": 1435,
        "output": 763,
        "total": 2198
      },
      "duration_seconds": 17.503,
      "started_at": "2026-02-20T03:58:11.971814+00:00",
      "ended_at": "2026-02-20T03:58:29.474735+00:00",
      "metadata": {
        "time": "2026-02-20T03:58:29.462094+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 13,
      "category": "impossible",
      "prompt": "What destination ports are most targeted?",
      "expected_cypher": "RETURN 'Not enough information in schema (no destination port)' AS note",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.destination_port IS NOT NULL\nOPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  a.destination_port AS destination_port,\n  count(*) AS attack_count,\n  count(DISTINCT ip) AS distinct_attacker_ips,\n  count(DISTINCT asn) AS distinct_attacker_asns\nORDER BY attack_count DESC\nLIMIT 10\nRETURN destination_port, attack_count, distinct_attacker_ips, distinct_attacker_asns",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 410,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which destination network ports are being targeted most frequently in the observed attack events, ranked by volume (and optionally broken down by protocol or other attack metadata) so the user can understand the most commonly attacked services.\",\n  \"KEY_ENTITIES\": \"Primary: (:IP)-[:ATTACKS]->(:Country) where the :ATTACKS relationship represents an attack event/observation. Relevant fields are expected to be on the :ATTACKS relationship (e.g., protocol, technique, technology, industry, pulse_id, documented_create_date, documented_modified_date). Secondary (optional enrichment): (:IP)-[:FROM]->(:Country) for attacker source country context; (:IP)-[:BELONGS_TO]->(:ASN) for attacker network (ASN) context.\",\n  \"FILTERS\": \"Core filter: only consider relationships of type :ATTACKS. Port filter/requirement: the question requires a destination port attribute, but the provided schema does not explicitly list a destination_port/dport property on :ATTACKS; clarify where destination port is stored (e.g., a property on :ATTACKS, encoded within protocol/technique/technology, or in an external mapping). Optional filters to clarify up front if needed: time window based on documented_create_date / documented_modified_date; limit to specific protocol(s) (TCP/UDP) if protocol is populated; restrict to specific target country (the :ATTACKS endpoint) or to specific attacker country/ASN/botnet; restrict to specific industry/technology/technique; restrict to specific pulse_id(s) or pulse_ids on IP nodes if the intent is to scope to certain campaigns.\",\n  \"OUTPUT_FORMAT\": \"A ranked list/table of destination ports with an attack count (descending). Recommended columns: destination_port, attack_count. Optional additional columns if requested: protocol, percentage_of_total, distinct_attacker_ips, distinct_attacker_asns, top_target_countries, and/or time range used. Also return the top N (e.g., 10 or 20) plus total number of port values observed.\",\n  \"SUGGESTED_APPROACH\": \"Treat each :ATTACKS relationship as an attack record. Extract the destination port value from the appropriate field (must be identified/confirmed). Group attack records by destination port (and optionally by protocol), count occurrences, sort descending, and return the top results. If enrichment is requested, join from attacker IPs to their ASN and source country via :BELONGS_TO and :FROM to compute additional context such as distinct attacker IPs/ASNs per port or top source regions. Apply optional time/campaign filters before aggregation to keep results relevant.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Aggregate all :ATTACKS relationships by destination port (from the correct port field), count how many attacks target each port, sort descending, and return the top targeted destination ports (optionally with protocol and basic context like distinct attacker IPs/ASNs if requested).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Aggregate all :ATTACKS relationships by destination port (from the correct port field), count how many attacks target each port, sort descending, and return the top targeted destination ports (optionally with protocol and basic context like distinct attacker IPs/ASNs if requested)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.destination_port IS NOT NULL\nOPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  a.destination_port AS destination_port,\n  count(*) AS attack_count,\n  count(DISTINCT ip) AS distinct_attacker_ips,\n  count(DISTINCT asn) AS distinct_attacker_asns\nORDER BY attack_count DESC\nLIMIT 10\nRETURN destination_port, attack_count, distinct_attacker_ips, distinct_attacker_asns"
          ],
          "trace": [
            {
              "subproblem": "Aggregate all :ATTACKS relationships by destination port (from the correct port field), count how many attacks target each port, sort descending, and return the top targeted destination ports (optionally with protocol and basic context like distinct attacker IPs/ASNs if requested).",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.destination_port IS NOT NULL\nOPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  a.destination_port AS destination_port,\n  count(*) AS attack_count,\n  count(DISTINCT ip) AS distinct_attacker_ips,\n  count(DISTINCT asn) AS distinct_attacker_asns\nORDER BY attack_count DESC\nLIMIT 10\nRETURN destination_port, attack_count, distinct_attacker_ips, distinct_attacker_asns",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE a.destination_port IS NOT NULL\nOPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  a.destination_port AS destination_port,\n  count(*) AS attack_count,\n  count(DISTINCT ip) AS distinct_attacker_ips,\n  count(DISTINCT asn) AS distinct_attacker_asns\nORDER BY attack_count DESC\nLIMIT 10\nRETURN destination_port, attack_count, distinct_attacker_ips, distinct_attacker_asns"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "This query finds the top 10 most-targeted destination ports in `ATTACKS` relationships (where the port is known), and for each port returns the total number of attacks plus the number of unique attacker IPs and ASNs involved."
        }
      },
      "token_usage": {
        "input": 1547,
        "output": 1970,
        "total": 3517
      },
      "duration_seconds": 37.646,
      "started_at": "2026-02-20T03:58:29.475354+00:00",
      "ended_at": "2026-02-20T03:59:07.121154+00:00",
      "metadata": {
        "time": "2026-02-20T03:59:07.109239+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 14,
      "category": "matcher-needed",
      "prompt": "How many attacks used technique ' Phishing' against Australia?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS {technique:'T1566 Phishing'}]->(:Country {name:'Australia'})\nRETURN count(a) AS attacks",
      "agent_cypher": "MATCH (:IP)-[r:ATTACKS {technique: \"T1566 Phishing\"}]->(:Country {name: \"Australia\"})\nRETURN count(*) AS phishing_attacks_to_australia",
      "response": [
        {
          "phishing_attacks_to_australia": 156
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 134,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Determine the total number of recorded attack events where the attack technique is labeled \u201cPhishing\u201d and the target country is Australia.\",\n  \"KEY_ENTITIES\": \"Relevant entities are IP nodes and Country nodes connected by the ATTACKS relationship, specifically (ip:IP)-[:ATTACKS]->(country:Country). The ATTACKS relationship properties of interest include technique (primary filter) and optionally pulse_id and documented dates for defining what constitutes a unique attack record. The Country node property of interest is name. The FROM and BELONGS_TO relationships are not required for answering the question unless the user later wants attacker origin or ASN attribution.\",\n  \"FILTERS\": \"1) Match Country.name exactly to \u201cAustralia\u201d on the ATTACKS relationship\u2019s destination country node (target). 2) Match ATTACKS.technique to \u201cPhishing\u201d (trim leading/trailing whitespace and apply case-insensitive comparison if data quality is inconsistent, since the provided technique value includes a leading space). 3) No time window is specified; include all available records unless otherwise requested.\",\n  \"OUTPUT_FORMAT\": \"Return a single aggregated numeric result: the count of attacks matching the filters (e.g., {country: \\\"Australia\\\", technique: \\\"Phishing\\\", attack_count: N}).\",\n  \"SUGGESTED_APPROACH\": \"Traverse ATTACKS relationships from IP to Country, restrict to those where the target Country is Australia and the relationship technique indicates Phishing, then aggregate by counting the matching ATTACKS relationships. If duplicates are a concern, clarify whether to count raw ATTACKS edges, distinct pulse_id values, or distinct (ip, pulse_id) combinations; default to counting ATTACKS relationships as recorded.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Count the number of ATTACKS relationships with technique \u201cPhishing\u201d that point to the Country node named \u201cAustralia\u201d.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Count the number of ATTACKS relationships with technique \u201cPhishing\u201d that point to the Country node named \u201cAustralia\u201d."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (:IP)-[r:ATTACKS {technique: \"T1566 Phishing\"}]->(:Country {name: \"Australia\"})\nRETURN count(*) AS phishing_attacks_to_australia"
          ],
          "trace": [
            {
              "subproblem": "Count the number of ATTACKS relationships with technique \u201cPhishing\u201d that point to the Country node named \u201cAustralia\u201d.",
              "attempts": [
                {
                  "fragment": "MATCH (:IP)-[r:ATTACKS {technique: \"T1566 Phishing\"}]->(:Country {name: \"Australia\"})\nRETURN count(*) AS phishing_attacks_to_australia",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "\"Phishing\"",
                      "value": "T1566 Phishing"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "phishing_attacks_to_australia": 156
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (:IP)-[r:ATTACKS {technique: \"T1566 Phishing\"}]->(:Country {name: \"Australia\"})\nRETURN count(*) AS phishing_attacks_to_australia"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "phishing_attacks_to_australia": 156
            }
          ]
        },
        "explanation": {
          "text": "This query counts how many `ATTACKS` relationships labeled with the technique **\u201cT1566 Phishing\u201d** point from any `IP` node to the `Country` node named **\u201cAustralia\u201d**, returning that total as `phishing_attacks_to_australia`."
        }
      },
      "token_usage": {
        "input": 1375,
        "output": 649,
        "total": 2024
      },
      "duration_seconds": 20.684,
      "started_at": "2026-02-20T03:59:07.121805+00:00",
      "ended_at": "2026-02-20T03:59:27.805879+00:00",
      "metadata": {
        "time": "2026-02-20T03:59:27.794046+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 15,
      "category": "complex",
      "prompt": "Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.technique AS technique, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, technique, year_month, collect(DISTINCT asn)[0..50] AS asns\nUNWIND range(0, size(asns)-2) AS i\nUNWIND range(i+1, size(asns)-1) AS j\nWITH asns[i] AS asnA, asns[j] AS asnB, country, technique, year_month\nRETURN asnA, asnB, country, technique, year_month, count(*) AS co_attacks\nORDER BY co_attacks DESC\nLIMIT 10",
      "agent_cypher": null,
      "response": null,
      "error": "Empty query",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "EMPTY_QUERY",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with EMPTY_QUERY"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Find the strongest co-occurrence relationships between Autonomous Systems by identifying pairs of ASNs that conducted attacks against the same target country using the same attack technique during the same calendar month, then rank those ASN pairs by how often this shared (country, technique, month) pattern occurs.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacking source mapped to an ASN\",\n      \"(:ASN {number}) as the grouping entity for attackers\",\n      \"(:Country {name}) as the attack target (and optionally also the IP origin country)\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN) to associate attacks to an ASN\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country) as the core attack event record\",\n      \"(ip:IP)-[:FROM]->(country:Country) is available but not required unless the analysis should constrain attacker origin country\"\n    ],\n    \"PRIMARY_EVENT_GRAIN\": \"An attack record is represented by an :ATTACKS relationship from an IP to a target Country, enriched with technique and timestamps; these are rolled up to ASN level via IP\u2192ASN.\"\n  },\n  \"FILTERS\": [\n    \"Consider only attacks where :ATTACKS.technique is present (non-null / non-empty), since technique must match across ASNs.\",\n    \"Bucket attacks into the same calendar month using a consistent timestamp field; prefer :ATTACKS.documented_create_date as the event time for month grouping (or fall back to documented_modified_date only if create_date is missing, if such fallback is desired).\",\n    \"Two ASNs qualify as a co-attacking pair only if each has at least one attack in the same (target country, technique, month) bucket.\",\n    \"Exclude self-pairs (an ASN cannot be paired with itself).\",\n    \"De-duplicate symmetric pairs so each pair appears once (e.g., treat (ASN A, ASN B) the same as (ASN B, ASN A)).\",\n    \"Definition of 'co-attack count': count distinct shared buckets (country, technique, month) in which both ASNs are present (optionally independent of how many IPs/attacks each ASN contributed within that bucket).\",\n    \"Limit results to the top 10 ASN pairs by co-attack count.\"\n  ],\n  \"OUTPUT_FORMAT\": {\n    \"TYPE\": \"Tabular / list of records\",\n    \"FIELDS\": [\n      \"asn_1 (ASN number)\",\n      \"asn_2 (ASN number)\",\n      \"co_attack_count (number of distinct shared (country, technique, month) buckets)\"\n    ],\n    \"ORDERING\": \"Descending by co_attack_count; optionally add deterministic tie-breakers such as ascending asn_1 then asn_2.\",\n    \"OPTIONAL_ENRICHMENTS\": [\n      \"Include a small sample or summary of shared buckets (e.g., top shared target countries or techniques, or a few example (country, technique, month) tuples) to aid interpretability.\"\n    ]\n  },\n  \"SUGGESTED_APPROACH\": \"Aggregate attacks up from IPs to their ASNs, normalize each attack into a bucket defined by (target country, technique, month derived from documented_create_date), then for each bucket collect the distinct ASNs involved. Generate unique ASN pairs within each bucket, count how many buckets each pair co-occurs in, and finally sort by that count and return the top 10 pairs (ensuring self-pairs and duplicate orderings are removed).\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Compute the top 10 unique ASN pairs that both appear attacking the same target country with the same technique in the same calendar month (based on documented_create_date), where each pair\u2019s score is the number of distinct shared (country, technique, month) buckets.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Compute the top 10 unique ASN pairs that both appear attacking the same target country with the same technique in the same calendar month (based on documented_create_date), where each pair\u2019s score is the number of distinct shared (country, technique, month) buckets."
          ]
        },
        "generation": {
          "fragments": [],
          "trace": [
            {
              "subproblem": "Compute the top 10 unique ASN pairs that both appear attacking the same target country with the same technique in the same calendar month (based on documented_create_date), where each pair\u2019s score is the number of distinct shared (country, technique, month) buckets.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(country:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  country.name AS country,\n  a.technique AS technique,\n  date.truncate('month', a.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nUNWIND range(0, size(asns) - 2) AS i\nUNWIND range(i + 1, size(asns) - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2, country, technique, year_month\nWITH asn1, asn2, count(DISTINCT [country, technique, year_month]) AS score\nORDER BY score DESC, asn1 ASC, asn2 ASC\nLIMIT 10\nRETURN asn1, asn2, score",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.TransientError.General.MemoryPoolOutOfMemoryError} {message: The allocation of an extra 2.0 MiB would use more than the limit 716.8 MiB. Currently using 716.0 MiB. dbms.memory.transaction.total.max threshold reached} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[r:ATTACKS]->(country:Country)\nWITH country, r.technique AS technique, date.truncate('month', r.documented_create_date) AS year_month, asn.number AS asnNum\nORDER BY asnNum\nWITH country, technique, year_month, collect(DISTINCT asnNum) AS asns\nWITH country, technique, year_month, asns, size(asns) AS n\nWHERE n >= 2\nUNWIND range(0, n - 2) AS i\nUNWIND range(i + 1, n - 1) AS j\nWITH asns[i] AS asn1, asns[j] AS asn2, country.name AS country_name, technique, year_month\nWITH asn1, asn2, count(DISTINCT country_name + '|' + technique + '|' + toString(year_month)) AS score\nRETURN asn1, asn2, score\nORDER BY score DESC, asn1 ASC, asn2 ASC\nLIMIT 10",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.TransientError.General.MemoryPoolOutOfMemoryError} {message: The allocation of an extra 2.0 MiB would use more than the limit 716.8 MiB. Currently using 716.0 MiB. dbms.memory.transaction.total.max threshold reached} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                },
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country)\nWHERE r.technique <> 'unknown' AND r.documented_create_date IS NOT NULL\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH\n  c.name AS country,\n  r.technique AS technique,\n  date.truncate('month', r.documented_create_date) AS year_month,\n  collect(DISTINCT asn.number) AS asns\nWHERE size(asns) >= 2\nWITH country, technique, year_month, asns, range(0, size(asns) - 2) AS idxs\nUNWIND idxs AS i\nWITH country, technique, year_month, asns, i, range(i + 1, size(asns) - 1) AS jdxs\nUNWIND jdxs AS j\nWITH\n  country, technique, year_month,\n  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,\n  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2\nWITH asn1, asn2, collect(DISTINCT {country: country, technique: technique, year_month: year_month}) AS buckets\nRETURN asn1, asn2, size(buckets) AS score\nORDER BY score DESC, asn1 ASC, asn2 ASC\nLIMIT 10",
                  "matched_pairs": [],
                  "ok": false,
                  "error": "{neo4j_code: Neo.TransientError.General.MemoryPoolOutOfMemoryError} {message: The allocation of an extra 2.0 MiB would use more than the limit 716.8 MiB. Currently using 715.0 MiB. dbms.memory.transaction.total.max threshold reached} {gql_status: 50N42} {gql_status_description: error: general processing exception - unexpected error. Unexpected error has occurred. See debug log for details.}",
                  "rows_preview": null
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": ""
        },
        "final_validation": {
          "trace": [
            {
              "query": "",
              "ok": false,
              "error": "Empty query",
              "rows_preview": null
            },
            {
              "query": "",
              "ok": false,
              "error": "Empty query",
              "rows_preview": null
            },
            {
              "query": "",
              "ok": false,
              "error": "Empty query",
              "rows_preview": null
            }
          ],
          "error": "Empty query",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 3715,
        "output": 3615,
        "total": 7330
      },
      "duration_seconds": 139.186,
      "started_at": "2026-02-20T03:59:27.806387+00:00",
      "ended_at": "2026-02-20T04:01:46.992182+00:00",
      "metadata": {
        "time": "2026-02-20T04:01:46.954403+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    }
  ]
}