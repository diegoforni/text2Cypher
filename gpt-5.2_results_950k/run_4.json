{
  "summary": {
    "total_queries": 15,
    "run_duration_seconds": 2963.13523,
    "model": "gpt-5.2",
    "provider": "openai",
    "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
    "started_at": "2026-02-20T05:25:28.307749+00:00",
    "ended_at": "2026-02-20T06:14:51.442979+00:00",
    "status_breakdown": {
      "SUCCESS": 9,
      "ERROR": 4,
      "SUCCESS_ZERO_ROWS": 2
    },
    "error_types": {
      "OTHER": 4
    },
    "total_tokens": 46023,
    "total_duration_seconds": 2963.0779999999995,
    "success_rate": 60.0
  },
  "results": [
    {
      "index": 1,
      "category": "simple",
      "prompt": "What is the attack technique most used overall?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH a.technique AS technique, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 1\nRETURN technique, attacks",
      "agent_cypher": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS occurrence_count\nORDER BY occurrence_count DESC\nWITH collect({technique: technique, occurrence_count: occurrence_count}) AS rows\nWITH rows, rows[0].occurrence_count AS top_count\nUNWIND rows AS row\nWITH row\nWHERE row.occurrence_count = top_count\nRETURN row.technique AS technique, row.occurrence_count AS occurrence_count\nORDER BY occurrence_count DESC, technique ASC",
      "response": [
        {
          "technique": "T1566 Phishing",
          "occurrence_count": 2863569
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 503,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which attack technique (as recorded on ATTACKS relationships) appears most frequently across the entire dataset, i.e., the globally most commonly used technique.\",\n  \"KEY_ENTITIES\": \"Primary: (ip:IP)-[a:ATTACKS]->(country:Country) relationship and its property a.technique. Secondary (optional for context only, not required to answer): (ip)-[:FROM]->(country) and (ip)-[:BELONGS_TO]->(asn:ASN).\",\n  \"FILTERS\": \"No explicit filters are stated; compute over all ATTACKS relationships. Implicit data-quality filters to consider: exclude ATTACKS records where technique is missing, null, or blank. No constraints on protocol, technology, industry, botnet, pulse_id, country, ASN, or date unless the user later specifies a timeframe or subset.\",\n  \"OUTPUT_FORMAT\": \"Return the single most-used technique overall, along with its total occurrence count across ATTACKS records. If there is a tie for the top count, return all tied techniques with the same top count (or alternatively return one arbitrarily\u2014should be clarified if strict single result is required).\",\n  \"SUGGESTED_APPROACH\": \"Traverse all ATTACKS relationships, group records by the technique property, count how many ATTACKS entries each technique has, sort counts descending, and select the highest-count technique(s). Ensure techniques that are null/empty are ignored so the result reflects meaningful technique values.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the attack technique value on ATTACKS relationships that occurs most frequently across all ATTACKS records (excluding null/blank techniques), and return the top technique(s) with their occurrence count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the attack technique value on ATTACKS relationships that occurs most frequently across all ATTACKS records (excluding null/blank techniques), and return the top technique(s) with their occurrence count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS occurrence_count\nORDER BY occurrence_count DESC\nWITH collect({technique: technique, occurrence_count: occurrence_count}) AS rows\nWITH rows, rows[0].occurrence_count AS top_count\nUNWIND rows AS row\nWITH row\nWHERE row.occurrence_count = top_count\nRETURN row.technique AS technique, row.occurrence_count AS occurrence_count\nORDER BY occurrence_count DESC, technique ASC"
          ],
          "trace": [
            {
              "subproblem": "Find the attack technique value on ATTACKS relationships that occurs most frequently across all ATTACKS records (excluding null/blank techniques), and return the top technique(s) with their occurrence count.",
              "attempts": [
                {
                  "fragment": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS occurrence_count\nORDER BY occurrence_count DESC\nWITH collect({technique: technique, occurrence_count: occurrence_count}) AS rows\nWITH rows, rows[0].occurrence_count AS top_count\nUNWIND rows AS row\nWITH row\nWHERE row.occurrence_count = top_count\nRETURN row.technique AS technique, row.occurrence_count AS occurrence_count\nORDER BY occurrence_count DESC, technique ASC",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "occurrence_count": 2863569
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.technique IS NOT NULL AND trim(r.technique) <> ''\nWITH r.technique AS technique, count(*) AS occurrence_count\nORDER BY occurrence_count DESC\nWITH collect({technique: technique, occurrence_count: occurrence_count}) AS rows\nWITH rows, rows[0].occurrence_count AS top_count\nUNWIND rows AS row\nWITH row\nWHERE row.occurrence_count = top_count\nRETURN row.technique AS technique, row.occurrence_count AS occurrence_count\nORDER BY occurrence_count DESC, technique ASC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "occurrence_count": 2863569
            }
          ]
        },
        "explanation": {
          "text": "This query counts how many `:ATTACKS` relationships have each non-empty `technique`, finds the highest count, and returns the technique(s) tied for that top frequency (with their occurrence count)."
        }
      },
      "token_usage": {
        "input": 1554,
        "output": 730,
        "total": 2284
      },
      "duration_seconds": 346.627,
      "started_at": "2026-02-20T05:25:28.309517+00:00",
      "ended_at": "2026-02-20T05:31:14.936705+00:00",
      "metadata": {
        "time": "2026-02-20T05:31:14.923526+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 2,
      "category": "matcher-needed",
      "prompt": "From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?",
      "expected_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWITH ip, collect(toLower(a.technique)) AS allTechs\nWHERE any(t IN allTechs WHERE t CONTAINS 'phishing')\nMATCH (ip)-[a2:ATTACKS]->(:Country)\nWHERE NOT toLower(a2.technique) CONTAINS 'phishing'\nWITH a2.technique AS technique, count(*) AS cnt\nWITH collect({technique: technique, cnt: cnt}) AS rows, sum(cnt) AS total\nUNWIND rows AS r\nRETURN r.technique AS technique, r.cnt AS attacks, toFloat(r.cnt) / total * 100.0 AS percentage\nORDER BY percentage DESC",
      "agent_cypher": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort\nMATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip IN cohort AND a.technique <> 'phishing'\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, sum(event_count) AS total_non_phishing\nUNWIND rows AS row\nWITH row.technique AS technique, row.event_count AS event_count, total_non_phishing\nRETURN\n  technique,\n  event_count,\n  (toFloat(event_count) * 100.0) / CASE WHEN total_non_phishing = 0 THEN 1 ELSE total_non_phishing END AS percentage_of_total_non_phishing\nORDER BY event_count DESC",
      "response": [
        {
          "technique": "T1566 Phishing",
          "event_count": 2863569,
          "percentage_of_total_non_phishing": 93.73295638110146
        },
        {
          "technique": "T1595 Active Scanning",
          "event_count": 19712,
          "percentage_of_total_non_phishing": 0.6452311909314118
        },
        {
          "technique": "unknown",
          "event_count": 18852,
          "percentage_of_total_non_phishing": 0.6170808853205649
        },
        {
          "technique": "T1110 Brute Force",
          "event_count": 13452,
          "percentage_of_total_non_phishing": 0.4403231524152471
        },
        {
          "technique": "T1204 User Execution",
          "event_count": 6119,
          "percentage_of_total_non_phishing": 0.2002926977125258
        },
        {
          "technique": "T1071 Application Layer Protocol",
          "event_count": 4126,
          "percentage_of_total_non_phishing": 0.13505600110506316
        },
        {
          "technique": "T1129 Shared Modules",
          "event_count": 3928,
          "percentage_of_total_non_phishing": 0.12857488423186816
        },
        {
          "technique": "T1060 Registry Run Keys / Startup Folder",
          "event_count": 3717,
          "percentage_of_total_non_phishing": 0.12166823948316038
        },
        {
          "technique": "T1027 Obfuscated Files or Information",
          "event_count": 3707,
          "percentage_of_total_non_phishing": 0.12134091034815055
        },
        {
          "technique": "T1055 Process Injection",
          "event_count": 3664,
          "percentage_of_total_non_phishing": 0.1199333950676082
        },
        {
          "technique": "T1045 Software Packing",
          "event_count": 3275,
          "percentage_of_total_non_phishing": 0.10720029171572512
        },
        {
          "technique": "T1057 Process Discovery",
          "event_count": 3100,
          "percentage_of_total_non_phishing": 0.10147203185305279
        },
        {
          "technique": "T1040 Network Sniffing",
          "event_count": 3026,
          "percentage_of_total_non_phishing": 0.09904979625397992
        },
        {
          "technique": "T1140 Deobfuscate/Decode Files or Information",
          "event_count": 2920,
          "percentage_of_total_non_phishing": 0.09558010742287552
        },
        {
          "technique": "T1112 Modify Registry",
          "event_count": 2850,
          "percentage_of_total_non_phishing": 0.09328880347780659
        },
        {
          "technique": "T1119 Automated Collection",
          "event_count": 2809,
          "percentage_of_total_non_phishing": 0.09194675402426622
        },
        {
          "technique": "T1082 System Information Discovery",
          "event_count": 2740,
          "percentage_of_total_non_phishing": 0.08968818299269826
        },
        {
          "technique": "T1210 Exploitation of Remote Services",
          "event_count": 2501,
          "percentage_of_total_non_phishing": 0.08186501666596291
        },
        {
          "technique": "T1106 Native API",
          "event_count": 2358,
          "percentage_of_total_non_phishing": 0.07718421003532208
        },
        {
          "technique": "T1036 Masquerading",
          "event_count": 2316,
          "percentage_of_total_non_phishing": 0.07580942766828072
        },
        {
          "technique": "T1105 Ingress Tool Transfer",
          "event_count": 2245,
          "percentage_of_total_non_phishing": 0.07348539080971081
        },
        {
          "technique": "T1143 Hidden Window",
          "event_count": 2167,
          "percentage_of_total_non_phishing": 0.07093222355663399
        },
        {
          "technique": "T1047 Windows Management Instrumentation",
          "event_count": 2095,
          "percentage_of_total_non_phishing": 0.06857545378456309
        },
        {
          "technique": "T1003 OS Credential Dumping",
          "event_count": 2056,
          "percentage_of_total_non_phishing": 0.06729887015802469
        },
        {
          "technique": "T1023 Shortcut Modification",
          "event_count": 2022,
          "percentage_of_total_non_phishing": 0.06618595109899121
        },
        {
          "technique": "T1012 Query Registry",
          "event_count": 1895,
          "percentage_of_total_non_phishing": 0.06202887108436614
        },
        {
          "technique": "T1428 Unknown Technique",
          "event_count": 1895,
          "percentage_of_total_non_phishing": 0.06202887108436614
        },
        {
          "technique": "T1089 Disabling Security Tools",
          "event_count": 1894,
          "percentage_of_total_non_phishing": 0.061996138170865155
        },
        {
          "technique": "T1573 Encrypted Channel",
          "event_count": 1785,
          "percentage_of_total_non_phishing": 0.05842825059925781
        },
        {
          "technique": "T1133 External Remote Services",
          "event_count": 1774,
          "percentage_of_total_non_phishing": 0.05806818855074698
        },
        {
          "technique": "T1499 Endpoint Denial of Service",
          "event_count": 1665,
          "percentage_of_total_non_phishing": 0.05450030097913964
        },
        {
          "technique": "T1071.004 DNS",
          "event_count": 1646,
          "percentage_of_total_non_phishing": 0.05387837562262093
        },
        {
          "technique": "T1203 Exploitation for Client Execution",
          "event_count": 1546,
          "percentage_of_total_non_phishing": 0.05060508427252245
        },
        {
          "technique": "T1031 Modify Existing Service",
          "event_count": 1535,
          "percentage_of_total_non_phishing": 0.05024502222401162
        },
        {
          "technique": "T1564 Hide Artifacts",
          "event_count": 1529,
          "percentage_of_total_non_phishing": 0.05004862474300571
        },
        {
          "technique": "T1053 Scheduled Task/Job",
          "event_count": 1480,
          "percentage_of_total_non_phishing": 0.04844471198145746
        },
        {
          "technique": "T1485 Data Destruction",
          "event_count": 1411,
          "percentage_of_total_non_phishing": 0.04618614094988951
        },
        {
          "technique": "T1189 Drive-by Compromise",
          "event_count": 1411,
          "percentage_of_total_non_phishing": 0.04618614094988951
        },
        {
          "technique": "T1068 Exploitation for Privilege Escalation",
          "event_count": 1394,
          "percentage_of_total_non_phishing": 0.04562968142037277
        },
        {
          "technique": "T1059 Command and Scripting Interpreter",
          "event_count": 1298,
          "percentage_of_total_non_phishing": 0.04248732172427823
        },
        {
          "technique": "T1449 Unknown Technique",
          "event_count": 1195,
          "percentage_of_total_non_phishing": 0.0391158316336768
        },
        {
          "technique": "TA0011 Unknown Technique",
          "event_count": 1013,
          "percentage_of_total_non_phishing": 0.03315844137649757
        },
        {
          "technique": "TA0003 Unknown Technique",
          "event_count": 938,
          "percentage_of_total_non_phishing": 0.030703472863923713
        },
        {
          "technique": "TA0004 Unknown Technique",
          "event_count": 930,
          "percentage_of_total_non_phishing": 0.030441609555915836
        },
        {
          "technique": "TA0005 Unknown Technique",
          "event_count": 922,
          "percentage_of_total_non_phishing": 0.03017974624790796
        },
        {
          "technique": "T1071.001 Web Protocols",
          "event_count": 825,
          "percentage_of_total_non_phishing": 0.027004653638312434
        },
        {
          "technique": "T1056 Input Capture",
          "event_count": 825,
          "percentage_of_total_non_phishing": 0.027004653638312434
        },
        {
          "technique": "T1096 NTFS File Attributes",
          "event_count": 820,
          "percentage_of_total_non_phishing": 0.026840989070807512
        },
        {
          "technique": "T1090 Proxy",
          "event_count": 817,
          "percentage_of_total_non_phishing": 0.026742790330304557
        },
        {
          "technique": "T1114 Email Collection",
          "event_count": 817,
          "percentage_of_total_non_phishing": 0.026742790330304557
        },
        {
          "technique": "T1018 Remote System Discovery",
          "event_count": 785,
          "percentage_of_total_non_phishing": 0.025695337098273045
        },
        {
          "technique": "T1056.001 Keylogging",
          "event_count": 754,
          "percentage_of_total_non_phishing": 0.024680616779742516
        },
        {
          "technique": "TA0007 Unknown Technique",
          "event_count": 740,
          "percentage_of_total_non_phishing": 0.02422235599072873
        },
        {
          "technique": "T1497 Virtualization/Sandbox Evasion",
          "event_count": 709,
          "percentage_of_total_non_phishing": 0.0232076356721982
        },
        {
          "technique": "T1083 File and Directory Discovery",
          "event_count": 692,
          "percentage_of_total_non_phishing": 0.02265117614268146
        },
        {
          "technique": "TA0009 Unknown Technique",
          "event_count": 658,
          "percentage_of_total_non_phishing": 0.02153825708364798
        },
        {
          "technique": "T1059.007 JavaScript",
          "event_count": 654,
          "percentage_of_total_non_phishing": 0.02140732542964404
        },
        {
          "technique": "T1568 Dynamic Resolution",
          "event_count": 625,
          "percentage_of_total_non_phishing": 0.02045807093811548
        },
        {
          "technique": "T1088 Bypass User Account Control",
          "event_count": 612,
          "percentage_of_total_non_phishing": 0.02003254306260268
        },
        {
          "technique": "TA0002 Unknown Technique",
          "event_count": 582,
          "percentage_of_total_non_phishing": 0.019050555657573135
        },
        {
          "technique": "TA0006 Unknown Technique",
          "event_count": 570,
          "percentage_of_total_non_phishing": 0.01865776069556132
        },
        {
          "technique": "T1059.001 PowerShell",
          "event_count": 568,
          "percentage_of_total_non_phishing": 0.018592294868559348
        },
        {
          "technique": "T1583.005 Botnet",
          "event_count": 567,
          "percentage_of_total_non_phishing": 0.018559561955058364
        },
        {
          "technique": "T1033 System Owner/User Discovery",
          "event_count": 563,
          "percentage_of_total_non_phishing": 0.018428630301054426
        },
        {
          "technique": "T1553 Subvert Trust Controls",
          "event_count": 562,
          "percentage_of_total_non_phishing": 0.018395897387553442
        },
        {
          "technique": "T1583 Acquire Infrastructure",
          "event_count": 554,
          "percentage_of_total_non_phishing": 0.01813403407954556
        },
        {
          "technique": "T1176 Browser Extensions",
          "event_count": 549,
          "percentage_of_total_non_phishing": 0.01797036951204064
        },
        {
          "technique": "T1498 Network Denial of Service",
          "event_count": 527,
          "percentage_of_total_non_phishing": 0.017250245415018975
        },
        {
          "technique": "T1125 Video Capture",
          "event_count": 494,
          "percentage_of_total_non_phishing": 0.016170059269486475
        },
        {
          "technique": "T1547 Boot or Logon Autostart Execution",
          "event_count": 491,
          "percentage_of_total_non_phishing": 0.01607186052898352
        },
        {
          "technique": "T1110.002 Password Cracking",
          "event_count": 490,
          "percentage_of_total_non_phishing": 0.016039127615482537
        },
        {
          "technique": "T1132 Data Encoding",
          "event_count": 476,
          "percentage_of_total_non_phishing": 0.01558086682646875
        },
        {
          "technique": "T1155 AppleScript",
          "event_count": 452,
          "percentage_of_total_non_phishing": 0.014795276902445116
        },
        {
          "technique": "T1543 Create or Modify System Process",
          "event_count": 438,
          "percentage_of_total_non_phishing": 0.01433701611343133
        },
        {
          "technique": "T1094 Custom Command and Control Protocol",
          "event_count": 432,
          "percentage_of_total_non_phishing": 0.01414061863242542
        },
        {
          "technique": "T1064 Scripting",
          "event_count": 426,
          "percentage_of_total_non_phishing": 0.013944221151419512
        },
        {
          "technique": "T1070 Indicator Removal",
          "event_count": 426,
          "percentage_of_total_non_phishing": 0.013944221151419512
        },
        {
          "technique": "T1202 Indirect Command Execution",
          "event_count": 408,
          "percentage_of_total_non_phishing": 0.013355028708401787
        },
        {
          "technique": "T1003.008 /etc/passwd and /etc/shadow",
          "event_count": 392,
          "percentage_of_total_non_phishing": 0.01283130209238603
        },
        {
          "technique": "T1095 Non-Application Layer Protocol",
          "event_count": 380,
          "percentage_of_total_non_phishing": 0.012438507130374213
        },
        {
          "technique": "T1598 Phishing for Information",
          "event_count": 371,
          "percentage_of_total_non_phishing": 0.01214391090886535
        },
        {
          "technique": "T1445 Unknown Technique",
          "event_count": 360,
          "percentage_of_total_non_phishing": 0.011783848860354516
        },
        {
          "technique": "T1114.002 Remote Email Collection",
          "event_count": 332,
          "percentage_of_total_non_phishing": 0.010867327282326944
        },
        {
          "technique": "T1531 Account Access Removal",
          "event_count": 330,
          "percentage_of_total_non_phishing": 0.010801861455324973
        },
        {
          "technique": "T1566.001 Spearphishing Attachment",
          "event_count": 322,
          "percentage_of_total_non_phishing": 0.010539998147317096
        },
        {
          "technique": "T1021.001 Remote Desktop Protocol",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1021.006 Windows Remote Management",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1596.004 CDNs",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1001 Data Obfuscation",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1596.001 DNS/Passive DNS",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1454 Unknown Technique",
          "event_count": 318,
          "percentage_of_total_non_phishing": 0.010409066493313157
        },
        {
          "technique": "T1192 Spearphishing Link",
          "event_count": 316,
          "percentage_of_total_non_phishing": 0.010343600666311186
        },
        {
          "technique": "T1553.004 Install Root Certificate",
          "event_count": 310,
          "percentage_of_total_non_phishing": 0.010147203185305279
        },
        {
          "technique": "T1562 Impair Defenses",
          "event_count": 309,
          "percentage_of_total_non_phishing": 0.010114470271804293
        },
        {
          "technique": "T1563.002 RDP Hijacking",
          "event_count": 307,
          "percentage_of_total_non_phishing": 0.010049004444802324
        },
        {
          "technique": "T1071.002 File Transfer Protocols",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1055.001 Dynamic-link Library Injection",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1019 System Firmware",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1204.001 Malicious Link",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1059.004 Unix Shell",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1078.004 Cloud Accounts",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1011 Exfiltration Over Other Network Medium",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1218.001 Compiled HTML File",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1476 Unknown Technique",
          "event_count": 306,
          "percentage_of_total_non_phishing": 0.01001627153130134
        },
        {
          "technique": "T1059.002 AppleScript",
          "event_count": 295,
          "percentage_of_total_non_phishing": 0.009656209482790508
        },
        {
          "technique": "T1183 Image File Execution Options Injection",
          "event_count": 288,
          "percentage_of_total_non_phishing": 0.009427079088283614
        },
        {
          "technique": "T1029 Scheduled Transfer",
          "event_count": 288,
          "percentage_of_total_non_phishing": 0.009427079088283614
        },
        {
          "technique": "T1043 Commonly Used Port",
          "event_count": 285,
          "percentage_of_total_non_phishing": 0.00932888034778066
        },
        {
          "technique": "T1563 Remote Service Session Hijacking",
          "event_count": 284,
          "percentage_of_total_non_phishing": 0.009296147434279674
        },
        {
          "technique": "T1415 Unknown Technique",
          "event_count": 282,
          "percentage_of_total_non_phishing": 0.009230681607277705
        },
        {
          "technique": "T1410 Unknown Technique",
          "event_count": 265,
          "percentage_of_total_non_phishing": 0.008674222077760963
        },
        {
          "technique": "T1416 Unknown Technique",
          "event_count": 264,
          "percentage_of_total_non_phishing": 0.00864148916425998
        },
        {
          "technique": "T1046 Network Service Discovery",
          "event_count": 254,
          "percentage_of_total_non_phishing": 0.008314160029250131
        },
        {
          "technique": "T1459 Unknown Technique",
          "event_count": 254,
          "percentage_of_total_non_phishing": 0.008314160029250131
        },
        {
          "technique": "T1212 Exploitation for Credential Access",
          "event_count": 254,
          "percentage_of_total_non_phishing": 0.008314160029250131
        },
        {
          "technique": "T1041 Exfiltration Over C2 Channel",
          "event_count": 249,
          "percentage_of_total_non_phishing": 0.008150495461745207
        },
        {
          "technique": "T1016.001 Internet Connection Discovery",
          "event_count": 246,
          "percentage_of_total_non_phishing": 0.008052296721242254
        },
        {
          "technique": "T1123 Audio Capture",
          "event_count": 243,
          "percentage_of_total_non_phishing": 0.007954097980739299
        },
        {
          "technique": "T1001.003 Protocol or Service Impersonation",
          "event_count": 240,
          "percentage_of_total_non_phishing": 0.007855899240236344
        },
        {
          "technique": "T1138 Application Shimming",
          "event_count": 240,
          "percentage_of_total_non_phishing": 0.007855899240236344
        },
        {
          "technique": "T1017 Application Deployment Software",
          "event_count": 240,
          "percentage_of_total_non_phishing": 0.007855899240236344
        },
        {
          "technique": "T1457 Unknown Technique",
          "event_count": 233,
          "percentage_of_total_non_phishing": 0.007626768845729452
        },
        {
          "technique": "T1158 Hidden Files and Directories",
          "event_count": 228,
          "percentage_of_total_non_phishing": 0.0074631042782245275
        },
        {
          "technique": "T1063 Security Software Discovery",
          "event_count": 227,
          "percentage_of_total_non_phishing": 0.007430371364723543
        },
        {
          "technique": "TA0034 Unknown Technique",
          "event_count": 226,
          "percentage_of_total_non_phishing": 0.007397638451222558
        },
        {
          "technique": "TA0040 Unknown Technique",
          "event_count": 226,
          "percentage_of_total_non_phishing": 0.007397638451222558
        },
        {
          "technique": "T1568.002 Domain Generation Algorithms",
          "event_count": 224,
          "percentage_of_total_non_phishing": 0.007332172624220588
        },
        {
          "technique": "T1491 Defacement",
          "event_count": 216,
          "percentage_of_total_non_phishing": 0.00707030931621271
        },
        {
          "technique": "T1472 Unknown Technique",
          "event_count": 216,
          "percentage_of_total_non_phishing": 0.00707030931621271
        },
        {
          "technique": "T1134 Access Token Manipulation",
          "event_count": 213,
          "percentage_of_total_non_phishing": 0.006972110575709756
        },
        {
          "technique": "TA0010 Unknown Technique",
          "event_count": 210,
          "percentage_of_total_non_phishing": 0.006873911835206802
        },
        {
          "technique": "T1199 Trusted Relationship",
          "event_count": 209,
          "percentage_of_total_non_phishing": 0.0068411789217058165
        },
        {
          "technique": "TA0008 Unknown Technique",
          "event_count": 208,
          "percentage_of_total_non_phishing": 0.006808446008204832
        },
        {
          "technique": "T1512 Unknown Technique",
          "event_count": 208,
          "percentage_of_total_non_phishing": 0.006808446008204832
        },
        {
          "technique": "T1518 Software Discovery",
          "event_count": 205,
          "percentage_of_total_non_phishing": 0.006710247267701878
        },
        {
          "technique": "T1102 Web Service",
          "event_count": 196,
          "percentage_of_total_non_phishing": 0.006415651046193015
        },
        {
          "technique": "T1480 Execution Guardrails",
          "event_count": 193,
          "percentage_of_total_non_phishing": 0.00631745230569006
        },
        {
          "technique": "T1003.005 Cached Domain Credentials",
          "event_count": 180,
          "percentage_of_total_non_phishing": 0.005891924430177258
        },
        {
          "technique": "TA0001 Unknown Technique",
          "event_count": 174,
          "percentage_of_total_non_phishing": 0.00569552694917135
        },
        {
          "technique": "T1505 Server Software Component",
          "event_count": 173,
          "percentage_of_total_non_phishing": 0.005662794035670365
        },
        {
          "technique": "T1107 File Deletion",
          "event_count": 172,
          "percentage_of_total_non_phishing": 0.00563006112216938
        },
        {
          "technique": "T1005 Data from Local System",
          "event_count": 171,
          "percentage_of_total_non_phishing": 0.0055973282086683954
        },
        {
          "technique": "T1423 Unknown Technique",
          "event_count": 168,
          "percentage_of_total_non_phishing": 0.0054991294681654415
        },
        {
          "technique": "T1506 Web Session Cookie",
          "event_count": 168,
          "percentage_of_total_non_phishing": 0.0054991294681654415
        },
        {
          "technique": "T1051 Shared Webroot",
          "event_count": 168,
          "percentage_of_total_non_phishing": 0.0054991294681654415
        },
        {
          "technique": "T1122 Component Object Model Hijacking",
          "event_count": 162,
          "percentage_of_total_non_phishing": 0.005302731987159533
        },
        {
          "technique": "T1179 Hooking",
          "event_count": 161,
          "percentage_of_total_non_phishing": 0.005269999073658548
        },
        {
          "technique": "T1443 Unknown Technique",
          "event_count": 160,
          "percentage_of_total_non_phishing": 0.005237266160157563
        },
        {
          "technique": "T1478 Unknown Technique",
          "event_count": 160,
          "percentage_of_total_non_phishing": 0.005237266160157563
        },
        {
          "technique": "T1081 Credentials in Files",
          "event_count": 158,
          "percentage_of_total_non_phishing": 0.005171800333155593
        },
        {
          "technique": "T1007 System Service Discovery",
          "event_count": 156,
          "percentage_of_total_non_phishing": 0.005106334506153624
        },
        {
          "technique": "T1553.002 Code Signing",
          "event_count": 156,
          "percentage_of_total_non_phishing": 0.005106334506153624
        },
        {
          "technique": "T1036.004 Masquerade Task or Service",
          "event_count": 146,
          "percentage_of_total_non_phishing": 0.0047790053711437765
        },
        {
          "technique": "T1021 Remote Services",
          "event_count": 135,
          "percentage_of_total_non_phishing": 0.004418943322632944
        },
        {
          "technique": "T1560 Archive Collected Data",
          "event_count": 130,
          "percentage_of_total_non_phishing": 0.00425527875512802
        },
        {
          "technique": "T1087 Account Discovery",
          "event_count": 129,
          "percentage_of_total_non_phishing": 0.004222545841627036
        },
        {
          "technique": "T1550 Use Alternate Authentication Material",
          "event_count": 129,
          "percentage_of_total_non_phishing": 0.004222545841627036
        },
        {
          "technique": "T1215 Kernel Modules and Extensions",
          "event_count": 128,
          "percentage_of_total_non_phishing": 0.00418981292812605
        },
        {
          "technique": "TA0037 Unknown Technique",
          "event_count": 126,
          "percentage_of_total_non_phishing": 0.004124347101124081
        },
        {
          "technique": "T1489 Service Stop",
          "event_count": 126,
          "percentage_of_total_non_phishing": 0.004124347101124081
        },
        {
          "technique": "T1583.001 Domains",
          "event_count": 124,
          "percentage_of_total_non_phishing": 0.004058881274122112
        },
        {
          "technique": "T1558 Steal or Forge Kerberos Tickets",
          "event_count": 121,
          "percentage_of_total_non_phishing": 0.003960682533619157
        },
        {
          "technique": "T1450 Unknown Technique",
          "event_count": 120,
          "percentage_of_total_non_phishing": 0.003927949620118172
        },
        {
          "technique": "T1552 Unsecured Credentials",
          "event_count": 120,
          "percentage_of_total_non_phishing": 0.003927949620118172
        },
        {
          "technique": "T1530 Data from Cloud Storage",
          "event_count": 120,
          "percentage_of_total_non_phishing": 0.003927949620118172
        },
        {
          "technique": "T1548 Abuse Elevation Control Mechanism",
          "event_count": 119,
          "percentage_of_total_non_phishing": 0.0038952167066171875
        },
        {
          "technique": "T1569 System Services",
          "event_count": 117,
          "percentage_of_total_non_phishing": 0.003829750879615218
        },
        {
          "technique": "T1049 System Network Connections Discovery",
          "event_count": 116,
          "percentage_of_total_non_phishing": 0.003797017966114233
        },
        {
          "technique": "T1218 System Binary Proxy Execution",
          "event_count": 115,
          "percentage_of_total_non_phishing": 0.0037642850526132484
        },
        {
          "technique": "T1571 Non-Standard Port",
          "event_count": 114,
          "percentage_of_total_non_phishing": 0.0037315521391122638
        },
        {
          "technique": "T1027.002 Software Packing",
          "event_count": 112,
          "percentage_of_total_non_phishing": 0.003666086312110294
        },
        {
          "technique": "T1110.003 Password Spraying",
          "event_count": 111,
          "percentage_of_total_non_phishing": 0.0036333533986093094
        },
        {
          "technique": "T1016 System Network Configuration Discovery",
          "event_count": 111,
          "percentage_of_total_non_phishing": 0.0036333533986093094
        },
        {
          "technique": "T1190 Exploit Public-Facing Application",
          "event_count": 110,
          "percentage_of_total_non_phishing": 0.0036006204851083247
        },
        {
          "technique": "T1427 Unknown Technique",
          "event_count": 110,
          "percentage_of_total_non_phishing": 0.0036006204851083247
        },
        {
          "technique": "T1035 Service Execution",
          "event_count": 110,
          "percentage_of_total_non_phishing": 0.0036006204851083247
        },
        {
          "technique": "T1173 Dynamic Data Exchange",
          "event_count": 108,
          "percentage_of_total_non_phishing": 0.003535154658106355
        },
        {
          "technique": "T1453 Unknown Technique",
          "event_count": 108,
          "percentage_of_total_non_phishing": 0.003535154658106355
        },
        {
          "technique": "T1059.006 Python",
          "event_count": 108,
          "percentage_of_total_non_phishing": 0.003535154658106355
        },
        {
          "technique": "T1572 Protocol Tunneling",
          "event_count": 105,
          "percentage_of_total_non_phishing": 0.003436955917603401
        },
        {
          "technique": "T1205.001 Port Knocking",
          "event_count": 104,
          "percentage_of_total_non_phishing": 0.003404223004102416
        },
        {
          "technique": "T1460 Unknown Technique",
          "event_count": 104,
          "percentage_of_total_non_phishing": 0.003404223004102416
        },
        {
          "technique": "T1080 Taint Shared Content",
          "event_count": 96,
          "percentage_of_total_non_phishing": 0.003142359696094538
        },
        {
          "technique": "T1198 SIP and Trust Provider Hijacking",
          "event_count": 96,
          "percentage_of_total_non_phishing": 0.003142359696094538
        },
        {
          "technique": "T1010 Application Window Discovery",
          "event_count": 90,
          "percentage_of_total_non_phishing": 0.002945962215088629
        },
        {
          "technique": "T1584 Compromise Infrastructure",
          "event_count": 88,
          "percentage_of_total_non_phishing": 0.0028804963880866598
        },
        {
          "technique": "T1110.001 Password Guessing",
          "event_count": 87,
          "percentage_of_total_non_phishing": 0.002847763474585675
        },
        {
          "technique": "T1055.003 Thread Execution Hijacking",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1608 Stage Capabilities",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1020 Automated Exfiltration",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1008 Fallback Channels",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1074 Data Staged",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1587 Develop Capabilities",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1567 Exfiltration Over Web Service",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1585 Establish Accounts",
          "event_count": 84,
          "percentage_of_total_non_phishing": 0.0027495647340827207
        },
        {
          "technique": "T1444 Unknown Technique",
          "event_count": 80,
          "percentage_of_total_non_phishing": 0.0026186330800787817
        },
        {
          "technique": "T1486 Data Encrypted for Impact",
          "event_count": 78,
          "percentage_of_total_non_phishing": 0.002553167253076812
        },
        {
          "technique": "T1496 Resource Hijacking",
          "event_count": 75,
          "percentage_of_total_non_phishing": 0.0024549685125738576
        },
        {
          "technique": "TA0029 Unknown Technique",
          "event_count": 72,
          "percentage_of_total_non_phishing": 0.0023567697720709036
        },
        {
          "technique": "T1502 Parent PID Spoofing",
          "event_count": 72,
          "percentage_of_total_non_phishing": 0.0023567697720709036
        },
        {
          "technique": "T1595.001 Scanning IP Blocks",
          "event_count": 71,
          "percentage_of_total_non_phishing": 0.0023240368585699185
        },
        {
          "technique": "T1595.002 Vulnerability Scanning",
          "event_count": 71,
          "percentage_of_total_non_phishing": 0.0023240368585699185
        },
        {
          "technique": "T1055.013 Process Doppelg\u00e4nging",
          "event_count": 68,
          "percentage_of_total_non_phishing": 0.002225838118066964
        },
        {
          "technique": "T1574 Hijack Execution Flow",
          "event_count": 67,
          "percentage_of_total_non_phishing": 0.0021931052045659795
        },
        {
          "technique": "T1156 Malicious Shell Modification",
          "event_count": 66,
          "percentage_of_total_non_phishing": 0.002160372291064995
        },
        {
          "technique": "T1614 System Location Discovery",
          "event_count": 64,
          "percentage_of_total_non_phishing": 0.002094906464063025
        },
        {
          "technique": "TA0043 Unknown Technique",
          "event_count": 62,
          "percentage_of_total_non_phishing": 0.002029440637061056
        },
        {
          "technique": "TA0030 Unknown Technique",
          "event_count": 62,
          "percentage_of_total_non_phishing": 0.002029440637061056
        },
        {
          "technique": "T1596.005 Scan Databases",
          "event_count": 60,
          "percentage_of_total_non_phishing": 0.001963974810059086
        },
        {
          "technique": "T1586.001 Social Media Accounts",
          "event_count": 60,
          "percentage_of_total_non_phishing": 0.001963974810059086
        },
        {
          "technique": "T1185 Browser Session Hijacking",
          "event_count": 60,
          "percentage_of_total_non_phishing": 0.001963974810059086
        },
        {
          "technique": "T1102.002 Bidirectional Communication",
          "event_count": 56,
          "percentage_of_total_non_phishing": 0.001833043156055147
        },
        {
          "technique": "T1110.004 Credential Stuffing",
          "event_count": 54,
          "percentage_of_total_non_phishing": 0.0017675773290531775
        },
        {
          "technique": "T1091 Replication Through Removable Media",
          "event_count": 54,
          "percentage_of_total_non_phishing": 0.0017675773290531775
        },
        {
          "technique": "T1098 Account Manipulation",
          "event_count": 52,
          "percentage_of_total_non_phishing": 0.001702111502051208
        },
        {
          "technique": "T1546 Event Triggered Execution",
          "event_count": 48,
          "percentage_of_total_non_phishing": 0.001571179848047269
        },
        {
          "technique": "T1583.004 Server",
          "event_count": 48,
          "percentage_of_total_non_phishing": 0.001571179848047269
        },
        {
          "technique": "T1605 Unknown Technique",
          "event_count": 48,
          "percentage_of_total_non_phishing": 0.001571179848047269
        },
        {
          "technique": "T1055.012 Process Hollowing",
          "event_count": 44,
          "percentage_of_total_non_phishing": 0.0014402481940433299
        },
        {
          "technique": "T1147 Hidden Users",
          "event_count": 41,
          "percentage_of_total_non_phishing": 0.0013420494535403755
        },
        {
          "technique": "T1529 System Shutdown/Reboot",
          "event_count": 40,
          "percentage_of_total_non_phishing": 0.0013093165400393908
        },
        {
          "technique": "T1490 Inhibit System Recovery",
          "event_count": 40,
          "percentage_of_total_non_phishing": 0.0013093165400393908
        },
        {
          "technique": "T1414 Unknown Technique",
          "event_count": 40,
          "percentage_of_total_non_phishing": 0.0013093165400393908
        },
        {
          "technique": "T1510 Unknown Technique",
          "event_count": 40,
          "percentage_of_total_non_phishing": 0.0013093165400393908
        },
        {
          "technique": "T1100 Web Shell",
          "event_count": 37,
          "percentage_of_total_non_phishing": 0.0012111177995364365
        },
        {
          "technique": "T1078 Valid Accounts",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1588 Obtain Capabilities",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1071.003 Mail Protocols",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1184 SSH Hijacking",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1547.001 Registry Run Keys / Startup Folder",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1111 Multi-Factor Authentication Interception",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1555.003 Credentials from Web Browsers",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1497.001 System Checks",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1059.005 Visual Basic",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1552.001 Credentials In Files",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1132.001 Standard Encoding",
          "event_count": 36,
          "percentage_of_total_non_phishing": 0.0011783848860354518
        },
        {
          "technique": "T1584.005 Botnet",
          "event_count": 34,
          "percentage_of_total_non_phishing": 0.001112919059033482
        },
        {
          "technique": "T1098.002 Additional Email Delegate Permissions",
          "event_count": 32,
          "percentage_of_total_non_phishing": 0.0010474532320315125
        },
        {
          "technique": "T1037.003 Network Logon Script",
          "event_count": 32,
          "percentage_of_total_non_phishing": 0.0010474532320315125
        },
        {
          "technique": "T1037 Boot or Logon Initialization Scripts",
          "event_count": 32,
          "percentage_of_total_non_phishing": 0.0010474532320315125
        },
        {
          "technique": "T1590 Gather Victim Network Information",
          "event_count": 28,
          "percentage_of_total_non_phishing": 0.0009165215780275735
        },
        {
          "technique": "T1539 Steal Web Session Cookie",
          "event_count": 28,
          "percentage_of_total_non_phishing": 0.0009165215780275735
        },
        {
          "technique": "T1113 Screen Capture",
          "event_count": 27,
          "percentage_of_total_non_phishing": 0.0008837886645265887
        },
        {
          "technique": "T1072 Software Deployment Tools",
          "event_count": 26,
          "percentage_of_total_non_phishing": 0.000851055751025604
        },
        {
          "technique": "T1021.004 SSH",
          "event_count": 25,
          "percentage_of_total_non_phishing": 0.0008183228375246192
        },
        {
          "technique": "T1546.015 Component Object Model Hijacking",
          "event_count": 24,
          "percentage_of_total_non_phishing": 0.0007855899240236345
        },
        {
          "technique": "T1588.004 Digital Certificates",
          "event_count": 24,
          "percentage_of_total_non_phishing": 0.0007855899240236345
        },
        {
          "technique": "T1211 Exploitation for Defense Evasion",
          "event_count": 24,
          "percentage_of_total_non_phishing": 0.0007855899240236345
        },
        {
          "technique": "T1048.002 Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",
          "event_count": 24,
          "percentage_of_total_non_phishing": 0.0007855899240236345
        },
        {
          "technique": "T1434 Unknown Technique",
          "event_count": 24,
          "percentage_of_total_non_phishing": 0.0007855899240236345
        },
        {
          "technique": "T1562.001 Disable or Modify Tools",
          "event_count": 20,
          "percentage_of_total_non_phishing": 0.0006546582700196954
        },
        {
          "technique": "T1399 Unknown Technique",
          "event_count": 18,
          "percentage_of_total_non_phishing": 0.0005891924430177259
        },
        {
          "technique": "T1491.001 Internal Defacement",
          "event_count": 18,
          "percentage_of_total_non_phishing": 0.0005891924430177259
        },
        {
          "technique": "T1448 Unknown Technique",
          "event_count": 17,
          "percentage_of_total_non_phishing": 0.000556459529516741
        },
        {
          "technique": "T1573.002 Asymmetric Cryptography",
          "event_count": 16,
          "percentage_of_total_non_phishing": 0.0005237266160157563
        },
        {
          "technique": "T1589 Gather Victim Identity Information",
          "event_count": 16,
          "percentage_of_total_non_phishing": 0.0005237266160157563
        },
        {
          "technique": "T1528 Steal Application Access Token",
          "event_count": 16,
          "percentage_of_total_non_phishing": 0.0005237266160157563
        },
        {
          "technique": "T1591 Gather Victim Org Information",
          "event_count": 16,
          "percentage_of_total_non_phishing": 0.0005237266160157563
        },
        {
          "technique": "T1118 InstallUtil",
          "event_count": 16,
          "percentage_of_total_non_phishing": 0.0005237266160157563
        },
        {
          "technique": "T1217 Browser Information Discovery",
          "event_count": 14,
          "percentage_of_total_non_phishing": 0.00045826078901378675
        },
        {
          "technique": "T1503 Credentials from Web Browsers",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1504 PowerShell Profile",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1585.001 Social Media Accounts",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1056.004 Credential API Hooking",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1557 Adversary-in-the-Middle",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1038 DLL Search Order Hijacking",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1003.004 LSA Secrets",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1534 Internal Spearphishing",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1590.002 DNS",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1562.004 Disable or Modify System Firewall",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1048.003 Exfiltration Over Unencrypted Non-C2 Protocol",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1568.001 Fast Flux DNS",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1578.003 Delete Cloud Instance",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1404 Unknown Technique",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1518.001 Security Software Discovery",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1076 Remote Desktop Protocol",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1069.001 Local Groups",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1222.002 Linux and Mac File and Directory Permissions Modification",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1565 Data Manipulation",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1583.002 DNS Server",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1574.008 Path Interception by Search Order Hijacking",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1003.002 Security Account Manager",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1036.005 Match Legitimate Name or Location",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1003.001 LSASS Memory",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1078.002 Domain Accounts",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1204.002 Malicious File",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1003.003 NTDS",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1078.003 Local Accounts",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1412 Unknown Technique",
          "event_count": 12,
          "percentage_of_total_non_phishing": 0.00039279496201181723
        },
        {
          "technique": "T1590.005 IP Addresses",
          "event_count": 10,
          "percentage_of_total_non_phishing": 0.0003273291350098477
        },
        {
          "technique": "T1590.004 Network Topology",
          "event_count": 10,
          "percentage_of_total_non_phishing": 0.0003273291350098477
        },
        {
          "technique": "T1195 Supply Chain Compromise",
          "event_count": 9,
          "percentage_of_total_non_phishing": 0.00029459622150886295
        },
        {
          "technique": "T1464 Unknown Technique",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1009 Binary Padding",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1574.002 DLL Side-Loading",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1070.006 Timestomp",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1600 Weaken Encryption",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1483 Domain Generation Algorithms",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1055.014 VDSO Hijacking",
          "event_count": 8,
          "percentage_of_total_non_phishing": 0.00026186330800787814
        },
        {
          "technique": "T1070.003 Clear Command History",
          "event_count": 6,
          "percentage_of_total_non_phishing": 0.00019639748100590862
        },
        {
          "technique": "T1067 Bootkit",
          "event_count": 6,
          "percentage_of_total_non_phishing": 0.00019639748100590862
        },
        {
          "technique": "T1120 Peripheral Device Discovery",
          "event_count": 6,
          "percentage_of_total_non_phishing": 0.00019639748100590862
        },
        {
          "technique": "T1054 Indicator Blocking",
          "event_count": 6,
          "percentage_of_total_non_phishing": 0.00019639748100590862
        },
        {
          "technique": "T1429 Unknown Technique",
          "event_count": 5,
          "percentage_of_total_non_phishing": 0.00016366456750492386
        },
        {
          "technique": "T1059.003 Windows Command Shell",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1055.008 Ptrace System Calls",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1553.006 Code Signing Policy Modification",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1027.004 Compile After Delivery",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1055.011 Extra Window Memory Injection",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1027.001 Binary Padding",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1036.001 Invalid Code Signature",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1027.003 Steganography",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1027.005 Indicator Removal from Tools",
          "event_count": 4,
          "percentage_of_total_non_phishing": 0.00013093165400393907
        },
        {
          "technique": "T1181 Extra Window Memory Injection",
          "event_count": 2,
          "percentage_of_total_non_phishing": 6.546582700196953e-05
        },
        {
          "technique": "T1422 Unknown Technique",
          "event_count": 2,
          "percentage_of_total_non_phishing": 6.546582700196953e-05
        },
        {
          "technique": "T1408 Unknown Technique",
          "event_count": 2,
          "percentage_of_total_non_phishing": 6.546582700196953e-05
        },
        {
          "technique": "T1213 Data from Information Repositories",
          "event_count": 2,
          "percentage_of_total_non_phishing": 6.546582700196953e-05
        },
        {
          "technique": "T1421 Unknown Technique",
          "event_count": 2,
          "percentage_of_total_non_phishing": 6.546582700196953e-05
        },
        {
          "technique": "TA0033 Unknown Technique",
          "event_count": 1,
          "percentage_of_total_non_phishing": 3.273291350098477e-05
        },
        {
          "technique": "T1516 Unknown Technique",
          "event_count": 1,
          "percentage_of_total_non_phishing": 3.273291350098477e-05
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 666,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 320,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 320 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify the set of IP addresses that have conducted at least one phishing attack, then determine what other attack techniques those same IPs have used (excluding phishing) and quantify how frequently each other technique occurs as a percentage of all their non-phishing attacks (or, alternatively, as a percentage of phishing-capable IPs\u2014see Filters/assumptions).\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"IP (properties: address, botnet, pulse_ids)\",\n      \"Country (properties: name)\",\n      \"ASN (properties: number)\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(:Country)\",\n      \"(:IP)-[:FROM]->(:Country) (optional enrichment for IP origin context)\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN) (optional enrichment for network ownership context)\"\n    ]\n  },\n  \"FILTERS\": {\n    \"PRIMARY_COHORT_DEFINITION\": \"Select IPs that have at least one ATTACKS relationship where technique equals 'phishing' (case/normalization rules should be applied consistently, e.g., lowercase comparison).\",\n    \"SECONDARY_EVENT_SCOPE\": \"For those selected IPs, consider their ATTACKS relationships where technique is not 'phishing' (exclude null/empty techniques if present, or group them as 'unknown' if desired).\",\n    \"PERCENTAGE_DENOMINATOR_ASSUMPTION\": \"Default: percentage is computed over the total count of non-phishing ATTACKS events made by phishing-capable IPs (i.e., each ATTACKS relationship counts as one event). If instead the user wants 'percentage of IPs that also used technique X', that changes the denominator to the number of distinct IPs in the phishing cohort; this should be confirmed.\",\n    \"TIME_WINDOW\": \"No time constraints provided; include all data unless the user specifies documented_create_date/documented_modified_date boundaries.\",\n    \"OPTIONAL_DIMENSIONS\": \"protocol/technology/industry/pulse_id can be included for breakdowns, but are not required by the question.\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"STRUCTURE\": \"A list/table grouped by other technique with: technique name, count of occurrences among qualifying events, and percentage per the chosen denominator.\",\n    \"SORTING\": \"Sort by percentage (descending), with counts as a secondary sort key.\",\n    \"OPTIONAL_ADDITIONS\": \"Optionally include total phishing cohort size (distinct IPs), total non-phishing event count for that cohort, and optionally top associated ASNs or FROM countries for context.\"\n  },\n  \"SUGGESTED_APPROACH\": \"1) Build the cohort of distinct IP nodes that have at least one ATTACKS event labeled as phishing. 2) Traverse from that cohort to all their ATTACKS events and filter to techniques other than phishing. 3) Aggregate by technique to get event counts. 4) Compute percentages using the selected denominator (default: total non-phishing ATTACKS event count within the cohort). 5) Return the aggregated technique distribution, sorted by highest percentage.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"From IPs that have at least one ATTACKS event with technique 'phishing', aggregate their non-phishing ATTACKS events by technique and return each technique\u2019s event count and percentage of the cohort\u2019s total non-phishing attacks.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "From IPs that have at least one ATTACKS event with technique 'phishing', aggregate their non-phishing ATTACKS events by technique and return each technique\u2019s event count and percentage of the cohort\u2019s total non-phishing attacks."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort\nMATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip IN cohort AND a.technique <> 'phishing'\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, sum(event_count) AS total_non_phishing\nUNWIND rows AS row\nWITH row.technique AS technique, row.event_count AS event_count, total_non_phishing\nRETURN\n  technique,\n  event_count,\n  (toFloat(event_count) * 100.0) / CASE WHEN total_non_phishing = 0 THEN 1 ELSE total_non_phishing END AS percentage_of_total_non_phishing\nORDER BY event_count DESC"
          ],
          "trace": [
            {
              "subproblem": "From IPs that have at least one ATTACKS event with technique 'phishing', aggregate their non-phishing ATTACKS events by technique and return each technique\u2019s event count and percentage of the cohort\u2019s total non-phishing attacks.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort\nMATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip IN cohort AND a.technique <> 'phishing'\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, sum(event_count) AS total_non_phishing\nUNWIND rows AS row\nWITH row.technique AS technique, row.event_count AS event_count, total_non_phishing\nRETURN\n  technique,\n  event_count,\n  (toFloat(event_count) * 100.0) / CASE WHEN total_non_phishing = 0 THEN 1 ELSE total_non_phishing END AS percentage_of_total_non_phishing\nORDER BY event_count DESC",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "'phishing'",
                      "value": "T1566 Phishing"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technique": "T1566 Phishing",
                      "event_count": 2863569,
                      "percentage_of_total_non_phishing": 93.73295638110146
                    },
                    {
                      "technique": "T1595 Active Scanning",
                      "event_count": 19712,
                      "percentage_of_total_non_phishing": 0.6452311909314118
                    },
                    {
                      "technique": "unknown",
                      "event_count": 18852,
                      "percentage_of_total_non_phishing": 0.6170808853205649
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[p:ATTACKS]->(:Country)\nWHERE p.technique = 'T1566 Phishing'\nWITH collect(DISTINCT ip) AS cohort\nMATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip IN cohort AND a.technique <> 'phishing'\nWITH a.technique AS technique, count(*) AS event_count\nWITH collect({technique: technique, event_count: event_count}) AS rows, sum(event_count) AS total_non_phishing\nUNWIND rows AS row\nWITH row.technique AS technique, row.event_count AS event_count, total_non_phishing\nRETURN\n  technique,\n  event_count,\n  (toFloat(event_count) * 100.0) / CASE WHEN total_non_phishing = 0 THEN 1 ELSE total_non_phishing END AS percentage_of_total_non_phishing\nORDER BY event_count DESC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technique": "T1566 Phishing",
              "event_count": 2863569,
              "percentage_of_total_non_phishing": 93.73295638110146
            },
            {
              "technique": "T1595 Active Scanning",
              "event_count": 19712,
              "percentage_of_total_non_phishing": 0.6452311909314118
            },
            {
              "technique": "unknown",
              "event_count": 18852,
              "percentage_of_total_non_phishing": 0.6170808853205649
            }
          ]
        },
        "explanation": {
          "text": "It finds all IPs that have launched **T1566 Phishing** attacks, then for that same IP cohort counts and ranks the **other ATTACKS techniques** they used (excluding \u201cphishing\u201d), returning each technique\u2019s event count and its percentage of all non\u2011phishing events."
        }
      },
      "token_usage": {
        "input": 1706,
        "output": 1660,
        "total": 3366
      },
      "duration_seconds": 329.134,
      "started_at": "2026-02-20T05:31:14.937205+00:00",
      "ended_at": "2026-02-20T05:36:44.071664+00:00",
      "metadata": {
        "time": "2026-02-20T05:36:44.048829+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 3,
      "category": "complex",
      "prompt": "Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.protocol AS protocol, a.technique AS technique, a.industry AS industry, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, protocol, technique, industry, year_month, collect(DISTINCT asn) AS asns, count(*) AS attacks\nWHERE size(asns) > 1\nRETURN country, protocol, technique, industry, year_month, asns, size(asns) AS asn_count\nORDER BY asn_count DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"China\"})\nWITH collect(DISTINCT ip) AS ips\nWITH ips, size(ips) AS distinct_attacker_ip_count\nUNWIND ips AS ip1\nMATCH (ip1)-[a:ATTACKS]->(target:Country)\nWITH distinct_attacker_ip_count, ips, target.name AS target_country, count(a) AS attack_count\nORDER BY attack_count DESC\nWITH distinct_attacker_ip_count, ips, collect({country: target_country, attacks: attack_count})[0..5] AS top_5_target_countries\nUNWIND ips AS ip2\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWITH distinct_attacker_ip_count, top_5_target_countries, a2.technique AS technique, count(a2) AS technique_count\nORDER BY technique_count DESC\nWITH distinct_attacker_ip_count, top_5_target_countries, collect({technique: technique, attacks: technique_count})[0..3] AS top_3_techniques\nRETURN distinct_attacker_ip_count, top_5_target_countries, top_3_techniques",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1847,
        "output": 2109,
        "total": 3956
      },
      "duration_seconds": 400.112,
      "started_at": "2026-02-20T05:36:44.075037+00:00",
      "ended_at": "2026-02-20T05:43:24.187081+00:00",
      "metadata": {
        "time": "2026-02-20T05:43:23.680929+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 4,
      "category": "decomposable",
      "prompt": "Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.",
      "expected_cypher": "CALL {\n    MATCH (ip:IP)-[:FROM]->(country:Country)\n    WHERE country.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(:Country)\n    RETURN count(DISTINCT ip) AS chinaAttackingIPCount\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(originCountry:Country)\n    WHERE originCountry.name = 'China'\n    MATCH (ip)-[:ATTACKS]->(targetCountry:Country)\n    WITH targetCountry.name AS countryName, count(DISTINCT ip) AS attackCount\n    ORDER BY attackCount DESC\n    LIMIT 5\n    RETURN collect({countryName: countryName, attackCount: attackCount}) AS top5AttackedCountries\n}\nCALL {\n    MATCH (ip:IP)-[:FROM]->(c:Country {name: 'China'})\n    MATCH (ip)-[a:ATTACKS]->()\n    WITH a.technique AS technique, count(a.technique) AS count\n    ORDER BY count DESC\n    LIMIT 3\n    RETURN collect(technique) AS top3Techniques\n}\nRETURN chinaAttackingIPCount, top5AttackedCountries, top3Techniques",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(origin:Country)\nWHERE origin.name = 'China'\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS attacker_ip_count\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWITH attacker_ip_count, ips, target.name AS target_country, count(a) AS attack_events\nORDER BY attack_events DESC\nLIMIT 5\nWITH attacker_ip_count, ips, collect({country: target_country, attack_events: attack_events}) AS top_target_countries\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique IS NOT NULL AND a.technique <> 'unknown'\nWITH attacker_ip_count, top_target_countries, a.technique AS technique, count(a) AS event_count\nORDER BY event_count DESC\nLIMIT 3\nWITH attacker_ip_count, top_target_countries, collect({technique: technique, event_count: event_count}) AS top_techniques\nRETURN attacker_ip_count, top_target_countries, top_techniques",
      "response": [
        {
          "attacker_ip_count": 2790,
          "top_target_countries": [
            {
              "attack_events": 43430,
              "country": "Germany"
            },
            {
              "attack_events": 38573,
              "country": "United States of America"
            },
            {
              "attack_events": 36447,
              "country": "France"
            },
            {
              "attack_events": 36047,
              "country": "Poland"
            },
            {
              "attack_events": 35697,
              "country": "Canada"
            }
          ],
          "top_techniques": [
            {
              "technique": "T1566 Phishing",
              "event_count": 533403
            },
            {
              "technique": "T1110 Brute Force",
              "event_count": 8224
            },
            {
              "technique": "T1595 Active Scanning",
              "event_count": 7586
            }
          ]
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 865,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Summarize malicious activity originating from China by quantifying how many unique attacker IPs are involved, identifying which target countries are attacked most often, and determining the most frequently used attack techniques across all those attacks.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids}) as the attacker source\",\n      \"(:Country {name}) as both the source country (China) and the attacked/target countries\",\n      \"(:ASN {number}) is available for attribution context but not required for the requested outputs\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(:IP)-[:FROM]->(:Country) to identify attacker IPs whose origin country is China\",\n      \"(:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(:Country) to count attacks, group by target country, and aggregate techniques\",\n      \"(:IP)-[:BELONGS_TO]->(:ASN) optional (not requested in output, but could be used later to add ASN rollups)\"\n    ],\n    \"KEY_PROPERTIES_USED\": [\n      \"Country.name (must equal 'China' for the origin filter; also used for target country groupings)\",\n      \"ATTACKS.technique (used to compute top techniques)\",\n      \"IP.address (used to count distinct attacking IPs)\"\n    ]\n  },\n  \"FILTERS\": [\n    \"Only include attacker IP nodes that have a (:IP)-[:FROM]->(:Country) relationship where Country.name = 'China'.\",\n    \"Only count attacks represented by (:IP)-[:ATTACKS]->(:Country) relationships where the attacking IP satisfies the China-origin condition.\",\n    \"No time window is specified; include all ATTACKS records available unless the dataset requires excluding null/empty values (e.g., ignore ATTACKS entries with missing technique when computing top techniques).\"\n  ],\n  \"OUTPUT_FORMAT\": \"Return a single report-like result containing: (1) total_distinct_attacking_ips (integer), (2) top_5_countries_attacked as a ranked list of {country, attack_count} sorted by attack_count descending, and (3) top_3_attack_techniques_overall as a ranked list of {technique, attack_count} sorted by attack_count descending. Counts should reflect the number of ATTACKS relationships (events), not distinct IPs, unless otherwise specified.\",\n  \"SUGGESTED_APPROACH\": \"First, identify the set of attacker IPs whose origin country is China via the FROM relationship. From that constrained IP set, traverse all ATTACKS relationships to target Country nodes. Compute three aggregations over the resulting attack-event set: (a) count distinct attacker IP addresses, (b) group attack events by target Country.name and count events to rank the top 5 target countries, and (c) group attack events by ATTACKS.technique and count events to rank the top 3 techniques. Package these aggregations into a single combined response structure.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"From all IPs whose origin country is China, count distinct attacker IPs, find the top 5 target countries by number of ATTACKS events, and find the top 3 ATTACKS.technique values overall by event count, returning the results as a single consolidated report.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "From all IPs whose origin country is China, count distinct attacker IPs, find the top 5 target countries by number of ATTACKS events, and find the top 3 ATTACKS.technique values overall by event count, returning the results as a single consolidated report."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(origin:Country)\nWHERE origin.name = 'China'\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS attacker_ip_count\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWITH attacker_ip_count, ips, target.name AS target_country, count(a) AS attack_events\nORDER BY attack_events DESC\nLIMIT 5\nWITH attacker_ip_count, ips, collect({country: target_country, attack_events: attack_events}) AS top_target_countries\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique IS NOT NULL AND a.technique <> 'unknown'\nWITH attacker_ip_count, top_target_countries, a.technique AS technique, count(a) AS event_count\nORDER BY event_count DESC\nLIMIT 3\nWITH attacker_ip_count, top_target_countries, collect({technique: technique, event_count: event_count}) AS top_techniques\nRETURN attacker_ip_count, top_target_countries, top_techniques"
          ],
          "trace": [
            {
              "subproblem": "From all IPs whose origin country is China, count distinct attacker IPs, find the top 5 target countries by number of ATTACKS events, and find the top 3 ATTACKS.technique values overall by event count, returning the results as a single consolidated report.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(origin:Country)\nWHERE origin.name = 'China'\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS attacker_ip_count\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWITH attacker_ip_count, ips, target.name AS target_country, count(a) AS attack_events\nORDER BY attack_events DESC\nLIMIT 5\nWITH attacker_ip_count, ips, collect({country: target_country, attack_events: attack_events}) AS top_target_countries\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique IS NOT NULL AND a.technique <> 'unknown'\nWITH attacker_ip_count, top_target_countries, a.technique AS technique, count(a) AS event_count\nORDER BY event_count DESC\nLIMIT 3\nWITH attacker_ip_count, top_target_countries, collect({technique: technique, event_count: event_count}) AS top_techniques\nRETURN attacker_ip_count, top_target_countries, top_techniques",
                  "matched_pairs": [
                    {
                      "kind": "node",
                      "label": "Country",
                      "property": "name",
                      "original": "China",
                      "value": "China"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "attacker_ip_count": 2790,
                      "top_target_countries": [
                        {
                          "attack_events": 43430,
                          "country": "Germany"
                        },
                        {
                          "attack_events": 38573,
                          "country": "United States of America"
                        },
                        {
                          "attack_events": 36447,
                          "country": "France"
                        },
                        {
                          "attack_events": 36047,
                          "country": "Poland"
                        },
                        {
                          "attack_events": 35697,
                          "country": "Canada"
                        }
                      ],
                      "top_techniques": [
                        {
                          "technique": "T1566 Phishing",
                          "event_count": 533403
                        },
                        {
                          "technique": "T1110 Brute Force",
                          "event_count": 8224
                        },
                        {
                          "technique": "T1595 Active Scanning",
                          "event_count": 7586
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(origin:Country)\nWHERE origin.name = 'China'\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS attacker_ip_count\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(target:Country)\nWITH attacker_ip_count, ips, target.name AS target_country, count(a) AS attack_events\nORDER BY attack_events DESC\nLIMIT 5\nWITH attacker_ip_count, ips, collect({country: target_country, attack_events: attack_events}) AS top_target_countries\nUNWIND ips AS ip\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWHERE a.technique IS NOT NULL AND a.technique <> 'unknown'\nWITH attacker_ip_count, top_target_countries, a.technique AS technique, count(a) AS event_count\nORDER BY event_count DESC\nLIMIT 3\nWITH attacker_ip_count, top_target_countries, collect({technique: technique, event_count: event_count}) AS top_techniques\nRETURN attacker_ip_count, top_target_countries, top_techniques"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "attacker_ip_count": 2790,
              "top_target_countries": [
                {
                  "attack_events": 43430,
                  "country": "Germany"
                },
                {
                  "attack_events": 38573,
                  "country": "United States of America"
                },
                {
                  "attack_events": 36447,
                  "country": "France"
                },
                {
                  "attack_events": 36047,
                  "country": "Poland"
                },
                {
                  "attack_events": 35697,
                  "country": "Canada"
                }
              ],
              "top_techniques": [
                {
                  "technique": "T1566 Phishing",
                  "event_count": 533403
                },
                {
                  "technique": "T1110 Brute Force",
                  "event_count": 8224
                },
                {
                  "technique": "T1595 Active Scanning",
                  "event_count": 7586
                }
              ]
            }
          ]
        },
        "explanation": {
          "text": "It finds all distinct IPs originating from China, counts them, then returns that attacker IP count along with the top 5 targeted countries by number of ATTACKS events and the top 3 non-\u201cunknown\u201d attack techniques by event count from those IPs."
        }
      },
      "token_usage": {
        "input": 1820,
        "output": 1948,
        "total": 3768
      },
      "duration_seconds": 44.401,
      "started_at": "2026-02-20T05:43:24.187781+00:00",
      "ended_at": "2026-02-20T05:44:08.588762+00:00",
      "metadata": {
        "time": "2026-02-20T05:44:08.575871+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 5,
      "category": "multi-subquery",
      "prompt": "For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.",
      "expected_cypher": "CALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  RETURN count(DISTINCT ip) AS distinctIPs\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[:ATTACKS]->(:Country)\n  RETURN count(*) AS totalAttacks\n}\nCALL {\n  MATCH (ip:IP)-[:FROM]->(src:Country {name:'Russia'})\n  MATCH (ip)-[a:ATTACKS]->(:Country)\n  WITH a.industry AS industry, count(*) AS attacks\n  ORDER BY attacks DESC\n  LIMIT 5\n  RETURN collect({industry: industry, attacks: attacks}) AS topIndustries\n}\nRETURN distinctIPs, totalAttacks, topIndustries",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count\nUNWIND ips AS ip2\nOPTIONAL MATCH (ip2)-[a:ATTACKS]->(:Country)\nWITH distinct_ip_count, [x IN collect(a) WHERE x IS NOT NULL] AS attacks\nWITH distinct_ip_count, size(attacks) AS total_attacks, CASE WHEN size(attacks) = 0 THEN [null] ELSE attacks END AS attacks2\nUNWIND attacks2 AS a2\nWITH distinct_ip_count, total_attacks, a2.industry AS industry, count(a2) AS industry_count\nORDER BY industry_count DESC\nWITH distinct_ip_count, total_attacks, [x IN collect({industry: industry, attack_count: industry_count}) WHERE x.industry IS NOT NULL][0..5] AS top_5_industries\nRETURN distinct_ip_count AS distinct_ips, total_attacks AS total_attacks, top_5_industries AS top_5_industries",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 800,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Quantify activity originating from Russian IPs by (1) counting how many distinct IP addresses are from Russia, (2) counting how many total attack events those IPs carried out, and (3) identifying the top 5 targeted industries based on those attacks.\",\n  \"KEY_ENTITIES\": \"Relevant nodes: IP (address, botnet, pulse_ids), Country (name). Relevant relationships: IP-[:FROM]->Country to determine that an IP is from Russia; IP-[:ATTACKS]->Country to represent individual attack events, using relationship properties (industry, technique, protocol, technology, pulse_id, documented_create_date, documented_modified_date) for aggregation and ranking. ASN via IP-[:BELONGS_TO]->ASN is not required unless additional breakdown/validation is desired.\",\n  \"FILTERS\": \"Include only IP nodes that are geolocated to Russia via (IP)-[:FROM]->(Country) where Country.name matches \\\"Russia\\\" (optionally also handle common variants like \\\"Russian Federation\\\" if present in the data). For those Russian IPs, consider all outgoing ATTACKS relationships as attack events. No time window, protocol/technique constraints, or botnet constraints were specified.\",\n  \"OUTPUT_FORMAT\": \"Return a single result containing: distinct_ip_count (integer), total_attack_count (integer), and top_targeted_industries (an ordered list of up to 5 items). Each industry item should include industry name/value and its attack_count, sorted by attack_count descending (and a deterministic tiebreaker such as industry name if needed).\",\n  \"SUGGESTED_APPROACH\": \"First identify the set of IPs whose origin country is Russia using the FROM relationship. Then aggregate over all ATTACKS relationships emitted by those IPs: (a) count distinct IPs, (b) count total ATTACKS relationships as total attacks, and (c) group attacks by the ATTACKS.industry property to compute counts per industry, sort descending, and take the top 5. Assemble these aggregates into one combined response.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Using IPs that originate from Russia (via IP->FROM->Country{name=\\\"Russia\\\"}), compute the number of distinct IPs, the total number of ATTACKS relationships from those IPs, and the top 5 ATTACKS.industry values ranked by attack count, returning counts plus the ordered top-5 industry list.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Using IPs that originate from Russia (via IP->FROM->Country{name=\"Russia\"}), compute the number of distinct IPs, the total number of ATTACKS relationships from those IPs, and the top 5 ATTACKS.industry values ranked by attack count, returning counts plus the ordered top-5 industry list."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count\nUNWIND ips AS ip2\nOPTIONAL MATCH (ip2)-[a:ATTACKS]->(:Country)\nWITH distinct_ip_count, [x IN collect(a) WHERE x IS NOT NULL] AS attacks\nWITH distinct_ip_count, size(attacks) AS total_attacks, CASE WHEN size(attacks) = 0 THEN [null] ELSE attacks END AS attacks2\nUNWIND attacks2 AS a2\nWITH distinct_ip_count, total_attacks, a2.industry AS industry, count(a2) AS industry_count\nORDER BY industry_count DESC\nWITH distinct_ip_count, total_attacks, [x IN collect({industry: industry, attack_count: industry_count}) WHERE x.industry IS NOT NULL][0..5] AS top_5_industries\nRETURN distinct_ip_count AS distinct_ips, total_attacks AS total_attacks, top_5_industries AS top_5_industries"
          ],
          "trace": [
            {
              "subproblem": "Using IPs that originate from Russia (via IP->FROM->Country{name=\"Russia\"}), compute the number of distinct IPs, the total number of ATTACKS relationships from those IPs, and the top 5 ATTACKS.industry values ranked by attack count, returning counts plus the ordered top-5 industry list.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count\nUNWIND ips AS ip2\nOPTIONAL MATCH (ip2)-[a:ATTACKS]->(:Country)\nWITH distinct_ip_count, [x IN collect(a) WHERE x IS NOT NULL] AS attacks\nWITH distinct_ip_count, size(attacks) AS total_attacks, CASE WHEN size(attacks) = 0 THEN [null] ELSE attacks END AS attacks2\nUNWIND attacks2 AS a2\nWITH distinct_ip_count, total_attacks, a2.industry AS industry, count(a2) AS industry_count\nORDER BY industry_count DESC\nWITH distinct_ip_count, total_attacks, [x IN collect({industry: industry, attack_count: industry_count}) WHERE x.industry IS NOT NULL][0..5] AS top_5_industries\nRETURN distinct_ip_count AS distinct_ips, total_attacks AS total_attacks, top_5_industries AS top_5_industries",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:FROM]->(:Country {name: \"Russia\"})\nWITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count\nUNWIND ips AS ip2\nOPTIONAL MATCH (ip2)-[a:ATTACKS]->(:Country)\nWITH distinct_ip_count, [x IN collect(a) WHERE x IS NOT NULL] AS attacks\nWITH distinct_ip_count, size(attacks) AS total_attacks, CASE WHEN size(attacks) = 0 THEN [null] ELSE attacks END AS attacks2\nUNWIND attacks2 AS a2\nWITH distinct_ip_count, total_attacks, a2.industry AS industry, count(a2) AS industry_count\nORDER BY industry_count DESC\nWITH distinct_ip_count, total_attacks, [x IN collect({industry: industry, attack_count: industry_count}) WHERE x.industry IS NOT NULL][0..5] AS top_5_industries\nRETURN distinct_ip_count AS distinct_ips, total_attacks AS total_attacks, top_5_industries AS top_5_industries"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "It finds all distinct IPs whose `:FROM` country is Russia, counts them and their outgoing `:ATTACKS` relationships to any country, then returns the total attack count and the top 5 targeted industries by attack frequency."
        }
      },
      "token_usage": {
        "input": 1808,
        "output": 3137,
        "total": 4945
      },
      "duration_seconds": 50.714,
      "started_at": "2026-02-20T05:44:08.589446+00:00",
      "ended_at": "2026-02-20T05:44:59.303706+00:00",
      "metadata": {
        "time": "2026-02-20T05:44:59.291234+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 6,
      "category": "aggregation",
      "prompt": "Which ASN has attacked the most distinct countries?",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN), (ip)-[:ATTACKS]->(c:Country)\nWITH asn.number AS asn, count(DISTINCT c.name) AS countries\nORDER BY countries DESC\nLIMIT 1\nRETURN asn, countries",
      "agent_cypher": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(country:Country)\nWITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count\nWITH max(distinct_country_count) AS max_count, collect({asn_number: asn_number, distinct_country_count: distinct_country_count}) AS rows\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.distinct_country_count = max_count\nRETURN row.asn_number AS asn_number, row.distinct_country_count AS distinct_country_count\nORDER BY asn_number",
      "response": [
        {
          "asn_number": "AS57523 chang way technologies co. limited",
          "distinct_country_count": 64
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 480,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which Autonomous System Number (ASN) is associated with IPs that have attacked the widest geographic spread, measured by the highest number of distinct target countries attacked.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:ASN {number})\",\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\"\n    ],\n    \"NOTES\": [\n      \"The query should attribute attacks to an ASN via the attacking IP\u2019s BELONGS_TO relationship.\",\n      \"The IP\u2019s :FROM relationship to a Country exists but is not required to answer \u201cattacked the most distinct countries,\u201d which concerns target countries on :ATTACKS.\"\n    ]\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [\n      \"Only include ASNs that have at least one associated IP that has at least one ATTACKS relationship to a Country.\"\n    ],\n    \"OPTIONAL/CLARIFICATIONS\": [\n      \"Distinctness should be based on unique target Country nodes (not attack events).\",\n      \"If multiple ASNs tie for the maximum number of distinct attacked countries, return all tied ASNs (or explicitly choose a deterministic tie-breaker if only one result must be shown).\",\n      \"No time window or technique/protocol constraints were provided; include all ATTACKS relationships unless additional criteria are specified later.\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": {\n    \"TYPE\": \"Ranked summary (top result or all ties for top)\",\n    \"FIELDS\": [\n      \"asn_number\",\n      \"distinct_attacked_country_count\"\n    ],\n    \"OPTIONAL_FIELDS\": [\n      \"attacked_country_names (list) for validation/interpretability\"\n    ],\n    \"ORDERING\": [\n      \"distinct_attacked_country_count descending\",\n      \"asn_number ascending (optional deterministic secondary sort)\"\n    ]\n  },\n  \"SUGGESTED_APPROACH\": \"Traverse from ASN to its IPs via BELONGS_TO, then from those IPs to target countries via ATTACKS. For each ASN, compute the count of distinct target countries attacked (deduplicating across multiple IPs and multiple attack events). Then identify the maximum count and return the ASN(s) achieving it, along with the count (and optionally the list of countries).\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the ASN number(s) whose associated IPs have ATTACKS relationships to the largest number of distinct target Country nodes, and return the ASN number(s) with that distinct-country count (including all ties for the maximum).\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the ASN number(s) whose associated IPs have ATTACKS relationships to the largest number of distinct target Country nodes, and return the ASN number(s) with that distinct-country count (including all ties for the maximum)."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(country:Country)\nWITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count\nWITH max(distinct_country_count) AS max_count, collect({asn_number: asn_number, distinct_country_count: distinct_country_count}) AS rows\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.distinct_country_count = max_count\nRETURN row.asn_number AS asn_number, row.distinct_country_count AS distinct_country_count\nORDER BY asn_number"
          ],
          "trace": [
            {
              "subproblem": "Find the ASN number(s) whose associated IPs have ATTACKS relationships to the largest number of distinct target Country nodes, and return the ASN number(s) with that distinct-country count (including all ties for the maximum).",
              "attempts": [
                {
                  "fragment": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(country:Country)\nWITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count\nWITH max(distinct_country_count) AS max_count, collect({asn_number: asn_number, distinct_country_count: distinct_country_count}) AS rows\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.distinct_country_count = max_count\nRETURN row.asn_number AS asn_number, row.distinct_country_count AS distinct_country_count\nORDER BY asn_number",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn_number": "AS57523 chang way technologies co. limited",
                      "distinct_country_count": 64
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(country:Country)\nWITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count\nWITH max(distinct_country_count) AS max_count, collect({asn_number: asn_number, distinct_country_count: distinct_country_count}) AS rows\nUNWIND rows AS row\nWITH row, max_count\nWHERE row.distinct_country_count = max_count\nRETURN row.asn_number AS asn_number, row.distinct_country_count AS distinct_country_count\nORDER BY asn_number"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn_number": "AS57523 chang way technologies co. limited",
              "distinct_country_count": 64
            }
          ]
        },
        "explanation": {
          "text": "This query finds the ASN(s) whose IPs have attacked the largest number of distinct target countries, returning those ASN numbers and that maximum distinct-country count (including ties)."
        }
      },
      "token_usage": {
        "input": 1568,
        "output": 1107,
        "total": 2675
      },
      "duration_seconds": 21.619,
      "started_at": "2026-02-20T05:44:59.304269+00:00",
      "ended_at": "2026-02-20T05:45:20.923434+00:00",
      "metadata": {
        "time": "2026-02-20T05:45:20.910696+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 7,
      "category": "graph-structure",
      "prompt": "Find IPs that attacked more than 10 distinct countries.",
      "expected_cypher": "MATCH (ip:IP)-[:ATTACKS]->(c:Country)\nWITH ip.address AS ip, count(DISTINCT c.name) AS countries\nWHERE countries > 10\nRETURN ip, countries\nORDER BY countries DESC",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})\nWHERE trim(r.technique) = 'T1566 Phishing'\nRETURN count(r) AS total_attacks",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1401,
        "output": 745,
        "total": 2146
      },
      "duration_seconds": 400.108,
      "started_at": "2026-02-20T05:45:20.924011+00:00",
      "ended_at": "2026-02-20T05:52:01.032166+00:00",
      "metadata": {
        "time": "2026-02-20T05:51:52.590863+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 8,
      "category": "matcher-needed",
      "prompt": "Top 5 target countries attacked by IPs from United States using protocol ssh.",
      "expected_cypher": "MATCH (ip:IP)-[:FROM]->(src:Country {name:'United States of America'})\nMATCH (ip)-[a:ATTACKS {protocol:'RDP'}]->(tgt:Country)\nWITH tgt.name AS country, count(*) AS attacks\nORDER BY attacks DESC\nLIMIT 5\nRETURN country, attacks",
      "agent_cypher": "MATCH (ip:IP)-[r:ATTACKS]->(target:Country)\nMATCH (ip)-[:FROM]->(source:Country)\nWHERE source.name = 'United States'\n  AND r.protocol = 'ssh'\nWITH target, count(*) AS attack_count\nRETURN target.name AS target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
      "response": [],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 265,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 0,
        "status": "SUCCESS_ZERO_ROWS",
        "status_detail": "Query executed successfully but returned no data"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which destination countries are most frequently targeted when the attacking source IPs originate from the United States and the attack traffic uses the SSH protocol, returning the top five targets by volume.\",\n  \"KEY_ENTITIES\": \"Relevant nodes: IP (as the attacker/source), Country (as both source country and target country). Relevant relationships: IP-[:FROM]->Country (to determine the source country of the IP), IP-[:ATTACKS]->Country (to represent an attack from an IP to a target country, including protocol metadata on the relationship). Optional context: IP-[:BELONGS_TO]->ASN could be included for additional breakdowns but is not required for the core question.\",\n  \"FILTERS\": \"1) Source constraint: the attacking IP must be linked via (:IP)-[:FROM]->(:Country) where Country.name = 'United States'. 2) Protocol constraint: the attack relationship (:IP)-[:ATTACKS]->(:Country) must have protocol = 'ssh' (case/format normalization may be needed depending on data, e.g., 'SSH'). 3) No time window is specified, so include all available ATTACKS records unless the dataset requires restricting to a recent period. 4) Ensure the target country is the Country node on the ATTACKS relationship (not the FROM country).\",\n  \"OUTPUT_FORMAT\": \"Return a ranked list of 5 records, each containing: target_country (name), attack_count (number of matching ATTACKS relationships, or events), and rank/order. Optionally include a secondary metric such as distinct_source_ips to clarify whether results reflect many events from few IPs vs many IPs.\",\n  \"SUGGESTED_APPROACH\": \"Start from IP nodes that are sourced from the United States via the FROM relationship. From those IPs, traverse ATTACKS relationships to target Country nodes, filtering to only ATTACKS with protocol set to ssh. Aggregate by target country name, compute the total number of matching attacks (and optionally distinct attacking IPs), sort descending by the chosen count metric, and return the top 5.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the top 5 target countries (by count of ATTACKS events) that are attacked via protocol 'ssh' by IPs whose source country (FROM) is 'United States', and return each target country with its attack count in descending order.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the top 5 target countries (by count of ATTACKS events) that are attacked via protocol 'ssh' by IPs whose source country (FROM) is 'United States', and return each target country with its attack count in descending order."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[r:ATTACKS]->(target:Country)\nMATCH (ip)-[:FROM]->(source:Country)\nWHERE source.name = 'United States'\n  AND r.protocol = 'ssh'\nWITH target, count(*) AS attack_count\nRETURN target.name AS target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
          ],
          "trace": [
            {
              "subproblem": "Find the top 5 target countries (by count of ATTACKS events) that are attacked via protocol 'ssh' by IPs whose source country (FROM) is 'United States', and return each target country with its attack count in descending order.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[r:ATTACKS]->(target:Country)\nMATCH (ip)-[:FROM]->(source:Country)\nWHERE source.name = 'United States'\n  AND r.protocol = 'ssh'\nWITH target, count(*) AS attack_count\nRETURN target.name AS target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5",
                  "matched_pairs": [
                    {
                      "kind": "node",
                      "label": "Country",
                      "property": "name",
                      "original": "United States",
                      "value": "United States"
                    },
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "protocol",
                      "original": "ssh",
                      "value": "ssh"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": []
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[r:ATTACKS]->(target:Country)\nMATCH (ip)-[:FROM]->(source:Country)\nWHERE source.name = 'United States'\n  AND r.protocol = 'ssh'\nWITH target, count(*) AS attack_count\nRETURN target.name AS target_country, attack_count\nORDER BY attack_count DESC\nLIMIT 5"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": []
        },
        "explanation": {
          "text": "It finds IPs originating from the United States that have launched SSH attacks against countries, counts how many such attacks each target country received, and returns the top 5 target countries by attack count."
        }
      },
      "token_usage": {
        "input": 1475,
        "output": 758,
        "total": 2233
      },
      "duration_seconds": 21.144,
      "started_at": "2026-02-20T05:52:01.032745+00:00",
      "ended_at": "2026-02-20T05:52:22.176676+00:00",
      "metadata": {
        "time": "2026-02-20T05:52:22.164671+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 9,
      "category": "temporal",
      "prompt": "Monthly attack counts per technique (grouped by YYYY-MM).",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWITH substring(toString(a.documented_create_date[0]),0,7) AS year_month, a.technique AS technique, count(*) AS attacks\nRETURN year_month, technique, attacks\nORDER BY year_month DESC, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(target:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWHERE a.protocol <> 'unknown'\n  AND a.technique <> 'unknown'\nWITH\n  date.truncate('month', a.documented_create_date) AS year_month,\n  target.name AS target_country,\n  a.protocol AS protocol,\n  a.technique AS technique,\n  a.industry AS industry,\n  collect(DISTINCT asn.number) AS participating_asns,\n  count(DISTINCT asn.number) AS participating_asn_count,\n  count(DISTINCT ip.address) AS originating_ip_count,\n  count(*) AS attack_event_count\nWHERE participating_asn_count > 1\nRETURN\n  year_month,\n  target_country,\n  protocol,\n  technique,\n  industry,\n  participating_asn_count,\n  participating_asns,\n  originating_ip_count,\n  attack_event_count\nORDER BY attack_event_count DESC, participating_asn_count DESC, year_month DESC, target_country ASC",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1789,
        "output": 1923,
        "total": 3712
      },
      "duration_seconds": 400.113,
      "started_at": "2026-02-20T05:52:22.177178+00:00",
      "ended_at": "2026-02-20T05:59:02.290037+00:00",
      "metadata": {
        "time": "2026-02-20T05:58:57.888261+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 10,
      "category": "discovery",
      "prompt": "List distinct technologies observed in attacks against the Finance industry, with counts.",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS]->(:Country)\nWHERE a.industry = 'Finance'\nWITH a.technology AS technology, count(*) AS attacks\nORDER BY attacks DESC\nRETURN technology, attacks",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_events\nRETURN technology, attack_events\nORDER BY attack_events DESC",
      "response": [
        {
          "technology": "unknown",
          "attack_events": 5624
        },
        {
          "technology": "windows",
          "attack_events": 30
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 249,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 2,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 2 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which attack technologies have been observed targeting the Finance industry and quantify how frequently each technology appears in the recorded attack events.\",\n  \"KEY_ENTITIES\": \"Primary focus is the :ATTACKS relationship from (:IP) to (:Country), specifically its properties 'technology' and 'industry'. Nodes involved: (:IP) as the attacking source and (:Country) as the target/associated country endpoint of the attack record. The optional (:ASN) and :FROM/:BELONGS_TO relationships are not required unless additional attribution context is later requested.\",\n  \"FILTERS\": \"Match only ATTACKS records where the relationship property 'industry' corresponds to the Finance industry (e.g., exact value 'Finance' unless the data uses variants/case differences). Consider excluding records where 'technology' is missing, null, or an empty string so the 'distinct technologies' list is meaningful. No date constraints are specified, so include all available time unless otherwise clarified.\",\n  \"OUTPUT_FORMAT\": \"Return a table/list of unique technology values with an associated count for each. Counts should represent the number of attack observations/events (i.e., number of ATTACKS relationships) for that technology within Finance. Optionally sort by count descending, then technology name ascending for stable ordering.\",\n  \"SUGGESTED_APPROACH\": \"Traverse ATTACKS relationships, filter to those labeled for the Finance industry, normalize/clean the technology field if needed (trim/case handling), group results by technology, and compute the number of matching attack records per technology. Present distinct technology names alongside their frequencies, ideally ordered by highest frequency.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For all ATTACKS relationships whose industry is Finance, list each distinct technology value and the number of matching attack events observed for that technology (excluding missing/blank technology values), preferably sorted by count descending.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For all ATTACKS relationships whose industry is Finance, list each distinct technology value and the number of matching attack events observed for that technology (excluding missing/blank technology values), preferably sorted by count descending."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_events\nRETURN technology, attack_events\nORDER BY attack_events DESC"
          ],
          "trace": [
            {
              "subproblem": "For all ATTACKS relationships whose industry is Finance, list each distinct technology value and the number of matching attack events observed for that technology (excluding missing/blank technology values), preferably sorted by count descending.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_events\nRETURN technology, attack_events\nORDER BY attack_events DESC",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "industry",
                      "original": "'Finance'",
                      "value": "Finance"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "technology": "unknown",
                      "attack_events": 5624
                    },
                    {
                      "technology": "windows",
                      "attack_events": 30
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.industry = 'Finance'\n  AND a.technology IS NOT NULL\n  AND trim(a.technology) <> ''\nWITH a.technology AS technology, count(*) AS attack_events\nRETURN technology, attack_events\nORDER BY attack_events DESC"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "technology": "unknown",
              "attack_events": 5624
            },
            {
              "technology": "windows",
              "attack_events": 30
            }
          ]
        },
        "explanation": {
          "text": "It lists each non-empty technology used in Finance-sector ATTACKS relationships and counts how many attack events mention that technology, returning the technologies ordered by highest event count."
        }
      },
      "token_usage": {
        "input": 1451,
        "output": 682,
        "total": 2133
      },
      "duration_seconds": 397.993,
      "started_at": "2026-02-20T05:59:02.320936+00:00",
      "ended_at": "2026-02-20T06:05:40.314056+00:00",
      "metadata": {
        "time": "2026-02-20T06:05:40.298235+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 11,
      "category": "multi-hop",
      "prompt": "For each ASN, top 3 protocols it used when attacking France.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name:'France'})\nWITH asn.number AS asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn, cnt DESC\nWITH asn, collect({protocol: protocol, cnt: cnt}) AS items\nUNWIND items[0..3] AS top\nRETURN asn, top.protocol AS protocol, top.cnt AS attacks\nORDER BY asn, attacks DESC",
      "agent_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name: 'France'})\nWHERE a.protocol IS NOT NULL AND a.protocol <> 'unknown'\nWITH asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn.number, cnt DESC, protocol\nWITH asn, collect({protocol: protocol, count: cnt})[0..3] AS topProtocols\nWITH asn, topProtocols, range(0, size(topProtocols) - 1) AS idxs\nUNWIND idxs AS i\nWITH asn, i + 1 AS rank, topProtocols[i] AS tp\nRETURN asn.number AS asn, tp.protocol AS protocol, tp.count AS count, rank\nORDER BY asn, rank",
      "response": [
        {
          "asn": "AS10103 hk broadband network ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS10220 pt. kreasi sejahtera teknologi",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS10439 carinet  inc.",
          "protocol": "snmp",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS10439 carinet  inc.",
          "protocol": "sip",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS11419 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS11427 charter communications inc",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS11888 television internacional  s.a. de c.v.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS12252 america movil peru s.a.c.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS12353 vodafone portugal - communicacoes pessoais s.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS12389 pjsc rostelecom",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS12479 orange espagne sa",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS12695 llc digital network",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS12768 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS12874 fastweb spa",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS12876 online s.a.s.",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS12876 online s.a.s.",
          "protocol": "snmp",
          "count": 3,
          "rank": 2
        },
        {
          "asn": "AS131090 cat telecom public company ltd",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS131314 china broadband communications (hong kong) company limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS131353 nhanhoa software company",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS131423 branch of long van system solution jsc - hanoi",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS132203 tencent building  kejizhongyi avenue",
          "protocol": "ssh",
          "count": 312,
          "rank": 1
        },
        {
          "asn": "AS132203 tencent building  kejizhongyi avenue",
          "protocol": "snmp",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS132787 helios it infrasolutions pvt",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS13285 talktalk communications",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS133296 web werks india pvt. ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS133334 dctv cable network broadband services inc",
          "protocol": "sip",
          "count": 9,
          "rank": 1
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "http",
          "count": 112,
          "rank": 1
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "tcp",
          "count": 112,
          "rank": 2
        },
        {
          "asn": "AS13335 cloudflare",
          "protocol": "ssh",
          "count": 1,
          "rank": 3
        },
        {
          "asn": "AS133398 tele asia limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS133774 fuzhou",
          "protocol": "ssh",
          "count": 9,
          "rank": 1
        },
        {
          "asn": "AS134026 ultranet services private limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134238 chinanet jiangxi province idc network",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS134337 r2 net solutions pvt ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134366 cloud computing hk limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134761 chinanet ningxia province zhongwei idc network",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS134763 chinanet guangdong province network",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS134765 chinanet yunnan province idc1 network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134768 chinanet shaanxi province cloud base network",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS134771 wenzhou  zhejiang province  p.r.china.",
          "protocol": "snmp",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS13490 buckeye cablevision  inc.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134945 blue sky broadband pvt. ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS134963 alibaba.com singapore e-commerce private limited",
          "protocol": "snmp",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS135182 moradabad internet services private limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS135310 inspire broadband",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "ssh",
          "count": 13,
          "rank": 1
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "sip",
          "count": 7,
          "rank": 2
        },
        {
          "asn": "AS135377 ucloud information technology (hk) limited",
          "protocol": "snmp",
          "count": 7,
          "rank": 3
        },
        {
          "asn": "AS135524 university of dhaka",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS135777 shreenortheast connect and services pvt ltd",
          "protocol": "telnet",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS135905 vietnam posts and telecommunications group",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS135932 viet storage technology joint stock company",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS135953 vietnam online network solution joint stock compnay",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS136052 pt cloud hosting indonesia",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS136170 pt. exabytes network indonesia",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS13650 axia fibrenet ltd.",
          "protocol": "snmp",
          "count": 11,
          "rank": 1
        },
        {
          "asn": "AS13650 axia fibrenet ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS136827 universitas pgri semarang",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS136958 china unicom guangdong ip network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS136970 yisu cloud ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137280 kingsoft cloud corporation limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137318 diskominfo kabupaten pati",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS137361 diskominfo kab. magelang",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137687 luoyang  henan province  p.r.china.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137697 chinatelecom jiangsu yangzhou idc networkdescr",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS137699 chinatelecom jiangsu suqian idc network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137702 nanjing  jiangsu province  p.r.china.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS137718 beijing volcano engine technology co.  ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS137823 cloudone",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS138421 china unicom",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS138950 jiangsu wuxi international idc network",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS139190 google asia pacific pte. ltd.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS139201 jiangxi jiujiang idc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS139282 novus network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS139473 shebatel network ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS13999 mega cable  s.a. de c.v.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS140061 qinghai telecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS140469 pt wahyu adidaya network",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS14051 consolidated communications",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS14061 digitalocean  llc",
          "protocol": "ssh",
          "count": 207,
          "rank": 1
        },
        {
          "asn": "AS14061 digitalocean  llc",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS14080 telmex colombia s.a.",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS142403 yisu cloud ltd",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS142608 china telecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS14618 amazon.com  inc.",
          "protocol": "snmp",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS147161 universitas muhammadiyah gresik",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS14987 rethem hosting llc",
          "protocol": "snmp",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS14988 african network information center",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "http",
          "count": 36,
          "rank": 1
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "tcp",
          "count": 36,
          "rank": 2
        },
        {
          "asn": "AS15169 google llc",
          "protocol": "ssh",
          "count": 10,
          "rank": 3
        },
        {
          "asn": "AS15290 allstream corp.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15311 telefonica empresas",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15475 nile online",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS15582 ojsc comcor",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15704 xtra telecom s.a.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS15713 llc global-city-net",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15895 kyivstar pjsc",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS15924 vodafone net iletisim hizmetleri anonim sirketi",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS16223 lanet network ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "ssh",
          "count": 33,
          "rank": 1
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "sip",
          "count": 10,
          "rank": 2
        },
        {
          "asn": "AS16276 ovh sas",
          "protocol": "snmp",
          "count": 1,
          "rank": 3
        },
        {
          "asn": "AS16735 algar telecom s/a",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS16814 nss s.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17222 mundivox do brasil ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS174 cogent communications",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17501 worldlink communications pvt ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17557 pakistan telecommunication company limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17577 lg hellovision corp.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17621 china unicom shanghai network",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS17623 china unicom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17638 china telecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17676 softbank bb corp.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS17676 softbank bb corp.",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS17858 lg powercomm",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS17882 univision llc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS17993 vodafone samoa limited",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS18049 taiwan infrastructure network technologie",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS18207 you broadband & cable india ltd.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS18229 ctrls datacenters",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS18403 fpt telecom company",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS18881 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS19318 interserver  inc",
          "protocol": "sip",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS19429 etb - colombia",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS19527 google llc",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS197068 hll llc",
          "protocol": "snmp",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS197119 krena - kyrgyz research and education network association",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS200350 yandex.cloud llc",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS20115 charter communications",
          "protocol": "telnet",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS20115 charter communications",
          "protocol": "ssh",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS201746 olivenet network s.l.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS202425 ip volume inc",
          "protocol": "snmp",
          "count": 15,
          "rank": 1
        },
        {
          "asn": "AS202425 ip volume inc",
          "protocol": "sip",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS202660 uzbektelekom joint stock company",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS203247 islamic azad university",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS207423 steil-south ltd",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS209605 uab host baltic",
          "protocol": "ssh",
          "count": 21,
          "rank": 1
        },
        {
          "asn": "AS210644 ",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS210950 tov e-rishennya",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS211252 delis llc",
          "protocol": "snmp",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS211279 alianta-tv s.r.l.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS211298 constantine cybersecurity ltd.",
          "protocol": "sip",
          "count": 11,
          "rank": 1
        },
        {
          "asn": "AS211298 constantine cybersecurity ltd.",
          "protocol": "snmp",
          "count": 6,
          "rank": 2
        },
        {
          "asn": "AS211680 nsec - sistemas informaticos  s.a.",
          "protocol": "sip",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS211680 nsec - sistemas informaticos  s.a.",
          "protocol": "snmp",
          "count": 2,
          "rank": 2
        },
        {
          "asn": "AS21491 uganda telecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS21501 host europe gmbh",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS21574 century telecom ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS21859 zenlayer inc",
          "protocol": "snmp",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS22773 cox communications inc.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS22884 total play telecomunicaciones sa de cv",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS23201 telecel s.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS23647 communications & communicate nepal pvt ltd",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS23650 chinanet",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS23678 mykris asia  managed network and service provider",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS23700 linknet fastnet asn",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS23724 idc china telecommunications corporation",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS23969 tot public company limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS23969 tot public company limited",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS24186 railtel corporation of india ltd",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS24309 atria convergence technologies",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS24400 shanghai mobile communications co. ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS24514 malaysian research & education network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS24532 inet global indo",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS24560 bharti airtel ltd.",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS24757 ethionet",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS24955 ojsc ufanet",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS25003 internet binat ltd",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS25106 mobile telesystems jllc",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS2518 biglobe inc.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS25184 afranet",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS2519 arteria networks corporation",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS25250 gamtel",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS2527 sony network communications inc.",
          "protocol": "telnet",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS25408 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS25490 pjsc rostelecom",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS25514 modus-global llc",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS25820 it7 networks inc",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS26210 axs bolivia s a",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS262793 douracom servicos de comunicacao ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS262805 rede minas telecom ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS263998 sim telecom",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS264411 costa do sol tv a cabo",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS26496 godaddy.com  llc",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS267251 telefonarnet telecomunicacoes",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS267285 ANDRE PEREIRA DA COSTA EIRELI ME",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS267506 netlux telecom",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS268622 oliveira telecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS268888 acrf servicos de informatica ltda - me",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS27651 entel chile s.a.",
          "protocol": "ssh",
          "count": 10,
          "rank": 1
        },
        {
          "asn": "AS27653 alpha communications network",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS27665 columbus communications trinidad limited.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS27699 telefnica brasil s.a",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS27843 optical technologies s.a.c.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS27882 telefnica celular de bolivia s.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS27988 servicios y telecomunicaciones s.a.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS28308 orion telecomunicaes comercio e servios ltda",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS2856 british telecommunications plc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS28573 claro s.a.",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS28624 provedora cma internet ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS28649 desktop sigmanet comunicao multimdia sa",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS28665 predlink rede de telecomunices ltda",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS29518 bredband2 ab",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS29580 a1 bulgaria ead",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS29789 reflected networks  inc.",
          "protocol": "http",
          "count": 150,
          "rank": 1
        },
        {
          "asn": "AS29789 reflected networks  inc.",
          "protocol": "tcp",
          "count": 42,
          "rank": 2
        },
        {
          "asn": "AS29791 internap holding llc",
          "protocol": "sip",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS30722 vodafone italia s.p.a.",
          "protocol": "telnet",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS30844 liquid telecommunications ltd",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS31200 novotelecom ltd",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS31898 oracle corporation",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS32 stanford university",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS3215 orange s.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS3216 pjsc vimpelcom",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS3243 meo servicos de comunicacoes e multimedia sa",
          "protocol": "ssh",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS32475 singlehop llc",
          "protocol": "sip",
          "count": 10,
          "rank": 1
        },
        {
          "asn": "AS327724 african network information center",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS327764 african network information center",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS327934 african network information center",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS3320 deutsche telekom ag",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS3356 level 3 parent  llc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS34088 host europe gmbh",
          "protocol": "sip",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS3462 data communication business group",
          "protocol": "ssh",
          "count": 17,
          "rank": 1
        },
        {
          "asn": "AS34918 pishgaman toseeh ertebatat company (private joint stock)",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS34974 pjsc rostelecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS34984 tellcom iletisim hizmetleri a.s.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS35366 isppro internet kg",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS35478 bunea telecom srl",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS35913 dedipath",
          "protocol": "snmp",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS36352 colocrossing",
          "protocol": "ssh",
          "count": 12,
          "rank": 1
        },
        {
          "asn": "AS36791 portland internet hosting llc",
          "protocol": "snmp",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS36791 portland internet hosting llc",
          "protocol": "ssh",
          "count": 2,
          "rank": 2
        },
        {
          "asn": "AS36866 african network information center",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS36946 african network information center",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS37061 african network information center",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS37353 african network information center",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS37385 african network information center",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS3786 lg dacom corporation",
          "protocol": "ssh",
          "count": 17,
          "rank": 1
        },
        {
          "asn": "AS37963 hangzhou alibaba advertising co. ltd.",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS3816 colombia telecomunicaciones s.a. esp",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS38283 chinanet sichuan telecom internet data center",
          "protocol": "snmp",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS38283 chinanet sichuan telecom internet data center",
          "protocol": "ssh",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS38365 beijing baidu netcom science and technology co.  ltd.",
          "protocol": "ssh",
          "count": 25,
          "rank": 1
        },
        {
          "asn": "AS38457 honesty net solution",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS38482 biznet isp",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS38623 viettel",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS38700 smileserv",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS38731 vietel - cht company",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS394695 pdr",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS39493 cjsc kolomna-sviaz tv",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS396356 maxihost llc",
          "protocol": "snmp",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS396507 emerald onion",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS39651 com hem ab",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS396982 google",
          "protocol": "ssh",
          "count": 46,
          "rank": 1
        },
        {
          "asn": "AS396982 google",
          "protocol": "snmp",
          "count": 20,
          "rank": 2
        },
        {
          "asn": "AS396982 google",
          "protocol": "sip",
          "count": 4,
          "rank": 3
        },
        {
          "asn": "AS398101 godaddy.com  llc",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS398108 godaddy.com  llc",
          "protocol": "sip",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS39811 mts pjsc",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS39812 closed joint stock company radiotelephone",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS398324 censys  inc.",
          "protocol": "snmp",
          "count": 6,
          "rank": 1
        },
        {
          "asn": "AS398324 censys  inc.",
          "protocol": "sip",
          "count": 5,
          "rank": 2
        },
        {
          "asn": "AS39927 e-light-telecom ltd.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS399804 hostodo",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "ssh",
          "count": 237,
          "rank": 1
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "snmp",
          "count": 9,
          "rank": 2
        },
        {
          "asn": "AS4134 chinanet",
          "protocol": "telnet",
          "count": 8,
          "rank": 3
        },
        {
          "asn": "AS41668 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS42237 amati foundation",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS42313 albtelecom sh.a.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS42610 pjsc rostelecom",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS42667 artur sienkiewicz",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS42708 glesys ab",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS43162 olimp llc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS44327 delta comm llc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS45061 shanghai information network co. ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS45090 shenzhen tencent computer systems company limited",
          "protocol": "ssh",
          "count": 192,
          "rank": 1
        },
        {
          "asn": "AS45090 shenzhen tencent computer systems company limited",
          "protocol": "telnet",
          "count": 4,
          "rank": 2
        },
        {
          "asn": "AS45102 alibaba (us) technology co.  ltd.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS4538 china education and research network center",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS45557 vietnam technology and telecommunication jsc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS45820 tata teleservices",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS45899 vnpt corp",
          "protocol": "ssh",
          "count": 21,
          "rank": 1
        },
        {
          "asn": "AS45903 cmc telecom infrastructure company",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS4609 companhia de telecomunicacoes de macau sarl",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS4621 uninet-th",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS46606 unified layer",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS47331 ttnet a.s.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS47433 sibirskie seti ltd.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS4750 cs loxinfo public company limited",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS4755 tata communications",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS4760 hkt limited",
          "protocol": "ssh",
          "count": 10,
          "rank": 1
        },
        {
          "asn": "AS4766 korea telecom",
          "protocol": "ssh",
          "count": 40,
          "rank": 1
        },
        {
          "asn": "AS4766 korea telecom",
          "protocol": "telnet",
          "count": 2,
          "rank": 2
        },
        {
          "asn": "AS4780 digital united inc.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS4788 tm net  internet service provider",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS48004 pe tsibrankov konstantin igorevich",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS4808 china unicom beijing province network",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS48090 pptechnology limited",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS48090 pptechnology limited",
          "protocol": "snmp",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS4812 china telecom (group)",
          "protocol": "ssh",
          "count": 13,
          "rank": 1
        },
        {
          "asn": "AS4816 china telecom (group)",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS4835 china telecom (group)",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS4837 china unicom china169 backbone",
          "protocol": "ssh",
          "count": 37,
          "rank": 1
        },
        {
          "asn": "AS4847 china networks inter-exchange",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS49392 llc baxet",
          "protocol": "ssh",
          "count": 8,
          "rank": 1
        },
        {
          "asn": "AS49403 avk-wellcom ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS49424 new line solutions llc",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS49434 harmony hosting sarl",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS49505 ooo network of data-centers selectel",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS49870 alsycon b.v.",
          "protocol": "sip",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS50215 master llc",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS51167 contabo gmbh",
          "protocol": "sip",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS51559 netinternet bilisim teknolojileri as",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS51604 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS51604 jsc er-telecom holding",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS51852 private layer inc",
          "protocol": "ssh",
          "count": 9,
          "rank": 1
        },
        {
          "asn": "AS52312 tv music house jujuy",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS53334 total uptime technologies  llc",
          "protocol": "http",
          "count": 112,
          "rank": 1
        },
        {
          "asn": "AS53334 total uptime technologies  llc",
          "protocol": "tcp",
          "count": 112,
          "rank": 2
        },
        {
          "asn": "AS53667 frantech solutions",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS53831 squarespace  inc.",
          "protocol": "http",
          "count": 396,
          "rank": 1
        },
        {
          "asn": "AS53831 squarespace  inc.",
          "protocol": "tcp",
          "count": 396,
          "rank": 2
        },
        {
          "asn": "AS54113 fastly",
          "protocol": "http",
          "count": 112,
          "rank": 1
        },
        {
          "asn": "AS54113 fastly",
          "protocol": "tcp",
          "count": 112,
          "rank": 2
        },
        {
          "asn": "AS5483 magyar telekom plc.",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS55577 atria convergence technologies pvt ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS55720 gigabit hosting sdn bhd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS56040 china mobile communications corporation",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS56044 china mobile communications corporation",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS56046 china mobile communications corporation",
          "protocol": "ssh",
          "count": 13,
          "rank": 1
        },
        {
          "asn": "AS56048 china mobile communicaitons corporation",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS56466 zentex",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS5650 frontier communications of america  inc.",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS57049 small private enterprise kvant-ii",
          "protocol": "telnet",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS57427 sierra llc",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS57523 chang way technologies co. limited",
          "protocol": "http",
          "count": 42,
          "rank": 1
        },
        {
          "asn": "AS57523 chang way technologies co. limited",
          "protocol": "tcp",
          "count": 42,
          "rank": 2
        },
        {
          "asn": "AS577 bell canada",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS57835 jsc elektrosvyaz",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS57858 inter connects inc",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS58461 ct-hangzhou-idc",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS58461 ct-hangzhou-idc",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS58519 cloud computing corporation",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS58542 tianjij 300000",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS58543 guangdong",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS58593 shanghai blue cloud technology co. ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS58819 pt arsenet global solusi",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS58946 grameen communications",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS59019 beijing kingsoft cloud internet technology co ltd",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6057 administracion nacional de telecomunicaciones",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6128 cablevision systems corp.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS6130 american internet services  llc.",
          "protocol": "snmp",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS61432 itbks892",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6147 telefonica del peru s.a.a.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS61826 nethouse telecom",
          "protocol": "telnet",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS62068 spectraip b.v.",
          "protocol": "sip",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS63199 capitalonline data service co. ltd",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS63526 systems solutions & development technologies limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS63730 vnso technology company",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS63835 no 293 wanbao avenue",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS63949 linode  llc",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS63949 linode  llc",
          "protocol": "telnet",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS6568 entel s.a. - entelnet",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS6702 science production company trifle ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6703 private joint-stock company farlep-invest",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6713 itissalat al-maghrib",
          "protocol": "ssh",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS6730 sunrise communications ag",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6799 ote sa (hellenic telecommunications organisation)",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS6830 liberty global b.v.",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS6849 pjsc ukrtelecom",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS6939 hurricane electric llc",
          "protocol": "snmp",
          "count": 9,
          "rank": 1
        },
        {
          "asn": "AS6939 hurricane electric llc",
          "protocol": "ssh",
          "count": 5,
          "rank": 2
        },
        {
          "asn": "AS701 verizon",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "sip",
          "count": 14,
          "rank": 1
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "ssh",
          "count": 4,
          "rank": 2
        },
        {
          "asn": "AS7018 att services inc",
          "protocol": "telnet",
          "count": 2,
          "rank": 3
        },
        {
          "asn": "AS7184 universidad veracruzana",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS7303 telecom argentina s.a.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS7470 true internet co. ltd.",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS7545 tpg telecom limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS7552 viettel group",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS7713 pt telekomunikasi indonesia",
          "protocol": "ssh",
          "count": 11,
          "rank": 1
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "sip",
          "count": 7,
          "rank": 1
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "ssh",
          "count": 3,
          "rank": 2
        },
        {
          "asn": "AS7922 comcast",
          "protocol": "telnet",
          "count": 1,
          "rank": 3
        },
        {
          "asn": "AS8048 cantv servicios  venezuela",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS8070 microsoft corporation",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS8075 microsoft corporation",
          "protocol": "ssh",
          "count": 31,
          "rank": 1
        },
        {
          "asn": "AS8151 uninet s.a. de c.v.",
          "protocol": "ssh",
          "count": 5,
          "rank": 1
        },
        {
          "asn": "AS8220 colt technology services group limited",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8228 sfr sa",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8331 jsc er-telecom holding",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8359 mts pjsc",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS8402 pjsc vimpelcom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8449 elcat ltd.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS8473 bahnhof",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS852 telus communications inc.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8560 1&1 ionos se",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8612 tiscali italia s.p.a.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8758 iway ag",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS8866 bulgarian telecommunications company plc.",
          "protocol": "telnet",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9009 m247 ltd",
          "protocol": "sip",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9009 m247 ltd",
          "protocol": "snmp",
          "count": 1,
          "rank": 2
        },
        {
          "asn": "AS9198 jsc kazakhtelecom",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9269 hong kong broadband network",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9299 philippine long distance telephone company",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS9304 hgc global communications limited",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS9318 sk broadband co ltd",
          "protocol": "ssh",
          "count": 18,
          "rank": 1
        },
        {
          "asn": "AS9341 pt indonesia comnets plus",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9381 hkbn enterprise solutions hk limited",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS9498 bharti airtel ltd.",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS9802 abitcool(china) inc.",
          "protocol": "ssh",
          "count": 2,
          "rank": 1
        },
        {
          "asn": "AS9808 china mobile communications group co.  ltd.",
          "protocol": "ssh",
          "count": 25,
          "rank": 1
        },
        {
          "asn": "AS9812 oriental cable network co.  ltd.",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "AS9829 national internet backbone",
          "protocol": "ssh",
          "count": 4,
          "rank": 1
        },
        {
          "asn": "AS9891 cs loxinfo public company limited.",
          "protocol": "ssh",
          "count": 9,
          "rank": 1
        },
        {
          "asn": "AS9924 taiwan fixed network telco and network service provider",
          "protocol": "ssh",
          "count": 3,
          "rank": 1
        },
        {
          "asn": "AS9931 the communication authority of thailand",
          "protocol": "ssh",
          "count": 1,
          "rank": 1
        },
        {
          "asn": "ASNone ",
          "protocol": "ssh",
          "count": 51,
          "rank": 1
        },
        {
          "asn": "ASNone ",
          "protocol": "sip",
          "count": 16,
          "rank": 2
        },
        {
          "asn": "ASNone ",
          "protocol": "snmp",
          "count": 14,
          "rank": 3
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 535,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 426,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 426 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify, for each ASN associated with attacking IPs, the three most frequently used attack protocols in attacks targeting France, so the user can understand protocol preferences by ASN when France is the victim.\",\n  \"KEY_ENTITIES\": \"Relevant nodes: IP (attack source), ASN (attribution of IP), Country (attack target). Relevant relationships: IP-[:ATTACKS]->Country (contains the protocol used and other attack metadata), IP-[:BELONGS_TO]->ASN (maps each attacking IP to an ASN). The IP-[:FROM]->Country relationship is optional context (source geolocation) and is not required unless the user also wants to restrict attacks to IPs originating from a specific country.\",\n  \"FILTERS\": \"Target country must be France: Country.name = 'France' on the ATTACKS target. Only include ATTACKS relationships that have a usable protocol value (e.g., protocol is present and non-empty) to rank protocols. Group results by ASN.number. Define 'top' as the highest frequency of protocol usage per ASN, typically counted as the number of ATTACKS relationships to France per protocol (unless the user prefers counting distinct IPs or distinct pulse_id events; default assumption is counting attack records/relationships). Return the top 3 protocols per ASN; if ties occur at rank 3, apply a deterministic tie-breaker (e.g., protocol name ascending) unless otherwise specified.\",\n  \"OUTPUT_FORMAT\": \"A per-ASN result set that includes: ASN identifier (ASN.number) and an ordered list of up to 3 protocol entries for attacks against France. Each protocol entry should include the protocol value and its corresponding usage count for that ASN. Results should be sortable (e.g., by ASN.number ascending) and each ASN\u2019s protocol list should be ranked from most to least frequent.\",\n  \"SUGGESTED_APPROACH\": \"1) Traverse from IP nodes that have ATTACKS relationships to the Country node where name is France. 2) From those IPs, traverse BELONGS_TO to obtain the associated ASN. 3) Aggregate attack records by (ASN, protocol) and compute a frequency metric (default: count of ATTACKS relationships). 4) Within each ASN group, rank protocols by frequency (and apply a stable tie-break). 5) Select the top 3 protocols per ASN and format as a list per ASN with counts.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"For each ASN linked to IPs that attacked the country named France, compute protocol usage frequencies from ATTACKS records and return the top 3 protocols per ASN (with counts), ranked by highest frequency.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "For each ASN linked to IPs that attacked the country named France, compute protocol usage frequencies from ATTACKS records and return the top 3 protocols per ASN (with counts), ranked by highest frequency."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name: 'France'})\nWHERE a.protocol IS NOT NULL AND a.protocol <> 'unknown'\nWITH asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn.number, cnt DESC, protocol\nWITH asn, collect({protocol: protocol, count: cnt})[0..3] AS topProtocols\nWITH asn, topProtocols, range(0, size(topProtocols) - 1) AS idxs\nUNWIND idxs AS i\nWITH asn, i + 1 AS rank, topProtocols[i] AS tp\nRETURN asn.number AS asn, tp.protocol AS protocol, tp.count AS count, rank\nORDER BY asn, rank"
          ],
          "trace": [
            {
              "subproblem": "For each ASN linked to IPs that attacked the country named France, compute protocol usage frequencies from ATTACKS records and return the top 3 protocols per ASN (with counts), ranked by highest frequency.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name: 'France'})\nWHERE a.protocol IS NOT NULL AND a.protocol <> 'unknown'\nWITH asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn.number, cnt DESC, protocol\nWITH asn, collect({protocol: protocol, count: cnt})[0..3] AS topProtocols\nWITH asn, topProtocols, range(0, size(topProtocols) - 1) AS idxs\nUNWIND idxs AS i\nWITH asn, i + 1 AS rank, topProtocols[i] AS tp\nRETURN asn.number AS asn, tp.protocol AS protocol, tp.count AS count, rank\nORDER BY asn, rank",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn": "AS10103 hk broadband network ltd.",
                      "protocol": "ssh",
                      "count": 1,
                      "rank": 1
                    },
                    {
                      "asn": "AS10220 pt. kreasi sejahtera teknologi",
                      "protocol": "ssh",
                      "count": 2,
                      "rank": 1
                    },
                    {
                      "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
                      "protocol": "ssh",
                      "count": 4,
                      "rank": 1
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country {name: 'France'})\nWHERE a.protocol IS NOT NULL AND a.protocol <> 'unknown'\nWITH asn, a.protocol AS protocol, count(*) AS cnt\nORDER BY asn.number, cnt DESC, protocol\nWITH asn, collect({protocol: protocol, count: cnt})[0..3] AS topProtocols\nWITH asn, topProtocols, range(0, size(topProtocols) - 1) AS idxs\nUNWIND idxs AS i\nWITH asn, i + 1 AS rank, topProtocols[i] AS tp\nRETURN asn.number AS asn, tp.protocol AS protocol, tp.count AS count, rank\nORDER BY asn, rank"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn": "AS10103 hk broadband network ltd.",
              "protocol": "ssh",
              "count": 1,
              "rank": 1
            },
            {
              "asn": "AS10220 pt. kreasi sejahtera teknologi",
              "protocol": "ssh",
              "count": 2,
              "rank": 1
            },
            {
              "asn": "AS10299 empresas municipales de cali e.i.c.e. e.s.p.",
              "protocol": "ssh",
              "count": 4,
              "rank": 1
            }
          ]
        },
        "explanation": {
          "text": "This query finds, for each ASN with IPs that have non-`unknown` ATTACKS against France, the top three attack `protocol` values by frequency and returns them with their counts and rank per ASN."
        }
      },
      "token_usage": {
        "input": 1663,
        "output": 1311,
        "total": 2974
      },
      "duration_seconds": 40.548,
      "started_at": "2026-02-20T06:05:40.323916+00:00",
      "ended_at": "2026-02-20T06:06:20.872353+00:00",
      "metadata": {
        "time": "2026-02-20T06:06:20.850291+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 12,
      "category": "impossible",
      "prompt": "List the top 5 malware families used in attacks.",
      "expected_cypher": "RETURN 'Not enough information in schema (no malware family)' AS note",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS botnet, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN botnet, attack_count",
      "response": [
        {
          "botnet": "unknown",
          "attack_count": 3025957
        },
        {
          "botnet": "botnet",
          "attack_count": 73462
        },
        {
          "botnet": "mirai",
          "attack_count": 36090
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 199,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 3,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 3 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Identify which malware families (e.g., botnet/malware groupings) are most commonly associated with observed attacks in the dataset, and rank them to return the top 5 by prevalence.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)\"\n    ],\n    \"NOTES\": \"The schema does not include a dedicated 'malware_family' field; the closest available representation is likely IP.botnet (and possibly ATTACKS.pulse_id correlated to IP.pulse_ids for campaign context).\"\n  },\n  \"FILTERS\": {\n    \"REQUIRED\": [],\n    \"IMPLICIT_ASSUMPTIONS_TO_CLARIFY\": [\n      \"Interpret 'malware family' as the value in IP.botnet (if null/empty, exclude or group as 'Unknown').\",\n      \"Define 'used in attacks' as any IP that has at least one outgoing :ATTACKS relationship.\",\n      \"Define ranking metric (default): total number of :ATTACKS relationships associated with IPs in each botnet/malware family (optionally alternative: number of distinct attacking IPs per family).\",\n      \"No time window specified; include all attacks unless constrained by documented_create_date / documented_modified_date.\"\n    ],\n    \"OPTIONAL\": [\n      \"Filter by date range using ATTACKS.documented_create_date and/or ATTACKS.documented_modified_date.\",\n      \"Filter by ATTACKS.industry / technique / protocol / technology if the user intends a narrower scope.\"\n    ]\n  },\n  \"OUTPUT_FORMAT\": \"Return a ranked list of 5 records with at least: malware_family (botnet name), count_metric (e.g., total attack events), and rank/order. Optionally include supporting fields such as distinct_attacking_ips and distinct_target_countries for context.\",\n  \"SUGGESTED_APPROACH\": \"Traverse from IP nodes to their :ATTACKS relationships, group results by the IP.botnet value (treating it as the malware family label), compute the chosen prevalence metric (preferably count of ATTACKS edges; optionally also count distinct IPs), sort descending by that metric, and return the top 5 groups. Exclude null/blank botnet values or bucket them as 'Unknown' depending on desired reporting.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Find the top 5 IP.botnet values among IPs that have :ATTACKS relationships, ranked by the number of associated attack events, and return each botnet name with its attack count.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Find the top 5 IP.botnet values among IPs that have :ATTACKS relationships, ranked by the number of associated attack events, and return each botnet name with its attack count."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS botnet, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN botnet, attack_count"
          ],
          "trace": [
            {
              "subproblem": "Find the top 5 IP.botnet values among IPs that have :ATTACKS relationships, ranked by the number of associated attack events, and return each botnet name with its attack count.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS botnet, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN botnet, attack_count",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "botnet": "unknown",
                      "attack_count": 3025957
                    },
                    {
                      "botnet": "botnet",
                      "attack_count": 73462
                    },
                    {
                      "botnet": "mirai",
                      "attack_count": 36090
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(:Country)\nWHERE ip.botnet IS NOT NULL AND ip.botnet <> ''\nWITH ip.botnet AS botnet, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 5\nRETURN botnet, attack_count"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "botnet": "unknown",
              "attack_count": 3025957
            },
            {
              "botnet": "botnet",
              "attack_count": 73462
            },
            {
              "botnet": "mirai",
              "attack_count": 36090
            }
          ]
        },
        "explanation": {
          "text": "This query finds the top 5 non-empty botnet names associated with IPs that have `ATTACKS` relationships to any country, ranking them by how many total attack relationships those botnet-tagged IPs have."
        }
      },
      "token_usage": {
        "input": 1429,
        "output": 978,
        "total": 2407
      },
      "duration_seconds": 22.486,
      "started_at": "2026-02-20T06:06:20.876206+00:00",
      "ended_at": "2026-02-20T06:06:43.361810+00:00",
      "metadata": {
        "time": "2026-02-20T06:06:43.349461+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 13,
      "category": "impossible",
      "prompt": "What destination ports are most targeted?",
      "expected_cypher": "RETURN 'Not enough information in schema (no destination port)' AS note",
      "agent_cypher": "MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})\nMATCH (ip)-[a:ATTACKS]->(:Country)\nWITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attack_events\nMATCH (ip2:IP)-[:FROM]->(:Country {name: 'Russia'})\nMATCH (ip2)-[a2:ATTACKS]->(:Country)\nWITH distinct_source_ips, total_attack_events, a2.industry AS industry, count(*) AS industry_attack_count\nORDER BY industry_attack_count DESC\nLIMIT 5\nWITH distinct_source_ips, total_attack_events, collect({industry: industry, attack_count: industry_attack_count}) AS top_industries\nRETURN distinct_source_ips, total_attack_events, top_industries",
      "response": null,
      "error": "Timeout after 400 seconds",
      "analysis": {
        "has_query": false,
        "query_length": 0,
        "has_error": true,
        "error_type": "OTHER",
        "has_results": false,
        "result_type": "None",
        "result_count": null,
        "status": "ERROR",
        "status_detail": "Failed with OTHER"
      },
      "agents": {
        "expansion": {
          "expanded": null,
          "needs_decomposition": null
        },
        "decomposition": {
          "subproblems": null
        },
        "generation": {
          "fragments": null,
          "trace": null
        },
        "composition": {
          "final_query": null
        },
        "final_validation": {
          "trace": null,
          "error": "Timeout after 400 seconds",
          "results_preview": null
        },
        "explanation": {
          "text": null
        }
      },
      "token_usage": {
        "input": 1654,
        "output": 1811,
        "total": 3465
      },
      "duration_seconds": 400.106,
      "started_at": "2026-02-20T06:06:43.362618+00:00",
      "ended_at": "2026-02-20T06:13:23.468183+00:00",
      "metadata": {
        "time": "2026-02-20T06:13:19.189456+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 14,
      "category": "matcher-needed",
      "prompt": "How many attacks used technique ' Phishing' against Australia?",
      "expected_cypher": "MATCH (:IP)-[a:ATTACKS {technique:'T1566 Phishing'}]->(:Country {name:'Australia'})\nRETURN count(a) AS attacks",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique = 'T1566 Phishing' AND c.name = 'Australia'\nRETURN count(*) AS phishing_attacks_to_australia",
      "response": [
        {
          "phishing_attacks_to_australia": 156
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 149,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 1,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 1 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Determine the total number of recorded attack events where the attack technique is Phishing and the target country is Australia.\",\n  \"KEY_ENTITIES\": \"Relevant entities are IP nodes and Country nodes connected by the ATTACKS relationship. Specifically: (ip:IP)-[:ATTACKS {technique, ...}]->(country:Country). The FROM and BELONGS_TO relationships are not required unless the user later wants attribution by source country or ASN.\",\n  \"FILTERS\": \"1) Target country must be the Country node with name = 'Australia' (confirm exact capitalization/spacing as stored). 2) ATTACKS.relationship property technique must match 'Phishing' (note the question shows a leading space before Phishing; treat this as likely accidental and match the normalized value 'Phishing', or alternatively trim whitespace before comparison if the data may contain it). 3) Count all matching ATTACKS relationships (each relationship instance represents one attack record).\",\n  \"OUTPUT_FORMAT\": \"Return a single numeric result: the count of Phishing attacks against Australia (optionally labeled, e.g., {country: 'Australia', technique: 'Phishing', attack_count: N}).\",\n  \"SUGGESTED_APPROACH\": \"Traverse from IP nodes through the ATTACKS relationship to the Country node, restrict to the Country named Australia and ATTACKS.technique equal to Phishing (handling potential leading/trailing whitespace), then aggregate by counting the matching ATTACKS relationships. Ensure the count reflects attack records (relationships), not distinct IPs, unless the user specifies otherwise.\",\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Count the number of ATTACKS relationships with technique 'Phishing' that point to the Country node named 'Australia'.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Count the number of ATTACKS relationships with technique 'Phishing' that point to the Country node named 'Australia'."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique = 'T1566 Phishing' AND c.name = 'Australia'\nRETURN count(*) AS phishing_attacks_to_australia"
          ],
          "trace": [
            {
              "subproblem": "Count the number of ATTACKS relationships with technique 'Phishing' that point to the Country node named 'Australia'.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique = 'T1566 Phishing' AND c.name = 'Australia'\nRETURN count(*) AS phishing_attacks_to_australia",
                  "matched_pairs": [
                    {
                      "kind": "relationship",
                      "label": "ATTACKS",
                      "property": "technique",
                      "original": "Phishing",
                      "value": "T1566 Phishing"
                    },
                    {
                      "kind": "node",
                      "label": "Country",
                      "property": "name",
                      "original": "Australia",
                      "value": "Australia"
                    }
                  ],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "phishing_attacks_to_australia": 156
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(c:Country)\nWHERE a.technique = 'T1566 Phishing' AND c.name = 'Australia'\nRETURN count(*) AS phishing_attacks_to_australia"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "phishing_attacks_to_australia": 156
            }
          ]
        },
        "explanation": {
          "text": "It counts how many `ATTACKS` relationships originate from any `IP` to the `Country` node named \u201cAustralia\u201d where the attack technique is **T1566 Phishing**."
        }
      },
      "token_usage": {
        "input": 1389,
        "output": 594,
        "total": 1983
      },
      "duration_seconds": 22.678,
      "started_at": "2026-02-20T06:13:23.468770+00:00",
      "ended_at": "2026-02-20T06:13:46.147095+00:00",
      "metadata": {
        "time": "2026-02-20T06:13:46.134397+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    },
    {
      "index": 15,
      "category": "complex",
      "prompt": "Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.",
      "expected_cypher": "MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)\nMATCH (ip)-[a:ATTACKS]->(c:Country)\nWITH c.name AS country, a.technique AS technique, substring(toString(a.documented_create_date[0]),0,7) AS year_month, asn.number AS asn\nWITH country, technique, year_month, collect(DISTINCT asn)[0..50] AS asns\nUNWIND range(0, size(asns)-2) AS i\nUNWIND range(i+1, size(asns)-1) AS j\nWITH asns[i] AS asnA, asns[j] AS asnB, country, technique, year_month\nRETURN asnA, asnB, country, technique, year_month, count(*) AS co_attacks\nORDER BY co_attacks DESC\nLIMIT 10",
      "agent_cypher": "MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH victim.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns\nWITH country, technique, year_month, asns, size(asns) AS n\nWHERE n > 1\nUNWIND range(0, n - 2) AS i\nUNWIND range(i + 1, n - 1) AS j\nWITH country, technique, year_month, asns[i] AS x, asns[j] AS y\nWITH CASE WHEN x < y THEN x ELSE y END AS asn1,\n     CASE WHEN x < y THEN y ELSE x END AS asn2,\n     country, technique, year_month\nWITH asn1, asn2, count(*) AS co_attack_count\nRETURN asn1, asn2, co_attack_count\nORDER BY co_attack_count DESC\nLIMIT 10",
      "response": [
        {
          "asn1": "AS29789 reflected networks  inc.",
          "asn2": "AS57523 chang way technologies co. limited",
          "co_attack_count": 2800
        },
        {
          "asn1": "AS53334 total uptime technologies  llc",
          "asn2": "AS57523 chang way technologies co. limited",
          "co_attack_count": 2619
        },
        {
          "asn1": "AS29789 reflected networks  inc.",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_attack_count": 2580
        },
        {
          "asn1": "AS13335 cloudflare",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_attack_count": 1035
        },
        {
          "asn1": "AS53334 total uptime technologies  llc",
          "asn2": "AS54113 fastly",
          "co_attack_count": 1012
        },
        {
          "asn1": "AS13335 cloudflare",
          "asn2": "AS54113 fastly",
          "co_attack_count": 977
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS54113 fastly",
          "co_attack_count": 637
        },
        {
          "asn1": "AS13335 cloudflare",
          "asn2": "AS16509 amazon.com inc",
          "co_attack_count": 580
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS53334 total uptime technologies  llc",
          "co_attack_count": 575
        },
        {
          "asn1": "AS16509 amazon.com inc",
          "asn2": "AS7922 comcast",
          "co_attack_count": 529
        }
      ],
      "error": null,
      "analysis": {
        "has_query": true,
        "query_length": 681,
        "has_error": false,
        "error_type": "NONE",
        "has_results": true,
        "result_type": "list",
        "result_count": 10,
        "status": "SUCCESS",
        "status_detail": "Query executed successfully and returned 10 rows"
      },
      "agents": {
        "expansion": {
          "expanded": "{\n  \"INTENT\": \"Find collaborating or coincident attacker infrastructure by identifying pairs of ASNs that targeted the same victim country using the same attack technique during the same calendar month, then rank those ASN pairs by how often this co-occurrence happens.\",\n  \"KEY_ENTITIES\": {\n    \"NODES\": [\n      \"(:ASN {number})\",\n      \"(:IP {address, botnet, pulse_ids})\",\n      \"(:Country {name})\"\n    ],\n    \"RELATIONSHIPS\": [\n      \"(ip:IP)-[:BELONGS_TO]->(asn:ASN)  // maps each attacking IP to its ASN\",\n      \"(ip:IP)-[:ATTACKS {technique, protocol, technology, industry, pulse_id, documented_create_date, documented_modified_date}]->(country:Country)  // attack event with attributes including technique and timestamp\",\n      \"(ip:IP)-[:FROM]->(country:Country)  // origin country of the IP (not the attacked country)\"\n    ],\n    \"PRIMARY_PATH_OF_INTEREST\": \"ASN <- BELONGS_TO - IP - ATTACKS -> Victim Country\"\n  },\n  \"FILTERS\": {\n    \"CO_ATTACK_DEFINITION\": [\n      \"Two different ASNs (asnA != asnB) are considered co-attacking when each has at least one IP that ATTACKS the same victim Country\",\n      \"The ATTACKS relationships match on the same technique value\",\n      \"The ATTACKS relationships fall within the same calendar month (derived from documented_create_date; use documented_modified_date only if create date is missing, if that is acceptable in your data policy)\"\n    ],\n    \"PAIR_CANONICALIZATION\": \"Treat (asnA, asnB) as an unordered pair (e.g., always order by ASN number) so the pair is counted once.\",\n    \"COUNTING_RULE\": \"Co-attack count should represent the number of distinct (victim country, technique, month) groupings where both ASNs are present (to avoid inflating counts due to many IPs or many events within the same grouping).\",\n    \"OPTIONAL_EXCLUSIONS\": [\n      \"Ignore records where technique is null/empty\",\n      \"Ignore records where documented_create_date is null/invalid (unless falling back to documented_modified_date is explicitly allowed)\"\n    ],\n    \"NON_FILTER_NOTE\": \"The (ip)-[:FROM]->(country) relationship describes IP origin and is not part of the victim matching criteria unless you later want to restrict by attacker origin.\"\n  },\n  \"OUTPUT_FORMAT\": {\n    \"RESULT_ROWS\": \"Top 10 ASN pairs by co-attack count (descending).\",\n    \"FIELDS_PER_ROW\": [\n      \"asn1 (number)\",\n      \"asn2 (number)\",\n      \"co_attack_count\"\n    ],\n    \"OPTIONAL_ADDITIONAL_FIELDS_IF_USEFUL\": [\n      \"example_victim_countries and/or techniques contributing to the count\",\n      \"time_range (min/max month) covered\"\n    ],\n    \"SORTING_AND_LIMIT\": \"Sort by co_attack_count DESC, then optionally tie-break by ASN numbers; limit 10.\"\n  },\n  \"SUGGESTED_APPROACH\": [\n    \"Start from ATTACKS events and join each attacking IP to its ASN via BELONGS_TO.\",\n    \"Derive a normalized month key from the ATTACKS timestamp (e.g., YYYY-MM) using documented_create_date (or a defined fallback).\",\n    \"Group attacks by (victim country, technique, month, ASN) to establish which ASNs participated in each group (deduplicate within the group so multiple IPs/events from the same ASN don\u2019t overcount).\",\n    \"Within each (victim country, technique, month) group, form all unique unordered ASN pairs that appear in that group.\",\n    \"Aggregate across all groups to count how many distinct groups each ASN pair co-appears in (the co_attack_count).\",\n    \"Order by co_attack_count descending and return the top 10 pairs.\"\n  ],\n  \"NEEDS_DECOMPOSITION\": false,\n  \"SINGLE_TASK\": \"Compute the top 10 unordered pairs of distinct ASNs that both have IPs attacking the same victim country with the same technique in the same calendar month (based on ATTACKS documented_create_date), counting distinct (country, technique, month) co-occurrences per pair and returning asn1, asn2, and the co_attack_count sorted descending.\"\n}",
          "needs_decomposition": false
        },
        "decomposition": {
          "subproblems": [
            "Compute the top 10 unordered pairs of distinct ASNs that both have IPs attacking the same victim country with the same technique in the same calendar month (based on ATTACKS documented_create_date), counting distinct (country, technique, month) co-occurrences per pair and returning asn1, asn2, and the co_attack_count sorted descending."
          ]
        },
        "generation": {
          "fragments": [
            "MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH victim.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns\nWITH country, technique, year_month, asns, size(asns) AS n\nWHERE n > 1\nUNWIND range(0, n - 2) AS i\nUNWIND range(i + 1, n - 1) AS j\nWITH country, technique, year_month, asns[i] AS x, asns[j] AS y\nWITH CASE WHEN x < y THEN x ELSE y END AS asn1,\n     CASE WHEN x < y THEN y ELSE x END AS asn2,\n     country, technique, year_month\nWITH asn1, asn2, count(*) AS co_attack_count\nRETURN asn1, asn2, co_attack_count\nORDER BY co_attack_count DESC\nLIMIT 10"
          ],
          "trace": [
            {
              "subproblem": "Compute the top 10 unordered pairs of distinct ASNs that both have IPs attacking the same victim country with the same technique in the same calendar month (based on ATTACKS documented_create_date), counting distinct (country, technique, month) co-occurrences per pair and returning asn1, asn2, and the co_attack_count sorted descending.",
              "attempts": [
                {
                  "fragment": "MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH victim.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns\nWITH country, technique, year_month, asns, size(asns) AS n\nWHERE n > 1\nUNWIND range(0, n - 2) AS i\nUNWIND range(i + 1, n - 1) AS j\nWITH country, technique, year_month, asns[i] AS x, asns[j] AS y\nWITH CASE WHEN x < y THEN x ELSE y END AS asn1,\n     CASE WHEN x < y THEN y ELSE x END AS asn2,\n     country, technique, year_month\nWITH asn1, asn2, count(*) AS co_attack_count\nRETURN asn1, asn2, co_attack_count\nORDER BY co_attack_count DESC\nLIMIT 10",
                  "matched_pairs": [],
                  "ok": true,
                  "error": null,
                  "rows_preview": [
                    {
                      "asn1": "AS29789 reflected networks  inc.",
                      "asn2": "AS57523 chang way technologies co. limited",
                      "co_attack_count": 2800
                    },
                    {
                      "asn1": "AS53334 total uptime technologies  llc",
                      "asn2": "AS57523 chang way technologies co. limited",
                      "co_attack_count": 2619
                    },
                    {
                      "asn1": "AS29789 reflected networks  inc.",
                      "asn2": "AS53334 total uptime technologies  llc",
                      "co_attack_count": 2580
                    }
                  ]
                }
              ]
            }
          ]
        },
        "composition": {
          "final_query": "MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)\nMATCH (ip)-[:BELONGS_TO]->(asn:ASN)\nWITH victim.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns\nWITH country, technique, year_month, asns, size(asns) AS n\nWHERE n > 1\nUNWIND range(0, n - 2) AS i\nUNWIND range(i + 1, n - 1) AS j\nWITH country, technique, year_month, asns[i] AS x, asns[j] AS y\nWITH CASE WHEN x < y THEN x ELSE y END AS asn1,\n     CASE WHEN x < y THEN y ELSE x END AS asn2,\n     country, technique, year_month\nWITH asn1, asn2, count(*) AS co_attack_count\nRETURN asn1, asn2, co_attack_count\nORDER BY co_attack_count DESC\nLIMIT 10"
        },
        "final_validation": {
          "trace": null,
          "error": null,
          "results_preview": [
            {
              "asn1": "AS29789 reflected networks  inc.",
              "asn2": "AS57523 chang way technologies co. limited",
              "co_attack_count": 2800
            },
            {
              "asn1": "AS53334 total uptime technologies  llc",
              "asn2": "AS57523 chang way technologies co. limited",
              "co_attack_count": 2619
            },
            {
              "asn1": "AS29789 reflected networks  inc.",
              "asn2": "AS53334 total uptime technologies  llc",
              "co_attack_count": 2580
            }
          ]
        },
        "explanation": {
          "text": "This query finds the top 10 pairs of ASNs whose IPs attack the same victim country using the same technique in the same month, ranked by how often those ASN pairs co-occur."
        }
      },
      "token_usage": {
        "input": 1825,
        "output": 2151,
        "total": 3976
      },
      "duration_seconds": 65.295,
      "started_at": "2026-02-20T06:13:46.147616+00:00",
      "ended_at": "2026-02-20T06:14:51.442400+00:00",
      "metadata": {
        "time": "2026-02-20T06:14:51.429785+00:00",
        "model": "gpt-5.2",
        "provider": "openai",
        "commit": "fe230c779a507b7632ca5ff91ff4f38503fe6b67",
        "langfuse": {
          "enabled": true,
          "host": "https://us.cloud.langfuse.com"
        }
      }
    }
  ]
}