[Wed Feb 11 22:21:37 UTC 2026] Worker 2: Starting Run #10
[Wed Feb 11 22:21:37 UTC 2026] Worker 2: Tokens used so far: 482795

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.technique IS NOT NULL AND a.technique <> '' AND a.technique <> 'unknown'
WITH a.technique AS technique, count(*) AS occurrence_count
ORDER BY occurrence_count DESC
LIMIT 1
RETURN technique, occurrence_count
[validation] first rows: [{'technique': 'T1566 Phishing', 'occurrence_count': 2863569}]

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'phishing'"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'phishing'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE a.technique = 'phishing'
WITH DISTINCT ip
MATCH (ip)-[b:ATTACKS]->(:Country)
WHERE b.technique <> 'phishing'
WITH b.technique AS technique, count(*) AS frequency
WITH collect({technique: technique, frequency: frequency}) AS rows, sum(frequency) AS total
UNWIND rows AS row
RETURN row.technique AS technique, row.frequency AS frequency, (toFloat(row.frequency) / total) * 100.0 AS percentage
ORDER BY frequency DESC, technique ASC
[validation] first rows: []

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(target:Country)
WHERE a.protocol <> 'unknown'
  AND a.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  target.name AS target_country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  ip,
  asn,
  a
WITH
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  collect(DISTINCT asn.number) AS distinct_asns,
  count(DISTINCT ip) AS distinct_ip_count,
  count(a) AS total_attack_events
WHERE size(distinct_asns) >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  distinct_asns,
  size(distinct_asns) AS distinct_asn_count,
  distinct_ip_count,
  total_attack_events
ORDER BY total_attack_events DESC, distinct_ip_count DESC, distinct_asn_count DESC, year_month DESC
[validation] first rows: [{'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'Serverhosting', 'distinct_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'total_attack_events': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'distinct_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'total_attack_events': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'distinct_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'total_attack_events': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'distinct_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'total_attack_events': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'distinct_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'total_attack_events': 1793}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1022 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH count(DISTINCT ip) AS distinct_attacker_ips
MATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip2)-[a2:ATTACKS]->(target:Country)
WITH distinct_attacker_ips, target.name AS target_country, count(*) AS attacks_count
ORDER BY attacks_count DESC
LIMIT 5
WITH distinct_attacker_ips, collect({country: target_country, attacks: attacks_count}) AS top_5_target_countries
MATCH (ip3:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip3)-[a3:ATTACKS]->(:Country)
WHERE a3.technique <> 'unknown'
WITH distinct_attacker_ips, top_5_target_countries, a3.technique AS technique, count(*) AS technique_count
ORDER BY technique_count DESC
LIMIT 3
WITH distinct_attacker_ips, top_5_target_countries, collect({technique: technique, attacks: technique_count}) AS top_3_techniques
RETURN distinct_attacker_ips, top_5_target_countries, top_3_techniques
[validation] first rows: [{'distinct_attacker_ips': 2790, 'top_5_target_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_3_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip1:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip1)-[a1:ATTACKS]->(:Country)
WITH collect(DISTINCT ip1.address) AS ips, count(a1) AS total_attack_events
MATCH (ip2:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip2)-[a2:ATTACKS]->(:Country)
WHERE a2.industry IS NOT NULL AND a2.industry <> 'unknown'
WITH ips, total_attack_events, a2.industry AS industry, count(a2) AS industry_attack_count
ORDER BY industry_attack_count DESC
WITH size(ips) AS distinct_source_ips, total_attack_events, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries
RETURN distinct_source_ips, total_attack_events, top_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[r:ATTACKS]->(c:Country)
WITH asn, count(DISTINCT c) AS distinct_attacked_country_count, collect(DISTINCT c.name) AS attacked_country_names
ORDER BY distinct_attacked_country_count DESC
LIMIT 1
RETURN asn.number AS asn_number, distinct_attacked_country_count, attacked_country_names
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_attacked_country_count': 64, 'attacked_country_names': ['Ukraine', 'United States of America', 'United Kingdom of Great Britain and Northern Ireland', 'France', 'Norway', 'Turkey', 'Romania', 'Czechia', 'Denmark', 'Latvia', 'Lithuania', 'Estonia', 'Poland', 'Germany', 'Canada', 'Australia', 'Sweden', 'ukraine', 'Portugal', 'United States', 'Spain', 'Russian Federation', 'Italy', 'Brazil', 'germany', 'Kenya', 'Chile', 'Japan', 'Taiwan', 'Singapore', 'Peru', 'United Kingdom', 'Hungary', 'Ireland', 'Mexico', 'Netherlands', 'Argentina', 'Korea, Republic of', 'mexico', 'indonesia', 'Belgium', 'Guatemala', 'Slovakia', 'Morocco', 'Costa Rica', 'Aruba', 'China', 'Georgia', 'Saint Vincent and the Grenadines', 'Austria', 'Panama', 'Malaysia', 'Hong Kong', 'Bahamas', 'Sint Maarten (Dutch part)', 'Anguilla', 'Cayman Islands', 'Saint Kitts and Nevis', 'Philippines', 'Tanzania, United Republic of', 'Saint Martin (French part)', 'CuraÃ§ao', 'Barbados', 'Trinidad and Tobago']}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (516 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for SSH -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'SSH', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(target:Country)
WHERE a.protocol = 'ssh'
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (232 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": ""}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": ""}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WHERE a.industry = "Finance"
  AND a.technology IS NOT NULL
  AND trim(a.technology) <> ""
WITH a.technology AS technology, count(*) AS attack_count
RETURN technology, attack_count
ORDER BY attack_count DESC
[validation] first rows: [{'technology': 'unknown', 'attack_count': 5624}, {'technology': 'windows', 'attack_count': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "France"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "France"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'France'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'France'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'unknown'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for France -> France
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for unknown -> unknown
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'France', 'value': 'France'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[r:ATTACKS]->(c:Country)
WHERE c.name = 'France' AND r.protocol <> 'unknown'
WITH asn.number AS asn, r.protocol AS protocol, count(*) AS attack_count
ORDER BY asn, attack_count DESC
WITH asn, collect({protocol: protocol, count: attack_count})[0..3] AS top3_protocols
RETURN asn, top3_protocols
ORDER BY asn
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'top3_protocols': [{'protocol': 'ssh', 'count': 1}]}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'top3_protocols': [{'protocol': 'ssh', 'count': 2}]}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top3_protocols': [{'protocol': 'ssh', 'count': 4}]}, {'asn': 'AS10439 carinet  inc.', 'top3_protocols': [{'protocol': 'snmp', 'count': 4}, {'protocol': 'sip', 'count': 1}]}, {'asn': 'AS11419 telefnica brasil s.a', 'top3_protocols': [{'protocol': 'ssh', 'count': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WITH ip.botnet AS family, count(*) AS attack_count
WHERE family IS NOT NULL
RETURN family, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: [{'family': 'unknown', 'attack_count': 3025957}, {'family': 'botnet', 'attack_count': 73462}, {'family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'/'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "':'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "' '"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'/'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "':'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "' '"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'/'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "':'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "' '"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'/'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "':'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "' '"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for '':'' -> 'unknown' (LCS length 0)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for '' '' -> 'unknown' (LCS length 0)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''/'' -> 'unknown' (LCS length 0)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'unknown'", 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'/'", 'value': "'/'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "':'", 'value': "':'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "' '", 'value': "' '"}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WITH
  CASE
    WHEN r.protocol IS NULL OR r.protocol = 'unknown' THEN NULL
    WHEN r.protocol CONTAINS '/' THEN split(r.protocol, '/')[size(split(r.protocol, '/')) - 1]
    WHEN r.protocol CONTAINS ':' THEN split(r.protocol, ':')[size(split(r.protocol, ':')) - 1]
    WHEN r.protocol CONTAINS ' ' THEN split(r.protocol, ' ')[size(split(r.protocol, ' ')) - 1]
    ELSE NULL
  END AS portStr
WITH trim(portStr) AS portStr
WHERE portStr IS NOT NULL AND portStr =~ '^[0-9]+$'
WITH toInteger(portStr) AS port, count(*) AS attack_count
RETURN port, attack_count
ORDER BY attack_count DESC, port ASC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (:IP)-[r:ATTACKS {technique: 'Phishing'}]->(c:Country {name: 'Australia'})
RETURN count(*) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn) AS asns
WHERE size(asns) >= 2
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH
  country,
  technique,
  year_month,
  asns[i] AS asnA,
  asns[j] AS asnB
WITH
  CASE WHEN asnA.number < asnB.number THEN asnA.number ELSE asnB.number END AS asn1,
  CASE WHEN asnA.number < asnB.number THEN asnB.number ELSE asnA.number END AS asn2,
  country,
  technique,
  year_month
WITH
  asn1,
  asn2,
  count(DISTINCT [country.name, technique, year_month]) AS co_attack_occurrences
RETURN asn1, asn2, co_attack_occurrences
ORDER BY co_attack_occurrences DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  country.name AS country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
WITH country, technique, year_month, asns, range(0, size(asns) - 2) AS idxs
UNWIND idxs AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH country, technique, year_month, asns[i] AS asn1, asns[j] AS asn2
WITH
  CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_low,
  CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_high,
  country, technique, year_month
WITH asn_low, asn_high, count(*) AS co_attack_occurrences
RETURN asn_low, asn_high, co_attack_occurrences
ORDER BY co_attack_occurrences DESC
LIMIT 10
[validation] first rows: [{'asn_low': 'AS29789 reflected networks  inc.', 'asn_high': 'AS57523 chang way technologies co. limited', 'co_attack_occurrences': 2800}, {'asn_low': 'AS53334 total uptime technologies  llc', 'asn_high': 'AS57523 chang way technologies co. limited', 'co_attack_occurrences': 2619}, {'asn_low': 'AS29789 reflected networks  inc.', 'asn_high': 'AS53334 total uptime technologies  llc', 'co_attack_occurrences': 2580}, {'asn_low': 'AS13335 cloudflare', 'asn_high': 'AS53334 total uptime technologies  llc', 'co_attack_occurrences': 1035}, {'asn_low': 'AS53334 total uptime technologies  llc', 'asn_high': 'AS54113 fastly', 'co_attack_occurrences': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'Germany'})
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour <= 16
WITH a.protocol AS protocol, count(*) AS cnt
WITH max(cnt) AS maxCnt, collect({protocol: protocol, cnt: cnt}) AS rows
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY count DESC, protocol ASC
[matcher] LLM response: ```json
[
  {"kind": "node", "label": "Country", "property": "name", "value": "Germany"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "unknown"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 9},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 16}
]
```
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "Germany"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "unknown"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 9},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 16}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'Germany'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 9}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 16}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'Germany'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 9}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 16}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for Germany -> Germany
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for unknown -> unknown
    Agent raised an exception: 'int' object has no attribute 'lower'

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3485.88 seconds
Total tokens: 62,911

Status Breakdown:
  ðŸ”´ ERROR                    :   8 ( 40.0%)
  âœ… SUCCESS                  :   8 ( 40.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   4 ( 20.0%)

Error Types:
  ðŸ”´ OTHER                         :   8

Success Rate: 40.0%

Results saved to: gpt-5.2_results_950k/run_10.json
================================================================================

[Wed Feb 11 23:19:48 UTC 2026] Worker 2: Run #10 completed
[Wed Feb 11 23:19:48 UTC 2026] Worker 2: Tokens in this run: 62911
[Wed Feb 11 23:19:48 UTC 2026] Worker 2: Total tokens: 545706
[Wed Feb 11 23:19:48 UTC 2026] Worker 2: Progress: 45%
[Wed Feb 11 23:19:50 UTC 2026] Worker 2: Starting Run #11
[Wed Feb 11 23:19:50 UTC 2026] Worker 2: Tokens used so far: 545706

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (512 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(victim:Country)
WHERE r.protocol <> 'unknown'
  AND r.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  victim,
  date.truncate('month', r.documented_create_date) AS year_month,
  r.protocol AS protocol,
  r.technique AS technique,
  r.industry AS industry,
  collect(DISTINCT asn.number) AS asn_list,
  count(*) AS attack_count,
  count(DISTINCT ip.address) AS distinct_ip_count
WHERE size(asn_list) >= 2
RETURN
  year_month,
  victim.name AS country,
  protocol,
  technique,
  industry,
  asn_list,
  attack_count,
  distinct_ip_count
ORDER BY attack_count DESC, distinct_ip_count DESC, year_month DESC, country ASC, protocol ASC, technique ASC, industry ASC
[validation] first rows: [{'year_month': neo4j.time.Date(2022, 5, 1), 'country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'attack_count': 1793, 'distinct_ip_count': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'attack_count': 1793, 'distinct_ip_count': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'attack_count': 1793, 'distinct_ip_count': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'attack_count': 1793, 'distinct_ip_count': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'country': 'Germany', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'attack_count': 1793, 'distinct_ip_count': 212}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (241 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_attacker_ips
UNWIND ips AS ip2
MATCH (ip2)-[a:ATTACKS]->(t:Country)
WITH ips, distinct_attacker_ips, t.name AS target_country, count(a) AS attack_count
ORDER BY attack_count DESC, target_country ASC
WITH ips, distinct_attacker_ips, collect({country: target_country, attacks: attack_count})[0..5] AS top_target_countries
UNWIND ips AS ip3
MATCH (ip3)-[a2:ATTACKS]->(:Country)
WHERE a2.technique <> 'unknown' AND a2.technique IS NOT NULL
WITH distinct_attacker_ips, top_target_countries, a2.technique AS technique, count(*) AS technique_count
ORDER BY technique_count DESC, technique ASC
WITH distinct_attacker_ips, top_target_countries, collect({technique: technique, count: technique_count})[0..3] AS top_techniques
RETURN distinct_attacker_ips, top_target_countries, top_techniques
[validation] first rows: [{'distinct_attacker_ips': 2790, 'top_target_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_techniques': [{'technique': 'T1566 Phishing', 'count': 533403}, {'technique': 'T1110 Brute Force', 'count': 8224}, {'technique': 'T1595 Active Scanning', 'count': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_ip_count, a.industry AS industry, count(a) AS industry_attack_count
WITH distinct_ip_count, sum(industry_attack_count) AS total_attack_relationships, collect({industry: industry, attack_count: industry_attack_count}) AS industry_counts
UNWIND industry_counts AS ic
WITH distinct_ip_count, total_attack_relationships, ic
ORDER BY ic.attack_count DESC
WITH distinct_ip_count, total_attack_relationships, collect(ic)[0..5] AS top_5_industries
RETURN distinct_ip_count, total_attack_relationships, top_5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[r:ATTACKS]->(target:Country)
WITH asn, count(DISTINCT target) AS distinct_country_count
WITH max(distinct_country_count) AS max_distinct_country_count
MATCH (ip2:IP)-[:BELONGS_TO]->(asn2:ASN)
MATCH (ip2)-[r2:ATTACKS]->(target2:Country)
WITH asn2, count(DISTINCT target2) AS distinct_country_count, max_distinct_country_count
WHERE distinct_country_count = max_distinct_country_count
RETURN asn2.number AS asn_number, distinct_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (411 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})
MATCH (ip)-[r:ATTACKS {protocol: 'ssh'}]->(target:Country)
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (216 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (133 chars)

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (c:Country {name: 'France'})
MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[a:ATTACKS]->(c)
WHERE a.protocol <> 'unknown'
WITH asn.number AS asn_number, a.protocol AS protocol, count(*) AS protocol_count
ORDER BY asn_number, protocol_count DESC, protocol ASC
WITH asn_number, collect({protocol: protocol, count: protocol_count})[0..3] AS top_protocols
RETURN asn_number, top_protocols
ORDER BY asn_number ASC
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'top_protocols': [{'protocol': 'ssh', 'count': 1}]}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'top_protocols': [{'protocol': 'ssh', 'count': 2}]}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top_protocols': [{'protocol': 'ssh', 'count': 4}]}, {'asn_number': 'AS10439 carinet  inc.', 'top_protocols': [{'protocol': 'snmp', 'count': 4}, {'protocol': 'sip', 'count': 1}]}, {'asn_number': 'AS11419 telefnica brasil s.a', 'top_protocols': [{'protocol': 'ssh', 'count': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> '' AND ip.botnet <> 'unknown'
WITH ip.botnet AS malware_family,
     count(*) AS attack_count,
     count(DISTINCT ip) AS distinct_ip_count,
     count(DISTINCT c) AS distinct_target_country_count
ORDER BY attack_count DESC
LIMIT 5
RETURN malware_family, attack_count, distinct_ip_count, distinct_target_country_count
[validation] first rows: [{'malware_family': 'botnet', 'attack_count': 73462, 'distinct_ip_count': 163, 'distinct_target_country_count': 53}, {'malware_family': 'mirai', 'attack_count': 36090, 'distinct_ip_count': 17, 'distinct_target_country_count': 61}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (:IP)-[a:ATTACKS]->(:Country)
WHERE a.destination_port IS NOT NULL
  AND a.protocol IS NOT NULL
  AND a.protocol <> 'unknown'
WITH a.protocol AS protocol, a.destination_port AS destination_port, count(*) AS attack_count
RETURN protocol, destination_port, attack_count
ORDER BY attack_count DESC
LIMIT coalesce($topN, 10)
[validation] executing: MATCH ()-[r:ATTACKS]->()
WHERE r.destination_port IS NOT NULL
WITH r, CASE WHEN coalesce($segmentByProtocol, false) THEN r.protocol ELSE 'all' END AS protocol_group
WHERE protocol_group <> 'unknown'
WITH r.destination_port AS destination_port, protocol_group AS protocol, count(*) AS attack_count
RETURN destination_port, protocol, attack_count
ORDER BY attack_count DESC
LIMIT coalesce($topN, 10)
[validation] executing: MATCH (:IP)-[a:ATTACKS]->(:Country)
WHERE a.destination_port IS NOT NULL
WITH a.destination_port AS destination_port, a.protocol AS protocol
WHERE protocol IS NOT NULL AND protocol <> 'unknown'
WITH destination_port, protocol, count(*) AS attacks
WITH destination_port, sum(attacks) AS attack_count, collect({protocol: protocol, attacks: attacks}) AS by_protocol
ORDER BY attack_count DESC
LIMIT toInteger(coalesce($topN, 10))
RETURN destination_port, attack_count, by_protocol

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "Phishing"},
  {"kind": "node", "label": "Country", "property": "name", "value": "Australia"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "Phishing"},
  {"kind": "node", "label": "Country", "property": "name", "value": "Australia"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'Phishing'}, {'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'Australia'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'Phishing'}, {'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'Australia'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for Australia -> Australia
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'Phishing' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'Phishing', 'value': 'T1566 Phishing'}, {'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'Australia', 'value': 'Australia'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE r.technique = 'T1566 Phishing' AND c.name = 'Australia'
RETURN count(r) AS phishing_attacks_to_australia_count
[validation] first rows: [{'phishing_attacks_to_australia_count': 156}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  victim.name AS country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
WITH country, technique, year_month, asns, range(0, size(asns) - 2) AS iRange
UNWIND iRange AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, country, technique, year_month
WITH
  CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_low,
  CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_high,
  country, technique, year_month
WITH asn_low, asn_high, count(DISTINCT {country: country, technique: technique, month: year_month}) AS shared_combinations
RETURN asn_low AS asn1, asn_high AS asn2, shared_combinations
ORDER BY shared_combinations DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(victim:Country)
WHERE r.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH victim.name AS country, r.technique AS technique, date.truncate('month', r.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH country, technique, year_month, asns, range(0, size(asns) - 2) AS idxs
UNWIND idxs AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH
  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,
  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2,
  [country, technique, year_month] AS combo
WITH asn1, asn2, count(DISTINCT combo) AS shared_combos
ORDER BY shared_combos DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_combos
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.documented_create_date IS NOT NULL
WITH victim, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns
WITH victim, technique, year_month, asns, size(asns) AS n
WHERE n > 1
UNWIND range(0, n - 2) AS i
UNWIND range(i + 1, n - 1) AS j
WITH victim, technique, year_month, asns[i] AS asn1, asns[j] AS asn2
WITH
  CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_a,
  CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_b,
  victim.name AS country,
  technique,
  year_month
WITH asn_a, asn_b, count(DISTINCT {country: country, technique: technique, month: year_month}) AS shared_combos
ORDER BY shared_combos DESC, asn_a ASC, asn_b ASC
LIMIT 10
RETURN asn_a AS asn1, asn_b AS asn2, shared_combos

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (c:Country {name: 'Germany'})
MATCH (ip:IP)-[a:ATTACKS]->(c)
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour <= 16
WITH a.protocol AS protocol, count(*) AS cnt
WITH max(cnt) AS maxCnt, collect({protocol: protocol, cnt: cnt}) AS rows
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol ASC
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "9"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.minute", "value": "0"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.second", "value": "0"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "9"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.minute", "value": "0"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.second", "value": "0"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.minute', 'value': '0'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.second', 'value': '0'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.minute', 'value': '0'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.second', 'value': '0'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.minute IS NOT NULL RETURN DISTINCT r.documented_create_date.minute AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.second IS NOT NULL RETURN DISTINCT r.documented_create_date.second AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Germany'' -> 'Germany' (LCS length 7)
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] exact match for 16 -> 16
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] exact match for 9 -> 9
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: [14, 29, 28, 27, 54]
[matcher] exact match for 0 -> 0
[matcher] first rows: [18, 19, 58, 48, 55]
[matcher] exact match for 0 -> 0
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] exact match for 16 -> 16
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'Germany'", 'value': 'Germany'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'unknown'", 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'original': '9', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'original': '16', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'original': '16', 'value': '16'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.minute', 'original': '0', 'value': '0'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.second', 'original': '0', 'value': '0'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND (
    r.documented_create_date.hour < 16
    OR (
      r.documented_create_date.hour = 16
      AND r.documented_create_date.minute = 0
      AND r.documented_create_date.second = 0
    )
  )
WITH r.protocol AS protocol, count(*) AS cnt
WITH collect({protocol: protocol, cnt: cnt}) AS rows, max(cnt) AS maxCnt
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'Germany'})
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date IS NOT NULL
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour <= 16
WITH a.protocol AS protocol, count(*) AS cnt
ORDER BY cnt DESC
WITH collect({protocol: protocol, cnt: cnt}) AS rows, head(collect({protocol: protocol, cnt: cnt})).cnt AS maxCnt
UNWIND rows AS row
WITH row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol
[validation] first rows: [{'protocol': 'tcp', 'count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'brute-force' -> 'T1110 Brute Force' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'brute-force', 'value': 'T1110 Brute Force'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(:Country)
WHERE r.technique = 'T1110 Brute Force'
WITH DISTINCT ip
MATCH (ip)-[:FROM]->(hostCountry:Country)
RETURN hostCountry.name AS country, count(DISTINCT ip) AS distinct_ip_count
ORDER BY distinct_ip_count DESC, country ASC
[validation] first rows: [{'country': 'China', 'distinct_ip_count': 1359}, {'country': 'United States of America', 'distinct_ip_count': 617}, {'country': 'Russian Federation', 'distinct_ip_count': 178}, {'country': 'India', 'distinct_ip_count': 167}, {'country': 'Singapore', 'distinct_ip_count': 159}]

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {
    "kind": "relationship",
    "label": "ATTACKS",
    "property": "technique",
    "value": "T1485 (Data Destruction)"
  }
]
[matcher] cleaned response: [
  {
    "kind": "relationship",
    "label": "ATTACKS",
    "property": "technique",
    "value": "T1485 (Data Destruction)"
  }
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485 (Data Destruction)'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485 (Data Destruction)'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'T1485 (Data Destruction)' -> 'T1485 Data Destruction' (LCS length 16)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'T1485 (Data Destruction)', 'value': 'T1485 Data Destruction'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.technique = 'T1485 Data Destruction'
WITH c, count(*) AS attack_count
ORDER BY attack_count DESC, c.name ASC
RETURN c.name AS country, attack_count
LIMIT 1
[validation] first rows: [{'country': 'United States of America', 'attack_count': 61}]

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WITH
  country,
  count(DISTINCT date(a.documented_create_date)) AS active_days,
  count(*) AS total_attacks,
  min(a.documented_create_date) AS first_seen,
  max(a.documented_create_date) AS last_seen
RETURN
  country.name AS country,
  active_days,
  total_attacks,
  first_seen,
  last_seen
ORDER BY active_days DESC, total_attacks DESC, country ASC
[validation] first rows: [{'country': 'United States of America', 'active_days': 886, 'total_attacks': 254170, 'first_seen': neo4j.time.DateTime(2018, 2, 10, 0, 36, 0, 396000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 22, 6, 45, 45, 714000000, tzinfo=<UTC>)}, {'country': 'Australia', 'active_days': 739, 'total_attacks': 19984, 'first_seen': neo4j.time.DateTime(2022, 1, 1, 8, 20, 2, 967000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 25, 8, 20, 9, 38000000, tzinfo=<UTC>)}, {'country': 'France', 'active_days': 399, 'total_attacks': 195247, 'first_seen': neo4j.time.DateTime(2022, 1, 1, 9, 40, 3, 240000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 25, 9, 40, 24, 412000000, tzinfo=<UTC>)}, {'country': 'Malaysia', 'active_days': 302, 'total_attacks': 2044, 'first_seen': neo4j.time.DateTime(2022, 5, 31, 12, 8, 22, 944000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 25, 23, 43, 55, 354000000, tzinfo=<UTC>)}, {'country': 'Poland', 'active_days': 274, 'total_attacks': 196108, 'first_seen': neo4j.time.DateTime(2021, 4, 28, 6, 16, 19, 579000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 24, 9, 43, 8, 222000000, tzinfo=<UTC>)}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(:Country)
WITH
  ip,
  count(*) AS attack_count,
  min(r.documented_create_date) AS first_seen,
  max(r.documented_create_date) AS last_seen,
  count(DISTINCT r.pulse_id) AS distinct_pulses,
  count(DISTINCT date.truncate('month', r.documented_create_date)) AS distinct_periods
WITH
  ip,
  attack_count,
  first_seen,
  last_seen,
  distinct_pulses,
  distinct_periods,
  duration.between(first_seen, last_seen).days AS active_span_days,
  (duration.between(first_seen, last_seen).days + (distinct_periods * 30) + distinct_pulses) AS persistence_score
RETURN
  ip.address AS ip_address,
  first_seen,
  last_seen,
  attack_count,
  distinct_pulses,
  distinct_periods,
  active_span_days,
  persistence_score,
  [ (ip)-[:BELONGS_TO]->(a:ASN) | a.number ][0] AS asn,
  [ (ip)-[:FROM]->(sc:Country) | sc.name ][0] AS source_country
ORDER BY persistence_score DESC, distinct_periods DESC, active_span_days DESC, attack_count DESC
LIMIT 10
[validation] first rows: [{'ip_address': '198.185.159.145', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 22, 6, 45, 45, 714000000, tzinfo=<UTC>), 'attack_count': 9487, 'distinct_pulses': 38, 'distinct_periods': 15, 'active_span_days': 10, 'persistence_score': 498, 'asn': 'AS53831 squarespace  inc.', 'source_country': 'United States of America'}, {'ip_address': '85.121.193.204', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 1, 15, 6, 0, 27, 154000000, tzinfo=<UTC>), 'attack_count': 260, 'distinct_pulses': 40, 'distinct_periods': 15, 'active_span_days': 3, 'persistence_score': 493, 'asn': 'AS44081 yul pro srl', 'source_country': 'Romania'}, {'ip_address': '189.195.118.9', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 12, 17, 17, 41, 45, 306000000, tzinfo=<UTC>), 'attack_count': 486, 'distinct_pulses': 46, 'distinct_periods': 14, 'active_span_days': 6, 'persistence_score': 472, 'asn': 'AS13999 mega cable  s.a. de c.v.', 'source_country': 'Mexico'}, {'ip_address': '185.230.63.171', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 3, 0, 35, 30, 936000000, tzinfo=<UTC>), 'attack_count': 6907, 'distinct_pulses': 29, 'distinct_periods': 14, 'active_span_days': 22, 'persistence_score': 471, 'asn': 'AS58182 wix.com ltd.', 'source_country': 'United States of America'}, {'ip_address': '95.9.192.159', 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 1, 4, 6, 0, 21, 516000000, tzinfo=<UTC>), 'attack_count': 43, 'distinct_pulses': 43, 'distinct_periods': 14, 'active_span_days': 7, 'persistence_score': 470, 'asn': 'AS47331 ttnet a.s.', 'source_country': 'TÃ¼rkiye'}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3902.34 seconds
Total tokens: 59,934

Status Breakdown:
  ðŸ”´ ERROR                    :   8 ( 40.0%)
  âœ… SUCCESS                  :  10 ( 50.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   2 ( 10.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   2
  ðŸ”´ OTHER                         :   6

Success Rate: 50.0%

Results saved to: gpt-5.2_results_950k/run_11.json
================================================================================

[Thu Feb 12 00:24:55 UTC 2026] Worker 2: Run #11 completed
[Thu Feb 12 00:24:55 UTC 2026] Worker 2: Tokens in this run: 59934
[Thu Feb 12 00:24:55 UTC 2026] Worker 2: Total tokens: 605640
[Thu Feb 12 00:24:55 UTC 2026] Worker 2: Progress: 50%
[Thu Feb 12 00:24:57 UTC 2026] Worker 2: Starting Run #12
[Thu Feb 12 00:24:57 UTC 2026] Worker 2: Tokens used so far: 605640

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WITH r.technique AS technique, count(*) AS total_count
ORDER BY total_count DESC
LIMIT 1
RETURN technique, total_count
[validation] first rows: [{'technique': 'T1566 Phishing', 'total_count': 2863569}]

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "phishing"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "phishing"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "unknown"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "phishing"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "phishing"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] exact match for unknown -> unknown
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'phishing' -> 'T1566 Phishing' (LCS length 8)
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'phishing' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'phishing', 'value': 'T1566 Phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'phishing', 'value': 'T1566 Phishing'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[p:ATTACKS]->(:Country)
WHERE p.technique = 'T1566 Phishing'
WITH DISTINCT ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.technique <> 'phishing' AND a.technique <> 'unknown' AND a.technique IS NOT NULL
WITH a.technique AS technique, count(*) AS technique_count
WITH collect({technique: technique, technique_count: technique_count}) AS rows, sum(technique_count) AS total_non_phishing
UNWIND rows AS row
RETURN
  row.technique AS technique,
  row.technique_count AS count,
  (toFloat(row.technique_count) / total_non_phishing) * 100.0 AS percentage_share
ORDER BY count DESC
[validation] first rows: [{'technique': 'T1566 Phishing', 'count': 2863569, 'percentage_share': 94.31495594624424}, {'technique': 'T1595 Active Scanning', 'count': 19712, 'percentage_share': 0.6492375115153036}, {'technique': 'T1110 Brute Force', 'count': 13452, 'percentage_share': 0.44305717354423013}, {'technique': 'T1204 User Execution', 'count': 6119, 'percentage_share': 0.2015363399432905}, {'technique': 'T1071 Application Layer Protocol', 'count': 4126, 'percentage_share': 0.1358945805860462}]

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.protocol <> 'unknown'
  AND a.technique <> 'unknown'
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  collect(DISTINCT asn.number) AS asn_list,
  count(*) AS attack_count,
  count(DISTINCT ip.address) AS distinct_ip_count
WHERE size(asn_list) >= 2
RETURN
  year_month,
  country.name AS country,
  protocol,
  technique,
  industry,
  asn_list,
  size(asn_list) AS distinct_asn_count,
  attack_count,
  distinct_ip_count
ORDER BY year_month DESC, country, protocol, technique, industry
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_asn_count': 123, 'attack_count': 309, 'distinct_ip_count': 230}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'France', 'protocol': 'sip', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asn_list': ['ASNone ', 'AS396982 google', 'AS398324 censys  inc.', 'AS29791 internap holding llc', 'AS211298 constantine cybersecurity ltd.', 'AS202425 ip volume inc'], 'distinct_asn_count': 6, 'attack_count': 10, 'distinct_ip_count': 10}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'France', 'protocol': 'snmp', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['ASNone ', 'AS135377 ucloud information technology (hk) limited', 'AS396982 google', 'AS6130 american internet services  llc.', 'AS398324 censys  inc.', 'AS6939 hurricane electric llc', 'AS197068 hll llc', 'AS211298 constantine cybersecurity ltd.', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.'], 'distinct_asn_count': 11, 'attack_count': 20, 'distinct_ip_count': 18}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (406 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS total_attackers
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(dest:Country)
WITH ips, total_attackers, dest.name AS dest_country, count(a) AS attack_count
ORDER BY attack_count DESC
WITH ips, total_attackers, collect({country: dest_country, attacks: attack_count})[0..5] AS top_destinations
UNWIND ips AS ip
MATCH (ip)-[a2:ATTACKS]->(:Country)
WHERE a2.technique <> 'unknown'
WITH total_attackers, top_destinations, a2.technique AS technique, count(a2) AS freq
ORDER BY freq DESC
WITH total_attackers, top_destinations, collect({technique: technique, attacks: freq})[0..3] AS top_techniques
RETURN {
  total_distinct_attacker_ips: total_attackers,
  top_destination_countries: top_destinations,
  top_attack_techniques: top_techniques
} AS summary
[validation] first rows: [{'summary': {'top_destination_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_attack_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}], 'total_distinct_attacker_ips': 2790}}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (src:Country {name: 'Russia'})<-[:FROM]-(ip:IP)
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH count(DISTINCT ip) AS distinct_ips, count(a) AS total_attacks
MATCH (src:Country {name: 'Russia'})<-[:FROM]-(ip:IP)
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attack_count
ORDER BY industry_attack_count DESC
LIMIT 5
RETURN distinct_ips, total_attacks, industry, industry_attack_count
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(country:Country)
WITH asn, count(DISTINCT country) AS distinct_country_count
WITH max(distinct_country_count) AS max_country_count, collect({asn: asn, cnt: distinct_country_count}) AS rows
UNWIND rows AS row
WHERE row.cnt = max_country_count
RETURN row.asn.number AS asn_number, row.cnt AS distinct_country_count
ORDER BY asn_number
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(dest:Country)
WITH asn, count(DISTINCT dest) AS distinct_country_count
WITH max(distinct_country_count) AS max_country_count
MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(dest:Country)
WITH asn, count(DISTINCT dest) AS distinct_country_count, max_country_count
WHERE distinct_country_count = max_country_count
RETURN asn.number AS asn_number, distinct_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (225 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(origin:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS {protocol: 'SSH'}]->(target:Country)
WITH target, count(a) AS attack_event_count
RETURN target.name AS target_country, attack_event_count
ORDER BY attack_event_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (216 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] exact match for unknown -> unknown
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance'
  AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS attacks_count
RETURN technology, attacks_count
ORDER BY attacks_count DESC
[validation] first rows: [{'technology': 'windows', 'attacks_count': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[a:ATTACKS]->(c:Country {name: 'France'})
WHERE a.protocol <> 'unknown'
WITH asn.number AS asn_number, a.protocol AS protocol, count(*) AS attack_count
ORDER BY asn_number, attack_count DESC, protocol
WITH asn_number, collect({protocol: protocol, count: attack_count})[0..3] AS top3_protocols
RETURN asn_number, top3_protocols
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'top3_protocols': [{'protocol': 'ssh', 'count': 1}]}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'top3_protocols': [{'protocol': 'ssh', 'count': 2}]}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top3_protocols': [{'protocol': 'ssh', 'count': 4}]}, {'asn_number': 'AS10439 carinet  inc.', 'top3_protocols': [{'protocol': 'snmp', 'count': 4}, {'protocol': 'sip', 'count': 1}]}, {'asn_number': 'AS11419 telefnica brasil s.a', 'top3_protocols': [{'protocol': 'ssh', 'count': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> ''
WITH ip.botnet AS malware_family, count(*) AS event_count
RETURN malware_family, event_count
ORDER BY event_count DESC
LIMIT 5
[validation] first rows: [{'malware_family': 'unknown', 'event_count': 3025957}, {'malware_family': 'botnet', 'event_count': 73462}, {'malware_family': 'mirai', 'event_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(:Country)
WHERE r.protocol IS NOT NULL AND r.protocol <> 'unknown'
WITH
  ip,
  r,
  toInteger(
    replace(
      replace(
        replace(
          replace(
            replace(
              replace(
                replace(
                  replace(
                    replace(
                      replace(
                        replace(
                          replace(r.protocol, 'tcp/', ''),
                        'udp/', ''),
                      'tcp:', ''),
                    'udp:', ''),
                  '/tcp', ''),
                '/udp', ''),
              'tcp ', ''),
            'udp ', ''),
          'tcp', ''),
        'udp', ''),
      '/', ''),
    ':', '')
  ) AS port
WHERE port IS NOT NULL
RETURN
  port,
  count(*) AS attack_count,
  count(DISTINCT ip.address) AS distinct_source_ips,
  count(DISTINCT r.pulse_id) AS distinct_pulse_ids
ORDER BY attack_count DESC, port ASC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})
WHERE trim(r.technique) = 'Phishing'
RETURN count(*) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.technique <> 'unknown'
  AND coalesce(r.documented_create_date, r.documented_modified_date) IS NOT NULL
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  country,
  r.technique AS technique,
  date.truncate('month', coalesce(r.documented_create_date, r.documented_modified_date)) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
MATCH (a1:ASN), (a2:ASN)
WHERE a1.number IN asns
  AND a2.number IN asns
  AND a1.number < a2.number
WITH a1.number AS asn1, a2.number AS asn2, count(*) AS co_attack_count
RETURN asn1, asn2, co_attack_count
ORDER BY co_attack_count DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] first rows: [{'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_count': 2769}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_count': 2589}, {'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_count': 2551}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_count': 1035}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS54113 fastly', 'co_attack_count': 983}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: "Germany"})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour <= 16
WITH r.protocol AS protocol, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 1
RETURN protocol, attack_count
[validation] first rows: [{'protocol': 'tcp', 'attack_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (288 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (288 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (288 chars)

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(tgt:Country)
WITH
  ip,
  min(a.documented_create_date) AS first_seen,
  max(a.documented_create_date) AS last_seen,
  count(*) AS total_attack_records,
  count(DISTINCT date.truncate('month', a.documented_create_date)) AS active_month_buckets,
  count(DISTINCT tgt.name) AS distinct_target_countries
WITH
  ip,
  first_seen,
  last_seen,
  total_attack_records,
  active_month_buckets,
  distinct_target_countries,
  duration.between(first_seen, last_seen).days AS active_span_days
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
OPTIONAL MATCH (ip)-[:FROM]->(src:Country)
WITH
  ip,
  first_seen,
  last_seen,
  active_span_days,
  active_month_buckets,
  total_attack_records,
  distinct_target_countries,
  collect(DISTINCT asn.number) AS asn_numbers,
  collect(DISTINCT src.name) AS source_countries
ORDER BY active_span_days DESC, active_month_buckets DESC, total_attack_records DESC, ip.address ASC
LIMIT 10
RETURN
  ip.address AS ip_address,
  first_seen,
  last_seen,
  active_span_days,
  active_month_buckets AS recurrence_month_buckets,
  total_attack_records,
  distinct_target_countries,
  asn_numbers,
  source_countries
[validation] first rows: [{'ip_address': '66.254.114.41', 'first_seen': neo4j.time.DateTime(2023, 11, 9, 4, 0, 48, 87000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 8, 5, 13, 13, 781000000, tzinfo=<UTC>), 'active_span_days': 30, 'recurrence_month_buckets': 11, 'total_attack_records': 25387, 'distinct_target_countries': 55, 'asn_numbers': ['AS29789 reflected networks  inc.'], 'source_countries': ['United States of America']}, {'ip_address': '14.224.160.150', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 6, 11, 1, 0, 55, 853000000, tzinfo=<UTC>), 'active_span_days': 30, 'recurrence_month_buckets': 9, 'total_attack_records': 242, 'distinct_target_countries': 17, 'asn_numbers': ['AS45899 vnpt corp'], 'source_countries': ['Viet Nam']}, {'ip_address': '43.134.181.196', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 6, 11, 1, 0, 41, 936000000, tzinfo=<UTC>), 'active_span_days': 30, 'recurrence_month_buckets': 8, 'total_attack_records': 232, 'distinct_target_countries': 17, 'asn_numbers': ['AS132203 tencent building  kejizhongyi avenue'], 'source_countries': ['Singapore']}, {'ip_address': '180.76.164.4', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 11, 11, 6, 46, 12, 200000000, tzinfo=<UTC>), 'active_span_days': 30, 'recurrence_month_buckets': 8, 'total_attack_records': 58, 'distinct_target_countries': 18, 'asn_numbers': ['AS38365 beijing baidu netcom science and technology co.  ltd.'], 'source_countries': ['China']}, {'ip_address': '104.152.52.23', 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 4, 10, 15, 1, 22, 293000000, tzinfo=<UTC>), 'active_span_days': 30, 'recurrence_month_buckets': 7, 'total_attack_records': 1310, 'distinct_target_countries': 16, 'asn_numbers': ['AS14987 rethem hosting llc'], 'source_countries': ['United States of America']}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4489.26 seconds
Total tokens: 48,933

Status Breakdown:
  ðŸ”´ ERROR                    :   6 ( 30.0%)
  âœ… SUCCESS                  :  11 ( 55.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ OTHER                         :   6

Success Rate: 55.0%

Results saved to: gpt-5.2_results_950k/run_12.json
================================================================================

[Thu Feb 12 01:39:49 UTC 2026] Worker 2: Run #12 completed
[Thu Feb 12 01:39:49 UTC 2026] Worker 2: Tokens in this run: 48933
[Thu Feb 12 01:39:49 UTC 2026] Worker 2: Total tokens: 654573
[Thu Feb 12 01:39:49 UTC 2026] Worker 2: Progress: 54%
[Thu Feb 12 01:39:51 UTC 2026] Worker 2: Starting Run #13
[Thu Feb 12 01:39:51 UTC 2026] Worker 2: Tokens used so far: 654573

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE r.technique IS NOT NULL AND trim(r.technique) <> ''
WITH r.technique AS technique, count(*) AS total_count
ORDER BY total_count DESC
LIMIT 1
RETURN technique, total_count
[validation] first rows: [{'technique': 'T1566 Phishing', 'total_count': 2863569}]

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'phishing'"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'phishing'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE a.technique = 'phishing'
WITH DISTINCT ip
MATCH (ip)-[a2:ATTACKS]->(:Country)
WHERE a2.technique <> 'phishing'
WITH a2.technique AS technique, count(*) AS attack_count
WITH collect({technique: technique, attack_count: attack_count}) AS rows, sum(attack_count) AS total
UNWIND rows AS row
WITH
  row.technique AS technique,
  row.attack_count AS attack_count,
  CASE WHEN total = 0 THEN 0.0 ELSE (toFloat(row.attack_count) / total) * 100 END AS percent_share
ORDER BY attack_count DESC
RETURN technique, attack_count, percent_share
[validation] first rows: []

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.protocol <> 'unknown'
  AND a.technique <> 'unknown'
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  c.name AS country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  collect(DISTINCT asn.number) AS asns,
  count(*) AS attack_count,
  count(DISTINCT ip.address) AS ip_count
WITH
  year_month, country, protocol, technique, industry,
  asns, size(asns) AS asn_count,
  attack_count, ip_count
WHERE asn_count >= 2
RETURN
  year_month,
  country,
  protocol,
  technique,
  industry,
  asns,
  asn_count,
  attack_count,
  ip_count
ORDER BY year_month DESC, attack_count DESC, asn_count DESC, country, protocol, technique, industry
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'asn_count': 123, 'attack_count': 723, 'ip_count': 412}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'asn_count': 174, 'attack_count': 373, 'ip_count': 373}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'asn_count': 123, 'attack_count': 309, 'ip_count': 230}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'asn_count': 67, 'attack_count': 118, 'ip_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'asn_count': 67, 'attack_count': 118, 'ip_count': 118}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (225 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_attackers
UNWIND ips AS ip
MATCH (ip)-[:ATTACKS]->(victim:Country)
WITH ips, distinct_attackers, victim.name AS victim_country, count(*) AS victim_attacks
ORDER BY victim_attacks DESC, victim_country ASC
WITH ips, distinct_attackers, collect({country: victim_country, attacks: victim_attacks})[0..5] AS top_5_victim_countries
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_attackers, top_5_victim_countries, a.technique AS technique, count(*) AS technique_attacks
ORDER BY technique_attacks DESC, technique ASC
WITH distinct_attackers, top_5_victim_countries, collect({technique: technique, attacks: technique_attacks})[0..3] AS top_3_techniques
RETURN distinct_attackers AS distinct_attacker_ips, top_5_victim_countries, top_3_techniques
[validation] first rows: [{'distinct_attacker_ips': 2790, 'top_5_victim_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_3_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
OPTIONAL MATCH (ip)-[r:ATTACKS]->(:Country)
WITH count(DISTINCT ip.address) AS distinct_source_ips,
     count(r) AS total_attacks,
     collect(r) AS rels
WITH distinct_source_ips,
     total_attacks,
     [x IN rels WHERE x IS NOT NULL] AS rels_nonnull
UNWIND (CASE WHEN size(rels_nonnull) = 0 THEN [null] ELSE rels_nonnull END) AS r2
WITH distinct_source_ips,
     total_attacks,
     r2.industry AS industry,
     count(r2) AS industry_attack_events
ORDER BY industry_attack_events DESC
WITH distinct_source_ips,
     total_attacks,
     collect({industry: industry, attacks: industry_attack_events}) AS industry_list
WITH distinct_source_ips,
     total_attacks,
     [x IN industry_list WHERE x.industry IS NOT NULL][0..5] AS top_industries
RETURN distinct_source_ips, total_attacks, top_industries
[validation] first rows: [{'distinct_source_ips': 0, 'total_attacks': 0, 'top_industries': []}]

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(attacked:Country)
WITH asn, collect(DISTINCT attacked) AS attackedCountries
WITH asn, attackedCountries, size(attackedCountries) AS attacked_country_count
WITH
  max(attacked_country_count) AS max_attacked_country_count,
  collect({
    asn_number: asn.number,
    attacked_country_count: attacked_country_count,
    attacked_countries: [c IN attackedCountries | c.name]
  }) AS rows
UNWIND rows AS row
WHERE row.attacked_country_count = max_attacked_country_count
RETURN row.asn_number AS asn_number, row.attacked_country_count AS attacked_country_count, row.attacked_countries AS attacked_countries
ORDER BY asn_number ASC
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(attackedCountry:Country)
WITH asn, collect(DISTINCT attackedCountry.name) AS attacked_countries
WITH asn, attacked_countries, size(attacked_countries) AS distinct_attacked_country_count
WITH max(distinct_attacked_country_count) AS max_count, collect({asn_number: asn.number, cnt: distinct_attacked_country_count, countries: attacked_countries}) AS rows
UNWIND rows AS row
WITH row, max_count WHERE row.cnt = max_count
RETURN row.asn_number AS asn_number, row.cnt AS distinct_attacked_country_count, row.countries AS attacked_countries
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_attacked_country_count': 64, 'attacked_countries': ['Ukraine', 'United States of America', 'United Kingdom of Great Britain and Northern Ireland', 'France', 'Norway', 'Turkey', 'Romania', 'Czechia', 'Denmark', 'Latvia', 'Lithuania', 'Estonia', 'Poland', 'Germany', 'Canada', 'Australia', 'Sweden', 'ukraine', 'Portugal', 'United States', 'Spain', 'Russian Federation', 'Italy', 'Brazil', 'germany', 'Kenya', 'Chile', 'Japan', 'Taiwan', 'Singapore', 'Peru', 'United Kingdom', 'Hungary', 'Ireland', 'Mexico', 'Netherlands', 'Argentina', 'Korea, Republic of', 'mexico', 'indonesia', 'Belgium', 'Guatemala', 'Slovakia', 'Morocco', 'Costa Rica', 'Aruba', 'China', 'Georgia', 'Saint Vincent and the Grenadines', 'Austria', 'Panama', 'Malaysia', 'Hong Kong', 'Bahamas', 'Sint Maarten (Dutch part)', 'Anguilla', 'Cayman Islands', 'Saint Kitts and Nevis', 'Philippines', 'Tanzania, United Republic of', 'Saint Martin (French part)', 'CuraÃ§ao', 'Barbados', 'Trinidad and Tobago']}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (128 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(tgt:Country)
WHERE a.protocol = 'ssh'
WITH tgt, count(*) AS attack_count
RETURN tgt.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (295 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] best match for ''Finance'' -> 'Finance' (LCS length 7)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': "'Finance'", 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': "'unknown'", 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WHERE a.industry = 'Finance'
  AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS attacks_count
RETURN technology, attacks_count
ORDER BY attacks_count DESC
[validation] first rows: [{'technology': 'windows', 'attacks_count': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[r:ATTACKS]->(c:Country {name: 'France'})
WHERE r.protocol <> 'unknown'
WITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count
ORDER BY asn_number, attack_count DESC, protocol
WITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols
UNWIND top_protocols AS p
RETURN asn_number, p.protocol AS protocol, p.attack_count AS attack_count
ORDER BY asn_number, attack_count DESC, protocol
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> ''
WITH ip.botnet AS botnet, count(a) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
RETURN botnet, attack_count
[validation] first rows: [{'botnet': 'unknown', 'attack_count': 3025957}, {'botnet': 'botnet', 'attack_count': 73462}, {'botnet': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(dest:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE ($start IS NULL OR r.documented_create_date >= datetime($start))
  AND ($end IS NULL OR r.documented_create_date < datetime($end))
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($pulse_id IS NULL OR r.pulse_id = $pulse_id)
  AND ($country IS NULL OR dest.name = $country)
  AND ($asn IS NULL OR asn.number = $asn)
  AND ($protocol IS NULL OR r.protocol = $protocol)
  AND (NOT coalesce($groupByProtocol,false) OR r.protocol <> 'unknown')
WITH
  r.destination_port AS port,
  CASE WHEN coalesce($groupByProtocol,false) THEN r.protocol ELSE NULL END AS protocol,
  count(*) AS attack_count
RETURN port, protocol, attack_count
ORDER BY attack_count DESC, port ASC
LIMIT coalesce($limit, 100)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(dest:Country)
WHERE ($start_datetime IS NULL OR a.documented_create_date >= datetime($start_datetime))
  AND ($end_datetime IS NULL OR a.documented_create_date < datetime($end_datetime))
  AND ($country_name IS NULL OR dest.name = $country_name)
  AND ($pulse_id IS NULL OR a.pulse_id = $pulse_id)
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($technique IS NULL OR a.technique = $technique)
  AND ($technology IS NULL OR a.technology = $technology)
  AND ($industry IS NULL OR a.industry = $industry)
  AND ($protocol IS NULL OR a.protocol = $protocol)
  AND ($group_by_protocol = false OR a.protocol <> 'unknown')
WITH ip, a
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH a, asn
WHERE ($asn_number IS NULL OR asn.number = $asn_number)
WITH a.port AS port,
     CASE WHEN $group_by_protocol THEN a.protocol ELSE null END AS protocol,
     count(*) AS attack_count
WHERE port IS NOT NULL AND port <> 'unknown'
RETURN port, protocol, attack_count
ORDER BY attack_count DESC, port ASC
LIMIT CASE WHEN $limit IS NULL THEN 100 ELSE $limit END
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(dst:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE r.port IS NOT NULL
  AND r.protocol <> 'unknown'
  AND ($start IS NULL OR r.documented_create_date >= datetime($start))
  AND ($end IS NULL OR r.documented_create_date < datetime($end))
  AND ($protocol IS NULL OR r.protocol = $protocol)
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($pulse_id IS NULL OR r.pulse_id = $pulse_id)
  AND ($country IS NULL OR dst.name = $country)
  AND ($asn IS NULL OR asn.number = $asn)
WITH r.port AS port, r.protocol AS protocol, count(*) AS attack_count
RETURN port, protocol, attack_count
ORDER BY attack_count DESC
LIMIT coalesce($limit, 50)

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: "Australia"})
WHERE toLower(trim(a.technique)) = toLower(trim("Phishing"))
RETURN count(*) AS total_attacks, count(DISTINCT a.pulse_id) AS distinct_pulse_ids
[validation] first rows: [{'total_attacks': 0, 'distinct_pulse_ids': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(a:ASN)
WITH c, r.technique AS technique, date.truncate('month', r.documented_create_date) AS year_month, collect(DISTINCT a.number) AS asns
WHERE size(asns) >= 2
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, c.name AS country, technique, year_month
WITH CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_low,
     CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_high,
     country, technique, year_month
WITH asn_low, asn_high, count(*) AS shared_contexts
RETURN asn_low, asn_high, shared_contexts
ORDER BY shared_contexts DESC, asn_low ASC, asn_high ASC
LIMIT 10
[validation] first rows: [{'asn_low': 'AS29789 reflected networks  inc.', 'asn_high': 'AS57523 chang way technologies co. limited', 'shared_contexts': 2800}, {'asn_low': 'AS53334 total uptime technologies  llc', 'asn_high': 'AS57523 chang way technologies co. limited', 'shared_contexts': 2619}, {'asn_low': 'AS29789 reflected networks  inc.', 'asn_high': 'AS53334 total uptime technologies  llc', 'shared_contexts': 2580}, {'asn_low': 'AS13335 cloudflare', 'asn_high': 'AS53334 total uptime technologies  llc', 'shared_contexts': 1035}, {'asn_low': 'AS53334 total uptime technologies  llc', 'asn_high': 'AS54113 fastly', 'shared_contexts': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: "Germany"})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour < 16
WITH r.protocol AS protocol, count(*) AS event_count
RETURN protocol, event_count
ORDER BY event_count DESC
LIMIT 1
[validation] first rows: [{'protocol': 'tcp', 'event_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE a.technique CONTAINS 'brute'
MATCH (ip)-[:FROM]->(fromCountry:Country)
WITH fromCountry, count(DISTINCT ip) AS distinct_ip_count
RETURN fromCountry.name AS country, distinct_ip_count
ORDER BY distinct_ip_count DESC
[validation] first rows: []

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'T1485' -> 'T1485 Data Destruction' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'T1485', 'value': 'T1485 Data Destruction'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.technique = 'T1485 Data Destruction'
WITH c, count(DISTINCT a.pulse_id) AS distinct_pulse_campaigns, count(*) AS total_attacks, count(DISTINCT ip) AS distinct_ips
ORDER BY distinct_pulse_campaigns DESC, total_attacks DESC, distinct_ips DESC, c.name ASC
LIMIT 1
RETURN c.name AS country, distinct_pulse_campaigns, total_attacks, distinct_ips
[validation] first rows: [{'country': 'United States of America', 'distinct_pulse_campaigns': 6, 'total_attacks': 61, 'distinct_ips': 4}]

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WITH c, date(a.documented_create_date) AS attack_day, count(*) AS events_on_day
WITH c, count(DISTINCT attack_day) AS active_days, sum(events_on_day) AS total_attack_events
RETURN c.name AS country, active_days, total_attack_events
ORDER BY active_days DESC, total_attack_events DESC, country ASC
[validation] first rows: [{'country': 'United States of America', 'active_days': 886, 'total_attack_events': 254170}, {'country': 'Australia', 'active_days': 739, 'total_attack_events': 19984}, {'country': 'France', 'active_days': 399, 'total_attack_events': 195247}, {'country': 'Malaysia', 'active_days': 302, 'total_attack_events': 2044}, {'country': 'Poland', 'active_days': 274, 'total_attack_events': 196108}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WITH
  ip,
  count(a) AS total_events,
  count(DISTINCT date.truncate('day', a.documented_create_date)) AS active_time_buckets,
  min(a.documented_create_date) AS first_seen,
  max(a.documented_create_date) AS last_seen
WITH
  ip,
  total_events,
  active_time_buckets,
  first_seen,
  last_seen,
  duration.between(date(first_seen), date(last_seen)).days AS span_days
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
OPTIONAL MATCH (ip)-[:FROM]->(src:Country)
WITH
  ip,
  total_events,
  active_time_buckets,
  first_seen,
  last_seen,
  span_days,
  asn,
  src
ORDER BY active_time_buckets DESC, span_days DESC, total_events DESC
LIMIT 10
RETURN
  ip.address AS ip,
  active_time_buckets,
  first_seen,
  last_seen,
  span_days,
  total_events,
  asn.number AS asn,
  src.name AS source_country
[validation] first rows: [{'ip': '204.76.203.83', 'active_time_buckets': 45, 'first_seen': neo4j.time.DateTime(2018, 2, 10, 0, 36, 0, 396000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 21, 8, 20, 2, 674000000, tzinfo=<UTC>), 'span_days': 11, 'total_events': 46, 'asn': 'AS400328 intelligence hosting llc', 'source_country': 'United States of America'}, {'ip': '206.189.95.94', 'active_time_buckets': 43, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 12, 17, 17, 41, 45, 306000000, tzinfo=<UTC>), 'span_days': 20, 'total_events': 45, 'asn': 'AS14061 digitalocean  llc', 'source_country': 'Singapore'}, {'ip': '122.226.191.252', 'active_time_buckets': 40, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 12, 17, 17, 41, 45, 306000000, tzinfo=<UTC>), 'span_days': 20, 'total_events': 41, 'asn': 'AS4134 chinanet', 'source_country': 'China'}, {'ip': '24.199.101.116', 'active_time_buckets': 38, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 2, 8, 6, 0, 20, 855000000, tzinfo=<UTC>), 'span_days': 12, 'total_events': 44, 'asn': 'ASNone ', 'source_country': 'United States of America'}, {'ip': '95.9.192.159', 'active_time_buckets': 37, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 1, 4, 6, 0, 21, 516000000, tzinfo=<UTC>), 'span_days': 8, 'total_events': 43, 'asn': 'AS47331 ttnet a.s.', 'source_country': 'TÃ¼rkiye'}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3312.18 seconds
Total tokens: 53,960

Status Breakdown:
  ðŸ”´ ERROR                    :   4 ( 20.0%)
  âœ… SUCCESS                  :  13 ( 65.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :   3

Success Rate: 65.0%

Results saved to: gpt-5.2_results_950k/run_13.json
================================================================================

[Thu Feb 12 02:35:05 UTC 2026] Worker 2: Run #13 completed
[Thu Feb 12 02:35:05 UTC 2026] Worker 2: Tokens in this run: 53960
[Thu Feb 12 02:35:05 UTC 2026] Worker 2: Total tokens: 708533
[Thu Feb 12 02:35:05 UTC 2026] Worker 2: Progress: 59%
[Thu Feb 12 02:35:07 UTC 2026] Worker 2: Starting Run #14
[Thu Feb 12 02:35:07 UTC 2026] Worker 2: Tokens used so far: 708533

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WITH r.technique AS technique, count(*) AS total_count
ORDER BY total_count DESC
LIMIT 1
RETURN technique, total_count
[validation] first rows: [{'technique': 'T1566 Phishing', 'total_count': 2863569}]

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind":"relationship","label":"ATTACKS","property":"technique","value":"'phishing'"}
]
```
[matcher] cleaned response: [
  {"kind":"relationship","label":"ATTACKS","property":"technique","value":"'phishing'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'phishing'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[r1:ATTACKS]->(:Country)
WHERE r1.technique = 'phishing'
WITH collect(DISTINCT ip) AS ips
MATCH (ip)-[r:ATTACKS]->(:Country)
WHERE ip IN ips AND r.technique <> 'phishing'
WITH r.technique AS technique, count(*) AS event_count
WITH collect({technique: technique, event_count: event_count}) AS rows, sum(event_count) AS total_non_phishing_events
UNWIND rows AS row
RETURN
  row.technique AS technique,
  row.event_count AS event_count,
  (toFloat(row.event_count) * 100.0) / total_non_phishing_events AS percentage_of_total_non_phishing_events
ORDER BY event_count DESC
[validation] first rows: []

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(target:Country)
WHERE a.protocol <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  target.name AS target_country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  collect(DISTINCT asn.number) AS asn_list,
  count(*) AS attack_count,
  count(DISTINCT ip.address) AS distinct_ip_count
WITH
  year_month, target_country, protocol, technique, industry,
  asn_list, size(asn_list) AS distinct_asn_count,
  attack_count, distinct_ip_count
WHERE distinct_asn_count >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  asn_list,
  distinct_asn_count,
  attack_count,
  distinct_ip_count
ORDER BY year_month DESC, attack_count DESC
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 123, 'attack_count': 723, 'distinct_ip_count': 412}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 174, 'attack_count': 373, 'distinct_ip_count': 373}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_asn_count': 123, 'attack_count': 309, 'distinct_ip_count': 230}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (413 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (origin:Country {name: 'China'})<-[:FROM]-(ip:IP)
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS total_distinct_attacking_ips
UNWIND ips AS ip2
MATCH (ip2)-[r:ATTACKS]->(dest:Country)
WITH ips, total_distinct_attacking_ips, dest.name AS destination_country, count(r) AS attacks
ORDER BY attacks DESC
WITH ips, total_distinct_attacking_ips, collect({destination_country: destination_country, attacks: attacks})[0..5] AS top_5_destination_countries
UNWIND ips AS ip3
MATCH (ip3)-[r2:ATTACKS]->(:Country)
WHERE r2.technique <> 'unknown'
WITH total_distinct_attacking_ips, top_5_destination_countries, r2.technique AS technique, count(r2) AS frequency
ORDER BY frequency DESC
WITH total_distinct_attacking_ips, top_5_destination_countries, collect({technique: technique, frequency: frequency})[0..3] AS top_3_techniques
RETURN total_distinct_attacking_ips, top_5_destination_countries, top_3_techniques
[validation] first rows: [{'total_distinct_attacking_ips': 2790, 'top_5_destination_countries': [{'destination_country': 'Germany', 'attacks': 43430}, {'destination_country': 'United States of America', 'attacks': 38573}, {'destination_country': 'France', 'attacks': 36447}, {'destination_country': 'Poland', 'attacks': 36047}, {'destination_country': 'Canada', 'attacks': 35697}], 'top_3_techniques': [{'technique': 'T1566 Phishing', 'frequency': 533403}, {'technique': 'T1110 Brute Force', 'frequency': 8224}, {'technique': 'T1595 Active Scanning', 'frequency': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name:"Russia"})
WITH collect(DISTINCT ip) AS ips
WITH ips, size(ips) AS distinct_ip_count
UNWIND ips AS ip
OPTIONAL MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_ip_count, collect(a) AS attacks
WITH distinct_ip_count, size(attacks) AS total_attacks, attacks
WITH distinct_ip_count, total_attacks, CASE WHEN size(attacks)=0 THEN [null] ELSE attacks END AS attacks2
UNWIND attacks2 AS a
WITH distinct_ip_count, total_attacks, CASE WHEN a IS NULL THEN '__NO_ATTACKS__' ELSE a.industry END AS industry
WITH distinct_ip_count, total_attacks, industry, count(*) AS industry_attacks
ORDER BY industry_attacks DESC
WITH distinct_ip_count, total_attacks, collect({industry: industry, attack_count: industry_attacks}) AS industry_counts
WITH
  distinct_ip_count,
  total_attacks,
  CASE
    WHEN total_attacks = 0 THEN []
    ELSE [x IN industry_counts WHERE x.industry <> '__NO_ATTACKS__'][0..5]
  END AS top_industries
RETURN
  distinct_ip_count AS distinct_ip_addresses,
  total_attacks AS total_outgoing_attacks,
  top_industries AS top_5_industries_by_attack_count
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(target:Country)
WITH asn, count(DISTINCT target) AS distinct_attacked_country_count, collect(DISTINCT target.name) AS attacked_countries
ORDER BY distinct_attacked_country_count DESC
WITH distinct_attacked_country_count, collect({asn_number: asn.number, distinct_attacked_country_count: distinct_attacked_country_count, attacked_countries: attacked_countries}) AS rows
UNWIND rows AS row
RETURN row.asn_number AS asn_number, row.distinct_attacked_country_count AS distinct_attacked_country_count, row.attacked_countries AS attacked_countries
ORDER BY distinct_attacked_country_count DESC, asn_number ASC
LIMIT 10
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_attacked_country_count': 64, 'attacked_countries': ['Ukraine', 'United States of America', 'United Kingdom of Great Britain and Northern Ireland', 'France', 'Norway', 'Turkey', 'Romania', 'Czechia', 'Denmark', 'Latvia', 'Lithuania', 'Estonia', 'Poland', 'Germany', 'Canada', 'Australia', 'Sweden', 'ukraine', 'Portugal', 'United States', 'Spain', 'Russian Federation', 'Italy', 'Brazil', 'germany', 'Kenya', 'Chile', 'Japan', 'Taiwan', 'Singapore', 'Peru', 'United Kingdom', 'Hungary', 'Ireland', 'Mexico', 'Netherlands', 'Argentina', 'Korea, Republic of', 'mexico', 'indonesia', 'Belgium', 'Guatemala', 'Slovakia', 'Morocco', 'Costa Rica', 'Aruba', 'China', 'Georgia', 'Saint Vincent and the Grenadines', 'Austria', 'Panama', 'Malaysia', 'Hong Kong', 'Bahamas', 'Sint Maarten (Dutch part)', 'Anguilla', 'Cayman Islands', 'Saint Kitts and Nevis', 'Philippines', 'Tanzania, United Republic of', 'Saint Martin (French part)', 'CuraÃ§ao', 'Barbados', 'Trinidad and Tobago']}, {'asn_number': 'AS53334 total uptime technologies  llc', 'distinct_attacked_country_count': 62, 'attacked_countries': ['germany', 'Spain', 'Singapore', 'India', 'indonesia', 'Taiwan', 'Hungary', 'Japan', 'United Kingdom', 'Belgium', 'Norway', 'Chile', 'United States of America', 'United Kingdom of Great Britain and Northern Ireland', 'Netherlands', 'Peru', 'Kenya', 'Slovakia', 'United States', 'Morocco', 'Guatemala', 'France', 'Poland', 'Canada', 'Sweden', 'ukraine', 'Ireland', 'Lithuania', 'Russian Federation', 'Germany', 'Australia', 'Saint Martin (French part)', 'Costa Rica', 'Luxembourg', 'Mexico', 'Denmark', 'Korea, Republic of', 'Finland', 'mexico', 'Brazil', 'Ukraine', 'United Arab Emirates', 'Anguilla', 'Saint Vincent and the Grenadines', 'Romania', 'Italy', 'Bahamas', 'Aruba', 'Estonia', 'Philippines', 'Georgia', 'Barbados', 'Turkey', 'Czechia', 'Tanzania, United Republic of', 'Saint Kitts and Nevis', 'Panama', 'CuraÃ§ao', 'Cayman Islands', 'Sint Maarten (Dutch part)', 'Latvia', 'Trinidad and Tobago']}, {'asn_number': 'AS396982 google', 'distinct_attacked_country_count': 59, 'attacked_countries': ['United States of America', 'Turkey', 'United Kingdom of Great Britain and Northern Ireland', 'Denmark', 'Latvia', 'France', 'Poland', 'Estonia', 'Lithuania', 'Czechia', 'Romania', 'Ukraine', 'Canada', 'Norway', 'Germany', 'Australia', 'Spain', 'United States', 'Sint Maarten (Dutch part)', 'Tanzania, United Republic of', 'Costa Rica', 'Barbados', 'indonesia', 'Aruba', 'CuraÃ§ao', 'Philippines', 'Saint Vincent and the Grenadines', 'Netherlands', 'Saint Kitts and Nevis', 'Bahamas', 'Georgia', 'Anguilla', 'ukraine', 'Guatemala', 'mexico', 'Mexico', 'Trinidad and Tobago', 'Japan', 'Panama', 'Cayman Islands', 'Saint Martin (French part)', 'Indonesia', 'Malaysia', 'Sweden', 'United Kingdom', 'Belgium', 'Italy', 'Austria', 'Taiwan', 'United Arab Emirates', 'Bulgaria', 'India', 'Russian Federation', 'China', 'Greece', 'TÃ¼rkiye', 'Israel', 'germany', 'KazajistÃ¡n']}, {'asn_number': 'AS4134 chinanet', 'distinct_attacked_country_count': 59, 'attacked_countries': ['Australia', 'United States of America', 'Indonesia', 'France', 'Germany', 'Czechia', 'Estonia', 'Turkey', 'Latvia', 'Poland', 'Ukraine', 'Denmark', 'United Kingdom of Great Britain and Northern Ireland', 'Norway', 'Lithuania', 'Belgium', 'United States', 'Romania', 'Canada', 'Spain', 'United Kingdom', 'mexico', 'indonesia', 'germany', 'ukraine', 'Portugal', 'Sweden', 'Malaysia', 'Korea, Republic of', 'KazajistÃ¡n', 'Russian Federation', 'Singapore', 'Italy', 'India', 'China', 'Taiwan', 'Thailand', 'Bahrain', 'Austria', 'Philippines', 'Japan', 'Georgia', 'Barbados', 'Guatemala', 'Sint Maarten (Dutch part)', 'Costa Rica', 'Netherlands', 'Saint Vincent and the Grenadines', 'Anguilla', 'Panama', 'Trinidad and Tobago', 'Mexico', 'Aruba', 'CuraÃ§ao', 'Bahamas', 'Saint Kitts and Nevis', 'Cayman Islands', 'Tanzania, United Republic of', 'Saint Martin (French part)']}, {'asn_number': 'AS14061 digitalocean  llc', 'distinct_attacked_country_count': 58, 'attacked_countries': ['Canada', 'Estonia', 'United Kingdom of Great Britain and Northern Ireland', 'United States of America', 'Romania', 'Ukraine', 'Turkey', 'Latvia', 'Poland', 'Lithuania', 'Denmark', 'Germany', 'Czechia', 'Norway', 'France', 'Australia', 'Sweden', 'United States', 'Spain', 'Portugal', 'Indonesia', 'Korea, Republic of', 'Malaysia', 'Singapore', 'United Kingdom', 'KazajistÃ¡n', 'Russian Federation', 'germany', 'Hungary', 'Luxembourg', 'ukraine', 'Japan', 'Brazil', 'Moldova, Republic of', 'Ireland', 'Mexico', 'Aruba', 'Anguilla', 'Costa Rica', 'Bahamas', 'Panama', 'Tanzania, United Republic of', 'Guatemala', 'Netherlands', 'Cayman Islands', 'indonesia', 'Barbados', 'CuraÃ§ao', 'Philippines', 'Saint Vincent and the Grenadines', 'Saint Kitts and Nevis', 'Saint Martin (French part)', 'Georgia', 'mexico', 'Trinidad and Tobago', 'Sint Maarten (Dutch part)', 'Italy', 'Belgium']}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (446 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country)
WHERE src.name = 'United States'
MATCH (ip)-[r:ATTACKS]->(target:Country)
WHERE r.protocol = 'ssh'
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (227 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] exact match for unknown -> unknown
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance' AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS attack_events
RETURN technology, attack_events
ORDER BY attack_events DESC
[validation] first rows: [{'technology': 'windows', 'attack_events': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[r:ATTACKS]->(c:Country {name: 'France'})
WHERE r.protocol <> 'unknown'
WITH asn.number AS asn_number, r.protocol AS protocol, count(*) AS attack_count
ORDER BY asn_number, attack_count DESC, protocol
WITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols
UNWIND top_protocols AS tp
RETURN asn_number, tp.protocol AS protocol, tp.attack_count AS attack_count
ORDER BY asn_number, attack_count DESC, protocol
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> '' AND toLower(ip.botnet) <> 'unknown'
WITH ip.botnet AS family, count(r) AS attack_count
RETURN family, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: [{'family': 'botnet', 'attack_count': 73462}, {'family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=2, column=9, offset=46>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 46, 'line': 2, 'column': 9}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.port IS NOT NULL\nWITH r.port AS destination_port, count(*) AS attack_events, count(DISTINCT ip) AS distinct_source_ips\nRETURN destination_port, attack_events, distinct_source_ips\nORDER BY attack_events DESC'
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=3, column=8, offset=70>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 70, 'line': 3, 'column': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (ip:IP)-[r:ATTACKS]->(:Country)\nWHERE r.port IS NOT NULL\nWITH r.port AS destination_port, count(*) AS attack_events, count(DISTINCT ip) AS distinct_source_ips\nRETURN destination_port, attack_events, distinct_source_ips\nORDER BY attack_events DESC'
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(:Country)
WHERE r.port IS NOT NULL
WITH r.port AS destination_port, count(*) AS attack_events, count(DISTINCT ip) AS distinct_source_ips
RETURN destination_port, attack_events, distinct_source_ips
ORDER BY attack_events DESC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Australia'' -> 'Australia' (LCS length 9)
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''Phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'Australia'", 'value': 'Australia'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'Phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})
WHERE r.technique = 'Phishing'
RETURN count(r) AS total_attacks
[validation] first rows: [{'total_attacks': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  c.name AS target_country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH
  target_country, technique, year_month,
  asns[i] AS asn_i,
  asns[j] AS asn_j
WITH
  CASE WHEN asn_i < asn_j THEN asn_i ELSE asn_j END AS asn_1,
  CASE WHEN asn_i < asn_j THEN asn_j ELSE asn_i END AS asn_2,
  target_country, technique, year_month
WITH asn_1, asn_2, count(*) AS shared_bucket_count
RETURN asn_1, asn_2, shared_bucket_count
ORDER BY shared_bucket_count DESC, asn_1 ASC, asn_2 ASC
LIMIT 10
[validation] first rows: [{'asn_1': 'AS29789 reflected networks  inc.', 'asn_2': 'AS57523 chang way technologies co. limited', 'shared_bucket_count': 2800}, {'asn_1': 'AS53334 total uptime technologies  llc', 'asn_2': 'AS57523 chang way technologies co. limited', 'shared_bucket_count': 2619}, {'asn_1': 'AS29789 reflected networks  inc.', 'asn_2': 'AS53334 total uptime technologies  llc', 'shared_bucket_count': 2580}, {'asn_1': 'AS13335 cloudflare', 'asn_2': 'AS53334 total uptime technologies  llc', 'shared_bucket_count': 1035}, {'asn_1': 'AS53334 total uptime technologies  llc', 'asn_2': 'AS54113 fastly', 'shared_bucket_count': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour < 16
WITH r.protocol AS protocol, count(*) AS attack_count
WITH collect({protocol: protocol, attack_count: attack_count}) AS rows, max(attack_count) AS max_count
UNWIND rows AS row
WITH row
WHERE row.attack_count = max_count
RETURN row.protocol AS protocol, row.attack_count AS attack_count
ORDER BY protocol
[validation] first rows: [{'protocol': 'tcp', 'attack_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (326 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (326 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (326 chars)

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (326 chars)

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3958.43 seconds
Total tokens: 49,939

Status Breakdown:
  ðŸ”´ ERROR                    :   7 ( 35.0%)
  âœ… SUCCESS                  :   9 ( 45.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   4 ( 20.0%)

Error Types:
  ðŸ”´ OTHER                         :   7

Success Rate: 45.0%

Results saved to: gpt-5.2_results_950k/run_14.json
================================================================================

[Thu Feb 12 03:41:08 UTC 2026] Worker 2: Run #14 completed
[Thu Feb 12 03:41:08 UTC 2026] Worker 2: Tokens in this run: 49939
[Thu Feb 12 03:41:08 UTC 2026] Worker 2: Total tokens: 758472
[Thu Feb 12 03:41:08 UTC 2026] Worker 2: Progress: 63%
[Thu Feb 12 03:41:10 UTC 2026] Worker 2: Starting Run #15
[Thu Feb 12 03:41:10 UTC 2026] Worker 2: Tokens used so far: 758472

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (326 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (751 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(target:Country)
WHERE r.protocol <> 'unknown'
  AND r.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  date.truncate('month', r.documented_create_date) AS year_month,
  target.name AS target_country,
  r.protocol AS protocol,
  r.technique AS technique,
  r.industry AS industry,
  collect(DISTINCT asn.number) AS asn_list,
  count(*) AS events,
  count(DISTINCT ip.address) AS unique_ips
WHERE size(asn_list) >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  asn_list,
  size(asn_list) AS distinct_asn_count,
  events,
  unique_ips
ORDER BY events DESC, year_month DESC, target_country ASC, protocol ASC, technique ASC, industry ASC
[validation] first rows: [{'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'events': 1793, 'unique_ips': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'events': 1793, 'unique_ips': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'events': 1793, 'unique_ips': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'events': 1793, 'unique_ips': 212}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'events': 1793, 'unique_ips': 212}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (415 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(fromC:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips
WITH ips, size(ips) AS distinct_attacking_ips
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(tc:Country)
WITH ips, distinct_attacking_ips, tc.name AS target_country, count(a) AS attacks_count
ORDER BY attacks_count DESC, target_country
WITH ips, distinct_attacking_ips, collect({country: target_country, attacks: attacks_count})[0..5] AS top_target_countries
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_attacking_ips, top_target_countries, a.technique AS technique, count(a) AS technique_count
ORDER BY technique_count DESC, technique
WITH distinct_attacking_ips, top_target_countries, collect({technique: technique, attacks: technique_count})[0..3] AS top_techniques
RETURN distinct_attacking_ips, top_target_countries, top_techniques
[validation] first rows: [{'distinct_attacking_ips': 2790, 'top_target_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.industry IS NOT NULL AND a.industry <> ''
WITH a.industry AS industry, count(DISTINCT ip) AS distinct_source_ips, count(*) AS total_attack_events
RETURN industry, distinct_source_ips, total_attack_events
ORDER BY total_attack_events DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(country:Country)
WITH asn, count(DISTINCT country) AS attacked_country_count
WITH collect({asn: asn, attacked_country_count: attacked_country_count}) AS rows, max(attacked_country_count) AS max_attacked_country_count
UNWIND rows AS row
WITH row.asn AS asn, row.attacked_country_count AS attacked_country_count, max_attacked_country_count
WHERE attacked_country_count = max_attacked_country_count
RETURN asn.number AS asn_number, attacked_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'attacked_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (234 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})
MATCH (ip)-[r:ATTACKS]->(target:Country)
WHERE r.protocol = 'ssh'
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (247 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (country:Country {name: 'France'})
MATCH (ip:IP)-[r:ATTACKS]->(country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE r.protocol <> 'unknown'
WITH asn.number AS asn, r.protocol AS protocol, count(*) AS attack_count
ORDER BY asn, attack_count DESC, protocol
WITH asn, collect({protocol: protocol, attack_count: attack_count}) AS protos
UNWIND protos[0..3] AS top
RETURN asn, top.protocol AS protocol, top.attack_count AS attack_count
ORDER BY asn, attack_count DESC, protocol
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WITH coalesce(ip.botnet, 'unknown') AS malware_family, count(*) AS attack_count
RETURN malware_family, attack_count
ORDER BY attack_count DESC, malware_family ASC
LIMIT 5
[validation] first rows: [{'malware_family': 'unknown', 'attack_count': 3025957}, {'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `destination_port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=2, column=9, offset=53>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 53, 'line': 2, 'column': 9}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.destination_port IS NOT NULL\nWITH r.destination_port AS destination_port, count(*) AS attack_count\nRETURN destination_port, attack_count\nORDER BY attack_count DESC, destination_port ASC'
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `destination_port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=3, column=8, offset=89>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 89, 'line': 3, 'column': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.destination_port IS NOT NULL\nWITH r.destination_port AS destination_port, count(*) AS attack_count\nRETURN destination_port, attack_count\nORDER BY attack_count DESC, destination_port ASC'
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.destination_port IS NOT NULL
WITH r.destination_port AS destination_port, count(*) AS attack_count
RETURN destination_port, attack_count
ORDER BY attack_count DESC, destination_port ASC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})
WHERE trim(r.technique) = 'Phishing'
RETURN count(*) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (681 chars)

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (:IP)-[r:ATTACKS]->(c:Country {name: "Germany"})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour <= 16
WITH r.protocol AS protocol, count(*) AS cnt
WITH max(cnt) AS maxCnt, collect({protocol: protocol, cnt: cnt}) AS rows
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: "Germany"})
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour < 16
WITH a.protocol AS protocol, count(*) AS cnt
WITH collect({protocol: protocol, cnt: cnt}) AS rows, max(cnt) AS maxCnt
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: "Germany"})
WHERE a.protocol <> "unknown"
WITH a
WHERE time(a.documented_create_date) >= time("09:00:00Z") AND time(a.documented_create_date) <= time("16:00:00Z")
WITH a.protocol AS protocol, count(*) AS cnt
WITH collect({protocol: protocol, cnt: cnt}) AS rows, max(cnt) AS maxCnt
UNWIND rows AS row
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS count
ORDER BY protocol

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'brute-force' -> 'T1110 Brute Force' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'brute-force', 'value': 'T1110 Brute Force'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(hostCountry:Country)
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.technique = 'T1110 Brute Force'
WITH hostCountry, count(DISTINCT ip) AS distinct_ip_count
RETURN hostCountry.name AS country, distinct_ip_count
ORDER BY distinct_ip_count DESC
[validation] first rows: [{'country': 'China', 'distinct_ip_count': 1359}, {'country': 'United States of America', 'distinct_ip_count': 617}, {'country': 'Russian Federation', 'distinct_ip_count': 178}, {'country': 'India', 'distinct_ip_count': 167}, {'country': 'Singapore', 'distinct_ip_count': 159}]

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": ""},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": "unknown"},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": 1}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": ""},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": "unknown"},
  {"kind": "relationship", "label": "ATTACKS", "property": "pulse_id", "value": 1}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'pulse_id', 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'pulse_id', 'value': 1}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'pulse_id', 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'pulse_id', 'value': 1}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.pulse_id IS NOT NULL RETURN DISTINCT r.pulse_id AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.pulse_id IS NOT NULL RETURN DISTINCT r.pulse_id AS val
[matcher] first rows: ['63456c2a30b92337ea1670e0', '65f5828f8217ecbe6ce3a89b', '65f5827a4e23b095e5af5f44', '65f582700d35b0e7c8dd9df8', '65f5823b9d7bc6b422256296']
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'T1485' -> 'T1485 Data Destruction' (LCS length 5)
[matcher] first rows: ['63456c2a30b92337ea1670e0', '65f5828f8217ecbe6ce3a89b', '65f5827a4e23b095e5af5f44', '65f582700d35b0e7c8dd9df8', '65f5823b9d7bc6b422256296']
[matcher] best match for 'unknown' -> '63456c2a30b92337ea1670e0' (LCS length 0)
    Agent raised an exception: 'int' object has no attribute 'lower'

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3919.23 seconds
Total tokens: 54,374

Status Breakdown:
  ðŸ”´ ERROR                    :  11 ( 55.0%)
  âœ… SUCCESS                  :   6 ( 30.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :  10

Success Rate: 30.0%

Results saved to: gpt-5.2_results_950k/run_15.json
================================================================================

[Thu Feb 12 04:46:31 UTC 2026] Worker 2: Run #15 completed
[Thu Feb 12 04:46:31 UTC 2026] Worker 2: Tokens in this run: 54374
[Thu Feb 12 04:46:31 UTC 2026] Worker 2: Total tokens: 812846
[Thu Feb 12 04:46:31 UTC 2026] Worker 2: Progress: 67%
[Thu Feb 12 04:46:33 UTC 2026] Worker 2: Starting Run #16
[Thu Feb 12 04:46:33 UTC 2026] Worker 2: Tokens used so far: 812846

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(tc:Country)
WHERE a.protocol <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH date.truncate('month', a.documented_create_date) AS year_month,
     tc,
     a.protocol AS protocol,
     a.technique AS technique,
     a.industry AS industry,
     asn.number AS asn_num,
     collect(DISTINCT ip.address) AS ip_addresses,
     collect(DISTINCT a.pulse_id) AS pulse_ids
WITH year_month,
     tc.name AS country,
     protocol,
     technique,
     industry,
     collect({asn: asn_num, ips: ip_addresses, pulses: pulse_ids}) AS asn_evidence,
     collect(DISTINCT asn_num) AS asns
WITH year_month, country, protocol, technique, industry, asn_evidence, asns, size(asns) AS distinct_asn_count
WHERE distinct_asn_count >= 2
RETURN year_month, country, protocol, technique, industry, distinct_asn_count, asns, asn_evidence
ORDER BY year_month DESC, country, protocol, technique, industry
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 67, 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'asn_evidence': [{'pulses': ['68c13129eded5baa71fb89a2', '68ccb8f509965a500807acf9', '68b7948135a76e095700ee1e', '68c27c7dbf0d82aa994bacfa', '68ca1c3c43c415c08d16985a'], 'ips': ['59.36.254.224', '58.49.26.202', '58.222.244.226', '49.75.185.71', '223.240.116.60', '1.197.78.123'], 'asn': 'AS4134 chinanet'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['112.216.108.62'], 'asn': 'AS3786 lg dacom corporation'}, {'pulses': ['68c13129eded5baa71fb89a2', '68c37e123ec2922c002e71fd'], 'ips': ['116.153.81.58', '119.188.171.173'], 'asn': 'AS4837 china unicom china169 backbone'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['3.143.152.247'], 'asn': 'AS16509 amazon.com inc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa', '68c13129eded5baa71fb89a2', '68b8eba638383bc8eda19b3c', '68ba43cae6726a60b7980c7e', '68b4ff2b31379389de893f0d', '68ccb8f509965a500807acf9', '68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e', '68c91656b66ae9520f619142', '68d4a4929fc24d9d226c01ac'], 'ips': ['45.91.171.169', '45.147.250.208', '37.111.53.110', '206.168.34.57', '206.168.34.167', '199.45.154.187', '199.45.154.185', '199.45.154.184', '199.45.154.182', '199.45.154.181', '199.45.154.142', '172.174.72.225', '170.64.209.39', '170.64.177.80', '146.88.241.70', '146.88.241.60', '146.88.241.171', '146.88.241.170', '146.88.241.161', '146.88.241.151', '103.206.72.2', '101.126.88.251'], 'asn': 'ASNone '}, {'pulses': ['68b66834e69445088089c4ed'], 'ips': ['39.99.212.219'], 'asn': 'AS37963 hangzhou alibaba advertising co. ltd.'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['222.73.56.10'], 'asn': 'AS4812 china telecom (group)'}, {'pulses': ['68c37e123ec2922c002e71fd', '68ccb8f509965a500807acf9'], 'ips': ['202.85.222.190', '117.50.165.23'], 'asn': 'AS4808 china unicom beijing province network'}, {'pulses': ['68c37e123ec2922c002e71fd', '68d4a4929fc24d9d226c01ac'], 'ips': ['169.197.113.175', '152.32.158.69'], 'asn': 'AS135377 ucloud information technology (hk) limited'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['202.112.237.201'], 'asn': 'AS4538 china education and research network center'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['102.223.92.101'], 'asn': 'AS328647 african network information center'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['81.192.46.49'], 'asn': 'AS6713 itissalat al-maghrib'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['222.253.40.231'], 'asn': 'AS45899 vnpt corp'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['103.239.252.66'], 'asn': 'AS63526 systems solutions & development technologies limited'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.115.24.11'], 'asn': 'AS137823 cloudone'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['103.153.190.121'], 'asn': 'AS140469 pt wahyu adidaya network'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.179.56.51'], 'asn': 'AS136052 pt cloud hosting indonesia'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['162.216.142.81'], 'asn': 'AS135247 k net solutions pvt ltd'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['103.248.120.6'], 'asn': 'AS58906 shivansh infotech pvt ltd'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.84.236.222'], 'asn': 'AS134945 blue sky broadband pvt. ltd.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['103.86.180.10'], 'asn': 'AS136284 paradise telecom pvt ltd'}, {'pulses': ['68c13129eded5baa71fb89a2', '68d4a4929fc24d9d226c01ac', '68c37e123ec2922c002e71fd', '68b8eba638383bc8eda19b3c', '68b7948135a76e095700ee1e'], 'ips': ['64.227.112.120', '188.166.68.252', '157.245.69.67', '143.110.182.33', '139.59.58.140', '138.197.24.249', '128.199.157.145'], 'asn': 'AS14061 digitalocean  llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa', '68b8eba638383bc8eda19b3c', '68b66834e69445088089c4ed', '68ccb8f509965a500807acf9', '68be3398c9569a076dd34f1f'], 'ips': ['34.128.77.56', '34.123.134.194', '205.210.31.246', '198.235.24.81', '198.235.24.114'], 'asn': 'AS396982 google'}, {'pulses': ['68be3398c9569a076dd34f1f'], 'ips': ['104.156.155.5'], 'asn': 'AS400161 academy of internet research limited liability company'}, {'pulses': ['68b66834e69445088089c4ed'], 'ips': ['45.79.163.53'], 'asn': 'AS63949 linode  llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['182.61.13.22'], 'asn': 'AS38365 beijing baidu netcom science and technology co.  ltd.'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['122.176.122.24'], 'asn': 'AS24560 bharti airtel ltd.'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['74.94.234.151'], 'asn': 'AS7922 comcast'}, {'pulses': ['68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e'], 'ips': ['198.23.174.113', '198.23.143.193'], 'asn': 'AS36352 colocrossing'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['216.172.190.206'], 'asn': 'AS46606 unified layer'}, {'pulses': ['68b4ff2b31379389de893f0d'], 'ips': ['109.205.213.18'], 'asn': 'AS208046 maximilian kutzner'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['118.122.147.195'], 'asn': 'AS38283 chinanet sichuan telecom internet data center'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['14.63.217.28', '14.63.221.137'], 'asn': 'AS4766 korea telecom'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['150.223.20.12'], 'asn': 'AS58519 cloud computing corporation'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['183.134.217.20'], 'asn': 'AS58461 ct-hangzhou-idc'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['122.129.74.58'], 'asn': 'AS17911 brain telecommunication'}, {'pulses': ['68d390d1581d658a42877880', '68c13129eded5baa71fb89a2'], 'ips': ['51.68.226.87', '51.195.138.37', '51.178.137.178', '152.228.131.33'], 'asn': 'AS16276 ovh sas'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['195.37.190.89'], 'asn': 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.'}, {'pulses': ['68be3398c9569a076dd34f1f'], 'ips': ['150.107.36.236'], 'asn': 'AS137426 simm it services'}, {'pulses': ['68b8eba638383bc8eda19b3c', '68b4ff2b31379389de893f0d', '68c91656b66ae9520f619142', '68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e'], 'ips': ['167.94.138.155', '167.94.138.147', '167.94.138.145', '167.94.138.141', '167.94.138.134', '162.142.125.88'], 'asn': 'AS398324 censys  inc.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['62.210.24.128'], 'asn': 'AS12876 online s.a.s.'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['167.94.145.28'], 'asn': 'AS398705 censys  inc.'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['181.2.151.236'], 'asn': 'AS7303 telecom argentina s.a.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['64.62.197.166'], 'asn': 'AS6939 hurricane electric llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['31.7.70.8'], 'asn': 'AS43754 asiatech data transmission company'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['92.63.197.210'], 'asn': 'AS44446 qwalarty corporation'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['186.149.199.90'], 'asn': 'AS12066 altice dominicana s.a.'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['187.111.28.131'], 'asn': 'AS53120 mundivox telecomunicaes ltda'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['79.3.96.178'], 'asn': 'AS3269 telecom italia s.p.a.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['193.163.125.110'], 'asn': 'AS211298 constantine cybersecurity ltd.'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['78.186.133.164'], 'asn': 'AS9121 turk telekomunikasyon anonim sirketi'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['195.88.120.62'], 'asn': 'AS48969 parus-telecom'}, {'pulses': ['68c37e123ec2922c002e71fd', '68ccb8f509965a500807acf9'], 'ips': ['2.57.122.112', '45.148.10.240'], 'asn': 'AS48090 pptechnology limited'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['202.125.94.71'], 'asn': 'AS46042 gunadarma university'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['202.131.233.35'], 'asn': 'AS9484 mobinet'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['202.51.214.99'], 'asn': 'AS10220 pt. kreasi sejahtera teknologi'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['87.126.166.109'], 'asn': 'AS8866 bulgarian telecommunications company plc.'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['220.205.122.62'], 'asn': 'AS140726 unicom anhui province network'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['36.103.243.179'], 'asn': 'AS134761 chinanet ningxia province zhongwei idc network'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['45.175.75.254'], 'asn': 'AS268888 acrf servicos de informatica ltda - me'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['49.65.102.127'], 'asn': 'AS134756 chinanet nanjing jishan idc network'}, {'pulses': ['68ba43cae6726a60b7980c7e', '68c91656b66ae9520f619142'], 'ips': ['93.174.95.106', '80.82.70.118'], 'asn': 'AS202425 ip volume inc'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['65.49.1.108'], 'asn': 'AS36791 portland internet hosting llc'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['66.240.236.119'], 'asn': 'AS10439 carinet  inc.'}, {'pulses': ['68b4ff2b31379389de893f0d'], 'ips': ['79.124.62.122'], 'asn': 'AS207812 dm auto eood'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['91.144.21.210'], 'asn': 'AS29256 syrian telecom'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['91.238.181.96'], 'asn': 'AS29551 aixit gmbh'}]}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'distinct_asn_count': 123, 'asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'asn_evidence': [{'pulses': ['68c9162db43f1abf2a0d7a4d', '68d106b203e0418dc62e4487'], 'ips': ['118.195.150.246'], 'asn': 'AS45090 shenzhen tencent computer systems company limited'}, {'pulses': ['68b8eb976696573d91bee14d', '68bfe3327a7ed5ce6d20c08a', '68c1311d72c4fb68bed6a95d', '68ccb8e8fcc9f28a17749fc0', '68c67ab37c92ddfd7b0695ef', '68ca1c1d770c45504db99193', '68cd1232cddff867d10d792e', '68be91b286e17e1290e3cd29', '68ba43be828c0d90145b6032', '68c7cc329a49c0b65042cd6f', '68cbc0b37d26eec9869b3c81', '68d106b203e0418dc62e4487'], 'ips': ['59.36.78.66', '59.36.75.227', '59.36.254.224', '58.49.26.202', '58.222.244.226', '27.185.52.202', '27.128.229.223', '27.128.174.164', '223.247.33.150', '222.172.32.246', '183.36.126.68', '123.187.241.160', '121.228.31.181', '121.227.31.13', '121.227.152.171', '118.122.93.139', '117.27.93.170', '1.197.78.123'], 'asn': 'AS4134 chinanet'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['112.216.108.62', '1.214.197.163'], 'asn': 'AS3786 lg dacom corporation'}, {'pulses': ['68ba43be828c0d90145b6032'], 'ips': ['116.120.97.12'], 'asn': 'AS9318 sk broadband co ltd'}, {'pulses': ['68cbc0b37d26eec9869b3c81', '68bbeeb2ea42ae685b805ef3', '68b7fa322068680adcb19696', '68c1311d72c4fb68bed6a95d', '68c134b274c78e6c5fdeefda', '68bfe3327a7ed5ce6d20c08a', '68c2399f46d51447a1381df1'], 'ips': ['61.240.156.16', '220.250.41.11', '123.139.116.220', '119.188.171.173', '103.120.227.88'], 'asn': 'AS4837 china unicom china169 backbone'}, {'pulses': ['68b6a8b245c884fb48bdbfba'], 'ips': ['42.200.78.78'], 'asn': 'AS4760 hkt limited'}, {'pulses': ['68d25834bf49e79e1b21ba5b'], 'ips': ['1.55.33.86'], 'asn': 'AS18403 fpt telecom company'}, {'pulses': ['68c3d7b22c18b1a86fc5d5fc', '68c1311d72c4fb68bed6a95d', '68b7fa322068680adcb19696', '68c134b274c78e6c5fdeefda', '68cbc0b37d26eec9869b3c81', '68bd40318f4795aec341706e', '68d390b6907a2dd3ae1c9b10', '68bfe3327a7ed5ce6d20c08a', '68b8eb976696573d91bee14d', '68b55732c35343fbe74749e9', '68c9162db43f1abf2a0d7a4d', '68b6a8b245c884fb48bdbfba', '68ba9d32b732655db022dd63', '68b4ff138243d0c9813a1149', '68ca1c1d770c45504db99193'], 'ips': ['57.128.182.5', '196.251.88.103', '172.174.72.225', '172.174.5.146', '14.103.118.79', '14.103.115.210', '14.103.112.100', '14.103.105.243', '120.48.162.75', '103.67.79.165', '103.31.119.10', '103.217.145.154', '103.191.178.123', '103.189.234.253', '101.126.11.137', '101.126.25.120', '101.126.30.240'], 'asn': 'ASNone '}, {'pulses': ['68c1311d72c4fb68bed6a95d', '68c91db211043a1f0289cd39', '68cbc0b37d26eec9869b3c81', '68b8eb976696573d91bee14d', '68ccb8e8fcc9f28a17749fc0', '68ca6f3bb973160ba5c2a137', '68be33872886ab2541813558'], 'ips': ['222.73.56.10', '101.226.180.6', '101.91.192.9', '180.167.207.234', '218.78.51.90'], 'asn': 'AS4812 china telecom (group)'}, {'pulses': ['68c37dfeca644940d15f87c8', '68b7fa322068680adcb19696', '68c1311d72c4fb68bed6a95d', '68c9162db43f1abf2a0d7a4d', '68bbeeb2ea42ae685b805ef3', '68ce63b2e66f3de2447a44e0', '68ccb8e8fcc9f28a17749fc0'], 'ips': ['202.85.222.190', '124.207.165.138', '123.59.28.66', '117.50.55.96', '117.50.51.119', '117.50.165.23', '117.50.119.25'], 'asn': 'AS4808 china unicom beijing province network'}, {'pulses': ['68ce63b2e66f3de2447a44e0', '68bfe3327a7ed5ce6d20c08a'], 'ips': ['101.36.65.131', '106.37.72.234'], 'asn': 'AS23724 idc china telecommunications corporation'}, {'pulses': ['68b55732c35343fbe74749e9', '68c3d7b22c18b1a86fc5d5fc', '68d4fb39056c1f04d4d708d5', '68be91b286e17e1290e3cd29'], 'ips': ['165.154.105.128', '152.32.250.188', '118.194.230.231', '101.36.108.134'], 'asn': 'AS135377 ucloud information technology (hk) limited'}, {'pulses': ['68ccb8e8fcc9f28a17749fc0'], 'ips': ['101.36.231.231'], 'asn': 'AS133119 china unicom ip network'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['203.205.37.233'], 'asn': 'AS45903 cmc telecom infrastructure company'}, {'pulses': ['68ce63b2e66f3de2447a44e0', '68ca1c1d770c45504db99193', '68b8eb976696573d91bee14d'], 'ips': ['81.192.87.130', '81.192.46.49', '160.174.129.232'], 'asn': 'AS6713 itissalat al-maghrib'}, {'pulses': ['68b55732c35343fbe74749e9', '68bfe3327a7ed5ce6d20c08a'], 'ips': ['123.30.249.49'], 'asn': 'AS45899 vnpt corp'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['14.225.206.98'], 'asn': 'AS135905 vietnam posts and telecommunications group'}, {'pulses': ['68d3a9b227669537cfc610e2', '68c7cc329a49c0b65042cd6f'], 'ips': ['103.115.24.11'], 'asn': 'AS137823 cloudone'}, {'pulses': ['68bd40318f4795aec341706e'], 'ips': ['103.119.92.117'], 'asn': 'AS137982 bow llc'}, {'pulses': ['68c2399f46d51447a1381df1'], 'ips': ['103.144.87.192'], 'asn': 'AS135932 viet storage technology joint stock company'}, {'pulses': ['68b8eb976696573d91bee14d', '68ca6f3bb973160ba5c2a137'], 'ips': ['103.153.190.121'], 'asn': 'AS140469 pt wahyu adidaya network'}, {'pulses': ['68b94bb1ca80f64506cee295', '68d25834bf49e79e1b21ba5b'], 'ips': ['106.51.92.114'], 'asn': 'AS24309 atria convergence technologies'}, {'pulses': ['68c134b274c78e6c5fdeefda', '68b94bb1ca80f64506cee295'], 'ips': ['103.179.57.150', '103.171.85.186'], 'asn': 'AS136052 pt cloud hosting indonesia'}, {'pulses': ['68c91db211043a1f0289cd39'], 'ips': ['103.203.224.181'], 'asn': 'AS134337 r2 net solutions pvt ltd'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['103.246.240.30'], 'asn': 'AS132137 shree omkar infocom pvt ltd'}, {'pulses': ['68ca1c1d770c45504db99193'], 'ips': ['103.248.120.6'], 'asn': 'AS58906 shivansh infotech pvt ltd'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['103.25.47.94'], 'asn': 'AS58898 rainbow communications india pvt ltd'}, {'pulses': ['68b94bb1ca80f64506cee295'], 'ips': ['103.48.192.48'], 'asn': 'AS131423 branch of long van system solution jsc - hanoi'}, {'pulses': ['68c2399f46d51447a1381df1'], 'ips': ['103.63.108.25'], 'asn': 'AS38732 cmc telecom infrastructure company'}, {'pulses': ['68c1311d72c4fb68bed6a95d', '68d25834bf49e79e1b21ba5b'], 'ips': ['202.157.176.29', '202.157.176.165'], 'asn': 'AS136170 pt. exabytes network indonesia'}, {'pulses': ['68d3a9b227669537cfc610e2'], 'ips': ['103.84.119.130'], 'asn': 'AS64316 universitas islam negeri raden fatah palembang'}, {'pulses': ['68b8eb976696573d91bee14d', '68c1311d72c4fb68bed6a95d'], 'ips': ['103.84.236.242', '103.84.236.222'], 'asn': 'AS134945 blue sky broadband pvt. ltd.'}, {'pulses': ['68ba9d32b732655db022dd63'], 'ips': ['103.86.180.10'], 'asn': 'AS136284 paradise telecom pvt ltd'}, {'pulses': ['68b7fa322068680adcb19696', '68c91db211043a1f0289cd39', '68b8eb976696573d91bee14d'], 'ips': ['165.22.217.96', '139.59.226.77', '128.199.168.119'], 'asn': 'AS14061 digitalocean  llc'}, {'pulses': ['68b8eb976696573d91bee14d', '68ce63b2e66f3de2447a44e0', '68c91db211043a1f0289cd39', '68d4fb39056c1f04d4d708d5', '68c2399f46d51447a1381df1', '68ba9d32b732655db022dd63'], 'ips': ['34.66.72.251', '34.175.118.185', '34.128.77.56', '34.123.134.194'], 'asn': 'AS396982 google'}, {'pulses': ['68ca6f3bb973160ba5c2a137'], 'ips': ['35.237.94.18'], 'asn': 'AS15169 google llc'}, {'pulses': ['68b55732c35343fbe74749e9', '68b94bb1ca80f64506cee295'], 'ips': ['52.183.128.237', '20.127.224.153'], 'asn': 'AS8075 microsoft corporation'}, {'pulses': ['68c7cc329a49c0b65042cd6f'], 'ips': ['60.199.224.55'], 'asn': 'AS9924 taiwan fixed network telco and network service provider'}, {'pulses': ['68c2399f46d51447a1381df1'], 'ips': ['182.61.13.22'], 'asn': 'AS38365 beijing baidu netcom science and technology co.  ltd.'}, {'pulses': ['68cbc0b37d26eec9869b3c81'], 'ips': ['117.34.125.173'], 'asn': 'AS134768 chinanet shaanxi province cloud base network'}, {'pulses': ['68c67ab37c92ddfd7b0695ef', '68c1311d72c4fb68bed6a95d', '68c91db211043a1f0289cd39'], 'ips': ['96.78.175.45', '74.94.234.151'], 'asn': 'AS7922 comcast'}, {'pulses': ['68d25834bf49e79e1b21ba5b', '68ce63b2e66f3de2447a44e0', '68c91db211043a1f0289cd39', '68be91b286e17e1290e3cd29', '68bbeeb2ea42ae685b805ef3'], 'ips': ['198.23.174.113', '192.210.233.234', '192.210.135.20', '107.173.85.161'], 'asn': 'AS36352 colocrossing'}, {'pulses': ['68b8eb976696573d91bee14d', '68c1311d72c4fb68bed6a95d'], 'ips': ['216.172.190.206', '162.240.156.34'], 'asn': 'AS46606 unified layer'}, {'pulses': ['68c134b274c78e6c5fdeefda'], 'ips': ['109.167.197.20'], 'asn': 'AS25408 jsc er-telecom holding'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['37.110.142.162'], 'asn': 'AS42610 pjsc rostelecom'}, {'pulses': ['68c37dfeca644940d15f87c8', '68b6a8b245c884fb48bdbfba', '68c67ab37c92ddfd7b0695ef', '68bfe3327a7ed5ce6d20c08a'], 'ips': ['36.91.166.34', '36.67.70.198', '36.66.16.233'], 'asn': 'AS7713 pt telekomunikasi indonesia'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['118.122.147.195'], 'asn': 'AS38283 chinanet sichuan telecom internet data center'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['175.100.24.139'], 'asn': 'AS38623 viettel'}, {'pulses': ['68b7fa322068680adcb19696', '68cd1232cddff867d10d792e'], 'ips': ['39.129.9.180', '36.133.64.211'], 'asn': 'AS9808 china mobile communications group co.  ltd.'}, {'pulses': ['68b4ff138243d0c9813a1149'], 'ips': ['111.53.87.28'], 'asn': 'AS56042 china mobile communications corporation'}, {'pulses': ['68c7cc329a49c0b65042cd6f', '68bbeeb2ea42ae685b805ef3', '68bd40318f4795aec341706e', '68ce63b2e66f3de2447a44e0', '68c9162db43f1abf2a0d7a4d', '68b7943ddb796636c4e8c0ba', '68b94bb1ca80f64506cee295', '68bfe3327a7ed5ce6d20c08a', '68cd1232cddff867d10d792e', '68cbc0b37d26eec9869b3c81', '68d106b203e0418dc62e4487', '68c1311d72c4fb68bed6a95d', '68d25834bf49e79e1b21ba5b', '68d4fb39056c1f04d4d708d5'], 'ips': ['222.107.156.227', '221.159.150.85', '220.80.223.144', '218.156.176.223', '211.253.37.225', '211.253.10.96', '210.114.22.126', '14.63.196.175', '14.63.217.28', '14.63.221.137'], 'asn': 'AS4766 korea telecom'}, {'pulses': ['68bfe3327a7ed5ce6d20c08a'], 'ips': ['36.155.114.62'], 'asn': 'AS56046 china mobile communications corporation'}, {'pulses': ['68b8eb976696573d91bee14d', '68b4ff138243d0c9813a1149', '68bfe3327a7ed5ce6d20c08a'], 'ips': ['182.43.235.75', '140.246.137.102', '113.125.140.222'], 'asn': 'AS58519 cloud computing corporation'}, {'pulses': ['68ce63b2e66f3de2447a44e0'], 'ips': ['125.76.228.194'], 'asn': 'AS4835 china telecom (group)'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['171.104.143.176'], 'asn': 'AS137693 chinatelecom guangxi nanning idc networkdescr'}, {'pulses': ['68d25834bf49e79e1b21ba5b'], 'ips': ['218.255.103.194'], 'asn': 'AS9381 hkbn enterprise solutions hk limited'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['115.241.83.2'], 'asn': 'AS55836 reliance jio infocomm limited'}, {'pulses': ['68bbeeb2ea42ae685b805ef3', '68c134b274c78e6c5fdeefda', '68c91db211043a1f0289cd39', '68b8eb976696573d91bee14d', '68d3a9b227669537cfc610e2', '68c1311d72c4fb68bed6a95d'], 'ips': ['171.244.37.97', '171.244.37.96', '171.244.37.103', '117.6.44.221', '117.2.49.125'], 'asn': 'AS7552 viettel group'}, {'pulses': ['68c37dfeca644940d15f87c8'], 'ips': ['119.96.158.238'], 'asn': 'AS58563 chinanet hubei province network'}, {'pulses': ['68b8eb976696573d91bee14d', '68d25834bf49e79e1b21ba5b', '68c1311d72c4fb68bed6a95d'], 'ips': ['59.98.83.57', '117.247.178.81', '117.219.14.193'], 'asn': 'AS9829 national internet backbone'}, {'pulses': ['68bd40318f4795aec341706e'], 'ips': ['36.134.69.15'], 'asn': 'AS56044 china mobile communications corporation'}, {'pulses': ['68b6a8b245c884fb48bdbfba', '68b7fa322068680adcb19696'], 'ips': ['182.76.204.237', '125.21.59.218'], 'asn': 'AS9498 bharti airtel ltd.'}, {'pulses': ['68c28637811347bc279ed3ad'], 'ips': ['219.150.93.157'], 'asn': 'AS17638 china telecom'}, {'pulses': ['68c134b274c78e6c5fdeefda'], 'ips': ['220.247.224.226'], 'asn': 'AS9329 sri lanka telecom internet'}, {'pulses': ['68cd1232cddff867d10d792e', '68c91db211043a1f0289cd39'], 'ips': ['182.93.50.90'], 'asn': 'AS4609 companhia de telecomunicacoes de macau sarl'}, {'pulses': ['68cd1232cddff867d10d792e', '68cbc0b37d26eec9869b3c81', '68c1311d72c4fb68bed6a95d', '68c3d7b22c18b1a86fc5d5fc', '68c134b274c78e6c5fdeefda'], 'ips': ['51.75.253.68', '51.68.137.240', '51.195.138.37', '51.178.137.178', '152.228.131.33', '151.80.61.151'], 'asn': 'AS16276 ovh sas'}, {'pulses': ['68bbeeb2ea42ae685b805ef3', '68b94bb1ca80f64506cee295'], 'ips': ['95.58.255.251'], 'asn': 'AS9198 jsc kazakhtelecom'}, {'pulses': ['68b6a8b245c884fb48bdbfba', '68c9162db43f1abf2a0d7a4d', '68b55732c35343fbe74749e9', '68ce63b2e66f3de2447a44e0', '68b94bb1ca80f64506cee295', '68ca1c1d770c45504db99193'], 'ips': ['27.254.235.4', '27.254.235.3', '27.254.235.13', '27.254.235.12', '27.254.235.1'], 'asn': 'AS4750 cs loxinfo public company limited'}, {'pulses': ['68bbeeb2ea42ae685b805ef3', '68bfe3327a7ed5ce6d20c08a', '68b94bb1ca80f64506cee295'], 'ips': ['186.96.145.241'], 'asn': 'AS22884 total play telecomunicaciones sa de cv'}, {'pulses': ['68ccb8e8fcc9f28a17749fc0'], 'ips': ['94.63.229.20'], 'asn': 'AS12353 vodafone portugal - communicacoes pessoais s.a.'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['179.33.186.151', '179.32.33.161'], 'asn': 'AS3816 colombia telecomunicaciones s.a. esp'}, {'pulses': ['68c3d7b22c18b1a86fc5d5fc'], 'ips': ['158.51.124.56'], 'asn': 'AS399804 hostodo'}, {'pulses': ['68d25834bf49e79e1b21ba5b', '68bd40318f4795aec341706e'], 'ips': ['51.158.120.121'], 'asn': 'AS12876 online s.a.s.'}, {'pulses': ['68c134b274c78e6c5fdeefda'], 'ips': ['186.10.86.130'], 'asn': 'AS27651 entel chile s.a.'}, {'pulses': ['68bfe3327a7ed5ce6d20c08a'], 'ips': ['168.167.228.74'], 'asn': 'AS14988 african network information center'}, {'pulses': ['68d3a9b227669537cfc610e2'], 'ips': ['176.196.236.146'], 'asn': 'AS39927 e-light-telecom ltd.'}, {'pulses': ['68d106b203e0418dc62e4487', '68bfe3327a7ed5ce6d20c08a', '68cd1232cddff867d10d792e', '68c2399f46d51447a1381df1', '68c91db211043a1f0289cd39', '68ce63b2e66f3de2447a44e0'], 'ips': ['95.167.225.76', '83.171.89.209', '188.18.49.50'], 'asn': 'AS12389 pjsc rostelecom'}, {'pulses': ['68b6a8b245c884fb48bdbfba'], 'ips': ['177.12.2.75'], 'asn': 'AS28665 predlink rede de telecomunices ltda'}, {'pulses': ['68cd1232cddff867d10d792e'], 'ips': ['187.16.96.250'], 'asn': 'AS17222 mundivox do brasil ltda'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['189.112.0.11'], 'asn': 'AS16735 algar telecom s/a'}, {'pulses': ['68b6a8b245c884fb48bdbfba'], 'ips': ['178.251.140.3'], 'asn': 'AS197140 jsc er-telecom holding'}, {'pulses': ['68ba9d32b732655db022dd63', '68b4ff138243d0c9813a1149'], 'ips': ['200.73.135.75'], 'asn': 'AS7303 telecom argentina s.a.'}, {'pulses': ['68c1311d72c4fb68bed6a95d'], 'ips': ['181.174.224.99'], 'asn': 'AS272059 charackwaves cusypata export/import s.a.c.'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['200.118.99.170'], 'asn': 'AS10620 telmex colombia s.a.'}, {'pulses': ['68c67ab37c92ddfd7b0695ef', '68c7cc329a49c0b65042cd6f'], 'ips': ['64.62.197.24', '64.62.197.184'], 'asn': 'AS6939 hurricane electric llc'}, {'pulses': ['68b7943ddb796636c4e8c0ba'], 'ips': ['47.180.114.229'], 'asn': 'AS5650 frontier communications of america  inc.'}, {'pulses': ['68c2399f46d51447a1381df1'], 'ips': ['62.28.222.221'], 'asn': 'AS15525 meo servicos de comunicacoes e multimedia sa'}, {'pulses': ['68c134b274c78e6c5fdeefda'], 'ips': ['186.31.95.163'], 'asn': 'AS19429 etb - colombia'}, {'pulses': ['68ce63b2e66f3de2447a44e0'], 'ips': ['190.202.130.61'], 'asn': 'AS8048 cantv servicios  venezuela'}, {'pulses': ['68c67ab37c92ddfd7b0695ef'], 'ips': ['187.110.238.50'], 'asn': 'AS28598 mob servicos de telecomunicacoes s.a.'}, {'pulses': ['68c9162db43f1abf2a0d7a4d'], 'ips': ['187.45.100.0'], 'asn': 'AS28146 mhnet telecom'}, {'pulses': ['68bbeeb2ea42ae685b805ef3'], 'ips': ['187.49.152.10'], 'asn': 'AS270515 enter telecom'}, {'pulses': ['68d25834bf49e79e1b21ba5b'], 'ips': ['213.6.203.226'], 'asn': 'AS12975 palestine telecommunications company (paltel)'}, {'pulses': ['68d390b6907a2dd3ae1c9b10', '68b4ff138243d0c9813a1149'], 'ips': ['190.12.102.58'], 'asn': 'AS11014 cps'}, {'pulses': ['68c3d7b22c18b1a86fc5d5fc', '68d106b203e0418dc62e4487'], 'ips': ['190.153.249.99'], 'asn': 'AS14259 gtd internet s.a.'}, {'pulses': ['68c3d7b22c18b1a86fc5d5fc'], 'ips': ['200.69.236.207'], 'asn': 'AS16814 nss s.a.'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['201.186.40.250'], 'asn': 'AS14117 telefonica del sur s.a.'}, {'pulses': ['68ba9d32b732655db022dd63', '68bbeeb2ea42ae685b805ef3'], 'ips': ['191.242.105.133'], 'asn': 'AS263476 vigweb comercio instalaes e manutenes ltda'}, {'pulses': ['68cbc0b37d26eec9869b3c81', '68ce63b2e66f3de2447a44e0', '68cfb5329635093fe634fd21'], 'ips': ['80.94.95.112'], 'asn': 'AS35478 bunea telecom srl'}, {'pulses': ['68c9162db43f1abf2a0d7a4d'], 'ips': ['78.186.133.164'], 'asn': 'AS9121 turk telekomunikasyon anonim sirketi'}, {'pulses': ['68c67ab37c92ddfd7b0695ef'], 'ips': ['196.0.120.6'], 'asn': 'AS21491 uganda telecom'}, {'pulses': ['68b55732c35343fbe74749e9', '68c1311d72c4fb68bed6a95d', '68cfb5329635093fe634fd21', '68b8eb976696573d91bee14d'], 'ips': ['197.5.145.8', '197.5.145.73', '197.5.145.150', '197.5.145.102'], 'asn': 'AS327934 african network information center'}, {'pulses': ['68ba9d32b732655db022dd63', '68c67ab37c92ddfd7b0695ef', '68d106b203e0418dc62e4487'], 'ips': ['45.148.10.196', '45.148.10.240'], 'asn': 'AS48090 pptechnology limited'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['202.131.233.35'], 'asn': 'AS9484 mobinet'}, {'pulses': ['68d4fb39056c1f04d4d708d5'], 'ips': ['202.51.214.99'], 'asn': 'AS10220 pt. kreasi sejahtera teknologi'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['70.54.182.130'], 'asn': 'AS577 bell canada'}, {'pulses': ['68bfe3327a7ed5ce6d20c08a', '68c3d7b22c18b1a86fc5d5fc', '68b6a8b245c884fb48bdbfba', '68bd40318f4795aec341706e', '68c5293f79b7cd589be06c1f', '68c28637811347bc279ed3ad', '68bbeeb2ea42ae685b805ef3', '68c134b274c78e6c5fdeefda', '68c67ab37c92ddfd7b0695ef', '68cd1232cddff867d10d792e', '68ce63b2e66f3de2447a44e0', '68cfb5329635093fe634fd21', '68b94bb1ca80f64506cee295', '68cbc0b37d26eec9869b3c81', '68ba9d32b732655db022dd63', '68be91b286e17e1290e3cd29', '68c91db211043a1f0289cd39', '68b55732c35343fbe74749e9', '68ca6f3bb973160ba5c2a137', '68c7cc329a49c0b65042cd6f', '68b7fa322068680adcb19696'], 'ips': ['204.76.203.83'], 'asn': 'AS400328 intelligence hosting llc'}, {'pulses': ['68be33872886ab2541813558'], 'ips': ['4.17.226.146'], 'asn': 'AS3356 level 3 parent  llc'}, {'pulses': ['68ce63b2e66f3de2447a44e0', '68cd1232cddff867d10d792e', '68c2399f46d51447a1381df1'], 'ips': ['83.235.21.125'], 'asn': 'AS6799 ote sa (hellenic telecommunications organisation)'}, {'pulses': ['68b94bb1ca80f64506cee295'], 'ips': ['95.85.114.218'], 'asn': 'AS20661 turkmentelecom isp network'}, {'pulses': ['68b8eb976696573d91bee14d'], 'ips': ['220.205.122.62'], 'asn': 'AS140726 unicom anhui province network'}, {'pulses': ['68b94bb1ca80f64506cee295'], 'ips': ['34.101.240.144'], 'asn': 'AS139190 google asia pacific pte. ltd.'}, {'pulses': ['68c1311d72c4fb68bed6a95d', '68cd1232cddff867d10d792e'], 'ips': ['36.103.243.179'], 'asn': 'AS134761 chinanet ningxia province zhongwei idc network'}, {'pulses': ['68c91db211043a1f0289cd39', '68c2399f46d51447a1381df1'], 'ips': ['45.120.115.150'], 'asn': 'AS63996 mazeda networks limited'}, {'pulses': ['68c67ab37c92ddfd7b0695ef'], 'ips': ['45.172.153.100'], 'asn': 'AS27847 tecnologa digital'}, {'pulses': ['68c2399f46d51447a1381df1'], 'ips': ['45.175.75.254'], 'asn': 'AS268888 acrf servicos de informatica ltda - me'}, {'pulses': ['68bbeeb2ea42ae685b805ef3'], 'ips': ['45.232.73.84'], 'asn': 'AS267251 telefonarnet telecomunicacoes'}, {'pulses': ['68cd1232cddff867d10d792e'], 'ips': ['46.25.236.192'], 'asn': 'AS12430 vodafone espana s.a.u.'}, {'pulses': ['68d25834bf49e79e1b21ba5b', '68ca1c1d770c45504db99193'], 'ips': ['49.65.102.127'], 'asn': 'AS134756 chinanet nanjing jishan idc network'}, {'pulses': ['68d3a9b227669537cfc610e2'], 'ips': ['64.62.156.29'], 'asn': 'AS13650 axia fibrenet ltd.'}, {'pulses': ['68d25834bf49e79e1b21ba5b', '68b94bb1ca80f64506cee295'], 'ips': ['65.49.1.59', '65.49.1.36'], 'asn': 'AS36791 portland internet hosting llc'}, {'pulses': ['68b8eb976696573d91bee14d', '68d3a9b227669537cfc610e2'], 'ips': ['81.30.162.18'], 'asn': 'AS24945 telecommunication company vinteleport'}, {'pulses': ['68cfb5329635093fe634fd21', '68c3d7b22c18b1a86fc5d5fc', '68cd1232cddff867d10d792e'], 'ips': ['91.205.219.185'], 'asn': 'AS48004 pe tsibrankov konstantin igorevich'}]}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 67, 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'asn_evidence': [{'pulses': ['68c13129eded5baa71fb89a2', '68ccb8f509965a500807acf9', '68b7948135a76e095700ee1e', '68c27c7dbf0d82aa994bacfa', '68ca1c3c43c415c08d16985a'], 'ips': ['59.36.254.224', '58.49.26.202', '58.222.244.226', '49.75.185.71', '223.240.116.60', '1.197.78.123'], 'asn': 'AS4134 chinanet'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['112.216.108.62'], 'asn': 'AS3786 lg dacom corporation'}, {'pulses': ['68c13129eded5baa71fb89a2', '68c37e123ec2922c002e71fd'], 'ips': ['116.153.81.58', '119.188.171.173'], 'asn': 'AS4837 china unicom china169 backbone'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['3.143.152.247'], 'asn': 'AS16509 amazon.com inc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa', '68c13129eded5baa71fb89a2', '68b8eba638383bc8eda19b3c', '68ba43cae6726a60b7980c7e', '68b4ff2b31379389de893f0d', '68ccb8f509965a500807acf9', '68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e', '68c91656b66ae9520f619142', '68d4a4929fc24d9d226c01ac'], 'ips': ['45.91.171.169', '45.147.250.208', '37.111.53.110', '206.168.34.57', '206.168.34.167', '199.45.154.187', '199.45.154.185', '199.45.154.184', '199.45.154.182', '199.45.154.181', '199.45.154.142', '172.174.72.225', '170.64.209.39', '170.64.177.80', '146.88.241.70', '146.88.241.60', '146.88.241.171', '146.88.241.170', '146.88.241.161', '146.88.241.151', '103.206.72.2', '101.126.88.251'], 'asn': 'ASNone '}, {'pulses': ['68b66834e69445088089c4ed'], 'ips': ['39.99.212.219'], 'asn': 'AS37963 hangzhou alibaba advertising co. ltd.'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['222.73.56.10'], 'asn': 'AS4812 china telecom (group)'}, {'pulses': ['68c37e123ec2922c002e71fd', '68ccb8f509965a500807acf9'], 'ips': ['202.85.222.190', '117.50.165.23'], 'asn': 'AS4808 china unicom beijing province network'}, {'pulses': ['68c37e123ec2922c002e71fd', '68d4a4929fc24d9d226c01ac'], 'ips': ['169.197.113.175', '152.32.158.69'], 'asn': 'AS135377 ucloud information technology (hk) limited'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['202.112.237.201'], 'asn': 'AS4538 china education and research network center'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['102.223.92.101'], 'asn': 'AS328647 african network information center'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['81.192.46.49'], 'asn': 'AS6713 itissalat al-maghrib'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['222.253.40.231'], 'asn': 'AS45899 vnpt corp'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['103.239.252.66'], 'asn': 'AS63526 systems solutions & development technologies limited'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.115.24.11'], 'asn': 'AS137823 cloudone'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['103.153.190.121'], 'asn': 'AS140469 pt wahyu adidaya network'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.179.56.51'], 'asn': 'AS136052 pt cloud hosting indonesia'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['162.216.142.81'], 'asn': 'AS135247 k net solutions pvt ltd'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['103.248.120.6'], 'asn': 'AS58906 shivansh infotech pvt ltd'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['103.84.236.222'], 'asn': 'AS134945 blue sky broadband pvt. ltd.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['103.86.180.10'], 'asn': 'AS136284 paradise telecom pvt ltd'}, {'pulses': ['68c13129eded5baa71fb89a2', '68d4a4929fc24d9d226c01ac', '68c37e123ec2922c002e71fd', '68b8eba638383bc8eda19b3c', '68b7948135a76e095700ee1e'], 'ips': ['64.227.112.120', '188.166.68.252', '157.245.69.67', '143.110.182.33', '139.59.58.140', '138.197.24.249', '128.199.157.145'], 'asn': 'AS14061 digitalocean  llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa', '68b8eba638383bc8eda19b3c', '68b66834e69445088089c4ed', '68ccb8f509965a500807acf9', '68be3398c9569a076dd34f1f'], 'ips': ['34.128.77.56', '34.123.134.194', '205.210.31.246', '198.235.24.81', '198.235.24.114'], 'asn': 'AS396982 google'}, {'pulses': ['68be3398c9569a076dd34f1f'], 'ips': ['104.156.155.5'], 'asn': 'AS400161 academy of internet research limited liability company'}, {'pulses': ['68b66834e69445088089c4ed'], 'ips': ['45.79.163.53'], 'asn': 'AS63949 linode  llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['182.61.13.22'], 'asn': 'AS38365 beijing baidu netcom science and technology co.  ltd.'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['122.176.122.24'], 'asn': 'AS24560 bharti airtel ltd.'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['74.94.234.151'], 'asn': 'AS7922 comcast'}, {'pulses': ['68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e'], 'ips': ['198.23.174.113', '198.23.143.193'], 'asn': 'AS36352 colocrossing'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['216.172.190.206'], 'asn': 'AS46606 unified layer'}, {'pulses': ['68b4ff2b31379389de893f0d'], 'ips': ['109.205.213.18'], 'asn': 'AS208046 maximilian kutzner'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['118.122.147.195'], 'asn': 'AS38283 chinanet sichuan telecom internet data center'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['14.63.217.28', '14.63.221.137'], 'asn': 'AS4766 korea telecom'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['150.223.20.12'], 'asn': 'AS58519 cloud computing corporation'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['183.134.217.20'], 'asn': 'AS58461 ct-hangzhou-idc'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['122.129.74.58'], 'asn': 'AS17911 brain telecommunication'}, {'pulses': ['68d390d1581d658a42877880', '68c13129eded5baa71fb89a2'], 'ips': ['51.68.226.87', '51.195.138.37', '51.178.137.178', '152.228.131.33'], 'asn': 'AS16276 ovh sas'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['195.37.190.89'], 'asn': 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.'}, {'pulses': ['68be3398c9569a076dd34f1f'], 'ips': ['150.107.36.236'], 'asn': 'AS137426 simm it services'}, {'pulses': ['68b8eba638383bc8eda19b3c', '68b4ff2b31379389de893f0d', '68c91656b66ae9520f619142', '68be3398c9569a076dd34f1f', '68b7948135a76e095700ee1e'], 'ips': ['167.94.138.155', '167.94.138.147', '167.94.138.145', '167.94.138.141', '167.94.138.134', '162.142.125.88'], 'asn': 'AS398324 censys  inc.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['62.210.24.128'], 'asn': 'AS12876 online s.a.s.'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['167.94.145.28'], 'asn': 'AS398705 censys  inc.'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['181.2.151.236'], 'asn': 'AS7303 telecom argentina s.a.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['64.62.197.166'], 'asn': 'AS6939 hurricane electric llc'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['31.7.70.8'], 'asn': 'AS43754 asiatech data transmission company'}, {'pulses': ['68ba43cae6726a60b7980c7e'], 'ips': ['92.63.197.210'], 'asn': 'AS44446 qwalarty corporation'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['186.149.199.90'], 'asn': 'AS12066 altice dominicana s.a.'}, {'pulses': ['68d390d1581d658a42877880'], 'ips': ['187.111.28.131'], 'asn': 'AS53120 mundivox telecomunicaes ltda'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['79.3.96.178'], 'asn': 'AS3269 telecom italia s.p.a.'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['193.163.125.110'], 'asn': 'AS211298 constantine cybersecurity ltd.'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['78.186.133.164'], 'asn': 'AS9121 turk telekomunikasyon anonim sirketi'}, {'pulses': ['68c37e123ec2922c002e71fd'], 'ips': ['195.88.120.62'], 'asn': 'AS48969 parus-telecom'}, {'pulses': ['68c37e123ec2922c002e71fd', '68ccb8f509965a500807acf9'], 'ips': ['2.57.122.112', '45.148.10.240'], 'asn': 'AS48090 pptechnology limited'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['202.125.94.71'], 'asn': 'AS46042 gunadarma university'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['202.131.233.35'], 'asn': 'AS9484 mobinet'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['202.51.214.99'], 'asn': 'AS10220 pt. kreasi sejahtera teknologi'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['87.126.166.109'], 'asn': 'AS8866 bulgarian telecommunications company plc.'}, {'pulses': ['68b8eba638383bc8eda19b3c'], 'ips': ['220.205.122.62'], 'asn': 'AS140726 unicom anhui province network'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['36.103.243.179'], 'asn': 'AS134761 chinanet ningxia province zhongwei idc network'}, {'pulses': ['68c27c7dbf0d82aa994bacfa'], 'ips': ['45.175.75.254'], 'asn': 'AS268888 acrf servicos de informatica ltda - me'}, {'pulses': ['68ca1c3c43c415c08d16985a'], 'ips': ['49.65.102.127'], 'asn': 'AS134756 chinanet nanjing jishan idc network'}, {'pulses': ['68ba43cae6726a60b7980c7e', '68c91656b66ae9520f619142'], 'ips': ['93.174.95.106', '80.82.70.118'], 'asn': 'AS202425 ip volume inc'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['65.49.1.108'], 'asn': 'AS36791 portland internet hosting llc'}, {'pulses': ['68c91656b66ae9520f619142'], 'ips': ['66.240.236.119'], 'asn': 'AS10439 carinet  inc.'}, {'pulses': ['68b4ff2b31379389de893f0d'], 'ips': ['79.124.62.122'], 'asn': 'AS207812 dm auto eood'}, {'pulses': ['68b7948135a76e095700ee1e'], 'ips': ['91.144.21.210'], 'asn': 'AS29256 syrian telecom'}, {'pulses': ['68c13129eded5baa71fb89a2'], 'ips': ['91.238.181.96'], 'asn': 'AS29551 aixit gmbh'}]}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'France', 'protocol': 'sip', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'distinct_asn_count': 6, 'asns': ['ASNone ', 'AS396982 google', 'AS398324 censys  inc.', 'AS29791 internap holding llc', 'AS211298 constantine cybersecurity ltd.', 'AS202425 ip volume inc'], 'asn_evidence': [{'pulses': ['68ca81f5009b15822e7d9141', '68bff5f416edf006e14538af', '68c93076d18853feee35a2ba'], 'ips': ['199.45.154.191', '199.45.154.176', '146.88.241.172'], 'asn': 'ASNone '}, {'pulses': ['68ca81f5009b15822e7d9141', '68c93076d18853feee35a2ba'], 'ips': ['198.235.24.184', '198.235.24.180'], 'asn': 'AS396982 google'}, {'pulses': ['68bd52f4cd458b1dea125cc4'], 'ips': ['167.94.138.159'], 'asn': 'AS398324 censys  inc.'}, {'pulses': ['68c3ea7be4a2f0cea352e29d'], 'ips': ['173.231.185.164'], 'asn': 'AS29791 internap holding llc'}, {'pulses': ['68c93076d18853feee35a2ba', '68bd52f4cd458b1dea125cc4'], 'ips': ['193.163.125.33', '193.163.125.250'], 'asn': 'AS211298 constantine cybersecurity ltd.'}, {'pulses': ['68c3ea7be4a2f0cea352e29d'], 'ips': ['93.174.95.106'], 'asn': 'AS202425 ip volume inc'}]}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'France', 'protocol': 'snmp', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 11, 'asns': ['ASNone ', 'AS135377 ucloud information technology (hk) limited', 'AS396982 google', 'AS6130 american internet services  llc.', 'AS398324 censys  inc.', 'AS6939 hurricane electric llc', 'AS197068 hll llc', 'AS211298 constantine cybersecurity ltd.', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.'], 'asn_evidence': [{'pulses': ['68ca81f72002b0ebd72354f1'], 'ips': ['199.45.154.191'], 'asn': 'ASNone '}, {'pulses': ['68ca81f72002b0ebd72354f1'], 'ips': ['45.43.62.77'], 'asn': 'AS135377 ucloud information technology (hk) limited'}, {'pulses': ['68c93078f7ef4dd7ed22cdc3', '68bc0178663b3e5d2f8f3a09', '68bff5f6976a0ed2c764e3f1'], 'ips': ['205.210.31.250', '205.210.31.218', '198.235.24.195', '198.235.24.125', '198.235.24.119'], 'asn': 'AS396982 google'}, {'pulses': ['68bff5f6976a0ed2c764e3f1', '68c93078f7ef4dd7ed22cdc3'], 'ips': ['147.203.255.20'], 'asn': 'AS6130 american internet services  llc.'}, {'pulses': ['68c93078f7ef4dd7ed22cdc3'], 'ips': ['162.142.125.87'], 'asn': 'AS398324 censys  inc.'}, {'pulses': ['68d119774a6b79caa01a53bd'], 'ips': ['64.62.197.26'], 'asn': 'AS6939 hurricane electric llc'}, {'pulses': ['68c3ea98fea7a685119ef5eb'], 'ips': ['185.94.111.1'], 'asn': 'AS197068 hll llc'}, {'pulses': ['68c93078f7ef4dd7ed22cdc3'], 'ips': ['193.163.125.30'], 'asn': 'AS211298 constantine cybersecurity ltd.'}, {'pulses': ['68bc0178663b3e5d2f8f3a09'], 'ips': ['64.62.156.13'], 'asn': 'AS13650 axia fibrenet ltd.'}, {'pulses': ['68c93078f7ef4dd7ed22cdc3', '68c3ea98fea7a685119ef5eb', '68bff5f6976a0ed2c764e3f1', '68ca81f72002b0ebd72354f1'], 'ips': ['65.49.1.69', '65.49.1.50', '65.49.1.111', '65.49.1.41'], 'asn': 'AS36791 portland internet hosting llc'}, {'pulses': ['68bff5f6976a0ed2c764e3f1', '68c93078f7ef4dd7ed22cdc3'], 'ips': ['71.6.232.27'], 'asn': 'AS10439 carinet  inc.'}]}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (517 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS attacker_ip_count
UNWIND ips AS ip2
MATCH (ip2)-[a:ATTACKS]->(t:Country)
WITH attacker_ip_count, ips, t.name AS target_country, count(a) AS attack_events
ORDER BY attack_events DESC, target_country ASC
WITH attacker_ip_count, ips, collect({country: target_country, count: attack_events})[0..5] AS top_target_countries
UNWIND ips AS ip3
MATCH (ip3)-[a2:ATTACKS]->(:Country)
WHERE a2.technique IS NOT NULL AND a2.technique <> 'unknown'
WITH attacker_ip_count, top_target_countries, a2.technique AS technique, count(a2) AS technique_count
ORDER BY technique_count DESC, technique ASC
WITH attacker_ip_count, top_target_countries, collect({technique: technique, count: technique_count})[0..3] AS top_techniques
RETURN {
  distinct_attacker_ips: attacker_ip_count,
  top_target_countries: top_target_countries,
  top_techniques: top_techniques
} AS result
[validation] first rows: [{'result': {'top_techniques': [{'technique': 'T1566 Phishing', 'count': 533403}, {'technique': 'T1110 Brute Force', 'count': 8224}, {'technique': 'T1595 Active Scanning', 'count': 7586}], 'distinct_attacker_ips': 2790, 'top_target_countries': [{'count': 43430, 'country': 'Germany'}, {'count': 38573, 'country': 'United States of America'}, {'count': 36447, 'country': 'France'}, {'count': 36047, 'country': 'Poland'}, {'count': 35697, 'country': 'Canada'}]}}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
WITH collect(DISTINCT ip) AS ips
UNWIND ips AS ip
OPTIONAL MATCH (ip)-[a:ATTACKS]->(:Country)
WITH ips, collect(a) AS attacks, count(a) AS total_attacks
UNWIND attacks AS a
WITH ips, attacks, total_attacks, a
WHERE a IS NOT NULL AND a.industry IS NOT NULL
WITH ips, attacks, total_attacks, a.industry AS industry, count(*) AS cnt
ORDER BY cnt DESC
WITH size(ips) AS distinct_ips, total_attacks, collect({industry: industry, count: cnt})[0..5] AS top_5_industries
RETURN distinct_ips, total_attacks, top_5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[r:ATTACKS]->(c:Country)
WITH asn, count(DISTINCT c) AS distinct_country_count
ORDER BY distinct_country_count DESC
WITH collect({asn: asn, cnt: distinct_country_count}) AS rows
WITH rows, rows[0].cnt AS max_cnt
UNWIND rows AS row
WITH row, max_cnt
WHERE row.cnt = max_cnt
RETURN row.asn.number AS asn_number, row.cnt AS distinct_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (451 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for SSH -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'SSH', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(tgt:Country)
WHERE a.protocol = 'ssh'
WITH tgt, count(*) AS attack_count
RETURN tgt.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (241 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] exact match for unknown -> unknown
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance' AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS attack_count
RETURN technology, attack_count
ORDER BY attack_count DESC
[validation] first rows: [{'technology': 'windows', 'attack_count': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'France'})
WHERE a.protocol <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH asn.number AS asn_number, a.protocol AS protocol, count(*) AS attack_count
ORDER BY asn_number ASC, attack_count DESC, protocol ASC
WITH asn_number, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols
UNWIND top_protocols AS tp
RETURN asn_number, tp.protocol AS protocol, tp.attack_count AS attack_count
ORDER BY asn_number ASC, attack_count DESC, protocol ASC
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn_number': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> '' AND toLower(ip.botnet) <> 'unknown'
WITH ip.botnet AS malware_family, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
RETURN malware_family, attack_count
[validation] first rows: [{'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `destination_port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=2, column=9, offset=44>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 44, 'line': 2, 'column': 9}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.destination_port IS NOT NULL\nWITH r.destination_port AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC'
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `destination_port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=3, column=8, offset=80>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 80, 'line': 3, 'column': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.destination_port IS NOT NULL\nWITH r.destination_port AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC'
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.destination_port IS NOT NULL
WITH r.destination_port AS port, count(*) AS attack_count
RETURN port, attack_count
ORDER BY attack_count DESC
LIMIT $topN
[validation] executing: MATCH (:IP)-[r:ATTACKS]->(:Country)
WHERE r.destination_port IS NOT NULL
WITH r.destination_port AS port, count(*) AS attack_count
RETURN port, attack_count
ORDER BY attack_count DESC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS {technique: 'Phishing'}]->(c:Country {name: 'Australia'})
RETURN count(a) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(target:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  target.name AS target_country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH asns, range(0, size(asns)-2) AS iRange
UNWIND iRange AS i
UNWIND range(i+1, size(asns)-1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2
WITH
  CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_low,
  CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_high
RETURN asn_low AS asn1, asn_high AS asn2, count(*) AS co_attack_bucket_count
ORDER BY co_attack_bucket_count DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] first rows: [{'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_bucket_count': 2800}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_bucket_count': 2619}, {'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_bucket_count': 2580}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_bucket_count': 1035}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS54113 fastly', 'co_attack_bucket_count': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour <= 16
WITH r.protocol AS protocol, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 1
RETURN protocol, attack_count
[validation] first rows: [{'protocol': 'tcp', 'attack_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {
    "kind": "relationship",
    "label": "ATTACKS",
    "property": "technique",
    "value": "brute-force"
  }
]
[matcher] cleaned response: [
  {
    "kind": "relationship",
    "label": "ATTACKS",
    "property": "technique",
    "value": "brute-force"
  }
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'brute-force' -> 'T1110 Brute Force' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'brute-force', 'value': 'T1110 Brute Force'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(:Country)
WHERE r.technique = 'T1110 Brute Force'
MATCH (ip)-[:FROM]->(host:Country)
WITH host, count(DISTINCT ip) AS distinct_ip_count
ORDER BY distinct_ip_count DESC
RETURN host.name AS hosting_country, distinct_ip_count AS distinct_bruteforce_attacker_ips
ORDER BY distinct_bruteforce_attacker_ips DESC
[validation] first rows: [{'hosting_country': 'China', 'distinct_bruteforce_attacker_ips': 1359}, {'hosting_country': 'United States of America', 'distinct_bruteforce_attacker_ips': 617}, {'hosting_country': 'Russian Federation', 'distinct_bruteforce_attacker_ips': 178}, {'hosting_country': 'India', 'distinct_bruteforce_attacker_ips': 167}, {'hosting_country': 'Singapore', 'distinct_bruteforce_attacker_ips': 159}]

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'T1485' -> 'T1485 Data Destruction' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'T1485', 'value': 'T1485 Data Destruction'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.technique = 'T1485 Data Destruction'
WITH c, count(*) AS attack_count, count(DISTINCT a.pulse_id) AS distinct_pulse_count
ORDER BY attack_count DESC
LIMIT 1
RETURN c.name AS country, attack_count, distinct_pulse_count
[validation] first rows: [{'country': 'United States of America', 'attack_count': 61, 'distinct_pulse_count': 6}]

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WITH c, date.truncate('day', a.documented_create_date) AS attack_day
WITH c, count(DISTINCT attack_day) AS active_day_count
RETURN c.name AS country, active_day_count
ORDER BY active_day_count DESC
[validation] first rows: [{'country': 'United States of America', 'active_day_count': 886}, {'country': 'Australia', 'active_day_count': 739}, {'country': 'France', 'active_day_count': 399}, {'country': 'Malaysia', 'active_day_count': 302}, {'country': 'Poland', 'active_day_count': 274}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (236 chars)

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3708.32 seconds
Total tokens: 48,370

Status Breakdown:
  ðŸ”´ ERROR                    :   6 ( 30.0%)
  âœ… SUCCESS                  :  11 ( 55.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ OTHER                         :   6

Success Rate: 55.0%

Results saved to: gpt-5.2_results_950k/run_16.json
================================================================================

[Thu Feb 12 05:48:24 UTC 2026] Worker 2: Run #16 completed
[Thu Feb 12 05:48:24 UTC 2026] Worker 2: Tokens in this run: 48370
[Thu Feb 12 05:48:24 UTC 2026] Worker 2: Total tokens: 861216
[Thu Feb 12 05:48:24 UTC 2026] Worker 2: Progress: 71%
[Thu Feb 12 05:48:26 UTC 2026] Worker 2: Starting Run #17
[Thu Feb 12 05:48:26 UTC 2026] Worker 2: Tokens used so far: 861216

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WITH r.technique AS technique, count(*) AS event_count
RETURN technique, event_count
ORDER BY event_count DESC
LIMIT 1
[validation] first rows: [{'technique': 'T1566 Phishing', 'event_count': 2863569}]

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1181 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1181 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(c:Country)
WITH count(DISTINCT ip) AS attacker_ip_count,
     collect({country: c.name, technique: a.technique}) AS events
UNWIND events AS e
WITH attacker_ip_count, events, e.country AS country, count(*) AS attack_count
ORDER BY attack_count DESC
WITH attacker_ip_count, events, collect({country: country, attack_count: attack_count})[0..5] AS top_attacked_countries
UNWIND events AS e2
WITH attacker_ip_count, top_attacked_countries, e2.technique AS technique, count(*) AS technique_count
ORDER BY technique_count DESC
WITH attacker_ip_count, top_attacked_countries, collect({technique: technique, technique_count: technique_count})[0..3] AS top_techniques
RETURN attacker_ip_count, top_attacked_countries, top_techniques
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS total_attackers
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(c:Country)
WITH ips, total_attackers, c.name AS country, count(a) AS attacks
ORDER BY attacks DESC
WITH ips, total_attackers, collect({country: country, attacks: attacks})[0..5] AS top_attacked_countries
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.technique IS NOT NULL AND a.technique <> 'unknown'
WITH total_attackers, top_attacked_countries, a.technique AS technique, count(a) AS events
ORDER BY events DESC
WITH total_attackers, top_attacked_countries, collect({technique: technique, events: events})[0..3] AS top_techniques
RETURN total_attackers, top_attacked_countries, top_techniques
[validation] first rows: [{'total_attackers': 2790, 'top_attacked_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_techniques': [{'technique': 'T1566 Phishing', 'events': 533403}, {'technique': 'T1110 Brute Force', 'events': 8224}, {'technique': 'T1595 Active Scanning', 'events': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_ip_count, coalesce(a.industry, '(missing)') AS industry, count(*) AS attack_count
WITH distinct_ip_count,
     collect({industry: industry, attack_count: attack_count}) AS industry_counts,
     sum(attack_count) AS total_attacks_count
UNWIND industry_counts AS ic
WITH distinct_ip_count, total_attacks_count, ic
ORDER BY ic.attack_count DESC, ic.industry ASC
WITH distinct_ip_count, total_attacks_count, collect(ic)[0..5] AS top5_industries
RETURN distinct_ip_count, total_attacks_count, top5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(target:Country)
WITH asn.number AS asn_number, count(DISTINCT target) AS country_count
WITH collect({asn_number: asn_number, country_count: country_count}) AS rows, max(country_count) AS max_country_count
UNWIND rows AS row
WHERE row.country_count = max_country_count
RETURN row.asn_number AS asn_number, row.country_count AS distinct_target_countries
ORDER BY asn_number
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(target:Country)
WITH asn, count(DISTINCT target) AS distinct_country_count
ORDER BY distinct_country_count DESC
RETURN asn.number AS asn_number, distinct_country_count
LIMIT 1
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1637 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(target:Country)
MATCH (ip)-[:FROM]->(src:Country)
WHERE src.name = 'United States'
  AND a.protocol = 'ssh'
WITH target, count(*) AS attack_events
RETURN target.name AS target_country, attack_events
ORDER BY attack_events DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (235 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "''"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "''"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] best match for '''' -> 'unknown' (LCS length 0)
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] best match for ''Finance'' -> 'Finance' (LCS length 7)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': "'Finance'", 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': "''", 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': "'unknown'", 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance'
  AND a.technology IS NOT NULL
  AND trim(a.technology) <> ''
  AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS occurrences
RETURN technology, occurrences
ORDER BY occurrences DESC
[validation] first rows: [{'technology': 'windows', 'occurrences': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[a:ATTACKS]->(c:Country {name: 'France'})
WHERE a.protocol <> 'unknown'
WITH asn.number AS asn, a.protocol AS protocol, count(*) AS attack_count
ORDER BY asn, attack_count DESC, protocol
WITH asn, collect({protocol: protocol, attack_count: attack_count})[0..3] AS top_protocols
UNWIND top_protocols AS tp
RETURN asn, tp.protocol AS protocol, tp.attack_count AS attack_count
ORDER BY asn, attack_count DESC, protocol
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE ip.botnet IS NOT NULL AND trim(ip.botnet) <> ''
WITH ip.botnet AS malware_family, count(*) AS attack_count
RETURN malware_family, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: [{'malware_family': 'unknown', 'attack_count': 3025957}, {'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=2, column=9, offset=44>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 44, 'line': 2, 'column': 9}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.port IS NOT NULL\nWITH r.port AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC'
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=3, column=8, offset=68>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 68, 'line': 3, 'column': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: 'MATCH (:IP)-[r:ATTACKS]->(:Country)\nWHERE r.port IS NOT NULL\nWITH r.port AS port, count(*) AS attack_count\nRETURN port, attack_count\nORDER BY attack_count DESC, port ASC'
[validation] executing: MATCH (:IP)-[r:ATTACKS]->(:Country)
WHERE r.port IS NOT NULL
WITH r.port AS port, count(*) AS attack_count
RETURN port, attack_count
ORDER BY attack_count DESC, port ASC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS {technique: 'Phishing'}]->(c:Country {name: 'Australia'})
RETURN count(*) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(a:ASN)
WITH
  c.name AS country,
  r.technique AS technique,
  date.truncate('month', coalesce(r.documented_create_date, r.documented_modified_date)) AS year_month,
  coalesce(r.pulse_id, 'null') AS pulse_id,
  a.number AS asn
WHERE year_month IS NOT NULL AND technique IS NOT NULL
WITH country, technique, year_month, pulse_id, collect(DISTINCT asn) AS asns
WHERE size(asns) > 1
WITH
  asns,
  country + '|' + technique + '|' + toString(year_month) + '|' + pulse_id AS context_id
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, context_id
WITH
  (CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END) AS asn_low,
  (CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END) AS asn_high,
  context_id
WITH asn_low, asn_high, count(DISTINCT context_id) AS shared_contexts
ORDER BY shared_contexts DESC, asn_low ASC, asn_high ASC
LIMIT 10
RETURN asn_low AS asn1, asn_high AS asn2, shared_contexts
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(target:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  target.name AS country,
  r.technique AS technique,
  date.truncate('month', coalesce(r.documented_create_date, r.documented_modified_date)) AS year_month,
  toString(coalesce(r.pulse_id, '')) AS pulse_id,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH
  asns[i] AS asn1,
  asns[j] AS asn2,
  country,
  technique,
  year_month,
  pulse_id
WITH
  asn1,
  asn2,
  count(DISTINCT [country, technique, year_month, pulse_id]) AS shared_coattack_contexts
ORDER BY shared_coattack_contexts DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_coattack_contexts
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE coalesce(r.documented_create_date, r.documented_modified_date) IS NOT NULL
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  c,
  r.technique AS technique,
  date.truncate('month', coalesce(r.documented_create_date, r.documented_modified_date)) AS year_month,
  coalesce(r.pulse_id, '') AS pulse_id,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH c, technique, year_month, pulse_id, asns, range(0, size(asns) - 2) AS idx1
UNWIND idx1 AS i
WITH c, technique, year_month, pulse_id, asns, i, range(i + 1, size(asns) - 1) AS idx2
UNWIND idx2 AS j
WITH
  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,
  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2,
  {country: c.name, technique: technique, year_month: year_month, pulse_id: pulse_id} AS context
WITH asn1, asn2, count(DISTINCT context) AS shared_co_attack_contexts
ORDER BY shared_co_attack_contexts DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_co_attack_contexts

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "9"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "9"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": "16"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': '16'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Germany'' -> 'Germany' (LCS length 7)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] exact match for 9 -> 9
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] exact match for 16 -> 16
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'Germany'", 'value': 'Germany'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'unknown'", 'value': 'unknown'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'original': '9', 'value': '9'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'original': '16', 'value': '16'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE c.name = 'Germany'
  AND a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour < 16
WITH a.protocol AS protocol, count(*) AS event_count
RETURN protocol, event_count
ORDER BY event_count DESC
LIMIT 1
[validation] first rows: [{'protocol': 'tcp', 'event_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute force"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute force"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute force'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute force'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'brute force' -> 'T1110 Brute Force' (LCS length 11)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'brute force', 'value': 'T1110 Brute Force'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE a.technique = 'T1110 Brute Force'
MATCH (ip)-[:FROM]->(from:Country)
WITH from, ip, count(a) AS attack_events
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH from, ip, attack_events, collect(DISTINCT asn.number) AS ip_asns
WITH from,
     count(DISTINCT ip) AS distinct_ip_count,
     sum(attack_events) AS total_attack_events,
     reduce(s = [], l IN collect(DISTINCT ip_asns) | s + l) AS asns_flat
UNWIND (CASE WHEN size(asns_flat) = 0 THEN [NULL] ELSE asns_flat END) AS asn_number
WITH from, distinct_ip_count, total_attack_events, collect(DISTINCT asn_number) AS asns_raw
WITH from, distinct_ip_count, total_attack_events, [x IN asns_raw WHERE x IS NOT NULL] AS asns
RETURN from.name AS from_country, distinct_ip_count, total_attack_events, asns
ORDER BY distinct_ip_count DESC, total_attack_events DESC
[validation] first rows: [{'from_country': 'China', 'distinct_ip_count': 1359, 'total_attack_events': 8224, 'asns': ['ASNone ', 'AS45090 shenzhen tencent computer systems company limited', 'AS4808 china unicom beijing province network', 'AS4837 china unicom china169 backbone', 'AS142608 china telecom', 'AS4134 chinanet', 'AS137702 nanjing  jiangsu province  p.r.china.', 'AS58461 ct-hangzhou-idc', 'AS134238 chinanet jiangxi province idc network', 'AS4812 china telecom (group)', 'AS17623 china unicom', 'AS17621 china unicom shanghai network', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS138950 jiangsu wuxi international idc network', 'AS23724 idc china telecommunications corporation', 'AS134756 chinanet nanjing jishan idc network', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS45110 beijing tian wei xin tong technology corp. limited.', 'AS134763 chinanet guangdong province network', 'AS132203 tencent building  kejizhongyi avenue', 'AS58542 tianjij 300000', 'AS56005 zhengzhou fastidc technology co. ltd.', 'AS58466 chinanet guangdong province network', 'AS58593 shanghai blue cloud technology co. ltd', 'AS58519 cloud computing corporation', 'AS56041 china mobile communications corporation', 'AS24445 henan mobile communications co. ltd', 'AS9808 china mobile communications group co.  ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS134768 chinanet shaanxi province cloud base network', 'AS9394 china tietong telecommunications corporation', 'AS56046 china mobile communications corporation', 'AS56040 china mobile communications corporation', 'AS56044 china mobile communications corporation', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS133774 fuzhou', 'AS56048 china mobile communicaitons corporation', 'AS149178 china telecom', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS140061 qinghai telecom', 'AS4847 china networks inter-exchange', 'AS132153 ct-shanxi-man', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS140726 unicom anhui province network', 'AS134420 chongqing telecom', 'AS17638 china telecom', 'AS24444 shandong mobile communication company limited', 'AS9929 china unicom industrial internet backbone', 'AS139220 sichuan chuanxn idc', 'AS4809 china telecom', 'AS58563 chinanet hubei province network', 'AS4538 china education and research network center', 'AS24547 hebei mobile communication', 'AS24400 shanghai mobile communications co. ltd.', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS38283 chinanet sichuan telecom internet data center', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS137718 beijing volcano engine technology co.  ltd.', 'AS63835 no 293 wanbao avenue', 'AS63838 chinatelecom', 'AS136958 china unicom guangdong ip network', 'AS58541 qingdao 266000', 'AS59078 yunify technologies inc.', 'AS134366 cloud computing hk limited', 'AS4835 china telecom (group)', 'AS23771 sxbctv  internet service provider', 'AS9812 oriental cable network co.  ltd.', 'AS9802 abitcool(china) inc.', 'AS134760 shijiazhuang idc network  chinanet hebei province', 'AS134771 wenzhou  zhejiang province  p.r.china.', 'AS136190 jinhua  zhejiang province  p.r.china.', 'AS135391 aofei data international company limited', 'AS58543 guangdong', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS133119 china unicom ip network', 'AS139201 jiangxi jiujiang idc', 'AS134765 chinanet yunnan province idc1 network', 'AS137699 chinatelecom jiangsu suqian idc network', 'AS140527 china telecom', 'AS45061 shanghai information network co. ltd.', 'AS131314 china broadband communications (hong kong) company limited', 'AS17816 china unicom', 'AS138421 china unicom', 'AS56042 china mobile communications corporation', 'AS132525 heilongjiang mobile communication company limited', 'AS134810 china mobile group jilin communications corporation', 'AS134766 chinanet yunnan province idc2 network', 'AS133776 quanzhou', 'AS4816 china telecom (group)']}, {'from_country': 'United States of America', 'distinct_ip_count': 617, 'total_attack_events': 3801, 'asns': ['AS7018 att services inc', 'AS8075 microsoft corporation', 'AS25820 it7 networks inc', 'AS26496 godaddy.com  llc', 'AS7922 comcast', 'AS6128 cablevision systems corp.', 'AS48090 pptechnology limited', 'ASNone ', 'AS1239 sprint', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS8560 1&1 ionos se', 'AS701 verizon', 'AS13490 buckeye cablevision  inc.', 'AS22773 cox communications inc.', 'AS398101 godaddy.com  llc', 'AS10439 carinet  inc.', 'AS3737 penteledata inc.', 'AS46606 unified layer', 'AS14051 consolidated communications', 'AS32475 singlehop llc', 'AS31898 oracle corporation', 'AS14061 digitalocean  llc', 'AS398791 godaddy.com  llc', 'AS20115 charter communications', 'AS11351 charter communications inc', 'AS29789 reflected networks  inc.', 'AS63949 linode  llc', 'AS36791 portland internet hosting llc', 'AS11426 charter communications inc', 'AS20141 quality technology services  llc', 'AS13650 axia fibrenet ltd.', 'AS16863 home telephone company  inc.', 'AS22394 verizon', 'AS32748 steadfast', 'AS132203 tencent building  kejizhongyi avenue', 'AS11427 charter communications inc', 'AS22271 beth abraham health services', 'AS53667 frantech solutions', 'AS26863 gameserverkings', 'AS14618 amazon.com  inc.', 'AS3356 level 3 parent  llc', 'AS174 cogent communications', 'AS396982 google', 'AS15169 google llc', 'AS19527 google llc', 'AS36352 colocrossing', 'AS46664 volume drive', 'AS396507 emerald onion', 'AS53334 total uptime technologies  llc', 'AS40676 psychz networks', 'AS3595 zcolo', 'AS19318 interserver  inc', 'AS400328 intelligence hosting llc', 'AS8070 microsoft corporation', 'AS58182 wix.com ltd.', 'AS53831 squarespace  inc.', 'AS30823 combahton gmbh', 'AS209371 private network', 'AS51167 contabo gmbh', 'AS54113 fastly', 'AS29791 internap holding llc', 'AS20940 akamai international b.v.', 'AS32 stanford university', 'AS398705 censys  inc.', 'AS398324 censys  inc.', 'AS398722 censys  inc.', 'AS135377 ucloud information technology (hk) limited', 'AS63023 gthost', 'AS21859 zenlayer inc', 'AS10796 charter communications inc', 'AS397270 netinformatik inc.', 'AS399804 hostodo', 'AS136970 yisu cloud ltd', 'AS16276 ovh sas', 'AS22552 esited solutions', 'AS27357 rackspace hosting', 'AS11232 midcontinent communications', 'AS4192 oracle corporation', 'AS3 massachusetts institute of technology', 'AS20057 at&t mobility llc', 'AS13335 cloudflare', 'AS62904 eonix corporation', 'AS14987 rethem hosting llc', 'AS49532 eonix corporation']}, {'from_country': 'Russian Federation', 'distinct_ip_count': 178, 'total_attack_events': 1888, 'asns': ['AS25408 jsc er-telecom holding', 'AS39805 city com  ltd.', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS24955 ojsc ufanet', 'AS21127 joint stock company transtelecom', 'AS44901 belcloud ltd', 'AS41754 jsc er-telecom holding', 'AS41668 jsc er-telecom holding', 'AS49531 netcom-r llc', 'AS47433 sibirskie seti ltd.', 'AS49403 avk-wellcom ltd.', 'AS44446 qwalarty corporation', 'AS61432 itbks892', 'AS8359 mts pjsc', 'AS57523 chang way technologies co. limited', 'AS50716 telecom.ru ltd', 'AS47895 ltd erline', 'AS42116 jsc er-telecom holding', 'AS12695 llc digital network', 'AS208911 alsycon b.v.', 'AS8402 pjsc vimpelcom', 'AS8443 pjsc rostelecom', 'AS35807 skynet ltd.', 'AS49392 llc baxet', 'AS42548 pjsc rostelecom', 'AS21378 pjsc rostelecom', 'AS200350 yandex.cloud llc', 'AS25490 pjsc rostelecom', 'AS15582 ojsc comcor', 'AS8439 jsc aist', 'AS41842 sinergiya ltd.', 'AS208091 postepay s.p.a.', 'ASNone ', 'AS12722 reconn llc', 'AS39153 llc setel', 'AS47119 vl-telecom + ltd', 'AS12714 net by net holding llc', 'AS3216 pjsc vimpelcom', 'AS28738 llc company interlan communications', 'AS39812 closed joint stock company radiotelephone', 'AS42861 foton telecom cjsc', 'AS34974 pjsc rostelecom', 'AS42610 pjsc rostelecom', 'AS13259 delta telesystems ltd.', 'AS39493 cjsc kolomna-sviaz tv', 'AS34665 petersburg internet network ltd.', 'AS20632 pjsc megafon', 'AS25227 avantel', 'AS49505 ooo network of data-centers selectel', 'AS210950 tov e-rishennya', 'AS57271 bitweb llc', 'AS50340 ooo network of data-centers selectel', 'AS132203 tencent building  kejizhongyi avenue', 'AS31200 novotelecom ltd', 'AS50215 master llc', 'AS43727 kvant-telekom closed joint stock company', 'AS50867 hostkey b.v.', 'AS39442 jsc rde unico', 'AS39811 mts pjsc', 'AS15974 joint stock company transtelecom', 'AS49749 vostokmediasvyaz ltd.', 'AS12768 jsc er-telecom holding', 'AS51200 ltd digital dialogue-t', 'AS8675 pjsc rostelecom', 'AS8331 jsc er-telecom holding', 'AS48969 parus-telecom', 'AS50676 telcom llc', 'AS8580 mts pjsc', 'AS50911 llc electron-telecom', 'AS60490 mts pjsc', 'AS34559 svyazresurs-region  ltd', 'AS59940 kanzas llc', 'AS198039 ooo russia consulting', 'AS51604 jsc er-telecom holding', 'AS207744 megalink llc', 'AS21353 jsc er-telecom holding', 'AS199782 teletime ltd', 'AS56784 limited liability company multihost msk', 'AS207423 steil-south ltd', 'AS48940 link ltd.', 'AS210644 ', 'AS57427 sierra llc', 'AS209588 flyservers s.a.', 'AS197140 jsc er-telecom holding', 'AS51112 oss ltd', 'AS31208 pjsc megafon', 'AS57378 jsc er-telecom holding', 'AS57835 jsc elektrosvyaz', 'AS30855 tele-plus llc', 'AS2895 ooo freenet group', 'AS200466 tst ooo', 'AS202306 hostglobal.plus ltd', 'AS34771 megaseti ltd.', 'AS51035 jsc er-telecom holding']}, {'from_country': 'India', 'distinct_ip_count': 167, 'total_attack_events': 1209, 'asns': ['AS14061 digitalocean  llc', 'AS9829 national internet backbone', 'AS8075 microsoft corporation', 'ASNone ', 'AS17762 tata teleservices maharashtra ltd', 'AS55577 atria convergence technologies pvt ltd', 'AS24309 atria convergence technologies', 'AS18229 ctrls datacenters', 'AS132787 helios it infrasolutions pvt', 'AS58678 intech online private limited', 'AS45536 readylink internet services limited', 'AS56268 northeast dataa network pvt ltd', 'AS396982 google', 'AS45804 meghbela broadband', 'AS394695 pdr', 'AS9498 bharti airtel ltd.', 'AS7633 softnet', 'AS24560 bharti airtel ltd.', 'AS17754 excellmedia', 'AS18209 atria convergence technologies pvt ltd', 'AS17813 mahanagar telephone nigam limited', 'AS45820 tata teleservices', 'AS135247 k net solutions pvt ltd', 'AS135377 ucloud information technology (hk) limited', 'AS133296 web werks india pvt. ltd.', 'AS45916 gujarat telelink pvt ltd', 'AS132774 niss internet services private limited', 'AS4755 tata communications', 'AS18002 interdomain routing', 'AS55836 reliance jio infocomm limited', 'AS17488 hathway ip over cable internet', 'AS132203 tencent building  kejizhongyi avenue', 'AS18207 you broadband & cable india ltd.', 'AS38457 honesty net solution', 'AS139195 seans media pvt ltd', 'AS18101 reliance communications ltd', 'AS45528 tikona infinet ltd.', 'AS17917 quadrant televentures limited', 'AS45184 den digital entertainment pvt. ltd.', 'AS24186 railtel corporation of india ltd', 'AS135139 skylink fibernet private limited', "AS45117 ishan's network", 'AS134311 trinn techologies pvt. ltd.', 'AS136292 netflix durga webtech pvt ltd', 'AS136284 paradise telecom pvt ltd', 'AS58762 candor infosolution pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS146932 scc network pvt ltd', 'AS133232 sampark estates pvt. ltd.', 'AS135234 sherie plexus isp private limited', 'AS55341 51/a rachna midas gokulpeth', 'AS58898 rainbow communications india pvt ltd', 'AS133278 dehradun enet solutions private ltd', 'AS132754 realtel network services pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS59165 auspice infratel pvt. ltd.', 'AS135182 moradabad internet services private limited', 'AS133647 elxire data services pvt. ltd.', 'AS134337 r2 net solutions pvt ltd', 'AS141253 hyosec solutions private limited', 'AS135777 shreenortheast connect and services pvt ltd', 'AS134319 elyzium technologies pvt. ltd.', 'AS133977 ishan netsol pvt ltd', 'AS134026 ultranet services private limited']}, {'from_country': 'Singapore', 'distinct_ip_count': 159, 'total_attack_events': 685, 'asns': ['AS26496 godaddy.com  llc', 'ASNone ', 'AS45102 alibaba (us) technology co.  ltd.', 'AS8075 microsoft corporation', 'AS16276 ovh sas', 'AS132203 tencent building  kejizhongyi avenue', 'AS396982 google', 'AS64050 bgpnet global asn', 'AS14061 digitalocean  llc', 'AS142002 scloud pte ltd', 'AS58593 shanghai blue cloud technology co. ltd', 'AS17547 m1 net ltd', 'AS3758 singnet', 'AS135377 ucloud information technology (hk) limited']}]

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (251 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WITH
  c,
  count(a) AS total_attacks,
  count(DISTINCT ip) AS distinct_attacker_ips,
  count(DISTINCT date(a.documented_create_date)) AS active_days
RETURN
  c.name AS country,
  active_days,
  total_attacks,
  distinct_attacker_ips
ORDER BY active_days DESC, total_attacks DESC, distinct_attacker_ips DESC, country ASC
[validation] first rows: [{'country': 'United States of America', 'active_days': 886, 'total_attacks': 254170, 'distinct_attacker_ips': 8599}, {'country': 'Australia', 'active_days': 739, 'total_attacks': 19984, 'distinct_attacker_ips': 4125}, {'country': 'France', 'active_days': 399, 'total_attacks': 195247, 'distinct_attacker_ips': 4880}, {'country': 'Malaysia', 'active_days': 302, 'total_attacks': 2044, 'distinct_attacker_ips': 902}, {'country': 'Poland', 'active_days': 274, 'total_attacks': 196108, 'distinct_attacker_ips': 4863}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (359 chars)

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4003.98 seconds
Total tokens: 59,065

Status Breakdown:
  ðŸ”´ ERROR                    :   7 ( 35.0%)
  âœ… SUCCESS                  :  10 ( 50.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :   6

Success Rate: 50.0%

Results saved to: gpt-5.2_results_950k/run_17.json
================================================================================

[Thu Feb 12 06:55:13 UTC 2026] Worker 2: Run #17 completed
[Thu Feb 12 06:55:13 UTC 2026] Worker 2: Tokens in this run: 59065
[Thu Feb 12 06:55:13 UTC 2026] Worker 2: Total tokens: 920281
[Thu Feb 12 06:55:13 UTC 2026] Worker 2: Progress: 76%
[Thu Feb 12 06:55:15 UTC 2026] Worker 2: Starting Run #18
[Thu Feb 12 06:55:15 UTC 2026] Worker 2: Tokens used so far: 920281

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (359 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (359 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)
WHERE a.protocol <> 'unknown' AND a.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  victim.name AS victim_country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  count(a) AS events,
  count(DISTINCT ip) AS unique_ips,
  collect(DISTINCT asn.number) AS involved_asns
WHERE size(involved_asns) > 1
RETURN
  year_month,
  victim_country,
  protocol,
  technique,
  industry,
  involved_asns,
  size(involved_asns) AS distinct_asn_count,
  events,
  unique_ips
ORDER BY year_month DESC, events DESC, unique_ips DESC, distinct_asn_count DESC, victim_country ASC, protocol ASC, technique ASC, industry ASC
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'victim_country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'involved_asns': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 123, 'events': 723, 'unique_ips': 412}, {'year_month': neo4j.time.Date(2025, 9, 1), 'victim_country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'involved_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 174, 'events': 373, 'unique_ips': 373}, {'year_month': neo4j.time.Date(2025, 9, 1), 'victim_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'involved_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_asn_count': 123, 'events': 309, 'unique_ips': 230}, {'year_month': neo4j.time.Date(2025, 9, 1), 'victim_country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'involved_asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'events': 118, 'unique_ips': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'victim_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'involved_asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'events': 118, 'unique_ips': 118}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1564 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips
WITH ips, size(ips) AS attacker_ip_count
UNWIND ips AS ip1
MATCH (ip1)-[a:ATTACKS]->(victim:Country)
WITH ips, attacker_ip_count, victim.name AS victim_country, count(a) AS attack_count
ORDER BY attack_count DESC, victim_country ASC
WITH ips, attacker_ip_count, collect({country: victim_country, attacks: attack_count})[0..5] AS top_victim_countries
UNWIND ips AS ip2
MATCH (ip2)-[a2:ATTACKS]->(:Country)
WHERE a2.technique IS NOT NULL
WITH attacker_ip_count, top_victim_countries, a2.technique AS technique, count(a2) AS technique_count
ORDER BY technique_count DESC, technique ASC
WITH attacker_ip_count, top_victim_countries, collect({technique: technique, attacks: technique_count})[0..3] AS top_techniques
RETURN attacker_ip_count, top_victim_countries, top_techniques
[validation] first rows: [{'attacker_ip_count': 2790, 'top_victim_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip.address) AS distinct_ip_count
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH distinct_ip_count, a.industry AS industry, count(*) AS industry_attack_count
ORDER BY industry_attack_count DESC
WITH
  distinct_ip_count,
  sum(industry_attack_count) AS total_attacks,
  collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_industries
RETURN distinct_ip_count, total_attacks, top_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(country:Country)
WITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count
WITH max(distinct_country_count) AS max_distinct_country_count
MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(country:Country)
WITH asn.number AS asn_number, count(DISTINCT country) AS distinct_country_count, max_distinct_country_count
WHERE distinct_country_count = max_distinct_country_count
RETURN asn_number, distinct_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (557 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'United States'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'SSH'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'United States'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'SSH'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'United States'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'SSH'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'United States'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'SSH'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''United States'' -> 'United States of America' (LCS length 13)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''SSH'' -> 'ssh' (LCS length 3)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'United States'", 'value': 'United States of America'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'SSH'", 'value': 'ssh'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': "'unknown'", 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(target:Country)
WHERE a.protocol = 'SSH' AND a.protocol <> 'unknown'
RETURN target.name AS target_country, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (319 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "''"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "'Finance'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "''"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "'unknown'"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': "'Finance'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': "'unknown'"}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] best match for '''' -> 'unknown' (LCS length 0)
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] best match for ''Finance'' -> 'Finance' (LCS length 7)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': "'Finance'", 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': "''", 'value': "''"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': "'unknown'", 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance'
  AND a.technology IS NOT NULL
  AND trim(a.technology) <> ''
  AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS observations
RETURN technology, observations
ORDER BY observations DESC
[validation] first rows: [{'technology': 'windows', 'observations': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'France'})
WHERE r.protocol <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH asn, r.protocol AS protocol, count(*) AS freq
ORDER BY asn.number, freq DESC, protocol
WITH asn, collect({protocol: protocol, count: freq}) AS protocol_counts
RETURN asn.number AS asn_number, protocol_counts[0..3] AS top_3_protocols
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS10103 hk broadband network ltd.', 'top_3_protocols': [{'protocol': 'ssh', 'count': 1}]}, {'asn_number': 'AS10220 pt. kreasi sejahtera teknologi', 'top_3_protocols': [{'protocol': 'ssh', 'count': 2}]}, {'asn_number': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top_3_protocols': [{'protocol': 'ssh', 'count': 4}]}, {'asn_number': 'AS10439 carinet  inc.', 'top_3_protocols': [{'protocol': 'snmp', 'count': 4}, {'protocol': 'sip', 'count': 1}]}, {'asn_number': 'AS11419 telefnica brasil s.a', 'top_3_protocols': [{'protocol': 'ssh', 'count': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> 'unknown'
WITH ip.botnet AS malware_family, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
RETURN malware_family, attack_count
[validation] first rows: [{'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.destination_port IS NOT NULL
WITH toString(a.destination_port) AS portsStr
WITH split(
  replace(
    replace(
      replace(
        replace(
          replace(
            replace(
              replace(portsStr, '[', ''),
            ']', ''),
          '"', ''),
        ';', ','),
      '|', ','),
    ' ', ','),
  '\n', ','),
',') AS portParts
UNWIND portParts AS portPart
WITH trim(portPart) AS port
WHERE port <> '' AND port <> 'null' AND port <> 'unknown'
RETURN port, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT toInteger(coalesce($topN, 50))
[validation] executing: MATCH ()-[r:ATTACKS]->()
WITH coalesce(r.destination_port, r.destination_ports, r.dest_port, r.dst_port, r.port, r.ports) AS portsRaw
WHERE portsRaw IS NOT NULL
WITH replace(replace(replace(replace(replace(replace(replace(toString(portsRaw),'[',''),']',''),'"',''),'''',''),';',','),'|',','),' ', '') AS portsStr
WITH split(portsStr, ',') AS portTokens
UNWIND portTokens AS portToken
WITH trim(portToken) AS portToken
WHERE portToken <> '' AND portToken =~ '^\d+$'
WITH toInteger(portToken) AS port
RETURN port, count(*) AS attack_frequency
ORDER BY attack_frequency DESC, port ASC
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WITH toString(coalesce(a.destination_port, a.dest_port, a.dst_port, a.dport, a.port)) AS portStr
WHERE portStr IS NOT NULL
WITH replace(replace(replace(replace(replace(portStr,'[',''),']',''),'"',''),'''',''), ' ', '') AS cleaned
WITH replace(replace(cleaned,';',','),'|',',') AS normalized
WITH split(normalized, ',') AS portTokens
UNWIND portTokens AS tok
WITH toLower(split(toString(tok), '/')[0]) AS p0
WITH replace(replace(replace(p0,'tcp',''),'udp',''),' ', '') AS port
WHERE port <> '' AND port <> 'unknown'
RETURN port AS destination_port, count(*) AS attack_count
ORDER BY attack_count DESC, destination_port ASC

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Australia'' -> 'Australia' (LCS length 9)
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''Phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'Australia'", 'value': 'Australia'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'Phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE c.name = 'Australia' AND r.technique = 'Phishing'
RETURN count(*) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH c.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH country, technique, year_month, asns, range(0, size(asns)-2) AS iRange
UNWIND iRange AS i
WITH country, technique, year_month, asns, i, range(i+1, size(asns)-1) AS jRange
UNWIND jRange AS j
WITH country, technique, year_month,
     CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,
     CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2
WITH asn1, asn2, count(*) AS co_attack_contexts
RETURN asn1, asn2, co_attack_contexts
ORDER BY co_attack_contexts DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] first rows: [{'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_contexts': 2800}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS57523 chang way technologies co. limited', 'co_attack_contexts': 2619}, {'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_contexts': 2580}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'co_attack_contexts': 1035}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS54113 fastly', 'co_attack_contexts': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour < 16
WITH r.protocol AS protocol, count(*) AS cnt
WITH collect({protocol: protocol, cnt: cnt}) AS rows, max(cnt) AS maxCnt
UNWIND rows AS row
WITH row, maxCnt
WHERE row.cnt = maxCnt
RETURN row.protocol AS protocol, row.cnt AS attack_count
ORDER BY protocol
[validation] first rows: [{'protocol': 'tcp', 'attack_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (420 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (221 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (:IP)-[a:ATTACKS]->(c:Country)
WITH c, collect(DISTINCT date.truncate('day', a.documented_create_date)) AS active_days
RETURN c.name AS country, size(active_days) AS active_day_count
ORDER BY active_day_count DESC, country ASC
[validation] first rows: [{'country': 'United States of America', 'active_day_count': 886}, {'country': 'Australia', 'active_day_count': 739}, {'country': 'France', 'active_day_count': 399}, {'country': 'Malaysia', 'active_day_count': 302}, {'country': 'Poland', 'active_day_count': 274}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WITH
  ip,
  count(*) AS total_event_count,
  count(DISTINCT date(a.documented_create_date)) AS persistence_active_days,
  count(DISTINCT date.truncate('week', a.documented_create_date)) AS persistence_active_weeks,
  min(a.documented_create_date) AS first_seen,
  max(a.documented_create_date) AS last_seen
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:FROM]->(origin_country:Country)
RETURN
  ip.address AS source_ip,
  asn.number AS asn,
  origin_country.name AS origin_country,
  persistence_active_days AS persistence_metric_active_days,
  persistence_active_weeks AS active_weeks,
  first_seen,
  last_seen,
  total_event_count
ORDER BY persistence_metric_active_days DESC, active_weeks DESC, total_event_count DESC
LIMIT 10
[validation] first rows: [{'source_ip': '204.76.203.83', 'asn': 'AS400328 intelligence hosting llc', 'origin_country': 'United States of America', 'persistence_metric_active_days': 45, 'active_weeks': 9, 'first_seen': neo4j.time.DateTime(2018, 2, 10, 0, 36, 0, 396000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 21, 8, 20, 2, 674000000, tzinfo=<UTC>), 'total_event_count': 46}, {'source_ip': '206.189.95.94', 'asn': 'AS14061 digitalocean  llc', 'origin_country': 'Singapore', 'persistence_metric_active_days': 43, 'active_weeks': 16, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 12, 17, 17, 41, 45, 306000000, tzinfo=<UTC>), 'total_event_count': 45}, {'source_ip': '122.226.191.252', 'asn': 'AS4134 chinanet', 'origin_country': 'China', 'persistence_metric_active_days': 40, 'active_weeks': 15, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2024, 12, 17, 17, 41, 45, 306000000, tzinfo=<UTC>), 'total_event_count': 41}, {'source_ip': '24.199.101.116', 'asn': 'ASNone ', 'origin_country': 'United States of America', 'persistence_metric_active_days': 38, 'active_weeks': 22, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 2, 8, 6, 0, 20, 855000000, tzinfo=<UTC>), 'total_event_count': 44}, {'source_ip': '95.9.192.159', 'asn': 'AS47331 ttnet a.s.', 'origin_country': 'TÃ¼rkiye', 'persistence_metric_active_days': 37, 'active_weeks': 28, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 1, 4, 6, 0, 21, 516000000, tzinfo=<UTC>), 'total_event_count': 43}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4229.35 seconds
Total tokens: 53,151

Status Breakdown:
  ðŸ”´ ERROR                    :   8 ( 40.0%)
  âœ… SUCCESS                  :  10 ( 50.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   2 ( 10.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :   7

Success Rate: 50.0%

Results saved to: gpt-5.2_results_950k/run_18.json
================================================================================

[Thu Feb 12 08:05:47 UTC 2026] Worker 2: Run #18 completed
[Thu Feb 12 08:05:47 UTC 2026] Worker 2: Tokens in this run: 53151
[Thu Feb 12 08:05:47 UTC 2026] Worker 2: Total tokens: 973432
[Thu Feb 12 08:05:47 UTC 2026] Worker 2: Progress: 81%
[Thu Feb 12 08:05:49 UTC 2026] Worker 2: Starting Run #19
[Thu Feb 12 08:05:49 UTC 2026] Worker 2: Tokens used so far: 973432

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (771 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (771 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.protocol <> 'unknown'
  AND a.technique <> 'unknown'
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  c.name AS country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  asn.number AS asn_number
WITH
  year_month, country, protocol, technique, industry,
  collect(DISTINCT asn_number) AS asn_list,
  count(*) AS attack_count
WHERE size(asn_list) >= 2
RETURN
  year_month,
  country,
  protocol,
  technique,
  industry,
  asn_list,
  size(asn_list) AS distinct_asn_count,
  attack_count
ORDER BY year_month DESC, distinct_asn_count DESC, attack_count DESC, country, protocol, technique, industry
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 174, 'attack_count': 373}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 123, 'attack_count': 723}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_asn_count': 123, 'attack_count': 309}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asn_list': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (735 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_attackers
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(t:Country)
WITH distinct_attackers, ips, t.name AS target_country, count(*) AS attacks
ORDER BY attacks DESC, target_country ASC
WITH distinct_attackers, ips, collect({country: target_country, attacks: attacks})[0..5] AS top5_target_countries
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.technique <> 'unknown'
WITH distinct_attackers, top5_target_countries, a.technique AS technique, count(*) AS frequency
ORDER BY frequency DESC, technique ASC
WITH distinct_attackers, top5_target_countries, collect({technique: technique, frequency: frequency})[0..3] AS top3_techniques
RETURN
  distinct_attackers AS total_distinct_attacker_ips,
  top5_target_countries AS top_5_target_countries_by_attacks,
  top3_techniques AS top_3_techniques_by_frequency
[validation] first rows: [{'total_distinct_attacker_ips': 2790, 'top_5_target_countries_by_attacks': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_3_techniques_by_frequency': [{'technique': 'T1566 Phishing', 'frequency': 533403}, {'technique': 'T1110 Brute Force', 'frequency': 8224}, {'technique': 'T1595 Active Scanning', 'frequency': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(fromCountry:Country {name: 'Russia'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH collect(DISTINCT ip) AS ips, collect(a) AS attacks
WITH size(ips) AS distinct_ips, size(attacks) AS total_attacks, attacks
UNWIND attacks AS a
WITH distinct_ips, total_attacks, a.industry AS industry, count(*) AS industry_attacks
ORDER BY industry_attacks DESC
WITH distinct_ips, total_attacks, collect({industry: industry, attacks: industry_attacks})[0..5] AS top_5_industries
RETURN distinct_ips, total_attacks, top_5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(attacked:Country)
WITH asn, count(DISTINCT attacked) AS distinct_attacked_country_count
WITH max(distinct_attacked_country_count) AS max_distinct_attacked_country_count
MATCH (ip2:IP)-[:BELONGS_TO]->(asn2:ASN)
MATCH (ip2)-[:ATTACKS]->(attacked2:Country)
WITH asn2, count(DISTINCT attacked2) AS distinct_attacked_country_count, max_distinct_attacked_country_count
WHERE distinct_attacked_country_count = max_distinct_attacked_country_count
RETURN asn2.number AS asn_number, distinct_attacked_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_attacked_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (487 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "SSH"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'SSH'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for SSH -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'SSH', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(target:Country)
WHERE a.protocol = 'ssh'
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (221 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] exact match for unknown -> unknown
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.industry = 'Finance'
  AND a.technology <> 'unknown'
WITH a.technology AS technology, count(*) AS attack_events
RETURN technology, attack_events
ORDER BY attack_events DESC, technology ASC
[validation] first rows: [{'technology': 'windows', 'attack_events': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (c:Country {name: 'France'})<- [a:ATTACKS]-(ip:IP)-[:BELONGS_TO]->(asn:ASN)
WHERE a.protocol <> 'unknown'
WITH asn, a.protocol AS protocol, count(*) AS frequency
ORDER BY asn.number, frequency DESC, protocol
WITH asn, collect({protocol: protocol, frequency: frequency})[0..3] AS top_protocols
RETURN asn.number AS asn, top_protocols
ORDER BY asn ASC
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'top_protocols': [{'protocol': 'ssh', 'frequency': 1}]}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'top_protocols': [{'protocol': 'ssh', 'frequency': 2}]}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top_protocols': [{'protocol': 'ssh', 'frequency': 4}]}, {'asn': 'AS10439 carinet  inc.', 'top_protocols': [{'protocol': 'snmp', 'frequency': 4}, {'protocol': 'sip', 'frequency': 1}]}, {'asn': 'AS11419 telefnica brasil s.a', 'top_protocols': [{'protocol': 'ssh', 'frequency': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WHERE ip.botnet IS NOT NULL AND trim(ip.botnet) <> '' AND toLower(trim(ip.botnet)) <> 'unknown'
WITH ip.botnet AS malware_family, count(*) AS attack_event_count
RETURN malware_family, attack_event_count
ORDER BY attack_event_count DESC
LIMIT 5
[validation] first rows: [{'malware_family': 'botnet', 'attack_event_count': 73462}, {'malware_family': 'mirai', 'attack_event_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH ()-[r:ATTACKS]->()
WITH coalesce(r.protocol, r.technology) AS attr
WITH attr,
     CASE
       WHEN attr IS NULL THEN NULL
       WHEN attr CONTAINS '/' THEN split(attr, '/')[size(split(attr, '/')) - 1]
       WHEN attr CONTAINS ':' THEN split(attr, ':')[size(split(attr, ':')) - 1]
       ELSE NULL
     END AS portStr
WHERE portStr IS NOT NULL AND portStr =~ '^[0-9]+$'
WITH toInteger(portStr) AS port, count(*) AS attack_event_count
RETURN port, attack_event_count
ORDER BY attack_event_count DESC, port ASC
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: "Australia"})
WHERE trim(r.technique) = "Phishing"
RETURN count(r) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)
WHERE a.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH date.truncate('month', a.documented_create_date) AS year_month,
     victim.name AS victim_country,
     a.technique AS technique,
     collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH year_month, victim_country, technique, asns, size(asns) AS n
UNWIND range(0, n - 2) AS i
UNWIND range(i + 1, n - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, year_month, victim_country, technique
WITH asn1, asn2, count(DISTINCT [year_month, victim_country, technique]) AS shared_contexts
ORDER BY shared_contexts DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_contexts
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(victim:Country)
WHERE a.technique <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH date.truncate('month', a.documented_create_date) AS year_month,
     victim.name AS victim_country,
     a.technique AS technique,
     collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, year_month, victim_country, technique
WITH asn1, asn2, count(*) AS context_count
ORDER BY context_count DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, context_count
[validation] first rows: [{'asn1': 'AS57523 chang way technologies co. limited', 'asn2': 'AS29789 reflected networks  inc.', 'context_count': 2769}, {'asn1': 'AS57523 chang way technologies co. limited', 'asn2': 'AS53334 total uptime technologies  llc', 'context_count': 2589}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS29789 reflected networks  inc.', 'context_count': 2551}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'context_count': 1035}, {'asn1': 'AS54113 fastly', 'asn2': 'AS53334 total uptime technologies  llc', 'context_count': 983}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
WITH r, r.documented_create_date.hour AS h, r.documented_create_date.minute AS m, r.documented_create_date.second AS s
WHERE (h > 9 OR (h = 9 AND m >= 0)) AND (h < 16 OR (h = 16 AND m = 0 AND s = 0))
WITH r.protocol AS protocol, count(*) AS freq
ORDER BY freq DESC, protocol
WITH collect({protocol: protocol, freq: freq}) AS rows
WITH rows, reduce(maxFreq = 0, x IN rows | CASE WHEN x.freq > maxFreq THEN x.freq ELSE maxFreq END) AS maxFreq
UNWIND rows AS row
WHERE row.freq = maxFreq
RETURN row.protocol AS protocol, row.freq AS frequency
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'Germany'})
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour <= 16
WITH a.protocol AS protocol, count(*) AS frequency
WITH max(frequency) AS max_frequency, collect({protocol: protocol, frequency: frequency}) AS rows
UNWIND rows AS row
WHERE row.frequency = max_frequency
RETURN row.protocol AS protocol, row.frequency AS frequency
ORDER BY protocol
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'Germany'})
WHERE a.protocol <> 'unknown'
  AND (a.documented_create_date.hour * 60 + a.documented_create_date.minute) >= 540
  AND (a.documented_create_date.hour * 60 + a.documented_create_date.minute) <= 960
WITH a.protocol AS protocol, count(*) AS freq
ORDER BY freq DESC
WITH collect({protocol: protocol, freq: freq}) AS rows, rows[0].freq AS maxFreq
UNWIND rows AS row
WHERE row.freq = maxFreq
RETURN row.protocol AS protocol, row.freq AS frequency
ORDER BY protocol

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
```
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "brute-force"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'brute-force'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'brute-force' -> 'T1110 Brute Force' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'brute-force', 'value': 'T1110 Brute Force'}]
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE a.technique = 'T1110 Brute Force'
MATCH (ip)-[:FROM]->(host:Country)
WITH host, collect(DISTINCT ip) AS ips
UNWIND ips AS ip2
OPTIONAL MATCH (ip2)-[:BELONGS_TO]->(asn:ASN)
WITH host, count(DISTINCT ip2) AS distinct_ip_count, collect(DISTINCT asn.number) AS asns
WITH host, distinct_ip_count, [x IN asns WHERE x IS NOT NULL] AS asn_numbers
RETURN host.name AS host_country, distinct_ip_count, asn_numbers
ORDER BY distinct_ip_count DESC
[validation] first rows: [{'host_country': 'China', 'distinct_ip_count': 1359, 'asn_numbers': ['ASNone ', 'AS45090 shenzhen tencent computer systems company limited', 'AS4808 china unicom beijing province network', 'AS4837 china unicom china169 backbone', 'AS142608 china telecom', 'AS4134 chinanet', 'AS137702 nanjing  jiangsu province  p.r.china.', 'AS58461 ct-hangzhou-idc', 'AS134238 chinanet jiangxi province idc network', 'AS4812 china telecom (group)', 'AS17623 china unicom', 'AS17621 china unicom shanghai network', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS138950 jiangsu wuxi international idc network', 'AS23724 idc china telecommunications corporation', 'AS134756 chinanet nanjing jishan idc network', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS45110 beijing tian wei xin tong technology corp. limited.', 'AS134763 chinanet guangdong province network', 'AS132203 tencent building  kejizhongyi avenue', 'AS58542 tianjij 300000', 'AS56005 zhengzhou fastidc technology co. ltd.', 'AS58466 chinanet guangdong province network', 'AS58593 shanghai blue cloud technology co. ltd', 'AS58519 cloud computing corporation', 'AS56041 china mobile communications corporation', 'AS24445 henan mobile communications co. ltd', 'AS9808 china mobile communications group co.  ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS134768 chinanet shaanxi province cloud base network', 'AS9394 china tietong telecommunications corporation', 'AS56046 china mobile communications corporation', 'AS56040 china mobile communications corporation', 'AS56044 china mobile communications corporation', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS133774 fuzhou', 'AS56048 china mobile communicaitons corporation', 'AS149178 china telecom', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS140061 qinghai telecom', 'AS4847 china networks inter-exchange', 'AS132153 ct-shanxi-man', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS140726 unicom anhui province network', 'AS134420 chongqing telecom', 'AS17638 china telecom', 'AS24444 shandong mobile communication company limited', 'AS9929 china unicom industrial internet backbone', 'AS139220 sichuan chuanxn idc', 'AS4809 china telecom', 'AS58563 chinanet hubei province network', 'AS4538 china education and research network center', 'AS24547 hebei mobile communication', 'AS24400 shanghai mobile communications co. ltd.', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS38283 chinanet sichuan telecom internet data center', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS137718 beijing volcano engine technology co.  ltd.', 'AS63835 no 293 wanbao avenue', 'AS63838 chinatelecom', 'AS136958 china unicom guangdong ip network', 'AS58541 qingdao 266000', 'AS59078 yunify technologies inc.', 'AS134366 cloud computing hk limited', 'AS4835 china telecom (group)', 'AS23771 sxbctv  internet service provider', 'AS9812 oriental cable network co.  ltd.', 'AS9802 abitcool(china) inc.', 'AS134760 shijiazhuang idc network  chinanet hebei province', 'AS134771 wenzhou  zhejiang province  p.r.china.', 'AS136190 jinhua  zhejiang province  p.r.china.', 'AS135391 aofei data international company limited', 'AS58543 guangdong', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS133119 china unicom ip network', 'AS139201 jiangxi jiujiang idc', 'AS134765 chinanet yunnan province idc1 network', 'AS137699 chinatelecom jiangsu suqian idc network', 'AS140527 china telecom', 'AS45061 shanghai information network co. ltd.', 'AS131314 china broadband communications (hong kong) company limited', 'AS17816 china unicom', 'AS138421 china unicom', 'AS56042 china mobile communications corporation', 'AS132525 heilongjiang mobile communication company limited', 'AS134810 china mobile group jilin communications corporation', 'AS134766 chinanet yunnan province idc2 network', 'AS133776 quanzhou', 'AS4816 china telecom (group)']}, {'host_country': 'United States of America', 'distinct_ip_count': 617, 'asn_numbers': ['AS7018 att services inc', 'AS8075 microsoft corporation', 'AS25820 it7 networks inc', 'AS26496 godaddy.com  llc', 'AS7922 comcast', 'AS6128 cablevision systems corp.', 'AS48090 pptechnology limited', 'ASNone ', 'AS1239 sprint', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS8560 1&1 ionos se', 'AS701 verizon', 'AS13490 buckeye cablevision  inc.', 'AS22773 cox communications inc.', 'AS398101 godaddy.com  llc', 'AS10439 carinet  inc.', 'AS3737 penteledata inc.', 'AS46606 unified layer', 'AS14051 consolidated communications', 'AS32475 singlehop llc', 'AS31898 oracle corporation', 'AS14061 digitalocean  llc', 'AS398791 godaddy.com  llc', 'AS20115 charter communications', 'AS11351 charter communications inc', 'AS29789 reflected networks  inc.', 'AS63949 linode  llc', 'AS36791 portland internet hosting llc', 'AS11426 charter communications inc', 'AS20141 quality technology services  llc', 'AS13650 axia fibrenet ltd.', 'AS16863 home telephone company  inc.', 'AS22394 verizon', 'AS32748 steadfast', 'AS132203 tencent building  kejizhongyi avenue', 'AS11427 charter communications inc', 'AS22271 beth abraham health services', 'AS53667 frantech solutions', 'AS26863 gameserverkings', 'AS14618 amazon.com  inc.', 'AS3356 level 3 parent  llc', 'AS174 cogent communications', 'AS396982 google', 'AS15169 google llc', 'AS19527 google llc', 'AS36352 colocrossing', 'AS46664 volume drive', 'AS396507 emerald onion', 'AS53334 total uptime technologies  llc', 'AS40676 psychz networks', 'AS3595 zcolo', 'AS19318 interserver  inc', 'AS400328 intelligence hosting llc', 'AS8070 microsoft corporation', 'AS58182 wix.com ltd.', 'AS53831 squarespace  inc.', 'AS30823 combahton gmbh', 'AS209371 private network', 'AS51167 contabo gmbh', 'AS54113 fastly', 'AS29791 internap holding llc', 'AS20940 akamai international b.v.', 'AS32 stanford university', 'AS398705 censys  inc.', 'AS398324 censys  inc.', 'AS398722 censys  inc.', 'AS135377 ucloud information technology (hk) limited', 'AS63023 gthost', 'AS21859 zenlayer inc', 'AS10796 charter communications inc', 'AS397270 netinformatik inc.', 'AS399804 hostodo', 'AS136970 yisu cloud ltd', 'AS16276 ovh sas', 'AS22552 esited solutions', 'AS27357 rackspace hosting', 'AS11232 midcontinent communications', 'AS4192 oracle corporation', 'AS3 massachusetts institute of technology', 'AS20057 at&t mobility llc', 'AS13335 cloudflare', 'AS62904 eonix corporation', 'AS14987 rethem hosting llc', 'AS49532 eonix corporation']}, {'host_country': 'Russian Federation', 'distinct_ip_count': 178, 'asn_numbers': ['AS25408 jsc er-telecom holding', 'AS39805 city com  ltd.', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS24955 ojsc ufanet', 'AS21127 joint stock company transtelecom', 'AS44901 belcloud ltd', 'AS41754 jsc er-telecom holding', 'AS41668 jsc er-telecom holding', 'AS49531 netcom-r llc', 'AS47433 sibirskie seti ltd.', 'AS49403 avk-wellcom ltd.', 'AS44446 qwalarty corporation', 'AS61432 itbks892', 'AS8359 mts pjsc', 'AS57523 chang way technologies co. limited', 'AS50716 telecom.ru ltd', 'AS47895 ltd erline', 'AS42116 jsc er-telecom holding', 'AS12695 llc digital network', 'AS208911 alsycon b.v.', 'AS8402 pjsc vimpelcom', 'AS8443 pjsc rostelecom', 'AS35807 skynet ltd.', 'AS49392 llc baxet', 'AS42548 pjsc rostelecom', 'AS21378 pjsc rostelecom', 'AS200350 yandex.cloud llc', 'AS25490 pjsc rostelecom', 'AS15582 ojsc comcor', 'AS8439 jsc aist', 'AS41842 sinergiya ltd.', 'AS208091 postepay s.p.a.', 'ASNone ', 'AS12722 reconn llc', 'AS39153 llc setel', 'AS47119 vl-telecom + ltd', 'AS12714 net by net holding llc', 'AS3216 pjsc vimpelcom', 'AS28738 llc company interlan communications', 'AS39812 closed joint stock company radiotelephone', 'AS42861 foton telecom cjsc', 'AS34974 pjsc rostelecom', 'AS42610 pjsc rostelecom', 'AS13259 delta telesystems ltd.', 'AS39493 cjsc kolomna-sviaz tv', 'AS34665 petersburg internet network ltd.', 'AS20632 pjsc megafon', 'AS25227 avantel', 'AS49505 ooo network of data-centers selectel', 'AS210950 tov e-rishennya', 'AS57271 bitweb llc', 'AS50340 ooo network of data-centers selectel', 'AS132203 tencent building  kejizhongyi avenue', 'AS31200 novotelecom ltd', 'AS50215 master llc', 'AS43727 kvant-telekom closed joint stock company', 'AS50867 hostkey b.v.', 'AS39442 jsc rde unico', 'AS39811 mts pjsc', 'AS15974 joint stock company transtelecom', 'AS49749 vostokmediasvyaz ltd.', 'AS12768 jsc er-telecom holding', 'AS51200 ltd digital dialogue-t', 'AS8675 pjsc rostelecom', 'AS8331 jsc er-telecom holding', 'AS48969 parus-telecom', 'AS50676 telcom llc', 'AS8580 mts pjsc', 'AS50911 llc electron-telecom', 'AS60490 mts pjsc', 'AS34559 svyazresurs-region  ltd', 'AS59940 kanzas llc', 'AS198039 ooo russia consulting', 'AS51604 jsc er-telecom holding', 'AS207744 megalink llc', 'AS21353 jsc er-telecom holding', 'AS199782 teletime ltd', 'AS56784 limited liability company multihost msk', 'AS207423 steil-south ltd', 'AS48940 link ltd.', 'AS210644 ', 'AS57427 sierra llc', 'AS209588 flyservers s.a.', 'AS197140 jsc er-telecom holding', 'AS51112 oss ltd', 'AS31208 pjsc megafon', 'AS57378 jsc er-telecom holding', 'AS57835 jsc elektrosvyaz', 'AS30855 tele-plus llc', 'AS2895 ooo freenet group', 'AS200466 tst ooo', 'AS202306 hostglobal.plus ltd', 'AS34771 megaseti ltd.', 'AS51035 jsc er-telecom holding']}, {'host_country': 'India', 'distinct_ip_count': 167, 'asn_numbers': ['AS14061 digitalocean  llc', 'AS9829 national internet backbone', 'AS8075 microsoft corporation', 'ASNone ', 'AS17762 tata teleservices maharashtra ltd', 'AS55577 atria convergence technologies pvt ltd', 'AS24309 atria convergence technologies', 'AS18229 ctrls datacenters', 'AS132787 helios it infrasolutions pvt', 'AS58678 intech online private limited', 'AS45536 readylink internet services limited', 'AS56268 northeast dataa network pvt ltd', 'AS396982 google', 'AS45804 meghbela broadband', 'AS394695 pdr', 'AS9498 bharti airtel ltd.', 'AS7633 softnet', 'AS24560 bharti airtel ltd.', 'AS17754 excellmedia', 'AS18209 atria convergence technologies pvt ltd', 'AS17813 mahanagar telephone nigam limited', 'AS45820 tata teleservices', 'AS135247 k net solutions pvt ltd', 'AS135377 ucloud information technology (hk) limited', 'AS133296 web werks india pvt. ltd.', 'AS45916 gujarat telelink pvt ltd', 'AS132774 niss internet services private limited', 'AS4755 tata communications', 'AS18002 interdomain routing', 'AS55836 reliance jio infocomm limited', 'AS17488 hathway ip over cable internet', 'AS132203 tencent building  kejizhongyi avenue', 'AS18207 you broadband & cable india ltd.', 'AS38457 honesty net solution', 'AS139195 seans media pvt ltd', 'AS18101 reliance communications ltd', 'AS45528 tikona infinet ltd.', 'AS17917 quadrant televentures limited', 'AS45184 den digital entertainment pvt. ltd.', 'AS24186 railtel corporation of india ltd', 'AS135139 skylink fibernet private limited', "AS45117 ishan's network", 'AS134311 trinn techologies pvt. ltd.', 'AS136292 netflix durga webtech pvt ltd', 'AS136284 paradise telecom pvt ltd', 'AS58762 candor infosolution pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS146932 scc network pvt ltd', 'AS133232 sampark estates pvt. ltd.', 'AS135234 sherie plexus isp private limited', 'AS55341 51/a rachna midas gokulpeth', 'AS58898 rainbow communications india pvt ltd', 'AS133278 dehradun enet solutions private ltd', 'AS132754 realtel network services pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS59165 auspice infratel pvt. ltd.', 'AS135182 moradabad internet services private limited', 'AS133647 elxire data services pvt. ltd.', 'AS134337 r2 net solutions pvt ltd', 'AS141253 hyosec solutions private limited', 'AS135777 shreenortheast connect and services pvt ltd', 'AS134319 elyzium technologies pvt. ltd.', 'AS133977 ishan netsol pvt ltd', 'AS134026 ultranet services private limited']}, {'host_country': 'Singapore', 'distinct_ip_count': 159, 'asn_numbers': ['AS26496 godaddy.com  llc', 'ASNone ', 'AS45102 alibaba (us) technology co.  ltd.', 'AS8075 microsoft corporation', 'AS16276 ovh sas', 'AS132203 tencent building  kejizhongyi avenue', 'AS396982 google', 'AS64050 bgpnet global asn', 'AS14061 digitalocean  llc', 'AS142002 scloud pte ltd', 'AS58593 shanghai blue cloud technology co. ltd', 'AS17547 m1 net ltd', 'AS3758 singnet', 'AS135377 ucloud information technology (hk) limited']}]

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "T1485"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': 'T1485'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for 'T1485' -> 'T1485 Data Destruction' (LCS length 5)
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': 'T1485', 'value': 'T1485 Data Destruction'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.technique = 'T1485 Data Destruction'
WITH country, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 1
RETURN country.name AS country, attack_count AS attack_count
[validation] first rows: [{'country': 'United States of America', 'attack_count': 61}]

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WITH country, date(coalesce(r.documented_create_date, r.documented_modified_date)) AS attack_day
WHERE attack_day IS NOT NULL
WITH country, count(DISTINCT attack_day) AS active_day_count
RETURN country.name AS country, active_day_count
ORDER BY active_day_count DESC, country ASC
[validation] first rows: [{'country': 'United States of America', 'active_day_count': 886}, {'country': 'Australia', 'active_day_count': 739}, {'country': 'France', 'active_day_count': 399}, {'country': 'Malaysia', 'active_day_count': 302}, {'country': 'Poland', 'active_day_count': 274}]

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(tgt:Country)
WITH
  ip,
  min(a.documented_create_date) AS first_seen,
  max(coalesce(a.documented_modified_date, a.documented_create_date)) AS last_seen,
  count(*) AS attack_count,
  count(DISTINCT date.truncate('month', a.documented_create_date)) AS active_months,
  count(DISTINCT date.truncate('week', a.documented_create_date)) AS active_weeks,
  count(DISTINCT date(a.documented_create_date)) AS active_days,
  collect(DISTINCT tgt.name) AS target_countries
WITH
  ip, first_seen, last_seen, attack_count, active_months, active_weeks, active_days, target_countries,
  duration.between(first_seen, last_seen).days AS span_days
WITH
  ip, first_seen, last_seen, attack_count, active_months, active_weeks, active_days, target_countries, span_days,
  (span_days + (active_months * 15) + (active_weeks * 3) + active_days) AS persistence_score
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
OPTIONAL MATCH (ip)-[:FROM]->(src:Country)
RETURN
  ip.address AS ip_address,
  persistence_score,
  attack_count,
  first_seen,
  last_seen,
  span_days,
  active_months,
  active_weeks,
  active_days,
  asn.number AS asn,
  src.name AS source_country,
  target_countries
ORDER BY persistence_score DESC, attack_count DESC
LIMIT 10
[validation] first rows: [{'ip_address': '95.9.192.159', 'persistence_score': 354, 'attack_count': 43, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 20, 0, 4, 49, 709000000, tzinfo=<UTC>), 'span_days': 23, 'active_months': 14, 'active_weeks': 28, 'active_days': 37, 'asn': 'AS47331 ttnet a.s.', 'source_country': 'TÃ¼rkiye', 'target_countries': ['United States of America']}, {'ip_address': '198.185.159.145', 'persistence_score': 344, 'attack_count': 9487, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 24, 4, 4, 5, 604000000, tzinfo=<UTC>), 'span_days': 12, 'active_months': 15, 'active_weeks': 26, 'active_days': 29, 'asn': 'AS53831 squarespace  inc.', 'source_country': 'United States of America', 'target_countries': ['United States of America', 'Turkey', 'Ukraine', 'Romania', 'Czechia', 'United Kingdom of Great Britain and Northern Ireland', 'Norway', 'Lithuania', 'Estonia', 'Latvia', 'Poland', 'Germany', 'Canada', 'France', 'Denmark', 'Australia', 'Spain', 'Japan', 'Italy', 'United States', 'germany', 'indonesia', 'United Kingdom', 'Sweden', 'Singapore', 'Anguilla', 'Aruba', 'Barbados', 'Costa Rica', 'Guatemala', 'Philippines', 'Panama', 'Sint Maarten (Dutch part)', 'Saint Martin (French part)', 'Cayman Islands', 'CuraÃ§ao', 'Mexico', 'Saint Vincent and the Grenadines', 'Saint Kitts and Nevis', 'Tanzania, United Republic of', 'Netherlands', 'Trinidad and Tobago', 'Bahamas', 'Georgia', 'ukraine', 'mexico', 'Ireland', 'TÃ¼rkiye', 'Seychelles', 'Bonaire, Sint Eustatius and Saba']}, {'ip_address': '85.121.193.204', 'persistence_score': 338, 'attack_count': 260, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 20, 0, 4, 49, 709000000, tzinfo=<UTC>), 'span_days': 8, 'active_months': 15, 'active_weeks': 25, 'active_days': 30, 'asn': 'AS44081 yul pro srl', 'source_country': 'Romania', 'target_countries': ['United States of America', 'Turkey', 'Ukraine', 'Romania', 'Czechia', 'United Kingdom of Great Britain and Northern Ireland', 'Norway', 'Lithuania', 'Estonia', 'Latvia', 'Poland', 'Germany', 'Canada', 'France', 'Denmark']}, {'ip_address': '189.195.118.9', 'persistence_score': 321, 'attack_count': 486, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 20, 0, 4, 49, 709000000, tzinfo=<UTC>), 'span_days': 8, 'active_months': 14, 'active_weeks': 23, 'active_days': 34, 'asn': 'AS13999 mega cable  s.a. de c.v.', 'source_country': 'Mexico', 'target_countries': ['United States of America', 'Turkey', 'Ukraine', 'Romania', 'Czechia', 'United Kingdom of Great Britain and Northern Ireland', 'Norway', 'Lithuania', 'Estonia', 'Latvia', 'Poland', 'Germany', 'Canada', 'France', 'Denmark']}, {'ip_address': '24.199.101.116', 'persistence_score': 307, 'attack_count': 44, 'first_seen': neo4j.time.DateTime(2023, 3, 27, 16, 17, 36, 94000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 20, 0, 4, 49, 709000000, tzinfo=<UTC>), 'span_days': 23, 'active_months': 12, 'active_weeks': 22, 'active_days': 38, 'asn': 'ASNone ', 'source_country': 'United States of America', 'target_countries': ['United States of America']}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 3816.93 seconds
Total tokens: 56,364

Status Breakdown:
  ðŸ”´ ERROR                    :   6 ( 30.0%)
  âœ… SUCCESS                  :  11 ( 55.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :   5

Success Rate: 55.0%

Results saved to: gpt-5.2_results_950k/run_19.json
================================================================================

[Thu Feb 12 09:09:30 UTC 2026] Worker 2: Run #19 completed
[Thu Feb 12 09:09:30 UTC 2026] Worker 2: Tokens in this run: 56364
[Thu Feb 12 09:09:30 UTC 2026] Worker 2: Total tokens: 1029796
[Thu Feb 12 09:09:30 UTC 2026] Worker 2: Progress: 85%
[Thu Feb 12 09:09:32 UTC 2026] Worker 2: Starting Run #20
[Thu Feb 12 09:09:32 UTC 2026] Worker 2: Tokens used so far: 1029796

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1250 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (1250 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(target:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE r.protocol <> 'unknown'
  AND r.technique <> 'unknown'
WITH
  date.truncate('month', r.documented_create_date) AS year_month,
  target.name AS target_country,
  r.protocol AS protocol,
  r.technique AS technique,
  r.industry AS industry,
  collect(DISTINCT asn.number) AS asn_list,
  count(DISTINCT asn.number) AS distinct_asn_count,
  count(DISTINCT ip.address) AS distinct_ip_count,
  count(*) AS event_count
WHERE distinct_asn_count >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  asn_list,
  distinct_asn_count,
  distinct_ip_count,
  event_count
ORDER BY event_count DESC, distinct_asn_count DESC, year_month DESC, target_country ASC
[validation] first rows: [{'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'event_count': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'event_count': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'event_count': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'smtp', 'technique': 'T1110 Brute Force', 'industry': 'Serverhosting', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'event_count': 1793}, {'year_month': neo4j.time.Date(2022, 5, 1), 'target_country': 'Germany', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'Technology', 'asn_list': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS4788 tm net  internet service provider', 'AS701 verizon', 'ASNone ', 'AS1221 telstra corporation ltd', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS131090 cat telecom public company ltd', 'AS132754 realtel network services pvt ltd', 'AS9341 pt indonesia comnets plus', 'AS135905 vietnam posts and telecommunications group', 'AS135139 skylink fibernet private limited', 'AS17621 china unicom shanghai network', 'AS24309 atria convergence technologies', 'AS212477 royalehosting b.v.', 'AS24186 railtel corporation of india ltd', 'AS55685 pt jala lintas media', 'AS133774 fuzhou', 'AS17762 tata teleservices maharashtra ltd', 'AS58762 candor infosolution pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS62904 eonix corporation', 'AS49532 eonix corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS7922 comcast', 'AS24547 hebei mobile communication', 'AS9762 hyundai communications network', 'AS9808 china mobile communications group co.  ltd.', 'AS45820 tata teleservices', 'AS4775 globe telecoms', 'AS17623 china unicom', 'AS9697 lg hellovision corp.', 'AS45267 lightwire ltd', 'AS58461 ct-hangzhou-idc', 'AS38731 vietel - cht company', 'AS17853 lgtelecom', 'AS17557 pakistan telecommunication company limited', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS135391 aofei data international company limited', 'AS9498 bharti airtel ltd.', 'AS137687 luoyang  henan province  p.r.china.', 'AS16276 ovh sas', 'AS58593 shanghai blue cloud technology co. ltd', 'AS51852 private layer inc', 'AS263703 netlink amrica c.a.', 'AS57043 hostkey b.v.', 'AS27357 rackspace hosting', 'AS5384 emirates telecommunications corporation', 'AS57523 chang way technologies co. limited', 'AS51167 contabo gmbh', 'AS398324 censys  inc.', 'AS63023 gthost', 'AS32 stanford university', 'AS49505 ooo network of data-centers selectel', 'AS12389 pjsc rostelecom', 'AS11419 telefnica brasil s.a', 'AS140292 chinatelecom jiangsu province suzhou 5g network', 'AS23201 telecel s.a.', 'AS50340 ooo network of data-centers selectel', 'AS61432 itbks892', 'AS44446 qwalarty corporation', 'AS210848 telkom internet ltd', 'AS41436 kamatera inc', 'AS60871 comnet sh.p.k', 'AS133398 tele asia limited', 'AS19429 etb - colombia', 'AS30722 vodafone italia s.p.a.', 'AS16814 nss s.a.', 'AS48721 flyservers s.a.', 'AS8580 mts pjsc', 'AS3741 african network information center', 'AS52440 universidad de la punta', 'AS4621 uninet-th', 'AS131178 opennet isp cambodia', 'AS7693 ksc commercial internet co.ltd.', 'AS15974 joint stock company transtelecom', 'AS56048 china mobile communicaitons corporation', 'AS49434 harmony hosting sarl', 'AS38794 uih', 'AS57271 bitweb llc', 'AS269359 canaa telecomunicaes ltda - me', 'AS202425 ip volume inc', 'AS209160 miti 2000 eood', 'AS207812 dm auto eood', 'AS12400 partner communications ltd.'], 'distinct_asn_count': 94, 'distinct_ip_count': 212, 'event_count': 1793}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (760 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[r:ATTACKS]->(target:Country)
WITH collect(DISTINCT ip) AS ips,
     collect({target: target.name, technique: r.technique}) AS events
UNWIND events AS e
WITH ips, events, e.target AS targetCountry, count(*) AS attackCount
ORDER BY attackCount DESC
WITH ips, events, collect({country: targetCountry, attacks: attackCount})[0..5] AS topTargetCountries
UNWIND events AS e2
WITH ips, topTargetCountries, e2.technique AS technique
WHERE technique <> 'unknown'
WITH ips, topTargetCountries, technique, count(*) AS techniqueCount
ORDER BY techniqueCount DESC
WITH size(ips) AS distinctAttackingIPs,
     topTargetCountries,
     collect({technique: technique, attacks: techniqueCount})[0..3] AS topTechniques
RETURN distinctAttackingIPs, topTargetCountries, topTechniques
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
WITH collect(DISTINCT ip) AS ips
WITH ips, size(ips) AS total_ips
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(t:Country)
WITH total_ips, t.name AS target_country, count(*) AS attack_count
ORDER BY attack_count DESC
WITH total_ips, collect({country: target_country, attacks: attack_count})[0..5] AS top_target_countries
MATCH (ip2:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip2)-[a2:ATTACKS]->(:Country)
WHERE a2.technique <> 'unknown'
WITH total_ips, top_target_countries, a2.technique AS technique, count(*) AS technique_count
ORDER BY technique_count DESC
WITH total_ips, top_target_countries, collect({technique: technique, attacks: technique_count})[0..3] AS top_attack_techniques
RETURN total_ips AS total_distinct_attacking_ips, top_target_countries, top_attack_techniques
[validation] first rows: [{'total_distinct_attacking_ips': 2790, 'top_target_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_attack_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (origin:Country {name: 'Russia'})<-[:FROM]-(ip:IP)
WITH collect(DISTINCT ip) AS ips, count(DISTINCT ip) AS distinct_ip_count
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH ips, distinct_ip_count, count(a) AS total_attacks
UNWIND ips AS ip
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.industry IS NOT NULL AND a.industry <> ''
WITH distinct_ip_count, total_attacks, a.industry AS industry, count(*) AS industry_attack_count
ORDER BY industry_attack_count DESC
WITH distinct_ip_count, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_5_industries
RETURN distinct_ip_count AS distinct_ips, total_attacks AS total_attacks, top_5_industries AS top_5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (asn:ASN)<-[:BELONGS_TO]-(ip:IP)-[:ATTACKS]->(c:Country)
WITH asn, count(DISTINCT c) AS attacked_country_count, collect(DISTINCT c.name) AS attacked_countries
WITH collect({asn: asn, cnt: attacked_country_count, countries: attacked_countries}) AS rows, max(attacked_country_count) AS max_cnt
UNWIND rows AS row
WHERE row.cnt = max_cnt
RETURN row.asn.number AS asn_number, row.cnt AS attacked_country_count, row.countries AS attacked_countries
ORDER BY asn_number
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(dest:Country)
WITH asn, count(DISTINCT dest) AS distinct_attacked_country_count, collect(DISTINCT dest.name) AS attacked_countries
WITH collect({asn_number: asn.number, distinct_attacked_country_count: distinct_attacked_country_count, attacked_countries: attacked_countries}) AS rows,
     max(distinct_attacked_country_count) AS max_count
UNWIND rows AS row
WHERE row.distinct_attacked_country_count = max_count
RETURN row.asn_number AS asn_number,
       row.distinct_attacked_country_count AS distinct_attacked_country_count,
       row.attacked_countries AS attacked_countries
ORDER BY asn_number
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[a:ATTACKS]->(dest:Country)
WITH asn, collect(DISTINCT dest) AS attackedCountries, count(DISTINCT dest) AS attackedCountryCount
WITH collect({asn: asn, attackedCountries: attackedCountries, attackedCountryCount: attackedCountryCount}) AS rows, max(attackedCountryCount) AS maxCount
UNWIND rows AS row
WHERE row.attackedCountryCount = maxCount
RETURN row.asn.number AS asn_number, row.attackedCountryCount AS distinct_attacked_country_count, [c IN row.attackedCountries | c.name] AS attacked_country_list
ORDER BY asn_number

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (239 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(target:Country)
WHERE a.protocol = 'ssh'
WITH target, count(*) AS attack_count
RETURN target.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (247 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] cleaned response: [
  {"kind": "relationship", "label": "ATTACKS", "property": "industry", "value": "Finance"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technology", "value": "unknown"}
]
[matcher] extracted pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] pairs after extraction: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'value': 'unknown'}]
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.industry IS NOT NULL RETURN DISTINCT r.industry AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technology IS NOT NULL RETURN DISTINCT r.technology AS val
[matcher] first rows: ['Defense', 'Industrial', 'Government', 'unknown', 'Serverhosting']
[matcher] exact match for Finance -> Finance
[matcher] first rows: ['unknown', 'sipvicious', 'mssql', 'vnc', 'lamp']
[matcher] exact match for unknown -> unknown
[matcher] resolved pairs: [{'kind': 'relationship', 'label': 'ATTACKS', 'property': 'industry', 'original': 'Finance', 'value': 'Finance'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technology', 'original': 'unknown', 'value': 'unknown'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.industry = 'Finance' AND r.technology <> 'unknown'
RETURN r.technology AS technology, count(*) AS observations
ORDER BY observations DESC
[validation] first rows: [{'technology': 'windows', 'observations': 30}]

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[r:ATTACKS]->(c:Country {name: 'France'})
WHERE r.protocol <> 'unknown'
WITH asn.number AS asn, r.protocol AS protocol, count(*) AS cnt
ORDER BY asn, cnt DESC, protocol
WITH asn, collect({protocol: protocol, count: cnt})[0..3] AS top_protocols
RETURN asn, top_protocols
ORDER BY asn
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'top_protocols': [{'protocol': 'ssh', 'count': 1}]}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'top_protocols': [{'protocol': 'ssh', 'count': 2}]}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'top_protocols': [{'protocol': 'ssh', 'count': 4}]}, {'asn': 'AS10439 carinet  inc.', 'top_protocols': [{'protocol': 'snmp', 'count': 4}, {'protocol': 'sip', 'count': 1}]}, {'asn': 'AS11419 telefnica brasil s.a', 'top_protocols': [{'protocol': 'ssh', 'count': 1}]}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> ''
WITH ip.botnet AS malware_family, count(a) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
RETURN malware_family, attack_count
[validation] first rows: [{'malware_family': 'unknown', 'attack_count': 3025957}, {'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=2, column=9, offset=53>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 53, 'line': 2, 'column': 9}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.port IS NOT NULL AND r.protocol <> 'unknown'\nWITH r.port AS port, r.protocol AS protocol, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 10\nRETURN port, protocol, attack_count"
Received notification from DBMS server: <GqlStatusObject gql_status='01N52', status_description='warn: property key does not exist. The property `port` does not exist. Verify that the spelling is correct.', position=<SummaryInputPosition line=3, column=8, offset=105>, raw_classification='UNRECOGNIZED', classification=<NotificationClassification.UNRECOGNIZED: 'UNRECOGNIZED'>, raw_severity='WARNING', severity=<NotificationSeverity.WARNING: 'WARNING'>, diagnostic_record={'_classification': 'UNRECOGNIZED', '_severity': 'WARNING', '_position': {'offset': 105, 'line': 3, 'column': 8}, 'OPERATION': '', 'OPERATION_CODE': '0', 'CURRENT_SCHEMA': '/'}> for query: "MATCH (ip:IP)-[r:ATTACKS]->(country:Country)\nWHERE r.port IS NOT NULL AND r.protocol <> 'unknown'\nWITH r.port AS port, r.protocol AS protocol, count(*) AS attack_count\nORDER BY attack_count DESC\nLIMIT 10\nRETURN port, protocol, attack_count"
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.port IS NOT NULL AND r.protocol <> 'unknown'
WITH r.port AS port, r.protocol AS protocol, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 10
RETURN port, protocol, attack_count
[validation] first rows: []

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Australia'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "technique", "value": "'Phishing'"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Australia'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'value': "'Phishing'"}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.technique IS NOT NULL RETURN DISTINCT r.technique AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Australia'' -> 'Australia' (LCS length 9)
[matcher] first rows: ['T1566 Phishing', 'unknown', 'T1110 Brute Force', 'T1595 Active Scanning', 'T1204 User Execution']
[matcher] best match for ''Phishing'' -> 'T1566 Phishing' (LCS length 8)
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': "'Australia'", 'value': 'Australia'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'technique', 'original': "'Phishing'", 'value': 'T1566 Phishing'}]
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
WHERE c.name = 'Australia'
  AND r.technique = 'Phishing'
RETURN count(r) AS attack_count
[validation] first rows: [{'attack_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE a.technique <> 'unknown' AND a.documented_create_date IS NOT NULL
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH c.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns
WHERE size(asns) >= 2
WITH country, technique, year_month, asns, range(0, size(asns)-2) AS iRange
UNWIND iRange AS i
WITH country, technique, year_month, asns, i, range(i+1, size(asns)-1) AS jRange
UNWIND jRange AS j
WITH
  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,
  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2
WITH asn1, asn2, count(*) AS shared_contexts
ORDER BY shared_contexts DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_contexts
[validation] first rows: [{'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS57523 chang way technologies co. limited', 'shared_contexts': 2769}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS57523 chang way technologies co. limited', 'shared_contexts': 2589}, {'asn1': 'AS29789 reflected networks  inc.', 'asn2': 'AS53334 total uptime technologies  llc', 'shared_contexts': 2551}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'shared_contexts': 1035}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS54113 fastly', 'shared_contexts': 983}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Germany'})
WHERE r.protocol <> 'unknown'
  AND r.documented_create_date.hour >= 9
  AND r.documented_create_date.hour <= 16
WITH r.protocol AS protocol, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 1
RETURN protocol, attack_count
[validation] first rows: [{'protocol': 'tcp', 'attack_count': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (252 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (231 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (179 chars)

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WITH
  ip,
  count(a) AS event_count,
  min(a.documented_create_date) AS first_seen,
  max(a.documented_create_date) AS last_seen,
  count(DISTINCT date.truncate('month', a.documented_create_date)) AS distinct_active_buckets
WITH
  ip,
  event_count,
  first_seen,
  last_seen,
  distinct_active_buckets,
  duration.between(first_seen, last_seen).days AS span_days
WITH
  ip,
  event_count,
  first_seen,
  last_seen,
  span_days,
  distinct_active_buckets,
  (span_days + (distinct_active_buckets * 10) + event_count) AS persistence_score
MATCH (ip)-[:FROM]->(origin:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
RETURN
  ip.address AS source_ip,
  persistence_score,
  event_count,
  first_seen,
  last_seen,
  span_days,
  distinct_active_buckets,
  origin.name AS origin_country,
  asn.number AS asn
ORDER BY persistence_score DESC, event_count DESC, span_days DESC
LIMIT 10
[validation] first rows: [{'source_ip': '66.254.114.41', 'persistence_score': 25527, 'event_count': 25387, 'first_seen': neo4j.time.DateTime(2023, 11, 9, 4, 0, 48, 87000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 8, 5, 13, 13, 781000000, tzinfo=<UTC>), 'span_days': 30, 'distinct_active_buckets': 11, 'origin_country': 'United States of America', 'asn': 'AS29789 reflected networks  inc.'}, {'source_ip': '208.95.112.1', 'persistence_score': 23046, 'event_count': 22940, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 7, 18, 0, 18, 50, 968000000, tzinfo=<UTC>), 'span_days': 6, 'distinct_active_buckets': 10, 'origin_country': 'United States of America', 'asn': 'AS53334 total uptime technologies  llc'}, {'source_ip': '176.111.174.109', 'persistence_score': 18799, 'event_count': 18672, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 8, 5, 13, 13, 781000000, tzinfo=<UTC>), 'span_days': 27, 'distinct_active_buckets': 10, 'origin_country': 'Russian Federation', 'asn': 'AS57523 chang way technologies co. limited'}, {'source_ip': '185.199.111.153', 'persistence_score': 13776, 'event_count': 13654, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 8, 13, 17, 17, 18, 456000000, tzinfo=<UTC>), 'span_days': 2, 'distinct_active_buckets': 12, 'origin_country': 'United States of America', 'asn': 'AS54113 fastly'}, {'source_ip': '198.185.159.145', 'persistence_score': 9647, 'event_count': 9487, 'first_seen': neo4j.time.DateTime(2022, 10, 11, 13, 14, 18, 676000000, tzinfo=<UTC>), 'last_seen': neo4j.time.DateTime(2025, 9, 22, 6, 45, 45, 714000000, tzinfo=<UTC>), 'span_days': 10, 'distinct_active_buckets': 15, 'origin_country': 'United States of America', 'asn': 'AS53831 squarespace  inc.'}]

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4204.13 seconds
Total tokens: 54,005

Status Breakdown:
  ðŸ”´ ERROR                    :   9 ( 45.0%)
  âœ… SUCCESS                  :   8 ( 40.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   3 ( 15.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :   8

Success Rate: 40.0%

Results saved to: gpt-5.2_results_950k/run_20.json
================================================================================

[Thu Feb 12 10:19:39 UTC 2026] Worker 2: Run #20 completed
[Thu Feb 12 10:19:39 UTC 2026] Worker 2: Tokens in this run: 54005
[Thu Feb 12 10:19:39 UTC 2026] Worker 2: Total tokens: 1083801
[Thu Feb 12 10:19:39 UTC 2026] Worker 2: Progress: 90%
[Thu Feb 12 10:19:41 UTC 2026] Worker 2: Starting Run #21
[Thu Feb 12 10:19:41 UTC 2026] Worker 2: Tokens used so far: 1083801

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (915 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (915 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.protocol <> 'unknown'
  AND a.technique <> 'unknown'
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  country.name AS target_country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  collect(DISTINCT asn.number) AS asns,
  collect(DISTINCT ip.address) AS ips,
  collect(DISTINCT a.pulse_id) AS pulse_ids
WHERE size(asns) >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  size(asns) AS distinct_asn_count,
  asns AS involved_asns,
  size(ips) AS distinct_ip_count,
  ips AS involved_ips,
  [p IN pulse_ids WHERE p IS NOT NULL] AS pulse_id_evidence
ORDER BY year_month DESC, distinct_asn_count DESC, distinct_ip_count DESC
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'distinct_asn_count': 174, 'involved_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_ip_count': 373, 'involved_ips': ['118.195.150.246', '1.202.223.2', '61.222.211.114', '125.228.185.131', '61.188.205.76', '60.190.239.92', '59.36.78.66', '59.36.254.224', '58.56.23.210', '58.222.244.226', '58.209.82.184', '27.185.52.202', '27.128.229.223', '27.128.171.39', '223.240.116.60', '222.89.138.40', '220.178.8.154', '183.63.103.84', '14.29.240.154', '14.29.214.161', '14.29.129.250', '14.22.89.30', '14.116.156.100', '125.91.33.72', '123.53.58.216', '123.187.241.160', '121.228.31.181', '121.227.153.123', '121.227.152.250', '121.227.152.171', '121.15.4.92', '119.1.156.50', '117.83.194.85', '117.27.93.170', '139.150.69.56', '118.128.237.197', '112.216.108.62', '1.214.197.163', '113.193.234.210', '116.120.97.12', '1.238.106.229', '116.153.81.58', '61.240.156.16', '122.114.252.143', '116.255.159.152', '223.197.248.209', '1.55.33.86', '103.81.86.208', '57.128.182.5', '37.111.53.110', '206.168.34.41', '203.145.34.222', '199.45.154.158', '172.190.89.127', '172.174.72.225', '172.174.5.146', '170.64.158.136', '165.154.163.10', '14.103.127.7', '14.103.127.198', '14.103.122.90', '14.103.122.180', '14.103.118.76', '14.103.115.233', '14.103.112.100', '120.48.175.69', '103.217.145.154', '103.191.178.123', '103.188.177.46', '103.182.132.154', '101.126.30.240', '101.126.4.215', '101.126.54.66', '101.126.81.188', '101.126.81.213', '101.126.88.251', '101.126.88.79', '101.126.89.164', '101.47.5.97', '58.33.97.119', '101.89.113.198', '101.91.192.9', '218.78.13.73', '218.78.51.90', '123.59.135.110', '117.50.67.183', '117.50.55.96', '117.50.51.198', '114.242.9.121', '106.37.72.112', '106.38.205.224', '150.109.244.181', '165.154.105.128', '152.32.253.152', '152.32.250.188', '118.194.234.14', '118.194.230.231', '183.91.11.36', '81.192.46.49', '160.174.129.232', '123.30.249.49', '103.106.194.74', '14.225.206.98', '103.115.24.11', '103.119.92.117', '103.133.36.6', '103.141.208.61', '103.153.190.121', '49.204.74.149', '106.51.92.114', '103.16.202.187', '103.179.57.150', '103.179.56.51', '103.176.78.213', '103.176.78.193', '103.171.85.186', '103.203.224.181', '103.187.147.214', '36.255.3.203', '182.18.161.165', '103.213.238.91', '103.233.206.154', '103.248.120.6', '103.25.47.94', '121.52.147.5', '202.157.176.29', '202.157.176.165', '103.82.240.194', '103.84.119.130', '103.84.236.242', '103.86.180.10', '12.156.67.18', '64.227.174.243', '165.22.217.96', '162.243.168.76', '159.65.154.92', '159.223.16.184', '142.93.116.14', '139.59.64.179', '139.59.226.77', '137.184.202.107', '128.199.183.223', '128.199.168.119', '128.199.157.145', '104.152.52.151', '104.152.52.153', '104.152.52.159', '104.152.52.160', '104.152.52.162', '34.128.77.56', '34.123.134.194', '205.210.31.41', '205.210.31.172', '198.235.24.71', '198.235.24.217', '104.195.12.40', '34.140.65.171', '20.87.21.241', '20.40.73.192', '20.193.141.133', '20.127.224.153', '104.208.108.166', '45.61.187.220', '41.111.183.173', '60.199.224.55', '182.61.13.22', '36.40.79.122', '113.141.166.35', '111.238.174.6', '122.176.122.24', '96.78.175.36', '50.225.176.238', '198.23.174.113', '198.23.143.193', '198.12.114.232', '192.210.233.234', '192.210.135.20', '107.173.85.161', '216.172.190.206', '198.1.117.220', '162.240.156.34', '36.91.166.34', '36.67.70.198', '36.64.68.99', '118.122.147.195', '49.231.192.36', '36.139.226.237', '36.137.249.148', '36.134.203.156', '59.12.160.91', '222.98.122.37', '222.102.21.102', '221.159.150.85', '220.80.223.144', '218.156.176.223', '218.145.181.48', '211.37.174.62', '211.253.9.49', '211.253.37.225', '175.207.13.86', '14.63.160.31', '14.63.217.28', '14.63.221.137', '112.196.70.142', '36.134.96.76', '223.68.169.181', '112.4.79.138', '122.53.133.167', '182.253.238.218', '42.123.115.126', '203.189.196.168', '223.197.125.110', '218.255.103.194', '115.241.83.2', '171.244.37.97', '171.244.37.96', '171.244.37.103', '117.6.44.221', '117.2.49.125', '171.244.134.21', '203.0.104.170', '119.96.174.235', '119.96.159.237', '119.96.158.238', '119.96.157.188', '59.98.83.57', '117.247.178.81', '117.91.186.55', '164.52.24.185', '119.246.15.94', '36.134.69.15', '120.92.33.108', '122.13.25.186', '203.145.143.163', '182.76.204.237', '125.20.16.22', '49.207.2.190', '220.247.224.226', '223.221.36.42', '195.178.110.224', '135.0.208.122', '51.75.253.68', '51.75.194.10', '51.68.137.240', '51.195.138.37', '51.178.43.161', '51.161.153.48', '193.70.87.152', '152.228.131.33', '151.80.61.151', '146.59.80.142', '142.44.247.114', '138.204.127.54', '143.64.168.136', '95.58.255.251', '46.191.141.152', '27.254.235.4', '27.254.235.3', '27.254.235.13', '27.254.235.12', '27.254.235.1', '27.254.192.185', '27.254.149.199', '147.50.227.79', '186.96.145.241', '5.157.10.83', '151.252.84.225', '179.33.186.151', '179.32.33.161', '152.200.181.42', '94.254.0.234', '158.51.124.56', '173.231.185.164', '51.159.54.22', '51.158.120.121', '167.94.145.99', '167.94.145.97', '167.94.145.109', '168.167.228.74', '168.167.228.123', '170.79.37.88', '95.167.225.76', '83.171.89.209', '188.17.148.221', '177.12.2.75', '187.16.96.250', '189.112.0.11', '181.188.159.138', '178.251.140.3', '179.51.153.37', '200.73.135.75', '181.2.151.236', '201.17.133.138', '190.128.241.2', '181.49.50.6', '64.62.197.215', '64.62.197.17', '184.105.247.252', '47.180.114.229', '186.103.169.12', '186.31.95.163', '186.154.90.114', '186.233.204.9', '201.249.89.102', '200.11.141.86', '200.109.234.38', '190.202.130.61', '187.110.238.50', '187.49.152.14', '187.49.152.10', '79.3.96.178', '213.6.203.226', '189.126.4.42', '201.184.50.251', '190.0.63.226', '190.12.102.58', '190.111.211.81', '200.69.236.207', '200.189.192.3', '201.186.40.250', '191.242.105.133', '193.106.245.20', '80.94.95.112', '194.113.236.217', '195.190.104.66', '78.186.133.164', '196.0.120.211', '45.245.61.114', '197.5.145.8', '197.5.145.73', '197.5.145.150', '197.5.145.102', '45.148.10.240', '202.131.233.35', '202.51.214.99', '202.51.214.98', '204.76.203.83', '83.235.21.125', '212.233.136.201', '62.193.106.227', '27.111.32.174', '34.101.240.144', '36.103.243.179', '43.242.247.141', '45.120.115.150', '45.121.147.47', '45.135.193.100', '45.164.39.253', '45.172.153.100', '45.175.75.254', '45.232.73.84', '46.25.236.192', '49.65.102.127', '93.174.93.12', '61.190.114.203', '63.41.9.210', '64.62.156.97', '64.62.156.94', '64.62.156.91', '64.62.156.86', '64.62.156.80', '64.62.156.100', '78.187.21.105', '79.106.73.114', '81.30.162.18', '82.65.43.136', '89.216.47.154', '91.77.163.86', '91.144.158.231', '91.205.219.185', '91.92.199.36', '92.27.157.252', '92.27.101.99'], 'pulse_id_evidence': ['68b66f8ca2fe4b0945017266']}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 123, 'involved_asns': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_ip_count': 412, 'involved_ips': ['61.222.211.114', '211.20.14.156', '60.174.72.198', '59.36.75.227', '59.36.254.224', '49.72.212.22', '27.128.171.39', '223.247.33.150', '223.247.218.112', '223.241.247.214', '223.240.116.60', '222.75.225.206', '220.178.8.154', '218.4.156.254', '218.22.187.66', '183.63.103.84', '183.56.231.213', '183.56.216.153', '183.36.126.68', '171.223.215.38', '14.29.240.154', '14.29.214.161', '14.29.129.250', '14.116.200.5', '124.114.149.106', '123.53.58.216', '123.187.241.160', '122.225.203.106', '122.224.164.194', '121.229.191.90', '121.228.31.181', '118.122.93.139', '117.27.93.170', '116.252.76.43', '118.128.237.197', '1.214.197.163', '113.193.234.210', '61.240.156.16', '58.18.81.242', '222.161.242.146', '221.209.48.203', '153.37.177.219', '123.139.116.220', '123.138.101.106', '116.255.159.152', '116.255.156.120', '116.172.130.191', '103.120.227.88', '223.197.248.209', '1.55.33.86', '88.214.25.125', '88.214.25.123', '88.214.25.121', '57.128.182.5', '207.90.244.14', '206.168.34.192', '206.168.34.120', '203.145.34.222', '199.45.155.78', '199.45.154.119', '196.251.88.103', '172.174.5.146', '14.103.122.90', '14.103.122.180', '14.103.118.79', '14.103.118.76', '14.103.112.100', '104.234.115.188', '103.217.145.154', '101.126.11.137', '101.126.30.240', '101.126.88.251', '101.126.89.164', '222.73.56.10', '58.33.97.119', '101.89.113.198', '101.91.192.9', '218.78.51.90', '117.79.132.166', '117.50.67.183', '117.50.55.96', '117.50.165.23', '117.50.119.25', '165.154.129.220', '165.154.105.128', '152.32.253.152', '123.58.213.117', '101.36.108.134', '101.36.118.148', '101.36.231.233', '101.36.231.231', '183.91.11.36', '81.192.46.49', '103.106.194.74', '14.225.206.98', '103.144.87.192', '103.153.190.121', '106.51.92.114', '103.170.4.19', '103.179.56.51', '103.213.238.91', '45.82.78.103', '103.233.206.154', '103.82.240.194', '103.84.119.130', '162.243.168.76', '139.59.188.13', '128.199.183.223', '34.91.0.68', '34.84.82.194', '34.175.118.185', '34.128.77.56', '205.210.31.95', '205.210.31.92', '205.210.31.74', '205.210.31.71', '205.210.31.70', '205.210.31.69', '205.210.31.68', '205.210.31.67', '205.210.31.64', '205.210.31.60', '205.210.31.58', '205.210.31.48', '205.210.31.47', '205.210.31.45', '205.210.31.44', '205.210.31.43', '205.210.31.33', '205.210.31.29', '205.210.31.28', '205.210.31.27', '205.210.31.25', '205.210.31.248', '205.210.31.246', '205.210.31.245', '205.210.31.237', '205.210.31.234', '205.210.31.23', '205.210.31.219', '205.210.31.218', '205.210.31.21', '205.210.31.209', '205.210.31.207', '205.210.31.195', '205.210.31.193', '205.210.31.185', '205.210.31.175', '205.210.31.171', '205.210.31.17', '205.210.31.169', '205.210.31.159', '205.210.31.158', '205.210.31.155', '205.210.31.154', '205.210.31.153', '205.210.31.151', '205.210.31.15', '205.210.31.146', '205.210.31.143', '205.210.31.138', '205.210.31.132', '205.210.31.130', '205.210.31.129', '205.210.31.11', '205.210.31.107', '205.210.31.102', '205.210.31.10', '198.235.24.93', '198.235.24.91', '198.235.24.86', '198.235.24.80', '198.235.24.79', '198.235.24.76', '198.235.24.68', '198.235.24.67', '198.235.24.64', '198.235.24.57', '198.235.24.53', '198.235.24.50', '198.235.24.49', '198.235.24.38', '198.235.24.37', '198.235.24.35', '198.235.24.33', '198.235.24.32', '198.235.24.28', '198.235.24.244', '198.235.24.242', '198.235.24.24', '198.235.24.230', '198.235.24.221', '198.235.24.215', '198.235.24.208', '198.235.24.204', '198.235.24.20', '198.235.24.2', '198.235.24.198', '198.235.24.197', '198.235.24.196', '198.235.24.192', '198.235.24.171', '198.235.24.17', '198.235.24.166', '198.235.24.156', '198.235.24.155', '198.235.24.154', '198.235.24.153', '198.235.24.144', '198.235.24.143', '198.235.24.141', '198.235.24.14', '198.235.24.138', '198.235.24.135', '198.235.24.131', '198.235.24.129', '198.235.24.120', '198.235.24.112', '198.235.24.108', '198.235.24.105', '198.235.24.100', '198.235.24.10', '45.43.33.218', '35.237.94.18', '20.193.141.133', '66.175.213.4', '45.79.181.94', '45.79.181.251', '45.79.181.223', '45.79.181.179', '45.79.181.104', '45.79.172.21', '45.79.128.205', '192.155.90.220', '192.155.90.118', '172.105.128.13', '172.105.128.12', '172.105.128.11', '172.104.11.4', '172.104.11.46', '172.104.11.51', '45.61.187.220', '120.48.20.114', '36.40.79.122', '117.34.125.173', '113.141.171.139', '113.141.166.35', '96.78.175.45', '74.94.234.151', '50.225.176.238', '198.23.143.193', '198.12.114.232', '216.172.190.206', '36.67.70.198', '222.124.14.234', '36.37.181.181', '175.100.24.139', '36.137.99.125', '36.137.249.148', '36.133.64.211', '111.53.87.28', '61.72.55.130', '222.98.122.37', '220.80.223.144', '218.156.176.223', '218.145.181.48', '211.253.9.49', '211.253.10.96', '121.142.87.218', '125.141.193.42', '14.63.160.31', '14.63.217.28', '112.196.70.142', '36.155.114.62', '112.4.79.138', '122.53.133.167', '42.123.115.126', '140.246.137.102', '115.241.83.2', '171.244.37.103', '203.0.104.170', '119.246.15.94', '219.152.170.58', '120.224.15.67', '182.76.204.237', '125.21.59.218', '219.150.93.157', '49.207.2.190', '220.247.223.56', '125.72.128.218', '150.136.129.10', '51.77.245.237', '51.75.194.10', '51.68.224.126', '51.68.137.240', '51.161.153.48', '193.70.87.152', '152.228.131.33', '151.80.61.151', '144.217.13.134', '138.204.127.54', '195.37.190.89', '46.191.141.152', '27.254.235.4', '27.254.235.12', '27.254.149.199', '147.50.227.79', '154.197.56.163', '94.254.0.234', '167.94.138.62', '167.94.138.58', '167.94.138.56', '162.142.125.46', '162.142.125.217', '162.142.125.209', '162.142.125.206', '162.142.125.116', '162.142.125.192', '51.159.54.22', '164.163.98.49', '167.94.146.63', '167.94.146.52', '167.94.146.50', '167.94.146.49', '167.94.145.96', '167.94.145.105', '167.94.145.106', '168.167.228.74', '168.167.228.123', '170.79.37.88', '181.188.159.138', '179.51.153.37', '201.17.133.138', '74.82.47.5', '74.82.47.4', '74.82.47.3', '64.62.197.77', '64.62.197.32', '64.62.197.17', '64.62.197.160', '64.62.197.15', '64.62.197.142', '216.218.206.69', '184.105.139.69', '31.7.70.8', '185.156.73.122', '185.170.144.3', '185.46.18.99', '186.103.169.12', '190.202.130.61', '187.45.100.0', '85.152.57.60', '190.0.63.226', '190.12.102.58', '190.111.211.81', '200.189.192.3', '191.242.105.133', '191.36.154.175', '80.94.95.112', '194.165.16.164', '194.165.16.162', '195.190.104.66', '196.0.120.6', '197.156.97.198', '197.153.57.103', '197.5.145.8', '45.148.10.240', '202.51.214.99', '202.51.214.98', '24.97.253.246', '208.105.196.214', '83.235.21.125', '62.193.106.227', '220.205.122.62', '223.223.177.215', '35.210.61.208', '36.108.172.220', '45.172.153.100', '45.232.73.84', '89.248.165.82', '89.248.165.108', '80.82.70.133', '63.41.9.210', '64.62.156.94', '64.62.156.66', '64.62.156.45', '64.62.156.115', '64.62.156.20', '65.49.1.66', '65.49.1.54', '65.49.1.100', '65.49.1.106', '65.49.1.108', '71.6.232.23', '71.6.146.185', '66.240.236.119', '66.240.236.116', '66.240.192.82', '72.240.125.133', '79.106.73.114', '90.161.217.228', '90.160.139.163', '91.144.21.210', '89.216.47.154', '91.205.128.170', '91.205.219.185', '91.238.181.96', '91.238.181.93', '91.238.181.92', '91.92.199.36', '92.27.157.252', '92.27.101.99'], 'pulse_id_evidence': ['68d1574cb077a1d73565f5cb', '68cb60ea271f7753253103f9', '68cdeecfd6cbc7164e1135a8', '68cf45330e79ce1230afd332', '68c2bdfff4c654c69919aec8', '68c1ae9250a911bd34780587', '68c4543f951e9786f94ab82f', '68c4519c194c025110a3f255', '68c454ce8afad048a245d0a2', '68cca63ee8c385afc43d55c7', '68cca641a1bd8c1834a7dcac', '68c36f148b08a5f4a338325e', '68d2d2137154280047a857e7', '68bce52eaac97ffb0418e417', '68bf7310cbb3f6a5f67c9405', '68ca057af74585bf6fa75648', '68b8c9f02d10afc4cd1893c6', '68c8b0eeb4e7f6c0e7e5a238', '68be1d501af99a07d1d15c38', '68bc6891633d6bd441ad2fe5', '68c0970f9ca22fe328ab0432', '68c05d12e1e9630324e29179', '68c8b0f74599d0524122c005', '68d1809116e88a6ff71216f1', '68c75f3806a26d19379e0932', '68bdba11707ab686ce4793ef', '68c300112244c5fdcae93189', '68bf0b9275ce0a72e4fcce01', '68d5d3bb315fe9caf4ae5235', '68b9c592c117be1be662c623', '68b9c6d825c1d69ec1a0ba39', '68d183164563ed279ee81568', '68d1831773306f5a8fa37289', '68d423f71faee799855ac643', '68b5d1125b3ee0efa00db88f', '68b630f1e3f822aece341766', '68c5b1912d1ebc629ba3a05c', '68bb77829e311aa8cc1d139f', '68b78a140a3ed8cdd984cf50', '68bb1717ad1b7d776ba042cd', '68b8741138186db070284aa1']}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'distinct_asn_count': 123, 'involved_asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_ip_count': 230, 'involved_ips': ['118.195.150.246', '59.36.78.66', '59.36.75.227', '59.36.254.224', '58.49.26.202', '58.222.244.226', '27.185.52.202', '27.128.229.223', '27.128.174.164', '223.247.33.150', '222.172.32.246', '183.36.126.68', '123.187.241.160', '121.228.31.181', '121.227.31.13', '121.227.152.171', '118.122.93.139', '117.27.93.170', '1.197.78.123', '112.216.108.62', '1.214.197.163', '116.120.97.12', '61.240.156.16', '220.250.41.11', '123.139.116.220', '119.188.171.173', '103.120.227.88', '42.200.78.78', '1.55.33.86', '57.128.182.5', '196.251.88.103', '172.174.72.225', '172.174.5.146', '14.103.118.79', '14.103.115.210', '14.103.112.100', '14.103.105.243', '120.48.162.75', '103.67.79.165', '103.31.119.10', '103.217.145.154', '103.191.178.123', '103.189.234.253', '101.126.11.137', '101.126.25.120', '101.126.30.240', '222.73.56.10', '101.226.180.6', '101.91.192.9', '180.167.207.234', '218.78.51.90', '202.85.222.190', '124.207.165.138', '123.59.28.66', '117.50.55.96', '117.50.51.119', '117.50.165.23', '117.50.119.25', '101.36.65.131', '106.37.72.234', '165.154.105.128', '152.32.250.188', '118.194.230.231', '101.36.108.134', '101.36.231.231', '203.205.37.233', '81.192.87.130', '81.192.46.49', '160.174.129.232', '123.30.249.49', '14.225.206.98', '103.115.24.11', '103.119.92.117', '103.144.87.192', '103.153.190.121', '106.51.92.114', '103.179.57.150', '103.171.85.186', '103.203.224.181', '103.246.240.30', '103.248.120.6', '103.25.47.94', '103.48.192.48', '103.63.108.25', '202.157.176.29', '202.157.176.165', '103.84.119.130', '103.84.236.242', '103.84.236.222', '103.86.180.10', '165.22.217.96', '139.59.226.77', '128.199.168.119', '34.66.72.251', '34.175.118.185', '34.128.77.56', '34.123.134.194', '35.237.94.18', '52.183.128.237', '20.127.224.153', '60.199.224.55', '182.61.13.22', '117.34.125.173', '96.78.175.45', '74.94.234.151', '198.23.174.113', '192.210.233.234', '192.210.135.20', '107.173.85.161', '216.172.190.206', '162.240.156.34', '109.167.197.20', '37.110.142.162', '36.91.166.34', '36.67.70.198', '36.66.16.233', '118.122.147.195', '175.100.24.139', '39.129.9.180', '36.133.64.211', '111.53.87.28', '222.107.156.227', '221.159.150.85', '220.80.223.144', '218.156.176.223', '211.253.37.225', '211.253.10.96', '210.114.22.126', '14.63.196.175', '14.63.217.28', '14.63.221.137', '36.155.114.62', '182.43.235.75', '140.246.137.102', '113.125.140.222', '125.76.228.194', '171.104.143.176', '218.255.103.194', '115.241.83.2', '171.244.37.97', '171.244.37.96', '171.244.37.103', '117.6.44.221', '117.2.49.125', '119.96.158.238', '59.98.83.57', '117.247.178.81', '117.219.14.193', '36.134.69.15', '182.76.204.237', '125.21.59.218', '219.150.93.157', '220.247.224.226', '182.93.50.90', '51.75.253.68', '51.68.137.240', '51.195.138.37', '51.178.137.178', '152.228.131.33', '151.80.61.151', '95.58.255.251', '27.254.235.4', '27.254.235.3', '27.254.235.13', '27.254.235.12', '27.254.235.1', '186.96.145.241', '94.63.229.20', '179.33.186.151', '179.32.33.161', '158.51.124.56', '51.158.120.121', '186.10.86.130', '168.167.228.74', '176.196.236.146', '95.167.225.76', '83.171.89.209', '188.18.49.50', '177.12.2.75', '187.16.96.250', '189.112.0.11', '178.251.140.3', '200.73.135.75', '181.174.224.99', '200.118.99.170', '64.62.197.24', '64.62.197.184', '47.180.114.229', '62.28.222.221', '186.31.95.163', '190.202.130.61', '187.110.238.50', '187.45.100.0', '187.49.152.10', '213.6.203.226', '190.12.102.58', '190.153.249.99', '200.69.236.207', '201.186.40.250', '191.242.105.133', '80.94.95.112', '78.186.133.164', '196.0.120.6', '197.5.145.8', '197.5.145.73', '197.5.145.150', '197.5.145.102', '45.148.10.196', '45.148.10.240', '202.131.233.35', '202.51.214.99', '70.54.182.130', '204.76.203.83', '4.17.226.146', '83.235.21.125', '95.85.114.218', '220.205.122.62', '34.101.240.144', '36.103.243.179', '45.120.115.150', '45.172.153.100', '45.175.75.254', '45.232.73.84', '46.25.236.192', '49.65.102.127', '64.62.156.29', '65.49.1.59', '65.49.1.36', '81.30.162.18', '91.205.219.185'], 'pulse_id_evidence': ['68c9162db43f1abf2a0d7a4d', '68d106b203e0418dc62e4487', '68b8eb976696573d91bee14d', '68bfe3327a7ed5ce6d20c08a', '68c1311d72c4fb68bed6a95d', '68ccb8e8fcc9f28a17749fc0', '68c67ab37c92ddfd7b0695ef', '68ca1c1d770c45504db99193', '68cd1232cddff867d10d792e', '68be91b286e17e1290e3cd29', '68ba43be828c0d90145b6032', '68c7cc329a49c0b65042cd6f', '68cbc0b37d26eec9869b3c81', '68bbeeb2ea42ae685b805ef3', '68b7fa322068680adcb19696', '68c134b274c78e6c5fdeefda', '68c2399f46d51447a1381df1', '68b6a8b245c884fb48bdbfba', '68d25834bf49e79e1b21ba5b', '68c3d7b22c18b1a86fc5d5fc', '68bd40318f4795aec341706e', '68d390b6907a2dd3ae1c9b10', '68b55732c35343fbe74749e9', '68ba9d32b732655db022dd63', '68b4ff138243d0c9813a1149', '68c91db211043a1f0289cd39', '68ca6f3bb973160ba5c2a137', '68be33872886ab2541813558', '68c37dfeca644940d15f87c8', '68ce63b2e66f3de2447a44e0', '68d4fb39056c1f04d4d708d5', '68d3a9b227669537cfc610e2', '68b94bb1ca80f64506cee295', '68b7943ddb796636c4e8c0ba', '68c28637811347bc279ed3ad', '68cfb5329635093fe634fd21', '68c5293f79b7cd589be06c1f']}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 67, 'involved_asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_ip_count': 118, 'involved_ips': ['59.36.254.224', '58.49.26.202', '58.222.244.226', '49.75.185.71', '223.240.116.60', '1.197.78.123', '112.216.108.62', '116.153.81.58', '119.188.171.173', '3.143.152.247', '45.91.171.169', '45.147.250.208', '37.111.53.110', '206.168.34.57', '206.168.34.167', '199.45.154.187', '199.45.154.185', '199.45.154.184', '199.45.154.182', '199.45.154.181', '199.45.154.142', '172.174.72.225', '170.64.209.39', '170.64.177.80', '146.88.241.70', '146.88.241.60', '146.88.241.171', '146.88.241.170', '146.88.241.161', '146.88.241.151', '103.206.72.2', '101.126.88.251', '39.99.212.219', '222.73.56.10', '202.85.222.190', '117.50.165.23', '169.197.113.175', '152.32.158.69', '202.112.237.201', '102.223.92.101', '81.192.46.49', '222.253.40.231', '103.239.252.66', '103.115.24.11', '103.153.190.121', '103.179.56.51', '162.216.142.81', '103.248.120.6', '103.84.236.222', '103.86.180.10', '64.227.112.120', '188.166.68.252', '157.245.69.67', '143.110.182.33', '139.59.58.140', '138.197.24.249', '128.199.157.145', '34.128.77.56', '34.123.134.194', '205.210.31.246', '198.235.24.81', '198.235.24.114', '104.156.155.5', '45.79.163.53', '182.61.13.22', '122.176.122.24', '74.94.234.151', '198.23.174.113', '198.23.143.193', '216.172.190.206', '109.205.213.18', '118.122.147.195', '14.63.217.28', '14.63.221.137', '150.223.20.12', '183.134.217.20', '122.129.74.58', '51.68.226.87', '51.195.138.37', '51.178.137.178', '152.228.131.33', '195.37.190.89', '150.107.36.236', '167.94.138.155', '167.94.138.147', '167.94.138.145', '167.94.138.141', '167.94.138.134', '162.142.125.88', '62.210.24.128', '167.94.145.28', '181.2.151.236', '64.62.197.166', '31.7.70.8', '92.63.197.210', '186.149.199.90', '187.111.28.131', '79.3.96.178', '193.163.125.110', '78.186.133.164', '195.88.120.62', '2.57.122.112', '45.148.10.240', '202.125.94.71', '202.131.233.35', '202.51.214.99', '87.126.166.109', '220.205.122.62', '36.103.243.179', '45.175.75.254', '49.65.102.127', '93.174.95.106', '80.82.70.118', '65.49.1.108', '66.240.236.119', '79.124.62.122', '91.144.21.210', '91.238.181.96'], 'pulse_id_evidence': ['68c13129eded5baa71fb89a2', '68ccb8f509965a500807acf9', '68b7948135a76e095700ee1e', '68c27c7dbf0d82aa994bacfa', '68ca1c3c43c415c08d16985a', '68c37e123ec2922c002e71fd', '68b8eba638383bc8eda19b3c', '68ba43cae6726a60b7980c7e', '68b4ff2b31379389de893f0d', '68be3398c9569a076dd34f1f', '68c91656b66ae9520f619142', '68d4a4929fc24d9d226c01ac', '68b66834e69445088089c4ed', '68d390d1581d658a42877880']}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'distinct_asn_count': 67, 'involved_asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_ip_count': 118, 'involved_ips': ['59.36.254.224', '58.49.26.202', '58.222.244.226', '49.75.185.71', '223.240.116.60', '1.197.78.123', '112.216.108.62', '116.153.81.58', '119.188.171.173', '3.143.152.247', '45.91.171.169', '45.147.250.208', '37.111.53.110', '206.168.34.57', '206.168.34.167', '199.45.154.187', '199.45.154.185', '199.45.154.184', '199.45.154.182', '199.45.154.181', '199.45.154.142', '172.174.72.225', '170.64.209.39', '170.64.177.80', '146.88.241.70', '146.88.241.60', '146.88.241.171', '146.88.241.170', '146.88.241.161', '146.88.241.151', '103.206.72.2', '101.126.88.251', '39.99.212.219', '222.73.56.10', '202.85.222.190', '117.50.165.23', '169.197.113.175', '152.32.158.69', '202.112.237.201', '102.223.92.101', '81.192.46.49', '222.253.40.231', '103.239.252.66', '103.115.24.11', '103.153.190.121', '103.179.56.51', '162.216.142.81', '103.248.120.6', '103.84.236.222', '103.86.180.10', '64.227.112.120', '188.166.68.252', '157.245.69.67', '143.110.182.33', '139.59.58.140', '138.197.24.249', '128.199.157.145', '34.128.77.56', '34.123.134.194', '205.210.31.246', '198.235.24.81', '198.235.24.114', '104.156.155.5', '45.79.163.53', '182.61.13.22', '122.176.122.24', '74.94.234.151', '198.23.174.113', '198.23.143.193', '216.172.190.206', '109.205.213.18', '118.122.147.195', '14.63.217.28', '14.63.221.137', '150.223.20.12', '183.134.217.20', '122.129.74.58', '51.68.226.87', '51.195.138.37', '51.178.137.178', '152.228.131.33', '195.37.190.89', '150.107.36.236', '167.94.138.155', '167.94.138.147', '167.94.138.145', '167.94.138.141', '167.94.138.134', '162.142.125.88', '62.210.24.128', '167.94.145.28', '181.2.151.236', '64.62.197.166', '31.7.70.8', '92.63.197.210', '186.149.199.90', '187.111.28.131', '79.3.96.178', '193.163.125.110', '78.186.133.164', '195.88.120.62', '2.57.122.112', '45.148.10.240', '202.125.94.71', '202.131.233.35', '202.51.214.99', '87.126.166.109', '220.205.122.62', '36.103.243.179', '45.175.75.254', '49.65.102.127', '93.174.95.106', '80.82.70.118', '65.49.1.108', '66.240.236.119', '79.124.62.122', '91.144.21.210', '91.238.181.96'], 'pulse_id_evidence': ['68c13129eded5baa71fb89a2', '68ccb8f509965a500807acf9', '68b7948135a76e095700ee1e', '68c27c7dbf0d82aa994bacfa', '68ca1c3c43c415c08d16985a', '68c37e123ec2922c002e71fd', '68b8eba638383bc8eda19b3c', '68ba43cae6726a60b7980c7e', '68b4ff2b31379389de893f0d', '68be3398c9569a076dd34f1f', '68c91656b66ae9520f619142', '68d4a4929fc24d9d226c01ac', '68b66834e69445088089c4ed', '68d390d1581d658a42877880']}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (799 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH count(DISTINCT ip) AS total_ips
MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(dest:Country)
WITH total_ips, dest.name AS destination_country, count(a) AS attacks
ORDER BY attacks DESC
WITH total_ips, collect({country: destination_country, attacks: attacks})[0..5] AS top_destination_countries
MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH total_ips, top_destination_countries, a.technique AS technique, count(a) AS attacks
ORDER BY attacks DESC
WITH total_ips, top_destination_countries, collect({technique: technique, attacks: attacks})[0..3] AS top_techniques
RETURN {
  total_distinct_attacking_ips: total_ips,
  top_destination_countries: top_destination_countries,
  top_techniques: top_techniques
} AS result
[validation] first rows: [{'result': {'top_destination_countries': [{'attacks': 43430, 'country': 'Germany'}, {'attacks': 38573, 'country': 'United States of America'}, {'attacks': 36447, 'country': 'France'}, {'attacks': 36047, 'country': 'Poland'}, {'attacks': 35697, 'country': 'Canada'}], 'top_techniques': [{'technique': 'T1566 Phishing', 'attacks': 533403}, {'technique': 'T1110 Brute Force', 'attacks': 8224}, {'technique': 'T1595 Active Scanning', 'attacks': 7586}], 'total_distinct_attacking_ips': 1922}}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH count(DISTINCT ip) AS distinct_source_ips, count(a) AS total_attacks, collect(a) AS attacks
UNWIND attacks AS a2
WITH distinct_source_ips, total_attacks, a2
WHERE a2.industry IS NOT NULL AND trim(a2.industry) <> ''
WITH distinct_source_ips, total_attacks, a2.industry AS industry, count(*) AS freq
ORDER BY freq DESC, industry
WITH distinct_source_ips, total_attacks, collect({industry: industry, attacks: freq})[0..5] AS top_industries
RETURN distinct_source_ips, total_attacks, top_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(country:Country)
WITH asn.number AS asn_number, count(DISTINCT country) AS distinct_attacked_country_count
WITH max(distinct_attacked_country_count) AS max_country_count, collect({asn_number: asn_number, cnt: distinct_attacked_country_count}) AS rows
UNWIND rows AS row
WITH row, max_country_count
WHERE row.cnt = max_country_count
RETURN row.asn_number AS asn_number, row.cnt AS distinct_attacked_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'distinct_attacked_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (542 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(tgt:Country)
WHERE a.protocol = 'ssh'
WITH tgt, count(*) AS attack_count
RETURN tgt.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (347 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (2077 chars)

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (c:Country {name: 'France'})
MATCH (ip:IP)-[a:ATTACKS]->(c)
WHERE a.protocol <> 'unknown'
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH asn, a.protocol AS protocol, count(*) AS cnt
ORDER BY asn.number, cnt DESC, protocol
WITH asn, collect({protocol: protocol, count: cnt}) AS protos
WITH asn, protos[..3] AS top3
UNWIND range(0, size(top3)-1) AS idx
WITH asn, idx+1 AS rank, top3[idx] AS item
RETURN asn.number AS asn, rank, item.protocol AS protocol, item.count AS count
ORDER BY asn, rank, protocol
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'rank': 1, 'protocol': 'ssh', 'count': 1}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'rank': 1, 'protocol': 'ssh', 'count': 2}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'rank': 1, 'protocol': 'ssh', 'count': 4}, {'asn': 'AS10439 carinet  inc.', 'rank': 1, 'protocol': 'snmp', 'count': 4}, {'asn': 'AS10439 carinet  inc.', 'rank': 2, 'protocol': 'sip', 'count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> ''
WITH ip.botnet AS malware_family, count(*) AS attack_count
ORDER BY attack_count DESC
LIMIT 5
RETURN malware_family, attack_count
[validation] first rows: [{'malware_family': 'unknown', 'attack_count': 3025957}, {'malware_family': 'botnet', 'attack_count': 73462}, {'malware_family': 'mirai', 'attack_count': 36090}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.port IS NOT NULL AND r.protocol IS NOT NULL AND r.protocol <> 'unknown'
WITH r.port AS port, r.protocol AS protocol, count(*) AS times_targeted
RETURN port, protocol, times_targeted
ORDER BY times_targeted DESC
LIMIT coalesce($topN, 10)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.protocol <> 'unknown'
  AND r.destination_port IS NOT NULL
WITH r.destination_port AS port, r.protocol AS protocol, count(*) AS targeted_count
RETURN port, protocol, targeted_count
ORDER BY targeted_count DESC
LIMIT $topN
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
WHERE r.port IS NOT NULL
WITH
  r.port AS port,
  (CASE WHEN coalesce($splitByProtocol, false) THEN r.protocol ELSE null END) AS protocol,
  count(*) AS targeted_count
WHERE protocol IS NULL OR protocol <> 'unknown'
RETURN port, protocol, targeted_count
ORDER BY targeted_count DESC, port ASC
LIMIT coalesce($topN, 10)

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'Australia'})
WHERE trim(r.technique) = 'Phishing'
RETURN count(r) AS attack_count
[validation] first rows: [{'attack_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(a:ASN)
WITH c.name AS country, r.technique AS technique, date.truncate('month', r.documented_create_date) AS year_month, collect(DISTINCT a.number) AS asns
WHERE size(asns) >= 2
UNWIND range(0, size(asns) - 2) AS i
UNWIND range(i + 1, size(asns) - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, country, technique, year_month
WITH asn1, asn2, count(*) AS shared_groupings
ORDER BY shared_groupings DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, shared_groupings
[validation] first rows: [{'asn1': 'AS57523 chang way technologies co. limited', 'asn2': 'AS29789 reflected networks  inc.', 'shared_groupings': 2800}, {'asn1': 'AS57523 chang way technologies co. limited', 'asn2': 'AS53334 total uptime technologies  llc', 'shared_groupings': 2619}, {'asn1': 'AS53334 total uptime technologies  llc', 'asn2': 'AS29789 reflected networks  inc.', 'shared_groupings': 2580}, {'asn1': 'AS13335 cloudflare', 'asn2': 'AS53334 total uptime technologies  llc', 'shared_groupings': 1035}, {'asn1': 'AS54113 fastly', 'asn2': 'AS53334 total uptime technologies  llc', 'shared_groupings': 1012}]

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: ```json
[
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 9},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 16},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.minute", "value": 0},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.second", "value": 0}
]
```
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "'Germany'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "'unknown'"},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 9},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.hour", "value": 16},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.minute", "value": 0},
  {"kind": "relationship", "label": "ATTACKS", "property": "documented_create_date.second", "value": 0}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 9}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 16}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': "'Germany'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': "'unknown'"}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 9}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'documented_create_date.hour', 'value': 16}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.documented_create_date.hour IS NOT NULL RETURN DISTINCT r.documented_create_date.hour AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] best match for ''Germany'' -> 'Germany' (LCS length 7)
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] best match for ''unknown'' -> 'unknown' (LCS length 7)
[matcher] first rows: [13, 11, 17, 5, 20]
[matcher] first rows: [13, 11, 17, 5, 20]
    Agent raised an exception: 'int' object has no attribute 'lower'

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (460 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (256 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (256 chars)

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4395.39 seconds
Total tokens: 60,046

Status Breakdown:
  ðŸ”´ ERROR                    :  12 ( 60.0%)
  âœ… SUCCESS                  :   6 ( 30.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   2 ( 10.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   1
  ðŸ”´ OTHER                         :  11

Success Rate: 30.0%

Results saved to: gpt-5.2_results_950k/run_21.json
================================================================================

[Thu Feb 12 11:32:59 UTC 2026] Worker 2: Run #21 completed
[Thu Feb 12 11:32:59 UTC 2026] Worker 2: Tokens in this run: 60046
[Thu Feb 12 11:32:59 UTC 2026] Worker 2: Total tokens: 1143847
[Thu Feb 12 11:32:59 UTC 2026] Worker 2: Progress: 95%
[Thu Feb 12 11:33:01 UTC 2026] Worker 2: Starting Run #22
[Thu Feb 12 11:33:01 UTC 2026] Worker 2: Tokens used so far: 1143847

(run 1/1) [1/20] simple :: What is the attack technique most used overall?
  Attempt 1/1 for query [1/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (313 chars)

(run 1/1) [2/20] matcher-needed :: From all the IPs that have attacked using phishing, which other techniques do they use for other attacks and how often (in percentage)?
  Attempt 1/1 for query [2/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (313 chars)

(run 1/1) [3/20] complex :: Detect attack rings: different ASNs that attacked the same country, with the same protocol, technique, and industry within the same calendar month.
  Attempt 1/1 for query [3/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(target:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE a.documented_create_date IS NOT NULL
  AND a.protocol IS NOT NULL AND a.protocol <> 'unknown'
  AND a.technique IS NOT NULL AND a.technique <> 'unknown'
WITH
  date.truncate('month', a.documented_create_date) AS year_month,
  target.name AS target_country,
  a.protocol AS protocol,
  a.technique AS technique,
  a.industry AS industry,
  collect(DISTINCT asn.number) AS asns,
  count(DISTINCT a) AS attack_count,
  count(DISTINCT ip) AS distinct_ip_count
WHERE size(asns) >= 2
RETURN
  year_month,
  target_country,
  protocol,
  technique,
  industry,
  asns,
  size(asns) AS distinct_asn_count,
  attack_count,
  distinct_ip_count
ORDER BY year_month DESC, attack_count DESC, distinct_asn_count DESC, target_country ASC, protocol ASC, technique ASC, industry ASC
[validation] first rows: [{'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Malaysia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS4816 china telecom (group)', 'AS136052 pt cloud hosting indonesia', 'AS135310 inspire broadband', 'AS55933 cloudie limited', 'AS133524 global technology co ltd', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS21859 zenlayer inc', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS63949 linode  llc', 'AS53667 frantech solutions', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS58519 cloud computing corporation', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9269 hong kong broadband network', 'AS134420 chongqing telecom', 'AS24444 shandong mobile communication company limited', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS31898 oracle corporation', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS135357 shenzhen katherine heng technology information co.  ltd.', 'AS8473 bahnhof', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS265949 info telecom internet ltda', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS27882 telefnica celular de bolivia s.a.', 'AS271186 eunapolis telecom ltda', 'AS28573 claro s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS48080 dmitriy panchenko', 'AS199782 teletime ltd', 'AS15311 telefonica empresas', 'AS8048 cantv servicios  venezuela', 'AS28146 mhnet telecom', 'AS12946 r cable y telecable telecomunicaciones  s.a.u.', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS3549 level 3 parent  llc', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS263333 vipturbo comrcio & servios de informtica ltda', 'AS35478 bunea telecom srl', 'AS48721 flyservers s.a.', 'AS3216 pjsc vimpelcom', 'AS21491 uganda telecom', 'AS24757 ethionet', 'AS36925 african network information center', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS10220 pt. kreasi sejahtera teknologi', 'AS11351 charter communications inc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS15475 nile online', 'AS140726 unicom anhui province network', 'AS45064 beijing zhongguancun software park development co. ltd.', 'AS19527 google llc', 'AS137695 chinatelecom xinjiang wulumuqi man network', 'AS27847 tecnologa digital', 'AS267251 telefonarnet telecomunicacoes', 'AS202425 ip volume inc', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS13490 buckeye cablevision  inc.', 'AS42313 albtelecom sh.a.', 'AS12479 orange espagne sa', 'AS29256 syrian telecom', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS47895 ltd erline', 'AS48004 pe tsibrankov konstantin igorevich', 'AS29551 aixit gmbh', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 123, 'attack_count': 723, 'distinct_ip_count': 412}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Indonesia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'Technology', 'asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4847 china networks inter-exchange', 'AS3462 data communication business group', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS45528 tikona infinet ltd.', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS132203 tencent building  kejizhongyi avenue', 'AS135377 ucloud information technology (hk) limited', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS134319 elyzium technologies pvt. ltd.', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS138133 universitas muslim indonesia', 'AS139473 shebatel network ltd', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS138608 cloud host pte ltd', 'AS18229 ctrls datacenters', 'AS135310 inspire broadband', 'AS133524 global technology co ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS45773 hec pern', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS7018 att services inc', 'AS14061 digitalocean  llc', 'AS14987 rethem hosting llc', 'AS396982 google', 'AS22552 esited solutions', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS53667 frantech solutions', 'AS36947 african network information center', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS2516 kddi corporation', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS45458 sbn-isp/awn-isp and sbn-nix/awn-nix', 'AS9808 china mobile communications group co.  ltd.', 'AS4766 korea telecom', 'AS17917 quadrant televentures limited', 'AS56046 china mobile communications corporation', 'AS9299 philippine long distance telephone company', 'AS17451 biznet networks', 'AS58519 cloud computing corporation', 'AS4515 hkt limited', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS38731 vietel - cht company', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS137697 chinatelecom jiangsu yangzhou idc networkdescr', 'AS63199 capitalonline data service co. ltd', 'AS9269 hong kong broadband network', 'AS56044 china mobile communications corporation', 'AS59019 beijing kingsoft cloud internet technology co ltd', 'AS136958 china unicom guangdong ip network', 'AS9498 bharti airtel ltd.', 'AS55577 atria convergence technologies pvt ltd', 'AS9329 sri lanka telecom internet', 'AS140061 qinghai telecom', 'AS30823 combahton gmbh', 'AS54614 cik telecom inc', 'AS16276 ovh sas', 'AS264411 costa do sol tv a cabo', 'AS58593 shanghai blue cloud technology co. ltd', 'AS9198 jsc kazakhtelecom', 'AS24955 ojsc ufanet', 'AS4750 cs loxinfo public company limited', 'AS9891 cs loxinfo public company limited.', 'AS22884 total play telecomunicaciones sa de cv', 'AS57858 inter connects inc', 'AS30855 tele-plus llc', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS8473 bahnhof', 'AS399804 hostodo', 'AS29791 internap holding llc', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS14988 african network information center', 'AS6147 telefonica del peru s.a.a.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS27882 telefnica celular de bolivia s.a.', 'AS197140 jsc er-telecom holding', 'AS271186 eunapolis telecom ltda', 'AS7303 telecom argentina s.a.', 'AS28573 claro s.a.', 'AS23201 telecel s.a.', 'AS14080 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15311 telefonica empresas', 'AS19429 etb - colombia', 'AS262958 carraro  hainosz & cia ltda - me', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS270515 enter telecom', 'AS3269 telecom italia s.p.a.', 'AS12975 palestine telecommunications company (paltel)', 'AS270344 ga telecom', 'AS13489 epm telecomunicaciones s.a. e.s.p.', 'AS11014 cps', 'AS16814 nss s.a.', 'AS3549 level 3 parent  llc', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS31242 3s s.a.', 'AS35478 bunea telecom srl', 'AS60490 mts pjsc', 'AS3216 pjsc vimpelcom', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS24863 linkdotnet ', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS400328 intelligence hosting llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS29582 optisprint ood', 'AS15475 nile online', 'AS24532 inet global indo', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS132787 helios it infrasolutions pvt', 'AS63996 mazeda networks limited', 'AS55720 gigabit hosting sdn bhd', 'AS213030 skylink data center bv', 'AS268622 oliveira telecom', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS142608 china telecom', 'AS22394 verizon', 'AS13650 axia fibrenet ltd.', 'AS47331 ttnet a.s.', 'AS42313 albtelecom sh.a.', 'AS24945 telecommunication company vinteleport', 'AS12322 free sas', 'AS31042 serbia broadband-srpske kablovske mreze d.o.o.', 'AS8359 mts pjsc', 'AS42116 jsc er-telecom holding', 'AS48004 pe tsibrankov konstantin igorevich', 'AS34224 neterra ltd.', 'AS13285 talktalk communications'], 'distinct_asn_count': 174, 'attack_count': 373, 'distinct_ip_count': 373}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1110 Brute Force', 'industry': 'unknown', 'asns': ['AS45090 shenzhen tencent computer systems company limited', 'AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS9318 sk broadband co ltd', 'AS4837 china unicom china169 backbone', 'AS4760 hkt limited', 'AS18403 fpt telecom company', 'ASNone ', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS23724 idc china telecommunications corporation', 'AS135377 ucloud information technology (hk) limited', 'AS133119 china unicom ip network', 'AS45903 cmc telecom infrastructure company', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS135905 vietnam posts and telecommunications group', 'AS137823 cloudone', 'AS137982 bow llc', 'AS135932 viet storage technology joint stock company', 'AS140469 pt wahyu adidaya network', 'AS24309 atria convergence technologies', 'AS136052 pt cloud hosting indonesia', 'AS134337 r2 net solutions pvt ltd', 'AS132137 shree omkar infocom pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS58898 rainbow communications india pvt ltd', 'AS131423 branch of long van system solution jsc - hanoi', 'AS38732 cmc telecom infrastructure company', 'AS136170 pt. exabytes network indonesia', 'AS64316 universitas islam negeri raden fatah palembang', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS15169 google llc', 'AS8075 microsoft corporation', 'AS9924 taiwan fixed network telco and network service provider', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS134768 chinanet shaanxi province cloud base network', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS25408 jsc er-telecom holding', 'AS42610 pjsc rostelecom', 'AS7713 pt telekomunikasi indonesia', 'AS38283 chinanet sichuan telecom internet data center', 'AS38623 viettel', 'AS9808 china mobile communications group co.  ltd.', 'AS56042 china mobile communications corporation', 'AS4766 korea telecom', 'AS56046 china mobile communications corporation', 'AS58519 cloud computing corporation', 'AS4835 china telecom (group)', 'AS137693 chinatelecom guangxi nanning idc networkdescr', 'AS9381 hkbn enterprise solutions hk limited', 'AS55836 reliance jio infocomm limited', 'AS7552 viettel group', 'AS58563 chinanet hubei province network', 'AS9829 national internet backbone', 'AS56044 china mobile communications corporation', 'AS9498 bharti airtel ltd.', 'AS17638 china telecom', 'AS9329 sri lanka telecom internet', 'AS4609 companhia de telecomunicacoes de macau sarl', 'AS16276 ovh sas', 'AS9198 jsc kazakhtelecom', 'AS4750 cs loxinfo public company limited', 'AS22884 total play telecomunicaciones sa de cv', 'AS12353 vodafone portugal - communicacoes pessoais s.a.', 'AS3816 colombia telecomunicaciones s.a. esp', 'AS399804 hostodo', 'AS12876 online s.a.s.', 'AS27651 entel chile s.a.', 'AS14988 african network information center', 'AS39927 e-light-telecom ltd.', 'AS12389 pjsc rostelecom', 'AS28665 predlink rede de telecomunices ltda', 'AS17222 mundivox do brasil ltda', 'AS16735 algar telecom s/a', 'AS197140 jsc er-telecom holding', 'AS7303 telecom argentina s.a.', 'AS272059 charackwaves cusypata export/import s.a.c.', 'AS10620 telmex colombia s.a.', 'AS6939 hurricane electric llc', 'AS5650 frontier communications of america  inc.', 'AS15525 meo servicos de comunicacoes e multimedia sa', 'AS19429 etb - colombia', 'AS8048 cantv servicios  venezuela', 'AS28598 mob servicos de telecomunicacoes s.a.', 'AS28146 mhnet telecom', 'AS270515 enter telecom', 'AS12975 palestine telecommunications company (paltel)', 'AS11014 cps', 'AS14259 gtd internet s.a.', 'AS16814 nss s.a.', 'AS14117 telefonica del sur s.a.', 'AS263476 vigweb comercio instalaes e manutenes ltda', 'AS35478 bunea telecom srl', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS21491 uganda telecom', 'AS327934 african network information center', 'AS48090 pptechnology limited', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS577 bell canada', 'AS400328 intelligence hosting llc', 'AS3356 level 3 parent  llc', 'AS6799 ote sa (hellenic telecommunications organisation)', 'AS20661 turkmentelecom isp network', 'AS140726 unicom anhui province network', 'AS139190 google asia pacific pte. ltd.', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS63996 mazeda networks limited', 'AS27847 tecnologa digital', 'AS268888 acrf servicos de informatica ltda - me', 'AS267251 telefonarnet telecomunicacoes', 'AS12430 vodafone espana s.a.u.', 'AS134756 chinanet nanjing jishan idc network', 'AS13650 axia fibrenet ltd.', 'AS36791 portland internet hosting llc', 'AS24945 telecommunication company vinteleport', 'AS48004 pe tsibrankov konstantin igorevich'], 'distinct_asn_count': 123, 'attack_count': 309, 'distinct_ip_count': 230}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'sip', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}, {'year_month': neo4j.time.Date(2025, 9, 1), 'target_country': 'Australia', 'protocol': 'ssh', 'technique': 'T1595 Active Scanning', 'industry': 'unknown', 'asns': ['AS4134 chinanet', 'AS3786 lg dacom corporation', 'AS4837 china unicom china169 backbone', 'AS16509 amazon.com inc', 'ASNone ', 'AS37963 hangzhou alibaba advertising co. ltd.', 'AS4812 china telecom (group)', 'AS4808 china unicom beijing province network', 'AS135377 ucloud information technology (hk) limited', 'AS4538 china education and research network center', 'AS328647 african network information center', 'AS6713 itissalat al-maghrib', 'AS45899 vnpt corp', 'AS63526 systems solutions & development technologies limited', 'AS137823 cloudone', 'AS140469 pt wahyu adidaya network', 'AS136052 pt cloud hosting indonesia', 'AS135247 k net solutions pvt ltd', 'AS58906 shivansh infotech pvt ltd', 'AS134945 blue sky broadband pvt. ltd.', 'AS136284 paradise telecom pvt ltd', 'AS14061 digitalocean  llc', 'AS396982 google', 'AS400161 academy of internet research limited liability company', 'AS63949 linode  llc', 'AS38365 beijing baidu netcom science and technology co.  ltd.', 'AS24560 bharti airtel ltd.', 'AS7922 comcast', 'AS36352 colocrossing', 'AS46606 unified layer', 'AS208046 maximilian kutzner', 'AS38283 chinanet sichuan telecom internet data center', 'AS4766 korea telecom', 'AS58519 cloud computing corporation', 'AS58461 ct-hangzhou-idc', 'AS17911 brain telecommunication', 'AS16276 ovh sas', 'AS680 verein zur foerderung eines deutschen forschungsnetzes e.v.', 'AS137426 simm it services', 'AS398324 censys  inc.', 'AS12876 online s.a.s.', 'AS398705 censys  inc.', 'AS7303 telecom argentina s.a.', 'AS6939 hurricane electric llc', 'AS43754 asiatech data transmission company', 'AS44446 qwalarty corporation', 'AS12066 altice dominicana s.a.', 'AS53120 mundivox telecomunicaes ltda', 'AS3269 telecom italia s.p.a.', 'AS211298 constantine cybersecurity ltd.', 'AS9121 turk telekomunikasyon anonim sirketi', 'AS48969 parus-telecom', 'AS48090 pptechnology limited', 'AS46042 gunadarma university', 'AS9484 mobinet', 'AS10220 pt. kreasi sejahtera teknologi', 'AS8866 bulgarian telecommunications company plc.', 'AS140726 unicom anhui province network', 'AS134761 chinanet ningxia province zhongwei idc network', 'AS268888 acrf servicos de informatica ltda - me', 'AS134756 chinanet nanjing jishan idc network', 'AS202425 ip volume inc', 'AS36791 portland internet hosting llc', 'AS10439 carinet  inc.', 'AS207812 dm auto eood', 'AS29256 syrian telecom', 'AS29551 aixit gmbh'], 'distinct_asn_count': 67, 'attack_count': 118, 'distinct_ip_count': 118}]    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (851 chars)

(run 1/1) [4/20] decomposable :: Report from all IPs attacking from China: total number of distinct attacking IPs, top 5 countries attacked by number of attacks, and top 3 most common attack technique overall.
  Attempt 1/1 for query [4/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[:ATTACKS]->(:Country)
WITH count(DISTINCT ip) AS attacker_ip_count
MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(dst:Country)
WITH attacker_ip_count, dst.name AS country, count(*) AS attack_count
ORDER BY attack_count DESC
WITH attacker_ip_count, collect({country: country, attack_count: attack_count})[0..5] AS top_attacked_countries
MATCH (ip:IP)-[:FROM]->(:Country {name: 'China'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WHERE a.technique IS NOT NULL AND a.technique <> 'unknown'
WITH attacker_ip_count, top_attacked_countries, a.technique AS technique, count(*) AS technique_count
ORDER BY technique_count DESC
WITH attacker_ip_count, top_attacked_countries, collect({technique: technique, attack_count: technique_count})[0..3] AS top_attack_techniques
RETURN attacker_ip_count, top_attacked_countries, top_attack_techniques
[validation] first rows: [{'attacker_ip_count': 1922, 'top_attacked_countries': [{'attack_count': 43430, 'country': 'Germany'}, {'attack_count': 38573, 'country': 'United States of America'}, {'attack_count': 36447, 'country': 'France'}, {'attack_count': 36047, 'country': 'Poland'}, {'attack_count': 35697, 'country': 'Canada'}], 'top_attack_techniques': [{'technique': 'T1566 Phishing', 'attack_count': 533403}, {'technique': 'T1110 Brute Force', 'attack_count': 8224}, {'technique': 'T1595 Active Scanning', 'attack_count': 7586}]}]

(run 1/1) [5/20] multi-subquery :: For IPs from Russia: count distinct IPs, count total attacks, and list top 5 industries targeted.
  Attempt 1/1 for query [5/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip)-[a:ATTACKS]->(:Country)
WITH count(DISTINCT ip) AS distinct_ips, count(a) AS total_attacks
MATCH (ip2:IP)-[:FROM]->(:Country {name: 'Russia'})
MATCH (ip2)-[a2:ATTACKS]->(:Country)
WITH distinct_ips, total_attacks, a2.industry AS industry, count(a2) AS industry_attack_count
ORDER BY industry_attack_count DESC
WITH distinct_ips, total_attacks, collect({industry: industry, attack_count: industry_attack_count})[0..5] AS top_5_industries
RETURN distinct_ips, total_attacks, top_5_industries
[validation] first rows: []

(run 1/1) [6/20] aggregation :: Which ASN has attacked the most distinct countries?
  Attempt 1/1 for query [6/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[:BELONGS_TO]->(asn:ASN)
MATCH (ip)-[:ATTACKS]->(c:Country)
WITH asn, count(DISTINCT c) AS attacked_country_count
WITH max(attacked_country_count) AS max_count
MATCH (ip2:IP)-[:BELONGS_TO]->(asn2:ASN)
MATCH (ip2)-[:ATTACKS]->(c2:Country)
WITH asn2, count(DISTINCT c2) AS attacked_country_count, max_count
WHERE attacked_country_count = max_count
RETURN asn2.number AS asn_number, attacked_country_count
ORDER BY asn_number
[validation] first rows: [{'asn_number': 'AS57523 chang way technologies co. limited', 'attacked_country_count': 64}]

(run 1/1) [7/20] graph-structure :: Find IPs that attacked more than 10 distinct countries.
  Attempt 1/1 for query [7/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (487 chars)

(run 1/1) [8/20] matcher-needed :: Top 5 target countries attacked by IPs from United States using protocol ssh.
  Attempt 1/1 for query [8/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[matcher] LLM response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] cleaned response: [
  {"kind": "node", "label": "Country", "property": "name", "value": "United States"},
  {"kind": "relationship", "label": "ATTACKS", "property": "protocol", "value": "ssh"}
]
[matcher] extracted pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] pairs after extraction: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'value': 'ssh'}]
[matcher] running query: MATCH (n:`Country`) WHERE n.name IS NOT NULL RETURN DISTINCT n.name AS val
[matcher] running query: MATCH ()-[r:`ATTACKS`]-() WHERE r.protocol IS NOT NULL RETURN DISTINCT r.protocol AS val
[matcher] first rows: ['Thailand', 'United States of America', 'Turkey', 'Ukraine', 'Romania']
[matcher] exact match for United States -> United States
[matcher] first rows: ['unknown', 'telnet', 'ssh', 'sip', 'smtp']
[matcher] exact match for ssh -> ssh
[matcher] resolved pairs: [{'kind': 'node', 'label': 'Country', 'property': 'name', 'original': 'United States', 'value': 'United States'}, {'kind': 'relationship', 'label': 'ATTACKS', 'property': 'protocol', 'original': 'ssh', 'value': 'ssh'}]
[validation] executing: MATCH (ip:IP)-[:FROM]->(src:Country {name: 'United States'})
MATCH (ip)-[a:ATTACKS]->(tgt:Country)
WHERE a.protocol = 'ssh'
WITH tgt, count(*) AS attack_count
RETURN tgt.name AS target_country, attack_count
ORDER BY attack_count DESC
LIMIT 5
[validation] first rows: []

(run 1/1) [9/20] temporal :: Monthly attack counts per technique (grouped by YYYY-MM).
  Attempt 1/1 for query [9/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (241 chars)

(run 1/1) [10/20] discovery :: List distinct technologies observed in attacks against the Finance industry, with counts.
  Attempt 1/1 for query [10/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (680 chars)

(run 1/1) [11/20] multi-hop :: For each ASN, top 3 protocols it used when attacking France.
  Attempt 1/1 for query [11/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(c:Country {name: 'France'})
MATCH (ip)-[:BELONGS_TO]->(a:ASN)
WHERE r.protocol <> 'unknown'
WITH a.number AS asn, r.protocol AS protocol, count(*) AS attack_count
ORDER BY asn, attack_count DESC, protocol
WITH asn, collect({protocol: protocol, attack_count: attack_count}) AS protos
UNWIND range(0, 2) AS idx
WITH asn, protos, idx
WHERE idx < size(protos)
RETURN asn, protos[idx].protocol AS protocol, protos[idx].attack_count AS attack_count
ORDER BY asn, attack_count DESC, protocol
[validation] first rows: [{'asn': 'AS10103 hk broadband network ltd.', 'protocol': 'ssh', 'attack_count': 1}, {'asn': 'AS10220 pt. kreasi sejahtera teknologi', 'protocol': 'ssh', 'attack_count': 2}, {'asn': 'AS10299 empresas municipales de cali e.i.c.e. e.s.p.', 'protocol': 'ssh', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'snmp', 'attack_count': 4}, {'asn': 'AS10439 carinet  inc.', 'protocol': 'sip', 'attack_count': 1}]

(run 1/1) [12/20] impossible :: List the top 5 malware families used in attacks.
  Attempt 1/1 for query [12/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
WHERE ip.botnet IS NOT NULL AND ip.botnet <> 'unknown'
WITH ip.botnet AS malware_family, count(DISTINCT a.pulse_id) AS attack_count
RETURN malware_family, attack_count
ORDER BY attack_count DESC, malware_family ASC
LIMIT 5
[validation] first rows: [{'malware_family': 'botnet', 'attack_count': 211}, {'malware_family': 'mirai', 'attack_count': 91}]

(run 1/1) [13/20] impossible :: What destination ports are most targeted?
  Attempt 1/1 for query [13/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(dst:Country)
WHERE r.port IS NOT NULL
  AND ($start IS NULL OR r.documented_create_date >= datetime($start))
  AND ($end IS NULL OR r.documented_create_date < datetime($end))
  AND r.protocol <> 'unknown'
  AND ($protocol IS NULL OR r.protocol = $protocol)
  AND ($industry IS NULL OR r.industry = $industry)
  AND ($technique IS NULL OR r.technique = $technique)
  AND ($pulse_id IS NULL OR r.pulse_id = $pulse_id)
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($source_country IS NULL OR (ip)-[:FROM]->(:Country {name: $source_country}))
  AND ($asn IS NULL OR (ip)-[:BELONGS_TO]->(:ASN {number: $asn}))
WITH r.port AS port, count(*) AS attack_count
RETURN port, attack_count
ORDER BY attack_count DESC, port ASC
LIMIT coalesce($limit, 10)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(dst:Country)
MATCH (ip)-[:FROM]->(src:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE ($start IS NULL OR a.documented_create_date >= datetime($start))
  AND ($end IS NULL OR a.documented_create_date < datetime($end))
  AND ($protocol IS NULL OR (a.protocol = $protocol AND a.protocol <> 'unknown'))
  AND ($technology IS NULL OR (a.technology = $technology AND a.technology <> 'unknown'))
  AND ($industry IS NULL OR a.industry = $industry)
  AND ($technique IS NULL OR a.technique = $technique)
  AND ($pulse_id IS NULL OR a.pulse_id = $pulse_id)
  AND ($source_country IS NULL OR src.name = $source_country)
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($asn_number IS NULL OR asn.number = $asn_number)
  AND a.destination_port IS NOT NULL
WITH a.destination_port AS destination_port, count(*) AS attack_count
RETURN destination_port, attack_count
ORDER BY attack_count DESC
LIMIT coalesce($limit, 10)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(dst:Country)
OPTIONAL MATCH (ip)-[:FROM]->(src:Country)
OPTIONAL MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WHERE ($start IS NULL OR r.documented_create_date >= datetime($start))
  AND ($end IS NULL OR r.documented_create_date < datetime($end))
  AND ($protocol IS NULL OR r.protocol = $protocol)
  AND ($industry IS NULL OR r.industry = $industry)
  AND ($technique IS NULL OR r.technique = $technique)
  AND ($pulse_id IS NULL OR r.pulse_id = $pulse_id)
  AND ($source_country IS NULL OR src.name = $source_country)
  AND ($botnet IS NULL OR ip.botnet = $botnet)
  AND ($asn IS NULL OR asn.number = $asn)
  AND r.technology <> 'unknown'
WITH r.technology AS destination_port, count(*) AS attack_count
ORDER BY attack_count DESC, destination_port
LIMIT coalesce($limit, 10)
RETURN destination_port, attack_count

(run 1/1) [14/20] matcher-needed :: How many attacks used technique ' Phishing' against Australia?
  Attempt 1/1 for query [14/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[r:ATTACKS {technique: 'Phishing'}]->(c:Country {name: 'Australia'})
RETURN count(r) AS attacks_count
[validation] first rows: [{'attacks_count': 0}]

(run 1/1) [15/20] complex :: Identify pairs of ASNs that both attacked the same country using the same technique within the same month; return top 10 pairs by co-attack count.
  Attempt 1/1 for query [15/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH c.name AS country, a.technique AS technique, date.truncate('month', a.documented_create_date) AS year_month, collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
WITH country, technique, year_month, asns, range(0, size(asns) - 2) AS iRange
UNWIND iRange AS i
WITH country, technique, year_month, asns, i, range(i + 1, size(asns) - 1) AS jRange
UNWIND jRange AS j
WITH
  CASE WHEN asns[i] < asns[j] THEN asns[i] ELSE asns[j] END AS asn1,
  CASE WHEN asns[i] < asns[j] THEN asns[j] ELSE asns[i] END AS asn2,
  country, technique, year_month
WITH asn1, asn2, count(DISTINCT {country: country, technique: technique, year_month: year_month}) AS bucket_count
RETURN asn1, asn2, bucket_count
ORDER BY bucket_count DESC, asn1 ASC, asn2 ASC
LIMIT 10
[validation] executing: MATCH (ip:IP)-[r:ATTACKS]->(country:Country)
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  country.name AS target_country,
  r.technique AS technique,
  date.truncate('month', r.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WHERE size(asns) > 1
WITH [target_country, technique, year_month] AS bucket, asns, range(0, size(asns) - 2) AS iRange
UNWIND iRange AS i
WITH bucket, asns, i, range(i + 1, size(asns) - 1) AS jRange
UNWIND jRange AS j
WITH bucket, asns[i] AS asn1, asns[j] AS asn2
WITH asn1, asn2, count(DISTINCT bucket) AS cooccurrence_buckets
ORDER BY cooccurrence_buckets DESC, asn1 ASC, asn2 ASC
LIMIT 10
RETURN asn1, asn2, cooccurrence_buckets
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(country:Country)
WHERE a.documented_create_date IS NOT NULL
MATCH (ip)-[:BELONGS_TO]->(asn:ASN)
WITH
  country.name AS country,
  a.technique AS technique,
  date.truncate('month', a.documented_create_date) AS year_month,
  collect(DISTINCT asn.number) AS asns
WITH country, technique, year_month, asns, size(asns) AS n
WHERE n >= 2
UNWIND range(0, n - 2) AS i
UNWIND range(i + 1, n - 1) AS j
WITH asns[i] AS asn1, asns[j] AS asn2, country, technique, year_month
WITH
  CASE WHEN asn1 < asn2 THEN asn1 ELSE asn2 END AS asn_low,
  CASE WHEN asn1 < asn2 THEN asn2 ELSE asn1 END AS asn_high,
  country,
  technique,
  year_month
WITH
  asn_low,
  asn_high,
  count(DISTINCT country + '|' + technique + '|' + toString(year_month)) AS cooccurrence_buckets
RETURN asn_low AS asn1, asn_high AS asn2, cooccurrence_buckets
ORDER BY cooccurrence_buckets DESC, asn1 ASC, asn2 ASC
LIMIT 10

(run 1/1) [16/20] temporal :: Which protocol appears most frequently in attacks targeting Germany between 9am and 4pm UTC?
  Attempt 1/1 for query [16/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
[validation] executing: MATCH (ip:IP)-[a:ATTACKS]->(c:Country {name: 'Germany'})
WHERE a.protocol <> 'unknown'
  AND a.documented_create_date.hour >= 9
  AND a.documented_create_date.hour <= 16
WITH a.protocol AS protocol, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 1
RETURN protocol, frequency
[validation] first rows: [{'protocol': 'tcp', 'frequency': 476}]

(run 1/1) [17/20] graph-structure :: Where are most IPs using brute force based or hosted?
  Attempt 1/1 for query [17/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (385 chars)

(run 1/1) [18/20] temporal :: Which country has been the primary target of Data Destruction (MITRE T1485) campaigns?
  Attempt 1/1 for query [18/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (250 chars)

(run 1/1) [19/20] temporal :: Which countries receive attacks most regularly (by number of active days)?
  Attempt 1/1 for query [19/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...
    Extracted partial Cypher from last_run.json (250 chars)

(run 1/1) [20/20] graph-structure :: Identify the top 10 source IP addresses that demonstrate the most persistent malicious activity over time.
  Attempt 1/1 for query [20/20]...
/srv/neo4j/text2Cypher/tools/evaluator.py:215: UserWarning: Parameters {'reasoning'} should be specified explicitly. Instead they were passed in as part of `model_kwargs` parameter.
  st = agent_run(prompt_inner, schema_inner)
    Timeout after 400 seconds. Terminating child process...

================================================================================
EVALUATION SUMMARY
================================================================================
Total queries: 20
Model: gpt-5.2
Duration: 4537.17 seconds
Total tokens: 59,215

Status Breakdown:
  ðŸ”´ ERROR                    :  12 ( 60.0%)
  âœ… SUCCESS                  :   6 ( 30.0%)
  ðŸŸ¡ SUCCESS_ZERO_ROWS        :   2 ( 10.0%)

Error Types:
  ðŸ”´ EMPTY_QUERY                   :   2
  ðŸ”´ OTHER                         :  10

Success Rate: 30.0%

Results saved to: gpt-5.2_results_950k/run_22.json
================================================================================

[Thu Feb 12 12:48:42 UTC 2026] Worker 2: Run #22 completed
[Thu Feb 12 12:48:42 UTC 2026] Worker 2: Tokens in this run: 59215
[Thu Feb 12 12:48:42 UTC 2026] Worker 2: Total tokens: 1203062
[Thu Feb 12 12:48:42 UTC 2026] Worker 2: Progress: 100%
[Thu Feb 12 12:48:42 UTC 2026] Worker 2: Limit reached!
